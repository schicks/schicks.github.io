var eI=Object.defineProperty,tI=Object.defineProperties;var nI=Object.getOwnPropertyDescriptors;var ld=Object.getOwnPropertySymbols;var YE=Object.prototype.hasOwnProperty,VE=Object.prototype.propertyIsEnumerable;var XE=(e,t,n)=>t in e?eI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,x=(e,t)=>{for(var n in t||(t={}))YE.call(t,n)&&XE(e,n,t[n]);if(ld)for(var n of ld(t))VE.call(t,n)&&XE(e,n,t[n]);return e},P=(e,t)=>tI(e,nI(t));var La=e=>typeof e=="symbol"?e:e+"",Z=(e,t)=>{var n={};for(var i in e)YE.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&ld)for(var i of ld(e))t.indexOf(i)<0&&VE.call(e,i)&&(n[i]=e[i]);return n};function Ia(){}function KE(e,t){for(const n in t)e[n]=t[n];return e}function JE(e){return e()}function ZE(){return Object.create(null)}function bl(e){e.forEach(JE)}function iI(e){return typeof e=="function"}function QE(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function rI(e){return Object.keys(e).length===0}function oI(e,t,n,i){if(e){const r=eS(e,t,n,i);return e[0](r)}}function eS(e,t,n,i){return e[1]&&i?KE(n.ctx.slice(),e[1](i(t))):n.ctx}function sI(e,t,n,i){if(e[2]&&i){const r=e[2](i(n));if(t.dirty===void 0)return r;if(typeof r=="object"){const o=[],s=Math.max(t.dirty.length,r.length);for(let a=0;a<s;a+=1)o[a]=t.dirty[a]|r[a];return o}return t.dirty|r}return t.dirty}function aI(e,t,n,i,r,o,s){const a=sI(t,i,r,o);if(a){const u=eS(t,n,i,s);e.p(u,a)}}function uI(e){const t={};for(const n in e)n[0]!=="$"&&(t[n]=e[n]);return t}function lI(e,t){e.appendChild(t)}function tS(e,t,n){e.insertBefore(t,n||null)}function c0(e){e.parentNode.removeChild(e)}function cI(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f0(e){return document.createElement(e)}function fI(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function cd(e){return document.createTextNode(e)}function dI(){return cd(" ")}function hI(){return cd("")}function pI(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function nS(e){return Array.from(e.childNodes)}function gI(e,t,n,i){for(let r=0;r<e.length;r+=1){const o=e[r];if(o.nodeName===t){let s=0;const a=[];for(;s<o.attributes.length;){const u=o.attributes[s++];n[u.name]||a.push(u.name)}for(let u=0;u<a.length;u++)o.removeAttribute(a[u]);return e.splice(r,1)[0]}}return i?fI(t):f0(t)}function iS(e,t){for(let n=0;n<e.length;n+=1){const i=e[n];if(i.nodeType===3)return i.data=""+t,e.splice(n,1)[0]}return cd(t)}function mI(e){return iS(e," ")}function yI(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function vI(e,t,n,i){e.style.setProperty(t,n,i?"important":"")}class bI{constructor(t=null){this.a=t,this.e=this.n=null}m(t,n,i=null){this.e||(this.e=f0(n.nodeName),this.t=n,this.h(t)),this.i(i)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let n=0;n<this.n.length;n+=1)tS(this.t,this.n[n],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(c0)}}let fd;function dd(e){fd=e}function d0(){if(!fd)throw new Error("Function called outside component initialization");return fd}function xI(e){d0().$$.on_mount.push(e)}function wI(e){d0().$$.after_update.push(e)}function _I(e,t){d0().$$.context.set(e,t)}const xl=[],h0=[],hd=[],rS=[],EI=Promise.resolve();let p0=!1;function SI(){p0||(p0=!0,EI.then(oS))}function g0(e){hd.push(e)}let m0=!1;const y0=new Set;function oS(){if(!m0){m0=!0;do{for(let e=0;e<xl.length;e+=1){const t=xl[e];dd(t),AI(t.$$)}for(dd(null),xl.length=0;h0.length;)h0.pop()();for(let e=0;e<hd.length;e+=1){const t=hd[e];y0.has(t)||(y0.add(t),t())}hd.length=0}while(xl.length);for(;rS.length;)rS.pop()();p0=!1,m0=!1,y0.clear()}}function AI(e){if(e.fragment!==null){e.update(),bl(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(g0)}}const pd=new Set;let _s;function kI(){_s={r:0,c:[],p:_s}}function CI(){_s.r||bl(_s.c),_s=_s.p}function sS(e,t){e&&e.i&&(pd.delete(e),e.i(t))}function $I(e,t,n,i){if(e&&e.o){if(pd.has(e))return;pd.add(e),_s.c.push(()=>{pd.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}}function MI(e,t){const n={},i={},r={$$scope:1};let o=e.length;for(;o--;){const s=e[o],a=t[o];if(a){for(const u in s)u in a||(i[u]=1);for(const u in a)r[u]||(n[u]=a[u],r[u]=1);e[o]=a}else for(const u in s)r[u]=1}for(const s in i)s in n||(n[s]=void 0);return n}function FI(e){return typeof e=="object"&&e!==null?e:{}}function DI(e){e&&e.c()}function TI(e,t){e&&e.l(t)}function aS(e,t,n,i){const{fragment:r,on_mount:o,on_destroy:s,after_update:a}=e.$$;r&&r.m(t,n),i||g0(()=>{const u=o.map(JE).filter(iI);s?s.push(...u):bl(u),e.$$.on_mount=[]}),a.forEach(g0)}function uS(e,t){const n=e.$$;n.fragment!==null&&(bl(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function OI(e,t){e.$$.dirty[0]===-1&&(xl.push(e),SI(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function NI(e,t,n,i,r,o,s=[-1]){const a=fd;dd(e);const u=e.$$={fragment:null,ctx:null,props:o,update:Ia,not_equal:r,bound:ZE(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:t.context||[]),callbacks:ZE(),dirty:s,skip_bound:!1};let l=!1;if(u.ctx=n?n(e,t.props||{},(c,f,...d)=>{const h=d.length?d[0]:f;return u.ctx&&r(u.ctx[c],u.ctx[c]=h)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](h),l&&OI(e,c)),f}):[],u.update(),l=!0,bl(u.before_update),u.fragment=i?i(u.ctx):!1,t.target){if(t.hydrate){const c=nS(t.target);u.fragment&&u.fragment.l(c),c.forEach(c0)}else u.fragment&&u.fragment.c();t.intro&&sS(e.$$.fragment),aS(e,t.target,t.anchor,t.customElement),oS()}dd(a)}class RI{$destroy(){uS(this,1),this.$destroy=Ia}$on(t,n){const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!rI(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Pa=[];function LI(e,t=Ia){let n;const i=[];function r(a){if(QE(e,a)&&(e=a,n)){const u=!Pa.length;for(let l=0;l<i.length;l+=1){const c=i[l];c[1](),Pa.push(c,e)}if(u){for(let l=0;l<Pa.length;l+=2)Pa[l][0](Pa[l+1]);Pa.length=0}}}function o(a){r(a(e))}function s(a,u=Ia){const l=[a,u];return i.push(l),i.length===1&&(n=t(r)||Ia),a(e),()=>{const c=i.indexOf(l);c!==-1&&i.splice(c,1),i.length===0&&(n(),n=null)}}return{set:r,update:o,subscribe:s}}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var II=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),PI=Object.prototype.hasOwnProperty;function v0(e,t){return PI.call(e,t)}function b0(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var i in e)v0(e,i)&&n.push(i);return n}function Rn(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function x0(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function Es(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function lS(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function w0(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(w0(e[t]))return!0}else if(typeof e=="object"){for(var i=b0(e),r=i.length,t=0;t<r;t++)if(w0(e[i[t]]))return!0}}return!1}function cS(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r!="undefined"&&n.push(i+": "+r)}return n.join(`
`)}var fS=function(e){II(t,e);function t(n,i,r,o,s){var a=this.constructor,u=e.call(this,cS(n,{name:i,index:r,operation:o,tree:s}))||this;return u.name=i,u.index=r,u.operation=o,u.tree=s,Object.setPrototypeOf(u,a.prototype),u.message=cS(n,{name:i,index:r,operation:o,tree:s}),u}return t}(Error),tt=fS,zI=Rn,za={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=gd(n,this.path);i&&(i=Rn(i));var r=Ss(n,{op:"remove",path:this.from}).removed;return Ss(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=gd(n,this.from);return Ss(n,{op:"add",path:this.path,value:Rn(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:wl(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},BI={add:function(e,t,n){return x0(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:za.move,copy:za.copy,test:za.test,_get:za._get};function gd(e,t){if(t=="")return e;var n={op:"_get",path:t};return Ss(e,n),n.value}function Ss(e,t,n,i,r,o){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):yd(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=gd(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=wl(e,t.value),s.test===!1)throw new tt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(n)throw new tt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}}else{i||(e=Rn(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=yd;;){if(h=u[c],r&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!x0(h))throw new tt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);x0(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new tt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var s=BI[t.op].call(t,l,h,e);if(s.test===!1)throw new tt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(h&&h.indexOf("~")!=-1&&(h=lS(h)),c>=f){var s=za[t.op].call(t,l,h,e);if(s.test===!1)throw new tt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}l=l[h]}}}function md(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new tt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=Rn(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=Ss(e,t[s],n,!0,r,s),e=o[s].newDocument;return o.newDocument=e,o}function UI(e,t,n){var i=Ss(e,t);if(i.test===!1)throw new tt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function yd(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new tt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(za[e.op]){if(typeof e.path!="string")throw new tt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new tt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new tt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new tt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&w0(e.value))throw new tt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,o=i.split("/").length;if(r!==o+1&&r!==o)throw new tt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new tt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},a=dS([s],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new tt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new tt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function dS(e,t,n){try{if(!Array.isArray(e))throw new tt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)md(Rn(t),Rn(e),n||!0);else{n=n||yd;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof tt)return r;throw r}}function wl(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,o,s;if(n&&i){if(o=e.length,o!=t.length)return!1;for(r=o;r--!=0;)if(!wl(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if(o=a.length,o!==Object.keys(t).length)return!1;for(r=o;r--!=0;)if(!t.hasOwnProperty(a[r]))return!1;for(r=o;r--!=0;)if(s=a[r],!wl(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}var jI=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:tt,deepClone:zI,getValueByPointer:gd,applyOperation:Ss,applyPatch:md,applyReducer:UI,validator:yd,validate:dS,_areEquals:wl});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var _0=new WeakMap,qI=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),WI=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function HI(e){return _0.get(e)}function GI(e,t){return e.observers.get(t)}function YI(e,t){e.observers.delete(t.callback)}function VI(e,t){t.unobserve()}function XI(e,t){var n=[],i,r=HI(e);if(!r)r=new qI(e),_0.set(e,r);else{var o=GI(r,t);i=o&&o.observer}if(i)return i;if(i={},r.value=Rn(e),t){i.callback=t,i.next=null;var s=function(){E0(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(s)};typeof window!="undefined"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=n,i.object=e,i.unobserve=function(){E0(i),clearTimeout(i.next),YI(r,i),typeof window!="undefined"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new WI(t,i)),i}function E0(e,t){t===void 0&&(t=!1);var n=_0.get(e.object);S0(n.value,e.object,e.patches,"",t),e.patches.length&&md(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function S0(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=b0(t),s=b0(e),a=!1,u=s.length-1;u>=0;u--){var l=s[u],c=e[l];if(v0(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null?S0(c,f,n,i+"/"+Es(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+Es(l),value:Rn(c)}),n.push({op:"replace",path:i+"/"+Es(l),value:Rn(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+Es(l),value:Rn(c)}),n.push({op:"remove",path:i+"/"+Es(l)}),a=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!a&&o.length==s.length))for(var u=0;u<o.length;u++){var l=o[u];!v0(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+Es(l),value:Rn(t[l])})}}}function KI(e,t,n){n===void 0&&(n=!1);var i=[];return S0(e,t,i,"",n),i}var JI=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:VI,observe:XI,generate:E0,compare:KI});Object.assign({},jI,JI,{JsonPatchError:fS,deepClone:Rn,escapePathComponent:Es,unescapePathComponent:lS});var ZI=/("(?:[^\\"]|\\.)*")|[:,]/g,A0=function(t,n){var i,r,o;return n=n||{},i=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),r=i===""?Infinity:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function s(a,u,l){var c,f,d,h,p,g,m,y,v,b,w,E;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),w=JSON.stringify(a,o),w===void 0)return w;if(m=r-u.length-l,w.length<=m&&(v=w.replace(ZI,function(S,_){return _||S+" "}),v.length<=m))return v;if(o!=null&&(a=JSON.parse(w),o=void 0),typeof a=="object"&&a!==null){if(y=u+i,d=[],f=0,Array.isArray(a))for(b="[",c="]",m=a.length;f<m;f++)d.push(s(a[f],y,f===m-1?0:1)||"null");else for(b="{",c="}",g=Object.keys(a),m=g.length;f<m;f++)h=g[f],p=JSON.stringify(h)+": ",E=s(a[h],y,p.length+(f===m-1?0:1)),E!==void 0&&d.push(p+E);if(d.length>0)return[b,i+d.join(`,
`+y),c].join(`
`+u)}return w}(t,"",0)},fo={exports:{}};const QI="2.0.0",e8=256,t8=Number.MAX_SAFE_INTEGER||9007199254740991,n8=16;var vd={SEMVER_SPEC_VERSION:QI,MAX_LENGTH:e8,MAX_SAFE_INTEGER:t8,MAX_SAFE_COMPONENT_LENGTH:n8};const i8=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var bd=i8;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=vd,i=bd;t=e.exports={};const r=t.re=[],o=t.src=[],s=t.t={};let a=0;const u=(l,c,f)=>{const d=a++;i(d,c),s[l]=d,o[d]=c,r[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),u("FULL",`^${o[s.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),u("LOOSE",`^${o[s.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${o[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${o[s.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),u("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",o[s.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(fo,fo.exports);const r8=["includePrerelease","loose","rtl"],o8=e=>e?typeof e!="object"?{loose:!0}:r8.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var xd=o8;const hS=/^[0-9]+$/,pS=(e,t)=>{const n=hS.test(e),i=hS.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1},s8=(e,t)=>pS(t,e);var k0={compareIdentifiers:pS,rcompareIdentifiers:s8};const wd=bd,{MAX_LENGTH:gS,MAX_SAFE_INTEGER:_d}=vd,{re:mS,t:yS}=fo.exports,a8=xd,{compareIdentifiers:_l}=k0;class gi{constructor(t,n){if(n=a8(n),t instanceof gi){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>gS)throw new TypeError(`version is longer than ${gS} characters`);wd("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const i=t.trim().match(n.loose?mS[yS.LOOSE]:mS[yS.FULL]);if(!i)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>_d||this.major<0)throw new TypeError("Invalid major version");if(this.minor>_d||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>_d||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){const o=+r;if(o>=0&&o<_d)return o}return r}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(wd("SemVer.compare",this.version,this.options,t),!(t instanceof gi)){if(typeof t=="string"&&t===this.version)return 0;t=new gi(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof gi||(t=new gi(t,this.options)),_l(this.major,t.major)||_l(this.minor,t.minor)||_l(this.patch,t.patch)}comparePre(t){if(t instanceof gi||(t=new gi(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const i=this.prerelease[n],r=t.prerelease[n];if(wd("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return _l(i,r)}while(++n)}compareBuild(t){t instanceof gi||(t=new gi(t,this.options));let n=0;do{const i=this.build[n],r=t.build[n];if(wd("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return _l(i,r)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);i===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var Jt=gi;const{MAX_LENGTH:u8}=vd,{re:vS,t:bS}=fo.exports,xS=Jt,l8=xd,c8=(e,t)=>{if(t=l8(t),e instanceof xS)return e;if(typeof e!="string"||e.length>u8||!(t.loose?vS[bS.LOOSE]:vS[bS.FULL]).test(e))return null;try{return new xS(e,t)}catch(i){return null}};var Ba=c8;const f8=Ba,d8=(e,t)=>{const n=f8(e,t);return n?n.version:null};var h8=d8;const p8=Ba,g8=(e,t)=>{const n=p8(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var m8=g8;const y8=Jt,v8=(e,t,n,i)=>{typeof n=="string"&&(i=n,n=void 0);try{return new y8(e,n).inc(t,i).version}catch(r){return null}};var b8=v8;const wS=Jt,x8=(e,t,n)=>new wS(e,n).compare(new wS(t,n));var mi=x8;const w8=mi,_8=(e,t,n)=>w8(e,t,n)===0;var C0=_8;const _S=Ba,E8=C0,S8=(e,t)=>{if(E8(e,t))return null;{const n=_S(e),i=_S(t),r=n.prerelease.length||i.prerelease.length,o=r?"pre":"",s=r?"prerelease":"";for(const a in n)if((a==="major"||a==="minor"||a==="patch")&&n[a]!==i[a])return o+a;return s}};var A8=S8;const k8=Jt,C8=(e,t)=>new k8(e,t).major;var $8=C8;const M8=Jt,F8=(e,t)=>new M8(e,t).minor;var D8=F8;const T8=Jt,O8=(e,t)=>new T8(e,t).patch;var N8=O8;const R8=Ba,L8=(e,t)=>{const n=R8(e,t);return n&&n.prerelease.length?n.prerelease:null};var I8=L8;const P8=mi,z8=(e,t,n)=>P8(t,e,n);var B8=z8;const U8=mi,j8=(e,t)=>U8(e,t,!0);var q8=j8;const ES=Jt,W8=(e,t,n)=>{const i=new ES(e,n),r=new ES(t,n);return i.compare(r)||i.compareBuild(r)};var $0=W8;const H8=$0,G8=(e,t)=>e.sort((n,i)=>H8(n,i,t));var Y8=G8;const V8=$0,X8=(e,t)=>e.sort((n,i)=>V8(i,n,t));var K8=X8;const J8=mi,Z8=(e,t,n)=>J8(e,t,n)>0;var Ed=Z8;const Q8=mi,eP=(e,t,n)=>Q8(e,t,n)<0;var M0=eP;const tP=mi,nP=(e,t,n)=>tP(e,t,n)!==0;var SS=nP;const iP=mi,rP=(e,t,n)=>iP(e,t,n)>=0;var F0=rP;const oP=mi,sP=(e,t,n)=>oP(e,t,n)<=0;var D0=sP;const aP=C0,uP=SS,lP=Ed,cP=F0,fP=M0,dP=D0,hP=(e,t,n,i)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return aP(e,n,i);case"!=":return uP(e,n,i);case">":return lP(e,n,i);case">=":return cP(e,n,i);case"<":return fP(e,n,i);case"<=":return dP(e,n,i);default:throw new TypeError(`Invalid operator: ${t}`)}};var AS=hP;const pP=Jt,gP=Ba,{re:Sd,t:Ad}=fo.exports,mP=(e,t)=>{if(e instanceof pP)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(Sd[Ad.COERCE]);else{let i;for(;(i=Sd[Ad.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||i.index+i[0].length!==n.index+n[0].length)&&(n=i),Sd[Ad.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;Sd[Ad.COERCERTL].lastIndex=-1}return n===null?null:gP(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var yP=mP,vP=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}},bP=Ee;Ee.Node=As,Ee.create=Ee;function Ee(e){var t=this;if(t instanceof Ee||(t=new Ee),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(r){t.push(r)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}Ee.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Ee.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Ee.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Ee.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)wP(this,arguments[e]);return this.length},Ee.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)_P(this,arguments[e]);return this.length},Ee.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Ee.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Ee.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;n!==null;i++)e.call(t,n.value,i,this),n=n.next},Ee.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;n!==null;i--)e.call(t,n.value,i,this),n=n.prev},Ee.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value},Ee.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value},Ee.prototype.map=function(e,t){t=t||this;for(var n=new Ee,i=this.head;i!==null;)n.push(e.call(t,i.value,this)),i=i.next;return n},Ee.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Ee,i=this.tail;i!==null;)n.push(e.call(t,i.value,this)),i=i.prev;return n},Ee.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else if(this.head)i=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=0;i!==null;r++)n=e(n,i.value,r),i=i.next;return n},Ee.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else if(this.tail)i=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=this.length-1;i!==null;r--)n=e(n,i.value,r),i=i.prev;return n},Ee.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e},Ee.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e},Ee.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Ee;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(;r!==null&&i<t;i++,r=r.next)n.push(r.value);return n},Ee.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Ee;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;r!==null&&i>t;i--)r=r.prev;for(;r!==null&&i>e;i--,r=r.prev)n.push(r.value);return n},Ee.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(var o=[],i=0;r&&i<t;i++)o.push(r.value),r=this.removeNode(r);r===null&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(var i=0;i<n.length;i++)r=xP(this,r,n[i]);return o},Ee.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};function xP(e,t,n){var i=t===e.head?new As(n,null,t,e):new As(n,t,t.next,e);return i.next===null&&(e.tail=i),i.prev===null&&(e.head=i),e.length++,i}function wP(e,t){e.tail=new As(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function _P(e,t){e.head=new As(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function As(e,t,n,i){if(!(this instanceof As))return new As(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{vP(Ee)}catch(e){}const EP=bP,ks=Symbol("max"),$r=Symbol("length"),Ua=Symbol("lengthCalculator"),El=Symbol("allowStale"),Cs=Symbol("maxAge"),Mr=Symbol("dispose"),kS=Symbol("noDisposeOnSet"),yt=Symbol("lruList"),yi=Symbol("cache"),CS=Symbol("updateAgeOnGet"),T0=()=>1;class SP{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[ks]=t.max||Infinity;const n=t.length||T0;if(this[Ua]=typeof n!="function"?T0:n,this[El]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Cs]=t.maxAge||0,this[Mr]=t.dispose,this[kS]=t.noDisposeOnSet||!1,this[CS]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[ks]=t||Infinity,Sl(this)}get max(){return this[ks]}set allowStale(t){this[El]=!!t}get allowStale(){return this[El]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Cs]=t,Sl(this)}get maxAge(){return this[Cs]}set lengthCalculator(t){typeof t!="function"&&(t=T0),t!==this[Ua]&&(this[Ua]=t,this[$r]=0,this[yt].forEach(n=>{n.length=this[Ua](n.value,n.key),this[$r]+=n.length})),Sl(this)}get lengthCalculator(){return this[Ua]}get length(){return this[$r]}get itemCount(){return this[yt].length}rforEach(t,n){n=n||this;for(let i=this[yt].tail;i!==null;){const r=i.prev;$S(this,t,i,n),i=r}}forEach(t,n){n=n||this;for(let i=this[yt].head;i!==null;){const r=i.next;$S(this,t,i,n),i=r}}keys(){return this[yt].toArray().map(t=>t.key)}values(){return this[yt].toArray().map(t=>t.value)}reset(){this[Mr]&&this[yt]&&this[yt].length&&this[yt].forEach(t=>this[Mr](t.key,t.value)),this[yi]=new Map,this[yt]=new EP,this[$r]=0}dump(){return this[yt].map(t=>kd(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[yt]}set(t,n,i){if(i=i||this[Cs],i&&typeof i!="number")throw new TypeError("maxAge must be a number");const r=i?Date.now():0,o=this[Ua](n,t);if(this[yi].has(t)){if(o>this[ks])return ja(this,this[yi].get(t)),!1;const u=this[yi].get(t).value;return this[Mr]&&(this[kS]||this[Mr](t,u.value)),u.now=r,u.maxAge=i,u.value=n,this[$r]+=o-u.length,u.length=o,this.get(t),Sl(this),!0}const s=new AP(t,n,o,r,i);return s.length>this[ks]?(this[Mr]&&this[Mr](t,n),!1):(this[$r]+=s.length,this[yt].unshift(s),this[yi].set(t,this[yt].head),Sl(this),!0)}has(t){if(!this[yi].has(t))return!1;const n=this[yi].get(t).value;return!kd(this,n)}get(t){return O0(this,t,!0)}peek(t){return O0(this,t,!1)}pop(){const t=this[yt].tail;return t?(ja(this,t),t.value):null}del(t){ja(this,this[yi].get(t))}load(t){this.reset();const n=Date.now();for(let i=t.length-1;i>=0;i--){const r=t[i],o=r.e||0;if(o===0)this.set(r.k,r.v);else{const s=o-n;s>0&&this.set(r.k,r.v,s)}}}prune(){this[yi].forEach((t,n)=>O0(this,n,!1))}}const O0=(e,t,n)=>{const i=e[yi].get(t);if(i){const r=i.value;if(kd(e,r)){if(ja(e,i),!e[El])return}else n&&(e[CS]&&(i.value.now=Date.now()),e[yt].unshiftNode(i));return r.value}},kd=(e,t)=>{if(!t||!t.maxAge&&!e[Cs])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Cs]&&n>e[Cs]},Sl=e=>{if(e[$r]>e[ks])for(let t=e[yt].tail;e[$r]>e[ks]&&t!==null;){const n=t.prev;ja(e,t),t=n}},ja=(e,t)=>{if(t){const n=t.value;e[Mr]&&e[Mr](n.key,n.value),e[$r]-=n.length,e[yi].delete(n.key),e[yt].removeNode(t)}};class AP{constructor(t,n,i,r,o){this.key=t,this.value=n,this.length=i,this.now=r,this.maxAge=o||0}}const $S=(e,t,n,i)=>{let r=n.value;kd(e,r)&&(ja(e,n),e[El]||(r=void 0)),r&&t.call(i,r.value,r.key,e)};var kP=SP;class Al{constructor(t,n){if(n=$P(n),t instanceof Al)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new Al(t.raw,n);if(t instanceof N0)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(i=>this.parseRange(i.trim())).filter(i=>i.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const i=this.set[0];if(this.set=this.set.filter(r=>!FS(r[0])),this.set.length===0)this.set=[i];else if(this.set.length>1){for(const r of this.set)if(r.length===1&&OP(r[0])){this.set=[r];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const i=`parseRange:${Object.keys(this.options).join(",")}:${t}`,r=MS.get(i);if(r)return r;const o=this.options.loose,s=o?Rt[Ct.HYPHENRANGELOOSE]:Rt[Ct.HYPHENRANGE];t=t.replace(s,qP(this.options.includePrerelease)),nt("hyphen replace",t),t=t.replace(Rt[Ct.COMPARATORTRIM],FP),nt("comparator trim",t,Rt[Ct.COMPARATORTRIM]),t=t.replace(Rt[Ct.TILDETRIM],DP),t=t.replace(Rt[Ct.CARETTRIM],TP),t=t.split(/\s+/).join(" ");const a=o?Rt[Ct.COMPARATORLOOSE]:Rt[Ct.COMPARATOR],u=t.split(" ").map(f=>NP(f,this.options)).join(" ").split(/\s+/).map(f=>jP(f,this.options)).filter(this.options.loose?f=>!!f.match(a):()=>!0).map(f=>new N0(f,this.options));u.length;const l=new Map;for(const f of u){if(FS(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return MS.set(i,c),c}intersects(t,n){if(!(t instanceof Al))throw new TypeError("a Range is required");return this.set.some(i=>DS(i,n)&&t.set.some(r=>DS(r,n)&&i.every(o=>r.every(s=>o.intersects(s,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new MP(t,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(WP(this.set[n],t,this.options))return!0;return!1}}var vi=Al;const CP=kP,MS=new CP({max:1e3}),$P=xd,N0=$d,nt=bd,MP=Jt,{re:Rt,t:Ct,comparatorTrimReplace:FP,tildeTrimReplace:DP,caretTrimReplace:TP}=fo.exports,FS=e=>e.value==="<0.0.0-0",OP=e=>e.value==="",DS=(e,t)=>{let n=!0;const i=e.slice();let r=i.pop();for(;n&&i.length;)n=i.every(o=>r.intersects(o,t)),r=i.pop();return n},NP=(e,t)=>(nt("comp",e,t),e=IP(e,t),nt("caret",e),e=RP(e,t),nt("tildes",e),e=zP(e,t),nt("xrange",e),e=UP(e,t),nt("stars",e),e),Zt=e=>!e||e.toLowerCase()==="x"||e==="*",RP=(e,t)=>e.trim().split(/\s+/).map(n=>LP(n,t)).join(" "),LP=(e,t)=>{const n=t.loose?Rt[Ct.TILDELOOSE]:Rt[Ct.TILDE];return e.replace(n,(i,r,o,s,a)=>{nt("tilde",e,i,r,o,s,a);let u;return Zt(r)?u="":Zt(o)?u=`>=${r}.0.0 <${+r+1}.0.0-0`:Zt(s)?u=`>=${r}.${o}.0 <${r}.${+o+1}.0-0`:a?(nt("replaceTilde pr",a),u=`>=${r}.${o}.${s}-${a} <${r}.${+o+1}.0-0`):u=`>=${r}.${o}.${s} <${r}.${+o+1}.0-0`,nt("tilde return",u),u})},IP=(e,t)=>e.trim().split(/\s+/).map(n=>PP(n,t)).join(" "),PP=(e,t)=>{nt("caret",e,t);const n=t.loose?Rt[Ct.CARETLOOSE]:Rt[Ct.CARET],i=t.includePrerelease?"-0":"";return e.replace(n,(r,o,s,a,u)=>{nt("caret",e,r,o,s,a,u);let l;return Zt(o)?l="":Zt(s)?l=`>=${o}.0.0${i} <${+o+1}.0.0-0`:Zt(a)?o==="0"?l=`>=${o}.${s}.0${i} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.0${i} <${+o+1}.0.0-0`:u?(nt("replaceCaret pr",u),o==="0"?s==="0"?l=`>=${o}.${s}.${a}-${u} <${o}.${s}.${+a+1}-0`:l=`>=${o}.${s}.${a}-${u} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.${a}-${u} <${+o+1}.0.0-0`):(nt("no pr"),o==="0"?s==="0"?l=`>=${o}.${s}.${a}${i} <${o}.${s}.${+a+1}-0`:l=`>=${o}.${s}.${a}${i} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.${a} <${+o+1}.0.0-0`),nt("caret return",l),l})},zP=(e,t)=>(nt("replaceXRanges",e,t),e.split(/\s+/).map(n=>BP(n,t)).join(" ")),BP=(e,t)=>{e=e.trim();const n=t.loose?Rt[Ct.XRANGELOOSE]:Rt[Ct.XRANGE];return e.replace(n,(i,r,o,s,a,u)=>{nt("xRange",e,i,r,o,s,a,u);const l=Zt(o),c=l||Zt(s),f=c||Zt(a),d=f;return r==="="&&d&&(r=""),u=t.includePrerelease?"-0":"",l?r===">"||r==="<"?i="<0.0.0-0":i="*":r&&d?(c&&(s=0),a=0,r===">"?(r=">=",c?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):r==="<="&&(r="<",c?o=+o+1:s=+s+1),r==="<"&&(u="-0"),i=`${r+o}.${s}.${a}${u}`):c?i=`>=${o}.0.0${u} <${+o+1}.0.0-0`:f&&(i=`>=${o}.${s}.0${u} <${o}.${+s+1}.0-0`),nt("xRange return",i),i})},UP=(e,t)=>(nt("replaceStars",e,t),e.trim().replace(Rt[Ct.STAR],"")),jP=(e,t)=>(nt("replaceGTE0",e,t),e.trim().replace(Rt[t.includePrerelease?Ct.GTE0PRE:Ct.GTE0],"")),qP=e=>(t,n,i,r,o,s,a,u,l,c,f,d,h)=>(Zt(i)?n="":Zt(r)?n=`>=${i}.0.0${e?"-0":""}`:Zt(o)?n=`>=${i}.${r}.0${e?"-0":""}`:s?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,Zt(l)?u="":Zt(c)?u=`<${+l+1}.0.0-0`:Zt(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),WP=(e,t,n)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let i=0;i<e.length;i++)if(nt(e[i].semver),e[i].semver!==N0.ANY&&e[i].semver.prerelease.length>0){const r=e[i].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0},kl=Symbol("SemVer ANY");class Cd{static get ANY(){return kl}constructor(t,n){if(n=HP(n),t instanceof Cd){if(t.loose===!!n.loose)return t;t=t.value}L0("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===kl?this.value="":this.value=this.operator+this.semver.version,L0("comp",this)}parse(t){const n=this.options.loose?TS[OS.COMPARATORLOOSE]:TS[OS.COMPARATOR],i=t.match(n);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=i[1]!==void 0?i[1]:"",this.operator==="="&&(this.operator=""),i[2]?this.semver=new NS(i[2],this.options.loose):this.semver=kl}toString(){return this.value}test(t){if(L0("Comparator.test",t,this.options.loose),this.semver===kl||t===kl)return!0;if(typeof t=="string")try{t=new NS(t,this.options)}catch(n){return!1}return R0(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof Cd))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new RS(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new RS(this.value,n).test(t.semver);const i=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),r=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),o=this.semver.version===t.semver.version,s=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),a=R0(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=R0(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return i||r||o&&s||a||u}}var $d=Cd;const HP=xd,{re:TS,t:OS}=fo.exports,R0=AS,L0=bd,NS=Jt,RS=vi,GP=vi,YP=(e,t,n)=>{try{t=new GP(t,n)}catch(i){return!1}return t.test(e)};var Md=YP;const VP=vi,XP=(e,t)=>new VP(e,t).set.map(n=>n.map(i=>i.value).join(" ").trim().split(" "));var KP=XP;const JP=Jt,ZP=vi,QP=(e,t,n)=>{let i=null,r=null,o=null;try{o=new ZP(t,n)}catch(s){return null}return e.forEach(s=>{o.test(s)&&(!i||r.compare(s)===-1)&&(i=s,r=new JP(i,n))}),i};var e9=QP;const t9=Jt,n9=vi,i9=(e,t,n)=>{let i=null,r=null,o=null;try{o=new n9(t,n)}catch(s){return null}return e.forEach(s=>{o.test(s)&&(!i||r.compare(s)===1)&&(i=s,r=new t9(i,n))}),i};var r9=i9;const I0=Jt,o9=vi,LS=Ed,s9=(e,t)=>{e=new o9(e,t);let n=new I0("0.0.0");if(e.test(n)||(n=new I0("0.0.0-0"),e.test(n)))return n;n=null;for(let i=0;i<e.set.length;++i){const r=e.set[i];let o=null;r.forEach(s=>{const a=new I0(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!o||LS(a,o))&&(o=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),o&&(!n||LS(n,o))&&(n=o)}return n&&e.test(n)?n:null};var a9=s9;const u9=vi,l9=(e,t)=>{try{return new u9(e,t).range||"*"}catch(n){return null}};var c9=l9;const f9=Jt,IS=$d,{ANY:d9}=IS,h9=vi,p9=Md,PS=Ed,zS=M0,g9=D0,m9=F0,y9=(e,t,n,i)=>{e=new f9(e,i),t=new h9(t,i);let r,o,s,a,u;switch(n){case">":r=PS,o=g9,s=zS,a=">",u=">=";break;case"<":r=zS,o=m9,s=PS,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(p9(e,t,i))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===d9&&(h=new IS(">=0.0.0")),f=f||h,d=d||h,r(h.semver,f.semver,i)?f=h:s(h.semver,d.semver,i)&&(d=h)}),f.operator===a||f.operator===u||(!d.operator||d.operator===a)&&o(e,d.semver))return!1;if(d.operator===u&&s(e,d.semver))return!1}return!0};var P0=y9;const v9=P0,b9=(e,t,n)=>v9(e,t,">",n);var x9=b9;const w9=P0,_9=(e,t,n)=>w9(e,t,"<",n);var E9=_9;const BS=vi,S9=(e,t,n)=>(e=new BS(e,n),t=new BS(t,n),e.intersects(t));var A9=S9;const k9=Md,C9=mi;var $9=(e,t,n)=>{const i=[];let r=null,o=null;const s=e.sort((c,f)=>C9(c,f,n));for(const c of s)k9(c,t,n)?(o=c,r||(r=c)):(o&&i.push([r,o]),o=null,r=null);r&&i.push([r,null]);const a=[];for(const[c,f]of i)c===f?a.push(c):!f&&c===s[0]?a.push("*"):f?c===s[0]?a.push(`<=${f}`):a.push(`${c} - ${f}`):a.push(`>=${c}`);const u=a.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const US=vi,Fd=$d,{ANY:z0}=Fd,Cl=Md,B0=mi,M9=(e,t,n={})=>{if(e===t)return!0;e=new US(e,n),t=new US(t,n);let i=!1;e:for(const r of e.set){for(const o of t.set){const s=F9(r,o,n);if(i=i||s!==null,s)continue e}if(i)return!1}return!0},F9=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===z0){if(t.length===1&&t[0].semver===z0)return!0;n.includePrerelease?e=[new Fd(">=0.0.0-0")]:e=[new Fd(">=0.0.0")]}if(t.length===1&&t[0].semver===z0){if(n.includePrerelease)return!0;t=[new Fd(">=0.0.0")]}const i=new Set;let r,o;for(const h of e)h.operator===">"||h.operator===">="?r=jS(r,h,n):h.operator==="<"||h.operator==="<="?o=qS(o,h,n):i.add(h.semver);if(i.size>1)return null;let s;if(r&&o){if(s=B0(r.semver,o.semver,n),s>0)return null;if(s===0&&(r.operator!==">="||o.operator!=="<="))return null}for(const h of i){if(r&&!Cl(h,String(r),n)||o&&!Cl(h,String(o),n))return null;for(const p of t)if(!Cl(h,String(p),n))return!1;return!0}let a,u,l,c,f=o&&!n.includePrerelease&&o.semver.prerelease.length?o.semver:!1,d=r&&!n.includePrerelease&&r.semver.prerelease.length?r.semver:!1;f&&f.prerelease.length===1&&o.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",r){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(a=jS(r,h,n),a===h&&a!==r)return!1}else if(r.operator===">="&&!Cl(r.semver,String(h),n))return!1}if(o){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=qS(o,h,n),u===h&&u!==o)return!1}else if(o.operator==="<="&&!Cl(o.semver,String(h),n))return!1}if(!h.operator&&(o||r)&&s!==0)return!1}return!(r&&l&&!o&&s!==0||o&&c&&!r&&s!==0||d||f)},jS=(e,t,n)=>{if(!e)return t;const i=B0(e.semver,t.semver,n);return i>0?e:i<0||t.operator===">"&&e.operator===">="?t:e},qS=(e,t,n)=>{if(!e)return t;const i=B0(e.semver,t.semver,n);return i<0?e:i>0||t.operator==="<"&&e.operator==="<="?t:e};var D9=M9;const U0=fo.exports;var WS={re:U0.re,src:U0.src,tokens:U0.t,SEMVER_SPEC_VERSION:vd.SEMVER_SPEC_VERSION,SemVer:Jt,compareIdentifiers:k0.compareIdentifiers,rcompareIdentifiers:k0.rcompareIdentifiers,parse:Ba,valid:h8,clean:m8,inc:b8,diff:A8,major:$8,minor:D8,patch:N8,prerelease:I8,compare:mi,rcompare:B8,compareLoose:q8,compareBuild:$0,sort:Y8,rsort:K8,gt:Ed,lt:M0,eq:C0,neq:SS,gte:F0,lte:D0,cmp:AS,coerce:yP,Comparator:$d,Range:vi,satisfies:Md,toComparators:KP,maxSatisfying:e9,minSatisfying:r9,minVersion:a9,validRange:c9,outside:P0,gtr:x9,ltr:E9,intersects:A9,simplifyRange:$9,subset:D9};function vn(e,t,n){return e.fields=t||[],e.fname=n,e}function Je(e){return e==null?null:e.fname}function Lt(e){return e==null?null:e.fields}function HS(e){return e.length===1?T9(e[0]):O9(e)}const T9=e=>function(t){return t[e]},O9=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function N(e){throw Error(e)}function ji(e){const t=[],n=e.length;let i=null,r=0,o="",s,a,u;e=e+"";function l(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(u=e[a],u==="\\")o+=e.substring(s,a),o+=e.substring(++a,++a),s=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;s===r&&u==='"'||s===r&&u==="'"?(s=a+1,i=u):u==="."&&!r?a>s?l():s=a+1:u==="["?(a>s&&l(),r=s=a+1):u==="]"&&(r||N("Access path missing open bracket: "+e),r>0&&l(),r=0,s=a+1)}return r&&N("Access path missing closing bracket: "+e),i&&N("Access path missing closing quote: "+e),a>s&&(a++,l()),t}function bn(e,t,n){const i=ji(e);return e=i.length===1?i[0]:e,vn((n&&n.get||HS)(i),[e],t||e)}const $l=bn("id"),It=vn(e=>e,[],"identity"),ho=vn(()=>0,[],"zero"),qa=vn(()=>1,[],"one"),Vn=vn(()=>!0,[],"true"),po=vn(()=>!1,[],"false");function Dd(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const GS=0,j0=1,q0=2,YS=3,VS=4;function W0(e,t){let n=e||GS;return{level(i){return arguments.length?(n=+i,this):n},error(){return n>=j0&&Dd(t||"error","ERROR",arguments),this},warn(){return n>=q0&&Dd(t||"warn","WARN",arguments),this},info(){return n>=YS&&Dd(t||"log","INFO",arguments),this},debug(){return n>=VS&&Dd(t||"log","DEBUG",arguments),this}}}var R=Array.isArray;function J(e){return e===Object(e)}const XS=e=>e!=="__proto__";function Wa(...e){return e.reduce((t,n)=>{for(const i in n)if(i==="signals")t.signals=N9(t.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;Ml(t,i,n[i],r)}return t},{})}function Ml(e,t,n,i){if(!XS(t))return;let r,o;if(J(n)&&!R(n)){o=J(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?Ml(o,r,n[r]):XS(r)&&(o[r]=n[r])}else e[t]=n}function N9(e,t){if(e==null)return t;const n={},i=[];function r(o){n[o.name]||(n[o.name]=1,i.push(o))}return t.forEach(r),e.forEach(r),i}function be(e){return e[e.length-1]}function Pt(e){return e==null||e===""?null:+e}const KS=e=>t=>e*Math.exp(t),JS=e=>t=>Math.log(e*t),ZS=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),QS=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Td=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Od(e,t,n,i){const r=n(e[0]),o=n(be(e)),s=(o-r)*t;return[i(r-s),i(o-s)]}function eA(e,t){return Od(e,t,Pt,It)}function tA(e,t){var n=Math.sign(e[0]);return Od(e,t,JS(n),KS(n))}function nA(e,t,n){return Od(e,t,Td(n),Td(1/n))}function iA(e,t,n){return Od(e,t,ZS(n),QS(n))}function Nd(e,t,n,i,r){const o=i(e[0]),s=i(be(e)),a=t!=null?i(t):(o+s)/2;return[r(a+(o-a)*n),r(a+(s-a)*n)]}function H0(e,t,n){return Nd(e,t,n,Pt,It)}function G0(e,t,n){const i=Math.sign(e[0]);return Nd(e,t,n,JS(i),KS(i))}function Rd(e,t,n,i){return Nd(e,t,n,Td(i),Td(1/i))}function Y0(e,t,n,i){return Nd(e,t,n,ZS(i),QS(i))}function rA(e){return 1+~~(new Date(e).getMonth()/3)}function oA(e){return 1+~~(new Date(e).getUTCMonth()/3)}function K(e){return e!=null?R(e)?e:[e]:[]}function sA(e,t,n){let i=e[0],r=e[1],o;return r<i&&(o=r,r=i,i=o),o=r-i,o>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-o),i+o]}function fe(e){return typeof e=="function"}const R9="descending";function V0(e,t,n){n=n||{},t=K(t)||[];const i=[],r=[],o={},s=n.comparator||L9;return K(e).forEach((a,u)=>{a!=null&&(i.push(t[u]===R9?-1:1),r.push(a=fe(a)?a:bn(a,null,n)),(Lt(a)||[]).forEach(l=>o[l]=1))}),r.length===0?null:vn(s(r,i),Object.keys(o))}const Ld=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),L9=(e,t)=>e.length===1?I9(e[0],t[0]):P9(e,t,e.length),I9=(e,t)=>function(n,i){return Ld(e(n),e(i))*t},P9=(e,t,n)=>(t.push(0),function(i,r){let o,s=0,a=-1;for(;s===0&&++a<n;)o=e[a],s=Ld(o(i),o(r));return s*t[a]});function zt(e){return fe(e)?e:()=>e}function X0(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function de(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function qi(e,t){let n=0,i,r,o,s;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(o=s=r;n<i;++n)r=e[n],r!=null&&(r<o&&(o=r),r>s&&(s=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(o=s=r;n<i;++n)r=t(e[n]),r!=null&&(r<o&&(o=r),r>s&&(s=r))}return[o,s]}function aA(e,t){const n=e.length;let i=-1,r,o,s,a,u;if(t==null){for(;++i<n;)if(o=e[i],o!=null&&o>=o){r=s=o;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)o=e[i],o!=null&&(r>o&&(r=o,a=i),s<o&&(s=o,u=i))}else{for(;++i<n;)if(o=t(e[i],i,e),o!=null&&o>=o){r=s=o;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)o=t(e[i],i,e),o!=null&&(r>o&&(r=o,a=i),s<o&&(s=o,u=i))}return[a,u]}const z9=Object.prototype.hasOwnProperty;function te(e,t){return z9.call(e,t)}const Id={};function Ha(e){let t={},n;function i(o){return te(t,o)&&t[o]!==Id}const r={size:0,empty:0,object:t,has:i,get(o){return i(o)?t[o]:void 0},set(o,s){return i(o)||(++r.size,t[o]===Id&&--r.empty),t[o]=s,this},delete(o){return i(o)&&(--r.size,++r.empty,t[o]=Id),this},clear(){r.size=r.empty=0,r.object=t={}},test(o){return arguments.length?(n=o,r):n},clean(){const o={};let s=0;for(const a in t){const u=t[a];u!==Id&&(!n||!n(u))&&(o[a]=u,++s)}r.size=s,r.empty=0,r.object=t=o}};return e&&Object.keys(e).forEach(o=>{r.set(o,e[o])}),r}function uA(e,t,n,i,r,o){if(!n&&n!==0)return o;const s=+n;let a=e[0],u=be(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=s?i:c<=s?r:o}function q(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),de(i,n)}function Ga(e,t,n,i){let r=t[0],o=t[t.length-1],s;return r>o&&(s=r,r=o,o=s),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=o:e<o)}function go(e){return typeof e=="boolean"}function mo(e){return Object.prototype.toString.call(e)==="[object Date]"}function lA(e){return e&&fe(e[Symbol.iterator])}function Oe(e){return typeof e=="number"}function cA(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function V(e){return typeof e=="string"}function K0(e,t,n){e&&(e=t?K(e).map(a=>a.replace(/\\(.)/g,"$1")):K(e));const i=e&&e.length,r=n&&n.get||HS,o=a=>r(t?[a]:ji(a));let s;if(!i)s=function(){return""};else if(i===1){const a=o(e[0]);s=function(u){return""+a(u)}}else{const a=e.map(o);s=function(u){let l=""+a[0](u),c=0;for(;++c<i;)l+="|"+a[c](u);return l}}return vn(s,e,"key")}function fA(e,t){const n=e[0],i=be(e),r=+t;return r?r===1?i:n+r*(i-n):n}const B9=1e4;function dA(e){e=+e||B9;let t,n,i;const r=()=>{t={},n={},i=0},o=(s,a)=>(++i>e&&(n=t,t={},i=1),t[s]=a);return r(),{clear:r,has:s=>te(t,s)||te(n,s),get:s=>te(t,s)?t[s]:te(n,s)?o(s,n[s]):void 0,set:(s,a)=>te(t,s)?t[s]=a:o(s,a)}}function hA(e,t,n,i){const r=t.length,o=n.length;if(!o)return t;if(!r)return n;const s=i||new t.constructor(r+o);let a=0,u=0,l=0;for(;a<r&&u<o;++l)s[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<r;++a,++l)s[l]=t[a];for(;u<o;++u,++l)s[l]=n[u];return s}function Fl(e,t){let n="";for(;--t>=0;)n+=e;return n}function pA(e,t,n,i){const r=n||" ",o=e+"",s=t-o.length;return s<=0?o:i==="left"?Fl(r,s)+o:i==="center"?Fl(r,~~(s/2))+o+Fl(r,Math.ceil(s/2)):o+Fl(r,s)}function Dl(e){return e&&be(e)-e[0]||0}function W(e){return R(e)?"["+e.map(W)+"]":J(e)||V(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function J0(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const U9=e=>Oe(e)||mo(e)?e:Date.parse(e);function Z0(e,t){return t=t||U9,e==null||e===""?null:t(e)}function Q0(e){return e==null||e===""?null:e+""}function vt(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function gA(e,t,n,i){const r=i!=null?i:"\u2026",o=e+"",s=o.length,a=Math.max(0,t-r.length);return s<=t?o:n==="left"?r+o.slice(s-a):n==="center"?o.slice(0,Math.ceil(a/2))+r+o.slice(s-~~(a/2)):o.slice(0,a)+r}function yo(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const o=t(e[r]);o&&n(o,r,e)}}else e.forEach(n)}const j9=/^([A-Za-z]+:)?\/\//,q9=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,W9=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,mA="file://";function H9(e,t){return n=>({options:n||{},sanitize:Y9,load:G9,fileAccess:!!t,file:V9(t),http:K9(e)})}async function G9(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function Y9(e,t){t=de({},this.options,t);const n=this.fileAccess,i={href:null};let r,o,s;const a=q9.test(e.replace(W9,""));(e==null||typeof e!="string"||!a)&&N("Sanitize failure, invalid URI: "+W(e));const u=j9.test(e);return(s=t.baseURL)&&!u&&(!e.startsWith("/")&&s[s.length-1]!=="/"&&(e="/"+e),e=s+e),o=(r=e.startsWith(mA))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(mA.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!o}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function V9(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,o)=>{r?i(r):n(o)})}):X9}async function X9(){N("No file system access.")}function K9(e){return e?async function(t,n){const i=de({},this.options.http,n),r=n&&n.response,o=await e(t,i);return o.ok?fe(o[r])?o[r]():o.text():N(o.status+""+o.statusText)}:J9}async function J9(){N("No HTTP fetch method available.")}const Z9=e=>e!=null&&e===e,Q9=e=>e==="true"||e==="false"||e===!0||e===!1,ez=e=>!Number.isNaN(Date.parse(e)),yA=e=>!Number.isNaN(+e)&&!(e instanceof Date),tz=e=>yA(e)&&Number.isInteger(+e),e1={boolean:J0,integer:Pt,number:Pt,date:Z0,string:Q0,unknown:It},Pd=[Q9,tz,yA,ez],nz=["boolean","integer","number","date"];function vA(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=Pd.length,r=Pd.map((o,s)=>s+1);for(let o=0,s=0,a,u;o<n;++o)for(u=t?e[o][t]:e[o],a=0;a<i;++a)if(r[a]&&Z9(u)&&!Pd[a](u)&&(r[a]=0,++s,s===Pd.length))return"string";return nz[r.reduce((o,s)=>o===0?s:o,0)-1]}function bA(e,t){return t.reduce((n,i)=>(n[i]=vA(e,i),n),{})}var xA={},t1={},n1=34,Tl=10,i1=13;function wA(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function iz(e,t){var n=wA(e);return function(i,r){return t(n(i),r,e)}}function _A(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function xn(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function rz(e){return e<0?"-"+xn(-e,6):e>9999?"+"+xn(e,6):xn(e,4)}function oz(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":rz(e.getUTCFullYear())+"-"+xn(e.getUTCMonth()+1,2)+"-"+xn(e.getUTCDate(),2)+(r?"T"+xn(t,2)+":"+xn(n,2)+":"+xn(i,2)+"."+xn(r,3)+"Z":i?"T"+xn(t,2)+":"+xn(n,2)+":"+xn(i,2)+"Z":n||t?"T"+xn(t,2)+":"+xn(n,2)+"Z":"")}function sz(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,d){var h,p,g=r(f,function(m,y){if(h)return h(m,y-1);p=m,h=d?iz(m,d):wA(m)});return g.columns=p||[],g}function r(f,d){var h=[],p=f.length,g=0,m=0,y,v=p<=0,b=!1;f.charCodeAt(p-1)===Tl&&--p,f.charCodeAt(p-1)===i1&&--p;function w(){if(v)return t1;if(b)return b=!1,xA;var S,_=g,A;if(f.charCodeAt(_)===n1){for(;g++<p&&f.charCodeAt(g)!==n1||f.charCodeAt(++g)===n1;);return(S=g)>=p?v=!0:(A=f.charCodeAt(g++))===Tl?b=!0:A===i1&&(b=!0,f.charCodeAt(g)===Tl&&++g),f.slice(_+1,S-1).replace(/""/g,'"')}for(;g<p;){if((A=f.charCodeAt(S=g++))===Tl)b=!0;else if(A===i1)b=!0,f.charCodeAt(g)===Tl&&++g;else if(A!==n)continue;return f.slice(_,S)}return v=!0,f.slice(_,p)}for(;(y=w())!==t1;){for(var E=[];y!==xA&&y!==t1;)E.push(y),y=w();d&&(E=d(E,m++))==null||h.push(E)}return h}function o(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function s(f,d){return d==null&&(d=_A(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function a(f,d){return d==null&&(d=_A(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?oz(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:s,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function EA(e){const t=function(n,i){const r={delimiter:e};return r1(n,i?de(i,r):r)};return t.responseType="text",t}function r1(e,t){return t.header&&(e=t.header.map(W).join(t.delimiter)+`
`+e),sz(t.delimiter).parse(e+"")}r1.responseType="text";function az(e){return typeof Buffer=="function"&&fe(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function o1(e,t){const n=t&&t.property?bn(t.property):It;return J(e)&&!az(e)?uz(n(e),t):n(JSON.parse(e))}o1.responseType="json";function uz(e,t){return!R(e)&&lA(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}function lz(e){return e}function cz(e){if(e==null)return lz;var t,n,i=e.scale[0],r=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*i+o,f[1]=(n+=a[1])*r+s;l<c;)f[l]=a[l],++l;return f}}function fz(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function dz(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return SA(e,n)})}:SA(e,t)}function SA(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,o=AA(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:o}:i==null?{type:"Feature",id:n,properties:r,geometry:o}:{type:"Feature",id:n,bbox:i,properties:r,geometry:o}}function AA(e,t){var n=cz(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&fz(f,p)}function o(c){return n(c)}function s(c){for(var f=[],d=0,h=c.length;d<h;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=s(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=s(c.arcs);break;case"MultiLineString":d=c.arcs.map(s);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function hz(e,t){var n={},i={},r={},o=[],s=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++s],t[s]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,p;if(h=r[f])if(delete r[h.end],h.push(l),h.end=d,p=i[d]){delete i[p.start];var g=p===h?h:h.concat(p);i[g.start=h.start]=r[g.end=p.end]=g}else i[h.start]=r[h.end]=h;else if(h=i[d])if(delete i[h.start],h.unshift(l),h.start=f,p=r[f]){delete r[p.end];var m=p===h?h:p.concat(h);i[m.start=p.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else h=[l],i[h.start=f]=r[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function pz(e){return AA(e,gz.apply(this,arguments))}function gz(e,t,n){var i,r,o;if(arguments.length>1)i=mz(e,t,n);else for(r=0,i=new Array(o=e.arcs.length);r<o;++r)i[r]=r;return{type:"MultiLineString",arcs:hz(e,i)}}function mz(e,t,n){var i=[],r=[],o;function s(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:o})}function a(f){f.forEach(s)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}const yz={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function kA(e,t){let n,i,r,o;return e=o1(e,t),t&&t.feature?(n=dz,r=t.feature):t&&t.mesh?(n=pz,r=t.mesh,o=yz[t.filter]):N("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,o):N("Invalid TopoJSON object: "+r),i&&i.features||[i]}kA.responseType="json";const zd={dsv:r1,csv:EA(","),tsv:EA("	"),json:o1,topojson:kA};function s1(e,t){return arguments.length>1?(zd[e]=t,this):te(zd,e)?zd[e]:null}function CA(e){const t=s1(e);return t&&t.responseType||"text"}function Ya(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ol(e){let t=e,n=e;e.length===1&&(t=(s,a)=>e(s)-a,n=vz(e));function i(s,a,u,l){for(u==null&&(u=0),l==null&&(l=s.length);u<l;){const c=u+l>>>1;n(s[c],a)<0?u=c+1:l=c}return u}function r(s,a,u,l){for(u==null&&(u=0),l==null&&(l=s.length);u<l;){const c=u+l>>>1;n(s[c],a)>0?l=c:u=c+1}return u}function o(s,a,u,l){u==null&&(u=0),l==null&&(l=s.length);const c=i(s,a,u,l-1);return c>u&&t(s[c-1],a)>-t(s[c],a)?c-1:c}return{left:i,center:o,right:r}}function vz(e){return(t,n)=>Ya(e(t),n)}function $A(e){return e===null?NaN:+e}function*bz(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const MA=Ol(Ya),vo=MA.right,xz=MA.left;Ol($A).center;function wz(e,t){let n=0,i,r=0,o=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(i=s-r,r+=i/++n,o+=i*(s-r));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,o+=i*(a-r))}if(n>1)return o/(n-1)}function _z(e,t){const n=wz(e,t);return n&&Math.sqrt(n)}class Qt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(n[i++]=a),t=s}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,o,s=0;if(n>0){for(s=t[--n];n>0&&(i=s,r=t[--n],s=i+r,o=r-(s-i),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(r=o*2,i=s+r,r==i-s&&(s=i))}return s}}function Ez(e,t){return Array.from(t,n=>e[n])}var a1=Math.sqrt(50),u1=Math.sqrt(10),l1=Math.sqrt(2);function c1(e,t,n){var i,r=-1,o,s,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((i=t<e)&&(o=e,e=t,t=o),(a=FA(e,t,n))===0||!isFinite(a))return[];if(a>0){let u=Math.round(e/a),l=Math.round(t/a);for(u*a<e&&++u,l*a>t&&--l,s=new Array(o=l-u+1);++r<o;)s[r]=(u+r)*a}else{a=-a;let u=Math.round(e*a),l=Math.round(t*a);for(u/a<e&&++u,l/a>t&&--l,s=new Array(o=l-u+1);++r<o;)s[r]=(u+r)/a}return i&&s.reverse(),s}function FA(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=a1?10:o>=u1?5:o>=l1?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=a1?10:o>=u1?5:o>=l1?2:1)}function bo(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=a1?r*=10:o>=u1?r*=5:o>=l1&&(r*=2),t<e?-r:r}function $s(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function f1(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function DA(e,t,n=0,i=e.length-1,r=Ya){for(;i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(i,Math.floor(t+(u-l)*f/u+d));DA(e,t,h,p,r)}const o=e[t];let s=n,a=i;for(Nl(e,n,t),r(e[i],o)>0&&Nl(e,n,i);s<a;){for(Nl(e,s,a),++s,--a;r(e[s],o)<0;)++s;for(;r(e[a],o)>0;)--a}r(e[n],o)===0?Nl(e,n,a):(++a,Nl(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function Nl(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function d1(e,t,n){if(e=Float64Array.from(bz(e,n)),!!(i=e.length)){if((t=+t)<=0||i<2)return f1(e);if(t>=1)return $s(e);var i,r=(i-1)*t,o=Math.floor(r),s=$s(DA(e,o).subarray(0,o+1)),a=f1(e.subarray(o+1));return s+(a-s)*(r-o)}}function TA(e,t,n=$A){if(!!(i=e.length)){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(r-o)}}function Sz(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let o of e)(o=t(o,++r,e))!=null&&(o=+o)>=o&&(++n,i+=o)}if(n)return i/n}function OA(e,t){return d1(e,.5,t)}function*Az(e){for(const t of e)yield*t}function NA(e){return Array.from(Az(e))}function Ln(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(r);++i<r;)o[i]=e+i*n;return o}function RA(e,t){let n=0;if(t===void 0)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function kz(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Bd(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Va(e){return e=Bd(Math.abs(e)),e?e[1]:NaN}function Cz(e,t){return function(n,i){for(var r=n.length,o=[],s=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),o.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function $z(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Mz=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Xa(e){if(!(t=Mz.exec(e)))throw new Error("invalid format: "+e);var t;return new h1({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Xa.prototype=h1.prototype;function h1(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}h1.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Fz(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var LA;function Dz(e,t){var n=Bd(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-(LA=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Bd(e,Math.max(0,t+o-1))[0]}function IA(e,t){var n=Bd(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}var PA={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:kz,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>IA(e*100,t),r:IA,s:Dz,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function zA(e){return e}var BA=Array.prototype.map,UA=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function jA(e){var t=e.grouping===void 0||e.thousands===void 0?zA:Cz(BA.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?zA:$z(BA.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=Xa(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,w=f.trim,E=f.type;E==="n"?(v=!0,E="g"):PA[E]||(b===void 0&&(b=12),w=!0,E="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",_=g==="$"?i:/[%p]/.test(E)?s:"",A=PA[E],C=/[defgprs%]/.test(E);b=b===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function k($){var F=S,D=_,L,M,I;if(E==="c")D=A($)+D,$="";else{$=+$;var U=$<0||1/$<0;if($=isNaN($)?u:A(Math.abs($),b),w&&($=Fz($)),U&&+$==0&&p!=="+"&&(U=!1),F=(U?p==="("?p:a:p==="-"||p==="("?"":p)+F,D=(E==="s"?UA[8+LA/3]:"")+D+(U&&p==="("?")":""),C){for(L=-1,M=$.length;++L<M;)if(I=$.charCodeAt(L),48>I||I>57){D=(I===46?r+$.slice(L+1):$.slice(L))+D,$=$.slice(0,L);break}}}v&&!m&&($=t($,Infinity));var Y=F.length+$.length+D.length,Q=Y<y?new Array(y-Y+1).join(d):"";switch(v&&m&&($=t(Q+$,Q.length?y-D.length:Infinity),Q=""),h){case"<":$=F+$+D+Q;break;case"=":$=F+Q+$+D;break;case"^":$=Q.slice(0,Y=Q.length>>1)+F+$+D+Q.slice(Y);break;default:$=Q+F+$+D;break}return o($)}return k.toString=function(){return f+""},k}function c(f,d){var h=l((f=Xa(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Va(d)/3)))*3,g=Math.pow(10,-p),m=UA[8+p/3];return function(y){return h(g*y)+m}}return{format:l,formatPrefix:c}}var Ud,jd,p1;Tz({thousands:",",grouping:[3],currency:["$",""]});function Tz(e){return Ud=jA(e),jd=Ud.format,p1=Ud.formatPrefix,Ud}function qA(e){return Math.max(0,-Va(Math.abs(e)))}function WA(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Va(t)/3)))*3-Va(Math.abs(e)))}function HA(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Va(t)-Va(e))+1}var g1=new Date,m1=new Date;function bt(e,t,n,i){function r(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return r.floor=function(o){return e(o=new Date(+o)),o},r.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},r.round=function(o){var s=r(o),a=r.ceil(o);return o-s<a-o?s:a},r.offset=function(o,s){return t(o=new Date(+o),s==null?1:Math.floor(s)),o},r.range=function(o,s,a){var u=[],l;if(o=r.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return u;do u.push(l=new Date(+o)),t(o,a),e(o);while(l<o&&o<s);return u},r.filter=function(o){return bt(function(s){if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},function(s,a){if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););})},n&&(r.count=function(o,s){return g1.setTime(+o),m1.setTime(+s),e(g1),e(m1),Math.floor(n(g1,m1))},r.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?r.filter(i?function(s){return i(s)%o==0}:function(s){return r.count(0,s)%o==0}):r}),r}var Rl=bt(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Rl.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?bt(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):Rl};const Fr=1e3,Xn=Fr*60,Dr=Xn*60,Ms=Dr*24,y1=Ms*7,GA=Ms*30,v1=Ms*365;var xo=bt(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Fr)},function(e,t){return(t-e)/Fr},function(e){return e.getUTCSeconds()}),b1=bt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Fr)},function(e,t){e.setTime(+e+t*Xn)},function(e,t){return(t-e)/Xn},function(e){return e.getMinutes()}),x1=bt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Fr-e.getMinutes()*Xn)},function(e,t){e.setTime(+e+t*Dr)},function(e,t){return(t-e)/Dr},function(e){return e.getHours()}),wo=bt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Xn)/Ms,e=>e.getDate()-1);function Fs(e){return bt(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Xn)/y1})}var Ll=Fs(0),w1=Fs(1);Fs(2),Fs(3);var Il=Fs(4);Fs(5),Fs(6);var qd=bt(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),Tr=bt(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Tr.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:bt(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var _1=bt(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Xn)},function(e,t){return(t-e)/Xn},function(e){return e.getUTCMinutes()}),E1=bt(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Dr)},function(e,t){return(t-e)/Dr},function(e){return e.getUTCHours()}),_o=bt(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Ms},function(e){return e.getUTCDate()-1});function Ds(e){return bt(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/y1})}var Pl=Ds(0),S1=Ds(1);Ds(2),Ds(3);var zl=Ds(4);Ds(5),Ds(6);var Wd=bt(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),Or=bt(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Or.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:bt(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};function YA(e,t,n,i,r,o){const s=[[xo,1,Fr],[xo,5,5*Fr],[xo,15,15*Fr],[xo,30,30*Fr],[o,1,Xn],[o,5,5*Xn],[o,15,15*Xn],[o,30,30*Xn],[r,1,Dr],[r,3,3*Dr],[r,6,6*Dr],[r,12,12*Dr],[i,1,Ms],[i,2,2*Ms],[n,1,y1],[t,1,GA],[t,3,3*GA],[e,1,v1]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=Ol(([,,m])=>m).right(s,d);if(h===s.length)return e.every(bo(l/v1,c/v1,f));if(h===0)return Rl.every(Math.max(bo(l,c,f),1));const[p,g]=s[d/s[h-1][2]<s[h][2]/d?h-1:h];return p.every(g)}return[a,u]}const[Oz,Nz]=YA(Or,Wd,Pl,_o,E1,_1),[Rz,Lz]=YA(Tr,qd,Ll,wo,x1,b1),$t="year",wn="quarter",Bt="month",ut="week",_n="date",Ut="day",Wi="dayofyear",In="hours",Pn="minutes",Kn="seconds",bi="milliseconds",A1=[$t,wn,Bt,ut,_n,Ut,Wi,In,Pn,Kn,bi],k1=A1.reduce((e,t,n)=>(e[t]=1+n,e),{});function C1(e){const t=K(e).slice(),n={};return t.length||N("Missing time unit."),t.forEach(r=>{te(k1,r)?n[r]=1:N("Invalid time unit: ".concat(r,"."))}),(n[ut]||n[Ut]?1:0)+(n[wn]||n[Bt]||n[_n]?1:0)+(n[Wi]?1:0)>1&&N("Incompatible time units: ".concat(e)),t.sort((r,o)=>k1[r]-k1[o]),t}const Iz={[$t]:"%Y ",[wn]:"Q%q ",[Bt]:"%b ",[_n]:"%d ",[ut]:"W%U ",[Ut]:"%a ",[Wi]:"%j ",[In]:"%H:00",[Pn]:"00:%M",[Kn]:":%S",[bi]:".%L",["".concat($t,"-").concat(Bt)]:"%Y-%m ",["".concat($t,"-").concat(Bt,"-").concat(_n)]:"%Y-%m-%d ",["".concat(In,"-").concat(Pn)]:"%H:%M"};function VA(e,t){const n=de({},Iz,t),i=C1(e),r=i.length;let o="",s=0,a,u;for(s=0;s<r;)for(a=i.length;a>s;--a)if(u=i.slice(s,a).join("-"),n[u]!=null){o+=n[u],s=a;break}return o.trim()}const Ts=new Date;function $1(e){return Ts.setFullYear(e),Ts.setMonth(0),Ts.setDate(1),Ts.setHours(0,0,0,0),Ts}function XA(e){return JA(new Date(e))}function KA(e){return M1(new Date(e))}function JA(e){return wo.count($1(e.getFullYear())-1,e)}function M1(e){return Ll.count($1(e.getFullYear())-1,e)}function F1(e){return $1(e).getDay()}function Pz(e,t,n,i,r,o,s){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,o,s);return a.setFullYear(e),a}return new Date(e,t,n,i,r,o,s)}function ZA(e){return ek(new Date(e))}function QA(e){return D1(new Date(e))}function ek(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return _o.count(t-1,e)}function D1(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Pl.count(t-1,e)}function T1(e){return Ts.setTime(Date.UTC(e,0,1)),Ts.getUTCDay()}function zz(e,t,n,i,r,o,s){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,o,s));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,o,s))}function tk(e,t,n,i,r){const o=t||1,s=be(e),a=(y,v,b)=>(b=b||y,Bz(n[b],i[b],y===s&&o,v)),u=new Date,l=vt(e),c=l[$t]?a($t):zt(2012),f=l[Bt]?a(Bt):l[wn]?a(wn):ho,d=l[ut]&&l[Ut]?a(Ut,1,ut+Ut):l[ut]?a(ut,1):l[Ut]?a(Ut,1):l[_n]?a(_n,1):l[Wi]?a(Wi,1):qa,h=l[In]?a(In):ho,p=l[Pn]?a(Pn):ho,g=l[Kn]?a(Kn):ho,m=l[bi]?a(bi):ho;return function(y){u.setTime(+y);const v=c(u);return r(v,f(u),d(u,v),h(u),p(u),g(u),m(u))}}function Bz(e,t,n,i){const r=n<=1?e:i?(o,s)=>i+n*Math.floor((e(o,s)-i)/n):(o,s)=>n*Math.floor(e(o,s)/n);return t?(o,s)=>t(r(o,s),s):r}function Ka(e,t,n){return t+e*7-(n+6)%7}const Uz={[$t]:e=>e.getFullYear(),[wn]:e=>Math.floor(e.getMonth()/3),[Bt]:e=>e.getMonth(),[_n]:e=>e.getDate(),[In]:e=>e.getHours(),[Pn]:e=>e.getMinutes(),[Kn]:e=>e.getSeconds(),[bi]:e=>e.getMilliseconds(),[Wi]:e=>JA(e),[ut]:e=>M1(e),[ut+Ut]:(e,t)=>Ka(M1(e),e.getDay(),F1(t)),[Ut]:(e,t)=>Ka(1,e.getDay(),F1(t))},jz={[wn]:e=>3*e,[ut]:(e,t)=>Ka(e,0,F1(t))};function nk(e,t){return tk(e,t||1,Uz,jz,Pz)}const qz={[$t]:e=>e.getUTCFullYear(),[wn]:e=>Math.floor(e.getUTCMonth()/3),[Bt]:e=>e.getUTCMonth(),[_n]:e=>e.getUTCDate(),[In]:e=>e.getUTCHours(),[Pn]:e=>e.getUTCMinutes(),[Kn]:e=>e.getUTCSeconds(),[bi]:e=>e.getUTCMilliseconds(),[Wi]:e=>ek(e),[ut]:e=>D1(e),[Ut]:(e,t)=>Ka(1,e.getUTCDay(),T1(t)),[ut+Ut]:(e,t)=>Ka(D1(e),e.getUTCDay(),T1(t))},Wz={[wn]:e=>3*e,[ut]:(e,t)=>Ka(e,0,T1(t))};function ik(e,t){return tk(e,t||1,qz,Wz,zz)}const Hz={[$t]:Tr,[wn]:qd.every(3),[Bt]:qd,[ut]:Ll,[_n]:wo,[Ut]:wo,[Wi]:wo,[In]:x1,[Pn]:b1,[Kn]:xo,[bi]:Rl},Gz={[$t]:Or,[wn]:Wd.every(3),[Bt]:Wd,[ut]:Pl,[_n]:_o,[Ut]:_o,[Wi]:_o,[In]:E1,[Pn]:_1,[Kn]:xo,[bi]:Rl};function Ja(e){return Hz[e]}function Za(e){return Gz[e]}function rk(e,t,n){return e?e.offset(t,n):void 0}function ok(e,t,n){return rk(Ja(e),t,n)}function sk(e,t,n){return rk(Za(e),t,n)}function ak(e,t,n,i){return e?e.range(t,n,i):void 0}function uk(e,t,n,i){return ak(Ja(e),t,n,i)}function lk(e,t,n,i){return ak(Za(e),t,n,i)}const Bl=1e3,Ul=Bl*60,jl=Ul*60,Hd=jl*24,Yz=Hd*7,ck=Hd*30,O1=Hd*365,fk=[$t,Bt,_n,In,Pn,Kn,bi],ql=fk.slice(0,-1),Wl=ql.slice(0,-1),Hl=Wl.slice(0,-1),Vz=Hl.slice(0,-1),Xz=[$t,ut],dk=[$t,Bt],hk=[$t],Gl=[[ql,1,Bl],[ql,5,5*Bl],[ql,15,15*Bl],[ql,30,30*Bl],[Wl,1,Ul],[Wl,5,5*Ul],[Wl,15,15*Ul],[Wl,30,30*Ul],[Hl,1,jl],[Hl,3,3*jl],[Hl,6,6*jl],[Hl,12,12*jl],[Vz,1,Hd],[Xz,1,Yz],[dk,1,ck],[dk,3,3*ck],[hk,1,O1]];function pk(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(Dl(t))/n;let r=Ol(a=>a[2]).right(Gl,i),o,s;return r===Gl.length?(o=hk,s=bo(t[0]/O1,t[1]/O1,n)):r?(r=Gl[i/Gl[r-1][2]<Gl[r][2]/i?r-1:r],o=r[0],s=r[1]):(o=fk,s=Math.max(bo(t[0],t[1],n),1)),{units:o,step:s}}function N1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function R1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Yl(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function gk(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,o=e.days,s=e.shortDays,a=e.months,u=e.shortMonths,l=Vl(r),c=Xl(r),f=Vl(o),d=Xl(o),h=Vl(s),p=Xl(s),g=Vl(a),m=Xl(a),y=Vl(u),v=Xl(u),b={a:U,A:Y,b:Q,B:ce,c:null,d:wk,e:wk,f:v7,g:$7,G:F7,H:g7,I:m7,j:y7,L:_k,m:b7,M:x7,p:$e,q:De,Q:$k,s:Mk,S:w7,u:_7,U:E7,V:S7,w:A7,W:k7,x:null,X:null,y:C7,Y:M7,Z:D7,"%":Ck},w={a:qe,A:Pe,b:mt,B:hi,c:null,d:Sk,e:Sk,f:R7,g:H7,G:Y7,H:T7,I:O7,j:N7,L:Ak,m:L7,M:I7,p:pi,q:yn,Q:$k,s:Mk,S:P7,u:z7,U:B7,V:U7,w:j7,W:q7,x:null,X:null,y:W7,Y:G7,Z:V7,"%":Ck},E={a:k,A:$,b:F,B:D,c:L,d:bk,e:bk,f:f7,g:vk,G:yk,H:xk,I:xk,j:a7,L:c7,m:s7,M:u7,p:C,q:o7,Q:h7,s:p7,S:l7,u:e7,U:t7,V:n7,w:Qz,W:i7,x:M,X:I,y:vk,Y:yk,Z:r7,"%":d7};b.x=S(n,b),b.X=S(i,b),b.c=S(t,b),w.x=S(n,w),w.X=S(i,w),w.c=S(t,w);function S(X,ue){return function(ye){var z=[],Ke=-1,ve=0,kt=X.length,Ye,et,rt;for(ye instanceof Date||(ye=new Date(+ye));++Ke<kt;)X.charCodeAt(Ke)===37&&(z.push(X.slice(ve,Ke)),(et=mk[Ye=X.charAt(++Ke)])!=null?Ye=X.charAt(++Ke):et=Ye==="e"?" ":"0",(rt=ue[Ye])&&(Ye=rt(ye,et)),z.push(Ye),ve=Ke+1);return z.push(X.slice(ve,Ke)),z.join("")}}function _(X,ue){return function(ye){var z=Yl(1900,void 0,1),Ke=A(z,X,ye+="",0),ve,kt;if(Ke!=ye.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(z.s*1e3+("L"in z?z.L:0));if(ue&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+z.p*12),z.m===void 0&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(ve=R1(Yl(z.y,0,1)),kt=ve.getUTCDay(),ve=kt>4||kt===0?S1.ceil(ve):S1(ve),ve=_o.offset(ve,(z.V-1)*7),z.y=ve.getUTCFullYear(),z.m=ve.getUTCMonth(),z.d=ve.getUTCDate()+(z.w+6)%7):(ve=N1(Yl(z.y,0,1)),kt=ve.getDay(),ve=kt>4||kt===0?w1.ceil(ve):w1(ve),ve=wo.offset(ve,(z.V-1)*7),z.y=ve.getFullYear(),z.m=ve.getMonth(),z.d=ve.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),kt="Z"in z?R1(Yl(z.y,0,1)).getUTCDay():N1(Yl(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+z.W*7-(kt+5)%7:z.w+z.U*7-(kt+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,R1(z)):N1(z)}}function A(X,ue,ye,z){for(var Ke=0,ve=ue.length,kt=ye.length,Ye,et;Ke<ve;){if(z>=kt)return-1;if(Ye=ue.charCodeAt(Ke++),Ye===37){if(Ye=ue.charAt(Ke++),et=E[Ye in mk?ue.charAt(Ke++):Ye],!et||(z=et(X,ye,z))<0)return-1}else if(Ye!=ye.charCodeAt(z++))return-1}return z}function C(X,ue,ye){var z=l.exec(ue.slice(ye));return z?(X.p=c.get(z[0].toLowerCase()),ye+z[0].length):-1}function k(X,ue,ye){var z=h.exec(ue.slice(ye));return z?(X.w=p.get(z[0].toLowerCase()),ye+z[0].length):-1}function $(X,ue,ye){var z=f.exec(ue.slice(ye));return z?(X.w=d.get(z[0].toLowerCase()),ye+z[0].length):-1}function F(X,ue,ye){var z=y.exec(ue.slice(ye));return z?(X.m=v.get(z[0].toLowerCase()),ye+z[0].length):-1}function D(X,ue,ye){var z=g.exec(ue.slice(ye));return z?(X.m=m.get(z[0].toLowerCase()),ye+z[0].length):-1}function L(X,ue,ye){return A(X,t,ue,ye)}function M(X,ue,ye){return A(X,n,ue,ye)}function I(X,ue,ye){return A(X,i,ue,ye)}function U(X){return s[X.getDay()]}function Y(X){return o[X.getDay()]}function Q(X){return u[X.getMonth()]}function ce(X){return a[X.getMonth()]}function $e(X){return r[+(X.getHours()>=12)]}function De(X){return 1+~~(X.getMonth()/3)}function qe(X){return s[X.getUTCDay()]}function Pe(X){return o[X.getUTCDay()]}function mt(X){return u[X.getUTCMonth()]}function hi(X){return a[X.getUTCMonth()]}function pi(X){return r[+(X.getUTCHours()>=12)]}function yn(X){return 1+~~(X.getUTCMonth()/3)}return{format:function(X){var ue=S(X+="",b);return ue.toString=function(){return X},ue},parse:function(X){var ue=_(X+="",!1);return ue.toString=function(){return X},ue},utcFormat:function(X){var ue=S(X+="",w);return ue.toString=function(){return X},ue},utcParse:function(X){var ue=_(X+="",!0);return ue.toString=function(){return X},ue}}}var mk={"-":"",_:" ","0":"0"},xt=/^\s*\d+/,Kz=/^%/,Jz=/[\\^$*+?|[\]().{}]/g;function Se(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(t)+r:r)}function Zz(e){return e.replace(Jz,"\\$&")}function Vl(e){return new RegExp("^(?:"+e.map(Zz).join("|")+")","i")}function Xl(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Qz(e,t,n){var i=xt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function e7(e,t,n){var i=xt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function t7(e,t,n){var i=xt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function n7(e,t,n){var i=xt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function i7(e,t,n){var i=xt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function yk(e,t,n){var i=xt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function vk(e,t,n){var i=xt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function r7(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function o7(e,t,n){var i=xt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function s7(e,t,n){var i=xt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function bk(e,t,n){var i=xt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function a7(e,t,n){var i=xt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function xk(e,t,n){var i=xt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function u7(e,t,n){var i=xt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function l7(e,t,n){var i=xt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function c7(e,t,n){var i=xt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function f7(e,t,n){var i=xt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function d7(e,t,n){var i=Kz.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function h7(e,t,n){var i=xt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function p7(e,t,n){var i=xt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function wk(e,t){return Se(e.getDate(),t,2)}function g7(e,t){return Se(e.getHours(),t,2)}function m7(e,t){return Se(e.getHours()%12||12,t,2)}function y7(e,t){return Se(1+wo.count(Tr(e),e),t,3)}function _k(e,t){return Se(e.getMilliseconds(),t,3)}function v7(e,t){return _k(e,t)+"000"}function b7(e,t){return Se(e.getMonth()+1,t,2)}function x7(e,t){return Se(e.getMinutes(),t,2)}function w7(e,t){return Se(e.getSeconds(),t,2)}function _7(e){var t=e.getDay();return t===0?7:t}function E7(e,t){return Se(Ll.count(Tr(e)-1,e),t,2)}function Ek(e){var t=e.getDay();return t>=4||t===0?Il(e):Il.ceil(e)}function S7(e,t){return e=Ek(e),Se(Il.count(Tr(e),e)+(Tr(e).getDay()===4),t,2)}function A7(e){return e.getDay()}function k7(e,t){return Se(w1.count(Tr(e)-1,e),t,2)}function C7(e,t){return Se(e.getFullYear()%100,t,2)}function $7(e,t){return e=Ek(e),Se(e.getFullYear()%100,t,2)}function M7(e,t){return Se(e.getFullYear()%1e4,t,4)}function F7(e,t){var n=e.getDay();return e=n>=4||n===0?Il(e):Il.ceil(e),Se(e.getFullYear()%1e4,t,4)}function D7(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Se(t/60|0,"0",2)+Se(t%60,"0",2)}function Sk(e,t){return Se(e.getUTCDate(),t,2)}function T7(e,t){return Se(e.getUTCHours(),t,2)}function O7(e,t){return Se(e.getUTCHours()%12||12,t,2)}function N7(e,t){return Se(1+_o.count(Or(e),e),t,3)}function Ak(e,t){return Se(e.getUTCMilliseconds(),t,3)}function R7(e,t){return Ak(e,t)+"000"}function L7(e,t){return Se(e.getUTCMonth()+1,t,2)}function I7(e,t){return Se(e.getUTCMinutes(),t,2)}function P7(e,t){return Se(e.getUTCSeconds(),t,2)}function z7(e){var t=e.getUTCDay();return t===0?7:t}function B7(e,t){return Se(Pl.count(Or(e)-1,e),t,2)}function kk(e){var t=e.getUTCDay();return t>=4||t===0?zl(e):zl.ceil(e)}function U7(e,t){return e=kk(e),Se(zl.count(Or(e),e)+(Or(e).getUTCDay()===4),t,2)}function j7(e){return e.getUTCDay()}function q7(e,t){return Se(S1.count(Or(e)-1,e),t,2)}function W7(e,t){return Se(e.getUTCFullYear()%100,t,2)}function H7(e,t){return e=kk(e),Se(e.getUTCFullYear()%100,t,2)}function G7(e,t){return Se(e.getUTCFullYear()%1e4,t,4)}function Y7(e,t){var n=e.getUTCDay();return e=n>=4||n===0?zl(e):zl.ceil(e),Se(e.getUTCFullYear()%1e4,t,4)}function V7(){return"+0000"}function Ck(){return"%"}function $k(e){return+e}function Mk(e){return Math.floor(+e/1e3)}var Qa,L1,Fk,I1,Dk;X7({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function X7(e){return Qa=gk(e),L1=Qa.format,Fk=Qa.parse,I1=Qa.utcFormat,Dk=Qa.utcParse,Qa}function Kl(e){const t={};return n=>t[n]||(t[n]=e(n))}function K7(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let o=J7(i,r);const s=o<i.length?i.slice(o):"";for(;--o>r;)if(i[o]!=="0"){++o;break}return i.slice(0,o)+s}}function J7(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function Tk(e){const t=Kl(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=Xa(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return K7(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,o,s){s=Xa(s==null?",f":s);const a=bo(i,r,o),u=Math.max(Math.abs(i),Math.abs(r));let l;if(s.precision==null)switch(s.type){case"s":return isNaN(l=WA(a,u))||(s.precision=l),n(s,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=HA(a,u))||(s.precision=l-(s.type==="e"));break}case"f":case"%":{isNaN(l=qA(a))||(s.precision=l-(s.type==="%")*2);break}}return t(s)}}}let P1;Ok();function Ok(){return P1=Tk({format:jd,formatPrefix:p1})}function Nk(e){return Tk(jA(e))}function Gd(e){return arguments.length?P1=Nk(e):P1}function Rk(e,t,n){n=n||{},J(n)||N("Invalid time multi-format specifier: ".concat(n));const i=t(Kn),r=t(Pn),o=t(In),s=t(_n),a=t(ut),u=t(Bt),l=t(wn),c=t($t),f=e(n[bi]||".%L"),d=e(n[Kn]||":%S"),h=e(n[Pn]||"%I:%M"),p=e(n[In]||"%I %p"),g=e(n[_n]||n[Ut]||"%a %d"),m=e(n[ut]||"%b %d"),y=e(n[Bt]||"%B"),v=e(n[wn]||"%B"),b=e(n[$t]||"%Y");return w=>(i(w)<w?f:r(w)<w?d:o(w)<w?h:s(w)<w?p:u(w)<w?a(w)<w?g:m:c(w)<w?l(w)<w?y:v:b)(w)}function Lk(e){const t=Kl(e.format),n=Kl(e.utcFormat);return{timeFormat:i=>V(i)?t(i):Rk(t,Ja,i),utcFormat:i=>V(i)?n(i):Rk(n,Za,i),timeParse:Kl(e.parse),utcParse:Kl(e.utcParse)}}let z1;Ik();function Ik(){return z1=Lk({format:L1,parse:Fk,utcFormat:I1,utcParse:Dk})}function Pk(e){return Lk(gk(e))}function Jl(e){return arguments.length?z1=Pk(e):z1}const B1=(e,t)=>de({},e,t);function zk(e,t){const n=e?Nk(e):Gd(),i=t?Pk(t):Jl();return B1(n,i)}function U1(e,t){const n=arguments.length;return n&&n!==2&&N("defaultLocale expects either zero or two arguments."),n?B1(Gd(e),Jl(t)):B1(Gd(),Jl())}function Z7(){return Ok(),Ik(),U1()}function Bk(e,t,n,i){t=t||{};const r=s1(t.type||"json");return r||N("Unknown data format type: "+t.type),e=r(e,t),t.parse&&Q7(e,t.parse,n,i),te(e,"columns")&&delete e.columns,e}function Q7(e,t,n,i){if(!e.length)return;const r=Jl();n=n||r.timeParse,i=i||r.utcParse;let o=e.columns||Object.keys(e[0]),s,a,u,l,c,f;t==="auto"&&(t=bA(e,o)),o=Object.keys(t);const d=o.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?i:n)(m);if(!e1[p])throw Error("Illegal format pattern: "+h+":"+p);return e1[p]});for(u=0,c=e.length,f=o.length;u<c;++u)for(s=e[u],l=0;l<f;++l)a=o[l],s[a]=d[l](s[a])}const Yd=H9(typeof fetch!="undefined"&&fetch,null);function Vd(e){const t=e||It,n=[],i={};return n.add=r=>{const o=t(r);return i[o]||(i[o]=1,n.push(r)),n},n.remove=r=>{const o=t(r);if(i[o]){i[o]=0;const s=n.indexOf(r);s>=0&&n.splice(s,1)}return n},n}async function Xd(e,t){try{await t(e)}catch(n){e.error(n)}}const Uk=Symbol("vega_id");let eB=1;function Kd(e){return!!(e&&ne(e))}function ne(e){return e[Uk]}function jk(e,t){return e[Uk]=t,e}function Ce(e){const t=e===Object(e)?e:{data:e};return ne(t)?t:jk(t,eB++)}function j1(e){return Jd(e,Ce({}))}function Jd(e,t){for(const n in e)t[n]=e[n];return t}function qk(e,t){return jk(t,ne(e))}function Os(e,t){return e?t?(n,i)=>e(n,i)||ne(t(n))-ne(t(i)):(n,i)=>e(n,i)||ne(n)-ne(i):null}function Wk(e){return e&&e.constructor===Ns}function Ns(){const e=[],t=[],n=[],i=[],r=[];let o=null,s=!1;return{constructor:Ns,insert(a){const u=K(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=fe(a)?i:t,l=K(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:zt(l)};return fe(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return fe(a)?r.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return o=a,this},reflow(){return s=!0,this},pulse(a,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[ne(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[ne(g)]=-1;for(f=0,d=i.length;f<d;++f)p=i[f],u.forEach(v=>{p(v)&&(l[ne(v)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=ne(g),l[m]?l[m]=1:a.add.push(Ce(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[ne(g)]<0&&a.rem.push(g);function y(v,b,w){w?v[b]=w(v):a.encode=b,s||(c[ne(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[ne(g)],m>0&&(y(g,p,h.value),a.modifies(p));for(f=0,d=r.length;f<d;++f)h=r[f],p=h.filter,u.forEach(v=>{p(v)&&l[ne(v)]>0&&y(v,h.field,h.value)}),a.modifies(h.field);if(s)a.mod=t.length||i.length?u.filter(v=>l[ne(v)]>0):u.slice();else for(m in c)a.mod.push(c[m]);return(o||o==null&&(t.length||i.length))&&a.clean(!0),a}}}const Zd="_:mod:_";function Qd(){Object.defineProperty(this,Zd,{writable:!0,value:{}})}Qd.prototype={set(e,t,n,i){const r=this,o=r[e],s=r[Zd];return t!=null&&t>=0?(o[t]!==n||i)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||i)&&(r[e]=n,s[e]=R(n)?1+n.length:-1),r},modified(e,t){const n=this[Zd];if(arguments.length){if(R(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Zd]={},this}};let tB=0;const nB="pulse",iB=new Qd,rB=1,oB=2;function Ie(e,t,n,i){this.id=++tB,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function Hk(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Ie.prototype={targets(){return this._targets||(this._targets=Vd($l))},set(e){return this.value!==e?(this.value=e,1):0},skip:Hk(rB),modified:Hk(oB),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new Qd,r=this._argops=this._argops||[],o=[];let s,a,u,l;const c=(f,d,h)=>{h instanceof Ie?(h!==this&&(t&&h.targets().add(this),o.push(h)),r.push({op:h,name:f,index:d})):i.set(f,d,h)};for(s in e)if(a=e[s],s===nB)K(a).forEach(f=>{f instanceof Ie?f!==this&&(f.targets().add(this),o.push(f)):N("Pulse parameters must be operator instances.")}),this.source=a;else if(R(a))for(i.set(s,-1,Array(u=a.length)),l=0;l<u;++l)c(s,l,a[l]);else c(s,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),o},marshall(e){const t=this._argval||iB,n=this._argops;let i,r,o,s;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],o=i.op,s=o.modified()&&o.stamp===e,t.set(i.name,i.index,o.value,s);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function sB(e,t,n,i){let r=1,o;return e instanceof Ie?o=e:e&&e.prototype instanceof Ie?o=new e:fe(e)?o=new Ie(null,e):(r=0,o=new Ie(e,t)),this.rank(o),r&&(i=n,n=t),n&&this.connect(o,o.parameters(n,i)),this.touch(o),o}function aB(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let uB=0;function eh(e,t,n){this.id=++uB,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Eo(e,t,n){return new eh(e,t,n)}eh.prototype={_filter:Vn,_apply:It,targets(){return this._targets||(this._targets=Vd($l))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Eo(e);return this.targets().add(t),t},apply(e){const t=Eo(null,e);return this.targets().add(t),t},merge(){const e=Eo();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Eo();return this.targets().add(Eo(null,null,X0(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(Eo(null,null,()=>n=!0)),t.targets().add(Eo(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Vn,this._targets=null}};function lB(e,t,n,i){const r=this,o=Eo(n,i),s=function(l){l.dataflow=r;try{o.receive(l)}catch(c){r.error(c)}finally{r.run()}};let a;typeof e=="string"&&typeof document!="undefined"?a=document.querySelectorAll(e):a=K(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,s);return o}function cB(e,t){const n=this.locale();return Bk(e,t,n.timeParse,n.utcParse)}function fB(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function dB(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:CA(t&&t.type)});try{r=n.parse(r,t)}catch(o){i=-2,n.warn("Data ingestion failed",e,o)}}catch(o){i=-1,n.warn("Loading failed",e,o)}return{data:r,status:i}}async function hB(e,t,n){const i=this,r=i._pending||pB(i);r.requests+=1;const o=await i.request(t,n);return i.pulse(e,i.changeset().remove(Vn).insert(o.data||[])),r.done(),o}function pB(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const gB={skip:!0};function mB(e,t,n,i,r){return(e instanceof Ie?vB:yB)(this,e,t,n,i,r),this}function yB(e,t,n,i,r,o){const s=de({},o,gB);let a,u;fe(n)||(n=zt(n)),i===void 0?a=l=>e.touch(n(l)):fe(i)?(u=new Ie(null,i,r,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;Wk(f)?e.pulse(c,f,o):e.update(c,f,s)}):a=l=>e.update(n(l),i,s),t.apply(a)}function vB(e,t,n,i,r,o){if(i===void 0)t.targets().add(n);else{const s=o||{},a=new Ie(null,bB(n,i),r,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function bB(e,t){return t=fe(t)?t:zt(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function xB(e){e.rank=++this._rank}function wB(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&N("Cycle detected in dataflow graph.")}const th={},Hi=1<<0,So=1<<1,Nr=1<<2,_B=Hi|So,Gk=Hi|Nr,eu=Hi|So|Nr,Yk=1<<3,Zl=1<<4,Vk=1<<5,Xk=1<<6;function Ao(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function q1(e,t){const n=[];return yo(e,t,i=>n.push(i)),n}function Kk(e,t){const n={};return e.visit(t,i=>{n[ne(i)]=1}),i=>n[ne(i)]?null:i}function nh(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}Ao.prototype={StopPropagation:th,ADD:Hi,REM:So,MOD:Nr,ADD_REM:_B,ADD_MOD:Gk,ALL:eu,REFLOW:Yk,SOURCE:Zl,NO_SOURCE:Vk,NO_FIELDS:Xk,fork(e){return new Ao(this.dataflow).init(this,e)},clone(){const e=this.fork(eu);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(eu|Zl)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Ao(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&Xk)&&(n.fields=e.fields),t&Hi?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&So?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Nr?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&Vk?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||eu;return t&Hi&&this.add.length||t&So&&this.rem.length||t&Nr&&this.mod.length},reflow(e){if(e)return this.fork(eu).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Nr,Kk(this,Hi))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return R(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?R(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Hi&&(n.addF=nh(n.addF,t)),e&So&&(n.remF=nh(n.remF,t)),e&Nr&&(n.modF=nh(n.modF,t)),e&Zl&&(n.srcF=nh(n.srcF,t)),n},materialize(e){e=e||eu;const t=this;return e&Hi&&t.addF&&(t.add=q1(t.add,t.addF),t.addF=null),e&So&&t.remF&&(t.rem=q1(t.rem,t.remF),t.remF=null),e&Nr&&t.modF&&(t.mod=q1(t.mod,t.modF),t.modF=null),e&Zl&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&Zl)return yo(n.source,n.srcF,i),n;e&Hi&&yo(n.add,n.addF,i),e&So&&yo(n.rem,n.remF,i),e&Nr&&yo(n.mod,n.modF,i);const r=n.source;if(e&Yk&&r){const o=n.add.length+n.mod.length;o===r.length||(o?yo(r,Kk(n,Gk),i):yo(r,n.srcF,i))}return n}};function W1(e,t,n,i){const r=this,o=n.length;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(let a=0;a<o;++a){const u=n[a];if(u.stamp===t){if(u.fields){const l=r.fields||(r.fields={});for(const c in u.fields)l[c]=1}u.changed(r.ADD)&&(s|=r.ADD),u.changed(r.REM)&&(s|=r.REM),u.changed(r.MOD)&&(s|=r.MOD)}}this.changes=s}q(W1,Ao,{fork(e){const t=new Ao(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?R(e)?e.some(i=>n[i]):n[e]:0},filter(){N("MultiPulse does not support filtering.")},materialize(){N("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let o=0;if(e&n.SOURCE)for(;o<r;++o)i[o].visit(e,t);else for(;o<r;++o)i[o].stamp===n.stamp&&i[o].visit(e,t);return n}});async function EB(e,t,n){const i=this,r=[];if(i._pulse)return Jk(i);if(i._pending&&await i._pending,t&&await Xd(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const o=++i._clock;i._pulse=new Ao(i,o,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=Vd($l);let s=0,a,u,l;try{for(;i._heap.size()>0;){if(a=i._heap.pop(),a.rank!==a.qrank){i._enqueue(a,!0);continue}u=a.run(i._getPulse(a,e)),u.then?u=await u:u.async&&(r.push(u.async),u=th),u!==th&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++s}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${o}: ${s} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await Xd(i,c[f].callback)}return n&&await Xd(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}async function SB(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function AB(e,t,n){return this._pulse?Jk(this):(this.evaluate(e,t,n),this)}function kB(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function Jk(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function CB(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function $B(e,t){const n=e.source,i=this._clock;return n&&R(n)?new W1(this,i,n.map(r=>r.pulse),t):this._input[e.id]||MB(this._pulse,n&&n.pulse)}function MB(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==th&&(e.source=t.source),e)}const H1={skip:!1,force:!1};function FB(e,t){const n=t||H1;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function DB(e,t,n){const i=n||H1;return(e.set(t)||i.force)&&this.touch(e,i),this}function TB(e,t,n){this.touch(e,n||H1);const i=new Ao(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function OB(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),Zk(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,NB(t,0,e)):i=n,i}}}function Zk(e,t,n,i){let r,o;const s=e[n];for(;n>t;){if(o=n-1>>1,r=e[o],i(s,r)<0){e[n]=r,n=o;continue}break}return e[n]=s}function NB(e,t,n){const i=t,r=e.length,o=e[t];let s=(t<<1)+1,a;for(;s<r;)a=s+1,a<r&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],t=s,s=(t<<1)+1;return e[t]=o,Zk(e,i,t,n)}function tu(){this.logger(W0()),this.logLevel(j0),this._clock=0,this._rank=0,this._locale=U1();try{this._loader=Yd()}catch(e){}this._touched=Vd($l),this._input={},this._pulse=null,this._heap=OB((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Ql(e){return function(){return this._log[e].apply(this,arguments)}}tu.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Ql("error"),warn:Ql("warn"),info:Ql("info"),debug:Ql("debug"),logLevel:Ql("level"),cleanThreshold:1e4,add:sB,connect:aB,rank:xB,rerank:wB,pulse:TB,touch:FB,update:DB,changeset:Ns,ingest:fB,parse:cB,preload:hB,request:dB,events:lB,on:mB,evaluate:EB,run:AB,runAsync:SB,runAfter:kB,_enqueue:CB,_getPulse:$B};function T(e,t){Ie.call(this,e,null,t)}q(T,Ie,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const nu={};function Qk(e){const t=eC(e);return t&&t.Definition||null}function eC(e){return e=e&&e.toLowerCase(),te(nu,e)?nu[e]:null}function*tC(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function G1(e,t,n){const i=Float64Array.from(tC(e,n));return i.sort(Ya),t.map(r=>TA(i,r))}function Y1(e,t){return G1(e,[.25,.5,.75],t)}function V1(e,t){const n=e.length,i=_z(e,t),r=Y1(e,t),o=(r[2]-r[0])/1.34,s=Math.min(i,o)||i||Math.abs(r[0])||1;return 1.06*s*Math.pow(n,-.2)}function nC(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let o=e.extent[0],s=e.extent[1],a,u,l,c,f,d;const h=e.span||s-o||Math.abs(o)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/i)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=r.length;f<d;++f)c=a/r[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/i)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/a+g)*a,o=o<c?c-a:c,s=Math.ceil(s/a)*a),{start:o,stop:s===o?o+a:s,step:a}}var Jn=Math.random;function RB(e){Jn=e}function iC(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(tC(e,i)),o=r.length,s=t;let a,u,l,c;for(l=0,c=Array(s);l<s;++l){for(a=0,u=0;u<o;++u)a+=r[~~(Jn()*o)];c[l]=a/o}return c.sort(Ya),[d1(c,n/2),d1(c,1-n/2)]}function rC(e,t,n,i){i=i||(d=>d);const r=e.length,o=new Float64Array(r);let s=0,a=1,u=i(e[0]),l=u,c=u+t,f;for(;a<r;++a){if(f=i(e[a]),f>=c){for(l=(u+l)/2;s<a;++s)o[s]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;s<a;++s)o[s]=l;return n?LB(o,t+t/4):o}function LB(e,t){const n=e.length;let i=0,r=1,o,s;for(;e[i]===e[r];)++r;for(;r<n;){for(o=r+1;e[r]===e[o];)++o;if(e[r]-e[r-1]<t){for(s=r+(i+o-r-r>>1);s<r;)e[s++]=e[r];for(;s>r;)e[s--]=e[i]}i=r,r=o}return e}function IB(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function PB(e,t){t==null&&(t=e,e=0);let n,i,r;const o={min(s){return arguments.length?(n=s||0,r=i-n,o):n},max(s){return arguments.length?(i=s||0,r=i-n,o):i},sample(){return n+Math.floor(r*Jn())},pdf(s){return s===Math.floor(s)&&s>=n&&s<i?1/r:0},cdf(s){const a=Math.floor(s);return a<n?0:a>=i?1:(a-n+1)/r},icdf(s){return s>=0&&s<=1?n-1+Math.floor(s*r):NaN}};return o.min(e).max(t)}const oC=Math.sqrt(2*Math.PI),zB=Math.SQRT2;let ec=NaN;function ih(e,t){e=e||0,t=t==null?1:t;let n=0,i=0,r,o;if(ec===ec)n=ec,ec=NaN;else{do n=Jn()*2-1,i=Jn()*2-1,r=n*n+i*i;while(r===0||r>1);o=Math.sqrt(-2*Math.log(r)/r),n*=o,ec=i*o}return e+n*t}function X1(e,t,n){n=n==null?1:n;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*oC)}function rh(e,t,n){t=t||0,n=n==null?1:n;const i=(e-t)/n,r=Math.abs(i);let o;if(r>37)o=0;else{const s=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,o=s*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,o=o/a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,o=s/a/2.506628274631)}return i>0?1-o:o}function oh(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*zB*BB(2*e-1)}function BB(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=Infinity,n*e}function K1(e,t){let n,i;const r={mean(o){return arguments.length?(n=o||0,r):n},stdev(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>ih(n,i),pdf:o=>X1(o,n,i),cdf:o=>rh(o,n,i),icdf:o=>oh(o,n,i)};return r.mean(e).stdev(t)}function J1(e,t){const n=K1();let i=0;const r={data(o){return arguments.length?(e=o,i=o?o.length:0,r.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=V1(e)),r):t},sample(){return e[~~(Jn()*i)]+t*n.sample()},pdf(o){let s=0,a=0;for(;a<i;++a)s+=n.pdf((o-e[a])/t);return s/t/i},cdf(o){let s=0,a=0;for(;a<i;++a)s+=n.cdf((o-e[a])/t);return s/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function Z1(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+ih()*t)}function Q1(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*oC*e)}function ey(e,t,n){return rh(Math.log(e),t,n)}function ty(e,t,n){return Math.exp(oh(e,t,n))}function sC(e,t){let n,i;const r={mean(o){return arguments.length?(n=o||0,r):n},stdev(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>Z1(n,i),pdf:o=>Q1(o,n,i),cdf:o=>ey(o,n,i),icdf:o=>ty(o,n,i)};return r.mean(e).stdev(t)}function aC(e,t){let n=0,i;function r(s){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=s[l]==null?1:+s[l];for(l=0;l<n;++l)a[l]/=u;return a}const o={weights(s){return arguments.length?(i=r(t=s||[]),o):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),o.weights(t)):e},sample(){const s=Jn();let a=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(s<u){a=e[l];break}return a.sample()},pdf(s){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].pdf(s);return a},cdf(s){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].cdf(s);return a},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function ny(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*Jn()}function iy(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function ry(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function oy(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function uC(e,t){let n,i;const r={min(o){return arguments.length?(n=o||0,r):n},max(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>ny(n,i),pdf:o=>iy(o,n,i),cdf:o=>ry(o,n,i),icdf:o=>oy(o,n,i)};return t==null&&(t=e==null?1:e,e=0),r.min(e).max(t)}function tc(e,t,n,i){const r=i-e*e,o=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-o*e,o]}function sh(e,t,n,i){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),i&&e.sort((h,p)=>t(h)-t(p));const r=e.length,o=new Float64Array(r),s=new Float64Array(r);let a=0,u=0,l=0,c,f,d;for(d of e)o[a]=c=+t(d),s[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<r;++a)o[a]-=u,s[a]-=l;return[o,s,u,l]}function nc(e,t,n,i){let r=-1,o,s;for(const a of e)o=t(a),s=n(a),o!=null&&(o=+o)>=o&&s!=null&&(s=+s)>=s&&i(o,s,++r)}function iu(e,t,n,i,r){let o=0,s=0;return nc(e,t,n,(a,u)=>{const l=u-r(a),c=u-i;o+=l*l,s+=c*c}),1-o/s}function sy(e,t,n){let i=0,r=0,o=0,s=0,a=0;nc(e,t,n,(c,f)=>{++a,i+=(c-i)/a,r+=(f-r)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=tc(i,r,o,s),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:iu(e,t,n,r,l)}}function lC(e,t,n){let i=0,r=0,o=0,s=0,a=0;nc(e,t,n,(c,f)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(f-r)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=tc(i,r,o,s),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:iu(e,t,n,r,l)}}function cC(e,t,n){const[i,r,o,s]=sh(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,p;nc(e,t,n,(v,b)=>{d=i[f++],h=Math.log(b),p=d*b,a+=(b*h-a)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=tc(u/s,a/s,l/s,c/s),y=v=>Math.exp(g+m*(v-o));return{coef:[Math.exp(g-m*o),m],predict:y,rSquared:iu(e,t,n,s,y)}}function fC(e,t,n){let i=0,r=0,o=0,s=0,a=0,u=0;nc(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,i+=(h-i)/u,r+=(p-r)/u,o+=(h*p-o)/u,s+=(h*h-s)/u,a+=(d-a)/u});const l=tc(i,r,o,s),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:iu(e,t,n,a,c)}}function ay(e,t,n){const[i,r,o,s]=sh(e,t,n),a=i.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<a;)p=i[h],g=r[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const y=c-u*u,v=u*y-l*l,b=(d*u-f*l)/v,w=(f*y-d*l)/v,E=-b*u,S=_=>(_=_-o,b*_*_+w*_+E+s);return{coef:[E-w*o+b*o*o+s,w-2*b*o,b],predict:S,rSquared:iu(e,t,n,s,S)}}function dC(e,t,n,i){if(i===1)return sy(e,t,n);if(i===2)return ay(e,t,n);const[r,o,s,a]=sh(e,t,n),u=r.length,l=[],c=[],f=i+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(r[p],d)*o[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(r[p],d+h);m[h]=g}c.push(m)}c.push(l);const y=jB(c),v=b=>{b-=s;let w=a+y[0]+y[1]*b+y[2]*b*b;for(d=3;d<f;++d)w+=y[d]*Math.pow(b,d);return w};return{coef:UB(f,y,-s,a),predict:v,rSquared:iu(e,t,n,a,v)}}function UB(e,t,n,i){const r=Array(e);let o,s,a,u;for(o=0;o<e;++o)r[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],u=1,r[o]+=a,s=1;s<=o;++s)u*=(o+1-s)/s,r[o-s]+=a*Math.pow(n,s)*u;return r[0]+=i,r}function jB(e){const t=e.length-1,n=[];let i,r,o,s,a;for(i=0;i<t;++i){for(s=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][s])&&(s=r);for(o=i;o<t+1;++o)a=e[o][i],e[o][i]=e[o][s],e[o][s]=a;for(r=i+1;r<t;++r)for(o=t;o>=i;o--)e[o][r]-=e[o][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,o=r+1;o<t;++o)a+=e[o][r]*n[o];n[r]=(e[t][r]-a)/e[r][r]}return n}const hC=2,pC=1e-12;function gC(e,t,n,i){const[r,o,s,a]=sh(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=hC;){const p=[0,l-1];for(let m=0;m<u;++m){const y=r[m],v=p[0],b=p[1],w=y-r[v]>r[b]-y?v:b;let E=0,S=0,_=0,A=0,C=0;const k=1/Math.abs(r[w]-y||1);for(let D=v;D<=b;++D){const L=r[D],M=o[D],I=qB(Math.abs(y-L)*k)*d[D],U=L*I;E+=I,S+=U,_+=M*I,A+=M*U,C+=L*U}const[$,F]=tc(S/E,_/E,A/E,C/E);c[m]=$+F*y,f[m]=Math.abs(o[m]-c[m]),WB(r,m+1,p)}if(h===hC)break;const g=OA(f);if(Math.abs(g)<pC)break;for(let m=0,y,v;m<u;++m)y=f[m]/(6*g),d[m]=y>=1?pC:(v=1-y*y)*v}return HB(r,c,s,a)}function qB(e){return(e=1-e*e*e)*e*e}function WB(e,t,n){const i=e[t];let r=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>r&&e[o]-i<=i-e[r];)n[0]=++r,n[1]=o,++o}function HB(e,t,n,i){const r=e.length,o=[];let s=0,a=0,u=[],l;for(;s<r;++s)l=e[s]+n,u[0]===l?u[1]+=(t[s]-u[1])/++a:(a=0,u[1]+=i,u=[l,t[s]],o.push(u));return u[1]+=i,o}const GB=.1*Math.PI/180;function ah(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=h=>[h,e(h)],o=t[0],s=t[1],a=s-o,u=a/i,l=[r(o)],c=[];if(n===i){for(let h=1;h<i;++h)l.push(r(o+h/n*a));return l.push(r(s)),l}else{c.push(r(s));for(let h=n;--h>0;)c.push(r(o+h/n*a))}let f=l[0],d=c[c.length-1];for(;d;){const h=r((f[0]+d[0])/2);h[0]-f[0]>=u&&YB(f,h,d)>GB?c.push(h):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function YB(e,t,n){const i=Math.atan2(n[1]-e[1],n[0]-e[0]),r=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(i-r)}function VB(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function uy(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:VB(e)}function mC(e,t,n){return n||e+(t?"_"+t:"")}const ly=()=>{},XB={init:ly,add:ly,rem:ly,idx:0},ic={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},rc=Object.keys(ic);function KB(e,t){return n=>de({name:e,out:n||e},XB,t)}rc.forEach(e=>{ic[e]=KB(e,ic[e])});function yC(e,t){return ic[e](t)}function vC(e,t){return e.idx-t.idx}function JB(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{t[r]||n(t[r]=ic[r]())})};return e.forEach(n),Object.values(t).sort(vC)}function ZB(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function QB(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function eU(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function tU(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function bC(e,t){const n=t||It,i=JB(e),r=e.slice().sort(vC);function o(s){this._ops=i,this._out=r,this.cell=s,this.init()}return o.prototype.init=ZB,o.prototype.add=QB,o.prototype.rem=eU,o.prototype.set=tU,o.prototype.get=n,o.fields=e.map(s=>s.out),o}function cy(e){this._key=e?bn(e):ne,this.reset()}const Mt=cy.prototype;Mt.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Mt.add=function(e){this._add.push(e)},Mt.rem=function(e){this._rem.push(e)},Mt.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,o=Array(i-r),s={};let a,u,l;for(a=0;a<r;++a)s[n(t[a])]=1;for(a=0,u=0;a<i;++a)s[n(l=e[a])]?s[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o},Mt.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,o;for(;--i>=0;)o=e(t[i])+"",te(n,o)||(n[o]=1,++r);return r},Mt.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=aA(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Mt.argmin=function(e){return this.extent(e)[0]||{}},Mt.argmax=function(e){return this.extent(e)[1]||{}},Mt.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0},Mt.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0},Mt.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Y1(this.values(),e),this._get=e),this._q},Mt.q1=function(e){return this.quartile(e)[0]},Mt.q2=function(e){return this.quartile(e)[1]},Mt.q3=function(e){return this.quartile(e)[2]},Mt.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=iC(this.values(),1e3,.05,e),this._get=e),this._ci},Mt.ci0=function(e){return this.ci(e)[0]},Mt.ci1=function(e){return this.ci(e)[1]};function ko(e){T.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}ko.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:rc},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},q(ko,T,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function o(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}o(e._prev),o(t);function s(a,u,l){const c=n[l],f=i[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<r?s(h,u,l):t[h]||e.cell(h,u)}}s("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(m){const y=K(Lt(m)),v=y.length;let b=0,w;for(;b<v;++b)i[w=y[b]]||(i[w]=1,t.push(w))}this._dims=K(e.groupby),this._dnames=this._dims.map(m=>{const y=Je(m);return r(m),n.push(y),y}),this.cellkey=e.key?e.key:uy(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],s=e.ops||["count"],a=e.as||[],u=o.length,l={};let c,f,d,h,p,g;for(u!==s.length&&N("Unmatched number of fields and aggregate ops."),g=0;g<u;++g){if(c=o[g],f=s[g],c==null&&f!=="count"&&N("Null aggregate field specified."),h=Je(c),p=mC(f,h,a[g]),n.push(p),f==="count"){this._counts.push(p);continue}d=l[h],d||(r(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(yC(f,p))}return this._measures=this._measures.map(m=>bC(m,m.field)),{}},cellkey:uy(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let o=0;o<r;++o)n.agg[o]=new i[o](n)}return n.store&&(n.data=new cy),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,o={};for(let s=0;s<r;++s)o[n[s]]=i[s](e);return t?qk(t.tuple,o):Ce(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,o=i.length;r<o;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,o=i.length;r<o;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,o=i.length;r<o;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,o=e.add,s=e.rem,a=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&s.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?s:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const nU=1e-14;function fy(e){T.call(this,null,e)}fy.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},q(fy,T,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,o=i.step,s=e.as||["bin0","bin1"],a=s[0],u=s[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Lt(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[a]=f,c[u]=f==null?null:r+o*(1+(f-r)/o)}:c=>c[a]=i(c)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=nC(e),i=n.step;let r=n.start,o=r+Math.ceil((n.stop-r)/i)*i,s,a;(s=e.anchor)!=null&&(a=s-(r+i*Math.floor((s-r)/i)),r+=a,o+=a);const u=function(l){let c=Pt(t(l));return c==null?null:c<r?-Infinity:c>o?Infinity:(c=Math.max(r,Math.min(c,o-i)),r+i*Math.floor(nU+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=vn(u,Lt(t),e.name||"bin_"+Je(t))}});function xC(e,t,n){const i=e;let r=t||[],o=n||[],s={},a=0;return{add:u=>o.push(u),remove:u=>s[i(u)]=++a,size:()=>r.length,data:(u,l)=>(a&&(r=r.filter(c=>!s[i(c)]),s={},a=0),l&&u&&r.sort(u),o.length&&(r=u?hA(u,r,o.sort(u)):r.concat(o),o=[]),r)}}function dy(e){T.call(this,[],e)}dy.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},q(dy,T,{transform(e,t){const n=t.fork(t.ALL),i=xC(ne,this.value,n.materialize(n.ADD).add),r=e.sort,o=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(o),this.value=n.source=i.data(Os(r),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function wC(e){Ie.call(this,null,iU,e)}q(wC,Ie);function iU(e){return this.value&&!e.modified()?this.value:V0(e.fields,e.orders)}function hy(e){T.call(this,null,e)}hy.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function rU(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}q(hy,T,{transform(e,t){const n=f=>d=>{for(var h=rU(a(d),e.case,o)||[],p,g=0,m=h.length;g<m;++g)s.test(p=h[g])||f(p)},i=this._parameterCheck(e,t),r=this._counts,o=this._match,s=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],o=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=i[a],l=n[a]||0,!u&&l?(i[a]=u=Ce({}),u[r]=a,u[o]=l,s.add.push(u)):l===0?(u&&s.rem.push(u),n[a]=null,i[a]=null):u[o]!==l&&(u[o]=l,s.mod.push(u));return s.modifies(t)}});function py(e){T.call(this,null,e)}py.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},q(py,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],o=i[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=oU(a,r,o,e.filter||Vn)):n.mod=a,n.source=this.value,n.modifies(i)}});function oU(e,t,n,i){for(var r=[],o={},s=e.length,a=0,u,l;a<s;++a)for(o[t]=l=e[a],u=0;u<s;++u)o[n]=e[u],i(o)&&(r.push(Ce(o)),o={},o[t]=l);return r}const _C={kde:J1,mixture:aC,normal:K1,lognormal:sC,uniform:uC},sU="distributions",EC="function",aU="field";function SC(e,t){const n=e[EC];te(_C,n)||N("Unknown distribution function: "+n);const i=_C[n]();for(const r in e)r===aU?i.data((e.from||t()).map(e[r])):r===sU?i[r](e[r].map(o=>SC(o,t))):typeof i[r]===EC&&i[r](e[r]);return i}function gy(e){T.call(this,null,e)}const AC=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],uU={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:AC},{name:"weights",type:"number",array:!0}]};gy.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:AC.concat(uU)},{name:"as",type:"string",array:!0,default:["value","density"]}]},q(gy,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=SC(e.distribution,lU(t)),r=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let s=e.method||"pdf";s!=="pdf"&&s!=="cdf"&&N("Invalid density method: "+s),!e.extent&&!i.data&&N("Missing density extent parameter."),s=i[s];const a=e.as||["value","density"],u=e.extent||qi(i.data()),l=ah(s,u,r,o).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],Ce(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function lU(e){return()=>e.materialize(e.SOURCE).source}function kC(e,t){return e?e.map((n,i)=>t[i]||Je(n)):null}function my(e,t,n){const i=[],r=f=>f(u);let o,s,a,u,l,c;if(t==null)i.push(e.map(n));else for(o={},s=0,a=e.length;s<a;++s)u=e[s],l=t.map(r),c=o[l],c||(o[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const CC="bin";function yy(e){T.call(this,null,e)}yy.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:CC}]};const cU=(e,t)=>Dl(qi(e,t))/30;q(yy,T,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=my(t.source,e.groupby,It),r=e.smooth||!1,o=e.field,s=e.step||cU(n,o),a=Os((p,g)=>o(p)-o(g)),u=e.as||CC,l=i.length;let c=Infinity,f=-Infinity,d=0,h;for(;d<l;++d){const p=i[d].sort(a);h=-1;for(const g of rC(p,s,r,o))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:s},t.reflow(!0).modifies(u)}});function $C(e){Ie.call(this,null,fU,e),this.modified(!0)}q($C,Ie);function fU(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:vn(n=>t(n,e),Lt(t),Je(t))}function vy(e){T.call(this,[void 0,void 0],e)}vy.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},q(vy,T,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let o=n[0],s=n[1];if((r||o==null)&&(o=Infinity,s=-Infinity),t.visit(r?t.SOURCE:t.ADD,a=>{const u=Pt(i(a));u!=null&&(u<o&&(o=u),u>s&&(s=u))}),!Number.isFinite(o)||!Number.isFinite(s)){let a=Je(i);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}});function by(e,t){Ie.call(this,e),this.parent=t,this.count=0}q(by,Ie,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function uh(e){T.call(this,{},e),this._keys=Ha();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}q(uh,T,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let o=te(r,e)&&r[e],s,a;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(a=i||(a=this._group[e])&&a.tuple,s=n.dataflow,o=new by(n.fork(n.NO_SOURCE),this),s.add(o).connect(t(s,e,a)),r[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,o=this._keys,s=e.modified("key"),a=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=ne(u),c=o.get(l);c!==void 0&&(o.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);o.set(ne(u),l),a(l).add(u)}),s||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=ne(u),c=o.get(l),f=i(u);c===f?a(f).mod(u):(o.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(o.get(ne(u))).mod(u)}),s&&t.visit(t.REFLOW,u=>{const l=ne(u),c=o.get(l),f=i(u);c!==f&&(o.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function MC(e){Ie.call(this,null,dU,e)}q(MC,Ie);function dU(e){return this.value&&!e.modified()?this.value:R(e.name)?K(e.name).map(t=>bn(t)):bn(e.name,e.as)}function xy(e){T.call(this,Ha(),e)}xy.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},q(xy,T,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),o=r.add,s=r.rem,a=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=ne(f);i.has(d)?i.delete(d):s.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):i.set(ne(f),1)});function c(f){const d=ne(f),h=u(f,e),p=i.get(d);h&&p?(i.delete(d),o.push(f)):!h&&!p?(i.set(d,1),s.push(f)):l&&h&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function wy(e){T.call(this,[],e)}wy.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},q(wy,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=kC(i,e.as||[]),o=e.index||null,s=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=i.map(p=>p(a)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=j1(a),f=0;f<s;++f)d[r[f]]=(h=u[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(r)}});function _y(e){T.call(this,[],e)}_y.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},q(_y,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(Je),o=e.as||["key","value"],s=o[0],a=o[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=j1(l),f[s]=r[c],f[a]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function Ey(e){T.call(this,null,e)}Ey.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},q(Ey,T,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),o=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(o,s=>s[i]=n(s,e))}});function FC(e){T.call(this,[],e)}q(FC,T,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,o=e.size-r.length,s,a,u;if(o>0){for(s=[];--o>=0;)s.push(u=Ce(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else a=r.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-o);return n.source=this.value=r,n}});const lh={value:"value",median:OA,mean:Sz,min:f1,max:$s},hU=[];function Sy(e){T.call(this,[],e)}Sy.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function pU(e){var t=e.method||lh.value,n;if(lh[t]==null)N("Unrecognized imputation method: "+t);else return t===lh.value?(n=e.value!==void 0?e.value:0,()=>n):lh[t]}function gU(e){const t=e.field;return n=>n?t(n):NaN}q(Sy,T,{transform(e,t){var n=t.fork(t.ALL),i=pU(e),r=gU(e),o=Je(e.field),s=Je(e.key),a=(e.groupby||[]).map(Je),u=mU(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,m,y,v,b,w,E;for(m=0,b=u.length;m<b;++m)for(d=u[m],p=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(g=u.domain[v],E={_impute:!0},y=0,w=p.length;y<w;++y)E[a[y]]=p[y];E[s]=g,E[o]=Number.isNaN(h)?h=i(d,r):h,l.push(Ce(E))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function mU(e,t,n,i){var r=y=>y(m),o=[],s=i?i.slice():[],a={},u={},l,c,f,d,h,p,g,m;for(s.forEach((y,v)=>a[y]=v+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=a[p]||(a[p]=s.push(p)),c=(l=t?t.map(r):hU)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=m;return o.domain=s,o}function Ay(e){ko.call(this,e)}Ay.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:rc},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},q(Ay,ko,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(r=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{de(o,r[n.cellkey(o)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function ky(e){T.call(this,null,e)}ky.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},q(ky,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=my(i,e.groupby,e.field),o=(e.groupby||[]).map(Je),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&N("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=qi(i,e.field)),f=d=e.steps||d),r.forEach(h=>{const p=J1(h,s)[a],g=e.counts?h.length:1,m=c||qi(h);ah(p,m,f,d).forEach(y=>{const v={};for(let b=0;b<o.length;++b)v[o[b]]=h.dims[b];v[u[0]]=y[0],v[u[1]]=y[1]*g,l.push(Ce(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function DC(e){Ie.call(this,null,yU,e)}q(DC,Ie);function yU(e){return this.value&&!e.modified()?this.value:K0(e.fields,e.flat)}function TC(e){T.call(this,[],e),this._pending=null}q(TC,T,{transform(e,t){const n=t.dataflow;return this._pending?Cy(this,t,this._pending):vU(e)?t.StopPropagation:e.values?Cy(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=K(r.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(i=>Cy(this,t,K(i.data)))}});function vU(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Cy(e,t,n){n.forEach(Ce);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function $y(e){T.call(this,{},e)}$y.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},q($y,T,{transform(e,t){const n=e.fields,i=e.index,r=e.values,o=e.default==null?null:e.default,s=e.modified(),a=n.length;let u=s?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return r?(d=r.length,a>1&&!c&&N('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&N('The "as" parameter has too few output field names.'),c=c||r.map(Je),f=function(p){for(var g=0,m=0,y,v;g<a;++g)if(v=i.get(n[g](p)),v==null)for(y=0;y<d;++y,++m)p[c[m]]=o;else for(y=0;y<d;++y,++m)p[c[m]]=r[y](v)}):(c||N("Missing output field names."),f=function(p){for(var g=0,m;g<a;++g)m=i.get(n[g](p)),p[c[g]]=m==null?o:m}),s?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function OC(e){Ie.call(this,null,bU,e)}q(OC,Ie);function bU(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=Infinity,r=-Infinity,o,s;for(o=0;o<n;++o)s=t[o],s[0]<i&&(i=s[0]),s[1]>r&&(r=s[1]);return[i,r]}function NC(e){Ie.call(this,null,xU,e)}q(NC,Ie);function xU(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function RC(e){T.call(this,null,e)}q(RC,T,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function My(e){ko.call(this,e)}My.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:rc,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},q(My,ko,{_transform:ko.prototype.transform,transform(e,t){return this._transform(wU(e,t),t)}});function wU(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",o=Lt(n).concat(Lt(i)),s=EU(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>r),fields:s.map(a=>_U(a,n,i,o)),as:s.map(a=>a+""),modified:e.modified.bind(e)}}function _U(e,t,n,i){return vn(r=>t(r)===e?n(r):NaN,i,e+"")}function EU(e,t,n){const i={},r=[];return n.visit(n.SOURCE,o=>{const s=e(o);i[s]||(i[s]=1,r.push(s))}),r.sort(Ld),t?r.slice(0,t):r}function LC(e){uh.call(this,e)}q(LC,uh,{transform(e,t){const n=e.subflow,i=e.field,r=o=>this.subflow(ne(o),n,t,o);return(e.modified("field")||i&&t.modified(Lt(i)))&&N("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,o=>{const s=r(o);i(o).forEach(a=>s.mod(a))}),t.visit(t.ADD,o=>{const s=r(o);i(o).forEach(a=>s.add(Ce(a)))}),t.visit(t.REM,o=>{const s=r(o);i(o).forEach(a=>s.rem(a))})):(t.visit(t.MOD,o=>r(o).mod(o)),t.visit(t.ADD,o=>r(o).add(o)),t.visit(t.REM,o=>r(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function Fy(e){T.call(this,null,e)}Fy.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},q(Fy,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=kC(e.fields,e.as||[]),o=i?(a,u)=>SU(a,u,i,r):Jd;let s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,a=>{const u=ne(a);n.rem.push(s[u]),s[u]=null}),t.visit(t.ADD,a=>{const u=o(a,Ce({}));s[ne(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(o(a,s[ne(a)]))}),n}});function SU(e,t,n,i){for(let r=0,o=n.length;r<o;++r)t[i[r]]=n[r](e);return t}function IC(e){T.call(this,null,e)}q(IC,T,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Dy(e){T.call(this,null,e)}Dy.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const AU=1e-14;q(Dy,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,o=my(r,e.groupby,e.field),s=(e.groupby||[]).map(Je),a=[],u=e.step||.01,l=e.probs||Ln(u/2,1-AU,u),c=l.length;return o.forEach(f=>{const d=G1(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<s.length;++g)p[s[g]]=f.dims[g];p[i[0]]=l[h],p[i[1]]=d[h],a.push(Ce(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function PC(e){T.call(this,null,e)}q(PC,T,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const o=ne(r);n.rem.push(i[o]),i[o]=null}),t.visit(t.ADD,r=>{const o=j1(r);i[ne(r)]=o,n.add.push(o)}),t.visit(t.MOD,r=>{const o=i[ne(r)];for(const s in r)o[s]=r[s],n.modifies(s);n.mod.push(o)})),n}});function Ty(e){T.call(this,[],e),this.count=0}Ty.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},q(Ty,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,o=this.value.reduce((c,f)=>(c[ne(f)]=1,c),{});let s=this.value,a=this.count,u=0;function l(c){let f,d;s.length<r?s.push(c):(d=~~((a+1)*Jn()),d<s.length&&d>=u&&(f=s[d],o[ne(f)]&&n.rem.push(f),s[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=ne(c);o[f]&&(o[f]=-1,n.rem.push(c)),--a}),s=s.filter(c=>o[ne(c)]!==-1)),(t.rem.length||i)&&s.length<r&&t.source&&(u=a=s.length,t.visit(t.SOURCE,c=>{o[ne(c)]||l(c)}),u=-1),i&&s.length>r){const c=s.length-r;for(let f=0;f<c;++f)o[ne(s[f])]=-1,n.rem.push(s[f]);s=s.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[ne(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=s.filter(c=>!o[ne(c)])),this.count=a,this.value=n.source=s,n}});function Oy(e){T.call(this,null,e)}Oy.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},q(Oy,T,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ln(e.start,e.stop,e.step||1).map(r=>{const o={};return o[i]=r,Ce(o)}),n.add=t.add.concat(this.value),n}});function zC(e){T.call(this,null,e),this.modified(!0)}q(zC,T,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Ny(e){T.call(this,null,e)}const BC=["unit0","unit1"];Ny.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:A1,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:BC}]},q(Ny,T,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",o=this._floor(e,t),s=(r?Za:Ja)(o.unit).offset,a=e.as||BC,u=a[0],l=a[1],c=o.step;let f=o.start||Infinity,d=o.stop||-Infinity,h=t.ADD;return(e.modified()||t.modified(Lt(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=Infinity,d=-Infinity),t.visit(h,p=>{const g=n(p);let m,y;g==null?(p[u]=null,i&&(p[l]=null)):(p[u]=m=y=o(g),i&&(p[l]=y=s(m,c)),m<f&&(f=m),y>d&&(d=y))}),o.start=f,o.stop=d,t.modifies(i?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:pk({extent:e.extent||qi(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=C1(i),s=this.value||{},a=(n?ik:nk)(o,r);return a.unit=be(o),a.units=o,a.step=r,a.start=s.start,a.stop=s.stop,this.value=a}});function UC(e){T.call(this,Ha(),e)}q(UC,T,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,o=a=>r.set(i(a),a);let s=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,o)):s=!1,this.modified(s),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function jC(e){T.call(this,null,e)}q(jC,T,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Os(e.sort)):t.source).map(e.field))}});function kU(e,t,n,i){const r=oc[e](t,n);return{init:r.init||ho,update:function(o,s){s[i]=r.next(o)}}}const oc={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=oc.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||N("ntile num must be greater than zero.");const n=oc.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||N("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=CU(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function CU(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const $U=Object.keys(oc);function qC(e){const t=K(e.ops),n=K(e.fields),i=K(e.params),r=K(e.as),o=this.outputs=[],s=this.windows=[],a={},u={},l=[],c=[];let f=!0;function d(h){K(Lt(h)).forEach(p=>a[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],m=Je(g),y=mC(h,m,r[p]);if(d(g),o.push(y),te(oc,h))s.push(kU(h,n[p],i[p],y));else{if(g==null&&h!=="count"&&N("Null aggregate field specified."),h==="count"){l.push(y);return}f=!1;let v=u[m];v||(v=u[m]=[],v.field=g,c.push(v)),v.push(yC(h,y))}}),(l.length||c.length)&&(this.cell=MU(c,l,f)),this.inputs=Object.keys(a)}const WC=qC.prototype;WC.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},WC.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,o=i&&i.length;let s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(r[s]);for(s=e.p1;s<e.i1;++s)n.add(r[s]);n.set(t)}for(s=0;s<o;++s)i[s].update(e,t)};function MU(e,t,n){e=e.map(u=>bC(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,o=i.agg=Array(r),s=0;s<r;++s)o[s]=new e[s](i);if(i.store)var a=i.data=new cy;return i.add=function(u){if(i.num+=1,!n){a&&a.add(u);for(let l=0;l<r;++l)o[l].add(o[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){a&&a.rem(u);for(let l=0;l<r;++l)o[l].rem(o[l].get(u),u)}},i.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},i.init=function(){i.num=0,a&&a.reset();for(let u=0;u<r;++u)o[u].init()},i}function Ry(e){T.call(this,{},e),this._mlen=0,this._mods=[]}Ry.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:$U.concat(rc)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},q(Ry,T,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=Os(e.sort),r=uy(e.groupby),o=a=>this.group(r(a));let s=this.state;(!s||n)&&(s=this.state=new qC(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,a=>o(a).add(a))):(t.visit(t.REM,a=>o(a).remove(a)),t.visit(t.ADD,a=>o(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)FU(this._mods[a],s,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=xC(ne),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function FU(e,t,n,i){const r=i.sort,o=r&&!i.ignorePeers,s=i.frame||[null,0],a=e.data(n),u=a.length,l=o?Ol(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||zt(-1)};t.init();for(let f=0;f<u;++f)DU(c,s,f,u),o&&TU(c,l),t.update(c,a[f])}function DU(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function TU(e,t){const n=e.i0,i=e.i1-1,r=e.compare,o=e.data,s=o.length-1;n>0&&!r(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),i<s&&!r(o[i],o[i+1])&&(e.i1=t.right(o,o[i]))}var OU=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:ko,bin:fy,collect:dy,compare:wC,countpattern:hy,cross:py,density:gy,dotbin:yy,expression:$C,extent:vy,facet:uh,field:MC,filter:xy,flatten:wy,fold:_y,formula:Ey,generate:FC,impute:Sy,joinaggregate:Ay,kde:ky,key:DC,load:TC,lookup:$y,multiextent:OC,multivalues:NC,params:RC,pivot:My,prefacet:LC,project:Fy,proxy:IC,quantile:Dy,relay:PC,sample:Ty,sequence:Oy,sieve:zC,subflow:by,timeunit:Ny,tupleindex:UC,values:jC,window:Ry});const Ly=Math.PI,Iy=2*Ly,Rs=1e-6,NU=Iy-Rs;function Py(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ls(){return new Py}Py.prototype=Ls.prototype={constructor:Py,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var o=this._x1,s=this._y1,a=n-e,u=i-t,l=o-e,c=s-t,f=l*l+c*c;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Rs)if(!(Math.abs(c*a-u*l)>Rs)||!r)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-o,h=i-s,p=a*a+u*u,g=d*d+h*h,m=Math.sqrt(p),y=Math.sqrt(f),v=r*Math.tan((Ly-Math.acos((p+f-g)/(2*m*y)))/2),b=v/y,w=v/m;Math.abs(b-1)>Rs&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+r+","+r+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+w*a)+","+(this._y1=t+w*u)}},arc:function(e,t,n,i,r,o){e=+e,t=+t,n=+n,o=!!o;var s=n*Math.cos(i),a=n*Math.sin(i),u=e+s,l=t+a,c=1^o,f=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>Rs||Math.abs(this._y1-l)>Rs)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%Iy+Iy),f>NU?this._+="A"+n+","+n+",0,1,"+c+","+(e-s)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>Rs&&(this._+="A"+n+","+n+",0,"+ +(f>=Ly)+","+c+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function Me(e){return function(){return e}}var HC=Math.abs,jt=Math.atan2,Is=Math.cos,RU=Math.max,zy=Math.min,Gi=Math.sin,ru=Math.sqrt,qt=1e-12,ou=Math.PI,ch=ou/2,GC=2*ou;function LU(e){return e>1?0:e<-1?ou:Math.acos(e)}function YC(e){return e>=1?ch:e<=-1?-ch:Math.asin(e)}function IU(e){return e.innerRadius}function PU(e){return e.outerRadius}function zU(e){return e.startAngle}function BU(e){return e.endAngle}function UU(e){return e&&e.padAngle}function jU(e,t,n,i,r,o,s,a){var u=n-e,l=i-t,c=s-r,f=a-o,d=f*u-c*l;if(!(d*d<qt))return d=(c*(t-o)-f*(e-r))/d,[e+d*u,t+d*l]}function fh(e,t,n,i,r,o,s){var a=e-n,u=t-i,l=(s?o:-o)/ru(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,g=i+f,m=(d+p)/2,y=(h+g)/2,v=p-d,b=g-h,w=v*v+b*b,E=r-o,S=d*g-p*h,_=(b<0?-1:1)*ru(RU(0,E*E*w-S*S)),A=(S*b-v*_)/w,C=(-S*v-b*_)/w,k=(S*b+v*_)/w,$=(-S*v+b*_)/w,F=A-m,D=C-y,L=k-m,M=$-y;return F*F+D*D>L*L+M*M&&(A=k,C=$),{cx:A,cy:C,x01:-c,y01:-f,x11:A*(r/E-1),y11:C*(r/E-1)}}function qU(){var e=IU,t=PU,n=Me(0),i=null,r=zU,o=BU,s=UU,a=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=r.apply(this,arguments)-ch,p=o.apply(this,arguments)-ch,g=HC(p-h),m=p>h;if(a||(a=l=Ls()),d<f&&(c=d,d=f,f=c),!(d>qt))a.moveTo(0,0);else if(g>GC-qt)a.moveTo(d*Is(h),d*Gi(h)),a.arc(0,0,d,h,p,!m),f>qt&&(a.moveTo(f*Is(p),f*Gi(p)),a.arc(0,0,f,p,h,m));else{var y=h,v=p,b=h,w=p,E=g,S=g,_=s.apply(this,arguments)/2,A=_>qt&&(i?+i.apply(this,arguments):ru(f*f+d*d)),C=zy(HC(d-f)/2,+n.apply(this,arguments)),k=C,$=C,F,D;if(A>qt){var L=YC(A/f*Gi(_)),M=YC(A/d*Gi(_));(E-=L*2)>qt?(L*=m?1:-1,b+=L,w-=L):(E=0,b=w=(h+p)/2),(S-=M*2)>qt?(M*=m?1:-1,y+=M,v-=M):(S=0,y=v=(h+p)/2)}var I=d*Is(y),U=d*Gi(y),Y=f*Is(w),Q=f*Gi(w);if(C>qt){var ce=d*Is(v),$e=d*Gi(v),De=f*Is(b),qe=f*Gi(b),Pe;if(g<ou&&(Pe=jU(I,U,De,qe,ce,$e,Y,Q))){var mt=I-Pe[0],hi=U-Pe[1],pi=ce-Pe[0],yn=$e-Pe[1],X=1/Gi(LU((mt*pi+hi*yn)/(ru(mt*mt+hi*hi)*ru(pi*pi+yn*yn)))/2),ue=ru(Pe[0]*Pe[0]+Pe[1]*Pe[1]);k=zy(C,(f-ue)/(X-1)),$=zy(C,(d-ue)/(X+1))}}S>qt?$>qt?(F=fh(De,qe,I,U,d,$,m),D=fh(ce,$e,Y,Q,d,$,m),a.moveTo(F.cx+F.x01,F.cy+F.y01),$<C?a.arc(F.cx,F.cy,$,jt(F.y01,F.x01),jt(D.y01,D.x01),!m):(a.arc(F.cx,F.cy,$,jt(F.y01,F.x01),jt(F.y11,F.x11),!m),a.arc(0,0,d,jt(F.cy+F.y11,F.cx+F.x11),jt(D.cy+D.y11,D.cx+D.x11),!m),a.arc(D.cx,D.cy,$,jt(D.y11,D.x11),jt(D.y01,D.x01),!m))):(a.moveTo(I,U),a.arc(0,0,d,y,v,!m)):a.moveTo(I,U),!(f>qt)||!(E>qt)?a.lineTo(Y,Q):k>qt?(F=fh(Y,Q,ce,$e,f,-k,m),D=fh(I,U,De,qe,f,-k,m),a.lineTo(F.cx+F.x01,F.cy+F.y01),k<C?a.arc(F.cx,F.cy,k,jt(F.y01,F.x01),jt(D.y01,D.x01),!m):(a.arc(F.cx,F.cy,k,jt(F.y01,F.x01),jt(F.y11,F.x11),!m),a.arc(0,0,f,jt(F.cy+F.y11,F.cx+F.x11),jt(D.cy+D.y11,D.cx+D.x11),m),a.arc(D.cx,D.cy,k,jt(D.y11,D.x11),jt(D.y01,D.x01),!m))):a.arc(0,0,f,w,b,m)}if(a.closePath(),l)return a=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-ou/2;return[Is(c)*l,Gi(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Me(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Me(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Me(+l),u):n},u.padRadius=function(l){return arguments.length?(i=l==null?null:typeof l=="function"?l:Me(+l),u):i},u.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:Me(+l),u):r},u.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Me(+l),u):o},u.padAngle=function(l){return arguments.length?(s=typeof l=="function"?l:Me(+l),u):s},u.context=function(l){return arguments.length?(a=l==null?null:l,u):a},u}function VC(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function XC(e){this._context=e}XC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function By(e){return new XC(e)}function KC(e){return e[0]}function JC(e){return e[1]}function ZC(e,t){var n=Me(!0),i=null,r=By,o=null;e=typeof e=="function"?e:e===void 0?KC:Me(e),t=typeof t=="function"?t:t===void 0?JC:Me(t);function s(a){var u,l=(a=VC(a)).length,c,f=!1,d;for(i==null&&(o=r(d=Ls())),u=0;u<=l;++u)!(u<l&&n(c=a[u],u,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(c,u,a),+t(c,u,a));if(d)return o=null,d+""||null}return s.x=function(a){return arguments.length?(e=typeof a=="function"?a:Me(+a),s):e},s.y=function(a){return arguments.length?(t=typeof a=="function"?a:Me(+a),s):t},s.defined=function(a){return arguments.length?(n=typeof a=="function"?a:Me(!!a),s):n},s.curve=function(a){return arguments.length?(r=a,i!=null&&(o=r(i)),s):r},s.context=function(a){return arguments.length?(a==null?i=o=null:o=r(i=a),s):i},s}function QC(e,t,n){var i=null,r=Me(!0),o=null,s=By,a=null;e=typeof e=="function"?e:e===void 0?KC:Me(+e),t=typeof t=="function"?t:Me(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?JC:Me(+n);function u(c){var f,d,h,p=(c=VC(c)).length,g,m=!1,y,v=new Array(p),b=new Array(p);for(o==null&&(a=s(y=Ls())),f=0;f<=p;++f){if(!(f<p&&r(g=c[f],f,c))===m)if(m=!m)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=f-1;h>=d;--h)a.point(v[h],b[h]);a.lineEnd(),a.areaEnd()}m&&(v[f]=+e(g,f,c),b[f]=+t(g,f,c),a.point(i?+i(g,f,c):v[f],n?+n(g,f,c):b[f]))}if(y)return a=null,y+""||null}function l(){return ZC().defined(r).curve(s).context(o)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Me(+c),i=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Me(+c),u):e},u.x1=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:Me(+c),u):i},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Me(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Me(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Me(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(i).y(t)},u.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Me(!!c),u):r},u.curve=function(c){return arguments.length?(s=c,o!=null&&(a=s(o)),u):s},u.context=function(c){return arguments.length?(c==null?o=a=null:a=s(o=c),u):o},u}var WU={draw:function(e,t){var n=Math.sqrt(t/ou);e.moveTo(n,0),e.arc(0,0,n,0,GC)}};function HU(e,t){var n=null;e=typeof e=="function"?e:Me(e||WU),t=typeof t=="function"?t:Me(t===void 0?64:+t);function i(){var r;if(n||(n=r=Ls()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return i.type=function(r){return arguments.length?(e=typeof r=="function"?r:Me(r),i):e},i.size=function(r){return arguments.length?(t=typeof r=="function"?r:Me(+r),i):t},i.context=function(r){return arguments.length?(n=r==null?null:r,i):n},i}function Co(){}function dh(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function hh(e){this._context=e}hh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:dh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:dh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function GU(e){return new hh(e)}function e$(e){this._context=e}e$.prototype={areaStart:Co,areaEnd:Co,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:dh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function YU(e){return new e$(e)}function t$(e){this._context=e}t$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:dh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function VU(e){return new t$(e)}function n$(e,t){this._basis=new hh(e),this._beta=t}n$.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],o=e[n]-i,s=t[n]-r,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+u*o),this._beta*t[a]+(1-this._beta)*(r+u*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var XU=function e(t){function n(i){return t===1?new hh(i):new n$(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function ph(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Uy(e,t){this._context=e,this._k=(1-t)/6}Uy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ph(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:ph(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var KU=function e(t){function n(i){return new Uy(i,t)}return n.tension=function(i){return e(+i)},n}(0);function jy(e,t){this._context=e,this._k=(1-t)/6}jy.prototype={areaStart:Co,areaEnd:Co,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ph(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var JU=function e(t){function n(i){return new jy(i,t)}return n.tension=function(i){return e(+i)},n}(0);function qy(e,t){this._context=e,this._k=(1-t)/6}qy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ph(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ZU=function e(t){function n(i){return new qy(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Wy(e,t,n){var i=e._x1,r=e._y1,o=e._x2,s=e._y2;if(e._l01_a>qt){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>qt){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,o,s,e._x2,e._y2)}function i$(e,t){this._context=e,this._alpha=t}i$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Wy(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var QU=function e(t){function n(i){return t?new i$(i,t):new Uy(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function r$(e,t){this._context=e,this._alpha=t}r$.prototype={areaStart:Co,areaEnd:Co,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Wy(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ej=function e(t){function n(i){return t?new r$(i,t):new jy(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function o$(e,t){this._context=e,this._alpha=t}o$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Wy(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var tj=function e(t){function n(i){return t?new o$(i,t):new qy(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function s$(e){this._context=e}s$.prototype={areaStart:Co,areaEnd:Co,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function nj(e){return new s$(e)}function a$(e){return e<0?-1:1}function u$(e,t,n){var i=e._x1-e._x0,r=t-e._x1,o=(e._y1-e._y0)/(i||r<0&&-0),s=(n-e._y1)/(r||i<0&&-0),a=(o*r+s*i)/(i+r);return(a$(o)+a$(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function l$(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Hy(e,t,n){var i=e._x0,r=e._y0,o=e._x1,s=e._y1,a=(o-i)/3;e._context.bezierCurveTo(i+a,r+a*t,o-a,s-a*n,o,s)}function gh(e){this._context=e}gh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Hy(this,this._t0,l$(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Hy(this,l$(this,n=u$(this,e,t)),n);break;default:Hy(this,this._t0,n=u$(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function c$(e){this._context=new f$(e)}(c$.prototype=Object.create(gh.prototype)).point=function(e,t){gh.prototype.point.call(this,t,e)};function f$(e){this._context=e}f$.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,o){this._context.bezierCurveTo(t,e,i,n,o,r)}};function ij(e){return new gh(e)}function rj(e){return new c$(e)}function d$(e){this._context=e}d$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=h$(e),r=h$(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function h$(e){var t,n=e.length-1,i,r=new Array(n),o=new Array(n),s=new Array(n);for(r[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/o[t-1],o[t]-=i,s[t]-=i*s[t-1];for(r[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)r[t]=(s[t]-r[t+1])/o[t];for(o[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-r[t+1];return[r,o]}function oj(e){return new d$(e)}function mh(e,t){this._context=e,this._t=t}mh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function sj(e){return new mh(e,.5)}function aj(e){return new mh(e,0)}function uj(e){return new mh(e,1)}function su(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const lj=()=>typeof Image!="undefined"?Image:null;function Yi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function $o(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Gy=Symbol("implicit");function Yy(){var e=new Map,t=[],n=[],i=Gy;function r(o){var s=o+"",a=e.get(s);if(!a){if(i!==Gy)return i;e.set(s,a=t.push(o))}return n[(a-1)%n.length]}return r.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Map;for(const s of o){const a=s+"";e.has(a)||e.set(a,t.push(s))}return r},r.range=function(o){return arguments.length?(n=Array.from(o),r):n.slice()},r.unknown=function(o){return arguments.length?(i=o,r):i},r.copy=function(){return Yy(t,n).unknown(i)},Yi.apply(r,arguments),r}function au(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function sc(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Mo(){}var Ps=.7,uu=1/Ps,lu="\\s*([+-]?\\d+)\\s*",ac="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cj=/^#([0-9a-f]{3,8})$/,fj=new RegExp("^rgb\\("+[lu,lu,lu]+"\\)$"),dj=new RegExp("^rgb\\("+[Vi,Vi,Vi]+"\\)$"),hj=new RegExp("^rgba\\("+[lu,lu,lu,ac]+"\\)$"),pj=new RegExp("^rgba\\("+[Vi,Vi,Vi,ac]+"\\)$"),gj=new RegExp("^hsl\\("+[ac,Vi,Vi]+"\\)$"),mj=new RegExp("^hsla\\("+[ac,Vi,Vi,ac]+"\\)$"),p$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};au(Mo,uc,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:g$,formatHex:g$,formatHsl:yj,formatRgb:m$,toString:m$});function g$(){return this.rgb().formatHex()}function yj(){return w$(this).formatHsl()}function m$(){return this.rgb().formatRgb()}function uc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=cj.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?y$(t):n===3?new Ft(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?yh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?yh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=fj.exec(e))?new Ft(t[1],t[2],t[3],1):(t=dj.exec(e))?new Ft(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=hj.exec(e))?yh(t[1],t[2],t[3],t[4]):(t=pj.exec(e))?yh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=gj.exec(e))?x$(t[1],t[2]/100,t[3]/100,1):(t=mj.exec(e))?x$(t[1],t[2]/100,t[3]/100,t[4]):p$.hasOwnProperty(e)?y$(p$[e]):e==="transparent"?new Ft(NaN,NaN,NaN,0):null}function y$(e){return new Ft(e>>16&255,e>>8&255,e&255,1)}function yh(e,t,n,i){return i<=0&&(e=t=n=NaN),new Ft(e,t,n,i)}function Vy(e){return e instanceof Mo||(e=uc(e)),e?(e=e.rgb(),new Ft(e.r,e.g,e.b,e.opacity)):new Ft}function Fo(e,t,n,i){return arguments.length===1?Vy(e):new Ft(e,t,n,i==null?1:i)}function Ft(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}au(Ft,Fo,sc(Mo,{brighter:function(e){return e=e==null?uu:Math.pow(uu,e),new Ft(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Ps:Math.pow(Ps,e),new Ft(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:v$,formatHex:v$,formatRgb:b$,toString:b$}));function v$(){return"#"+Xy(this.r)+Xy(this.g)+Xy(this.b)}function b$(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Xy(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function x$(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Xi(e,t,n,i)}function w$(e){if(e instanceof Xi)return new Xi(e.h,e.s,e.l,e.opacity);if(e instanceof Mo||(e=uc(e)),!e)return new Xi;if(e instanceof Xi)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,a=o-r,u=(o+r)/2;return a?(t===o?s=(n-i)/a+(n<i)*6:n===o?s=(i-t)/a+2:s=(t-n)/a+4,a/=u<.5?o+r:2-o-r,s*=60):a=u>0&&u<1?0:s,new Xi(s,a,u,e.opacity)}function vh(e,t,n,i){return arguments.length===1?w$(e):new Xi(e,t,n,i==null?1:i)}function Xi(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}au(Xi,vh,sc(Mo,{brighter:function(e){return e=e==null?uu:Math.pow(uu,e),new Xi(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ps:Math.pow(Ps,e),new Xi(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Ft(Ky(e>=240?e-240:e+120,r,i),Ky(e,r,i),Ky(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Ky(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const _$=Math.PI/180,E$=180/Math.PI,bh=18,S$=.96422,A$=1,k$=.82521,C$=4/29,cu=6/29,$$=3*cu*cu,vj=cu*cu*cu;function M$(e){if(e instanceof Ki)return new Ki(e.l,e.a,e.b,e.opacity);if(e instanceof Rr)return F$(e);e instanceof Ft||(e=Vy(e));var t=ev(e.r),n=ev(e.g),i=ev(e.b),r=Jy((.2225045*t+.7168786*n+.0606169*i)/A$),o,s;return t===n&&n===i?o=s=r:(o=Jy((.4360747*t+.3850649*n+.1430804*i)/S$),s=Jy((.0139322*t+.0971045*n+.7141733*i)/k$)),new Ki(116*r-16,500*(o-r),200*(r-s),e.opacity)}function xh(e,t,n,i){return arguments.length===1?M$(e):new Ki(e,t,n,i==null?1:i)}function Ki(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}au(Ki,xh,sc(Mo,{brighter:function(e){return new Ki(this.l+bh*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Ki(this.l-bh*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=S$*Zy(t),e=A$*Zy(e),n=k$*Zy(n),new Ft(Qy(3.1338561*t-1.6168667*e-.4906146*n),Qy(-.9787684*t+1.9161415*e+.033454*n),Qy(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Jy(e){return e>vj?Math.pow(e,1/3):e/$$+C$}function Zy(e){return e>cu?e*e*e:$$*(e-C$)}function Qy(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ev(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function bj(e){if(e instanceof Rr)return new Rr(e.h,e.c,e.l,e.opacity);if(e instanceof Ki||(e=M$(e)),e.a===0&&e.b===0)return new Rr(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*E$;return new Rr(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function wh(e,t,n,i){return arguments.length===1?bj(e):new Rr(e,t,n,i==null?1:i)}function Rr(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function F$(e){if(isNaN(e.h))return new Ki(e.l,0,0,e.opacity);var t=e.h*_$;return new Ki(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}au(Rr,wh,sc(Mo,{brighter:function(e){return new Rr(this.h,this.c,this.l+bh*(e==null?1:e),this.opacity)},darker:function(e){return new Rr(this.h,this.c,this.l-bh*(e==null?1:e),this.opacity)},rgb:function(){return F$(this).rgb()}}));var D$=-.14861,tv=1.78277,nv=-.29227,_h=-.90649,lc=1.97294,T$=lc*_h,O$=lc*tv,N$=tv*nv-_h*D$;function xj(e){if(e instanceof zs)return new zs(e.h,e.s,e.l,e.opacity);e instanceof Ft||(e=Vy(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(N$*i+T$*t-O$*n)/(N$+T$-O$),o=i-r,s=(lc*(n-r)-nv*o)/_h,a=Math.sqrt(s*s+o*o)/(lc*r*(1-r)),u=a?Math.atan2(s,o)*E$-120:NaN;return new zs(u<0?u+360:u,a,r,e.opacity)}function iv(e,t,n,i){return arguments.length===1?xj(e):new zs(e,t,n,i==null?1:i)}function zs(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}au(zs,iv,sc(Mo,{brighter:function(e){return e=e==null?uu:Math.pow(uu,e),new zs(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ps:Math.pow(Ps,e),new zs(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*_$,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new Ft(255*(t+n*(D$*i+tv*r)),255*(t+n*(nv*i+_h*r)),255*(t+n*(lc*i)),this.opacity)}}));function R$(e,t,n,i,r){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*i+s*r)/6}function L$(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],o=e[i+1],s=i>0?e[i-1]:2*r-o,a=i<t-1?e[i+2]:2*o-r;return R$((n-i/t)*t,s,r,o,a)}}function I$(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],o=e[i%t],s=e[(i+1)%t],a=e[(i+2)%t];return R$((n-i/t)*t,r,o,s,a)}}var Eh=e=>()=>e;function P$(e,t){return function(n){return e+n*t}}function wj(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function Sh(e,t){var n=t-e;return n?P$(e,n>180||n<-180?n-360*Math.round(n/360):n):Eh(isNaN(e)?t:e)}function _j(e){return(e=+e)==1?wt:function(t,n){return n-t?wj(t,n,e):Eh(isNaN(t)?n:t)}}function wt(e,t){var n=t-e;return n?P$(e,n):Eh(isNaN(e)?t:e)}var rv=function e(t){var n=_j(t);function i(r,o){var s=n((r=Fo(r)).r,(o=Fo(o)).r),a=n(r.g,o.g),u=n(r.b,o.b),l=wt(r.opacity,o.opacity);return function(c){return r.r=s(c),r.g=a(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function z$(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=Fo(t[s]),i[s]=a.r||0,r[s]=a.g||0,o[s]=a.b||0;return i=e(i),r=e(r),o=e(o),a.opacity=1,function(u){return a.r=i(u),a.g=r(u),a.b=o(u),a+""}}}var Ej=z$(L$),Sj=z$(I$);function ov(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=e[r]*(1-o)+t[r]*o;return i}}function B$(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Aj(e,t){return(B$(t)?ov:U$)(e,t)}function U$(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),o=new Array(n),s;for(s=0;s<i;++s)r[s]=Do(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<i;++s)o[s]=r[s](a);return o}}function j$(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function xi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function q$(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Do(e[r],t[r]):i[r]=t[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var sv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,av=new RegExp(sv.source,"g");function kj(e){return function(){return e}}function Cj(e){return function(t){return e(t)+""}}function W$(e,t){var n=sv.lastIndex=av.lastIndex=0,i,r,o,s=-1,a=[],u=[];for(e=e+"",t=t+"";(i=sv.exec(e))&&(r=av.exec(t));)(o=r.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(i=i[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:xi(i,r)})),n=av.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?Cj(u[0].x):kj(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function Do(e,t){var n=typeof t,i;return t==null||n==="boolean"?Eh(t):(n==="number"?xi:n==="string"?(i=uc(t))?(t=i,rv):W$:t instanceof uc?rv:t instanceof Date?j$:B$(t)?ov:Array.isArray(t)?U$:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?q$:xi)(e,t)}function $j(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Mj(e,t){var n=Sh(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function cc(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var H$=180/Math.PI,uv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function G$(e,t,n,i,r,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),e*i<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*H$,skewX:Math.atan(u)*H$,scaleX:s,scaleY:a}}var Ah;function Fj(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?uv:G$(t.a,t.b,t.c,t.d,t.e,t.f)}function Dj(e){return e==null||(Ah||(Ah=document.createElementNS("http://www.w3.org/2000/svg","g")),Ah.setAttribute("transform",e),!(e=Ah.transform.baseVal.consolidate()))?uv:(e=e.matrix,G$(e.a,e.b,e.c,e.d,e.e,e.f))}function Y$(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:xi(l,f)},{i:g-2,x:xi(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function s(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:xi(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function a(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:xi(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(r(h)+"scale(",null,",",null,")");p.push({i:g-4,x:xi(l,f)},{i:g-2,x:xi(c,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),s(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var Tj=Y$(Fj,"px, ","px)","deg)"),Oj=Y$(Dj,", ",")",")"),Nj=1e-12;function V$(e){return((e=Math.exp(e))+1/e)/2}function Rj(e){return((e=Math.exp(e))-1/e)/2}function Lj(e){return((e=Math.exp(2*e))-1)/(e+1)}var Ij=function e(t,n,i){function r(o,s){var a=o[0],u=o[1],l=o[2],c=s[0],f=s[1],d=s[2],h=c-a,p=f-u,g=h*h+p*p,m,y;if(g<Nj)y=Math.log(d/l)/t,m=function(_){return[a+_*h,u+_*p,l*Math.exp(t*_*y)]};else{var v=Math.sqrt(g),b=(d*d-l*l+i*g)/(2*l*n*v),w=(d*d-l*l-i*g)/(2*d*n*v),E=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(w*w+1)-w);y=(S-E)/t,m=function(_){var A=_*y,C=V$(E),k=l/(n*v)*(C*Lj(t*A+E)-Rj(E));return[a+k*h,u+k*p,l*C/V$(t*A+E)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return r.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return e(s,a,u)},r}(Math.SQRT2,2,4);function X$(e){return function(t,n){var i=e((t=vh(t)).h,(n=vh(n)).h),r=wt(t.s,n.s),o=wt(t.l,n.l),s=wt(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=o(a),t.opacity=s(a),t+""}}}var Pj=X$(Sh),zj=X$(wt);function Bj(e,t){var n=wt((e=xh(e)).l,(t=xh(t)).l),i=wt(e.a,t.a),r=wt(e.b,t.b),o=wt(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=i(s),e.b=r(s),e.opacity=o(s),e+""}}function K$(e){return function(t,n){var i=e((t=wh(t)).h,(n=wh(n)).h),r=wt(t.c,n.c),o=wt(t.l,n.l),s=wt(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=o(a),t.opacity=s(a),t+""}}}var Uj=K$(Sh),jj=K$(wt);function J$(e){return function t(n){n=+n;function i(r,o){var s=e((r=iv(r)).h,(o=iv(o)).h),a=wt(r.s,o.s),u=wt(r.l,o.l),l=wt(r.opacity,o.opacity);return function(c){return r.h=s(c),r.s=a(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i}(1)}var qj=J$(Sh),Wj=J$(wt);function lv(e,t){t===void 0&&(t=e,e=Do);for(var n=0,i=t.length-1,r=t[0],o=new Array(i<0?0:i);n<i;)o[n]=e(r,r=t[++n]);return function(s){var a=Math.max(0,Math.min(i-1,Math.floor(s*=i)));return o[a](s-a)}}function Hj(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}var Gj=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:Do,interpolateArray:Aj,interpolateBasis:L$,interpolateBasisClosed:I$,interpolateDate:j$,interpolateDiscrete:$j,interpolateHue:Mj,interpolateNumber:xi,interpolateNumberArray:ov,interpolateObject:q$,interpolateRound:cc,interpolateString:W$,interpolateTransformCss:Tj,interpolateTransformSvg:Oj,interpolateZoom:Ij,interpolateRgb:rv,interpolateRgbBasis:Ej,interpolateRgbBasisClosed:Sj,interpolateHsl:Pj,interpolateHslLong:zj,interpolateLab:Bj,interpolateHcl:Uj,interpolateHclLong:jj,interpolateCubehelix:qj,interpolateCubehelixLong:Wj,piecewise:lv,quantize:Hj});function Yj(e){return function(){return e}}function cv(e){return+e}var Z$=[0,1];function En(e){return e}function fv(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Yj(isNaN(t)?NaN:.5)}function Vj(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function Xj(e,t,n){var i=e[0],r=e[1],o=t[0],s=t[1];return r<i?(i=fv(r,i),o=n(s,o)):(i=fv(i,r),o=n(o,s)),function(a){return o(i(a))}}function Kj(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=fv(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var u=vo(e,a,1,i)-1;return o[u](r[u](a))}}function fc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function kh(){var e=Z$,t=Z$,n=Do,i,r,o,s=En,a,u,l;function c(){var d=Math.min(e.length,t.length);return s!==En&&(s=Vj(e[0],e[d-1])),a=d>2?Kj:Xj,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=a(e.map(i),t,n)))(i(s(d)))}return f.invert=function(d){return s(r((l||(l=a(t,e.map(i),xi)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,cv),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=cc,c()},f.clamp=function(d){return arguments.length?(s=d?!0:En,c()):s!==En},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return i=d,r=h,c()}}function Q$(){return kh()(En,En)}function eM(e,t,n,i){var r=bo(e,t,n),o;switch(i=Xa(i==null?",f":i),i.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(o=WA(r,s))&&(i.precision=o),p1(i,s)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=HA(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=qA(r))&&(i.precision=o-(i.type==="%")*2);break}}return jd(i)}function Bs(e){var t=e.domain;return e.ticks=function(n){var i=t();return c1(i[0],i[i.length-1],n==null?10:n)},e.tickFormat=function(n,i){var r=t();return eM(r[0],r[r.length-1],n==null?10:n,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,o=i.length-1,s=i[r],a=i[o],u,l,c=10;for(a<s&&(l=s,s=a,a=l,l=r,r=o,o=l);c-- >0;){if(l=FA(s,a,n),l===u)return i[r]=s,i[o]=a,t(i);if(l>0)s=Math.floor(s/l)*l,a=Math.ceil(a/l)*l;else if(l<0)s=Math.ceil(s*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function tM(){var e=Q$();return e.copy=function(){return fc(e,tM())},Yi.apply(e,arguments),Bs(e)}function nM(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,cv),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return nM(e).unknown(t)},e=arguments.length?Array.from(e,cv):[0,1],Bs(n)}function iM(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],o=e[i],s;return o<r&&(s=n,n=i,i=s,s=r,r=o,o=s),e[n]=t.floor(r),e[i]=t.ceil(o),e}function rM(e){return Math.log(e)}function oM(e){return Math.exp(e)}function Jj(e){return-Math.log(-e)}function Zj(e){return-Math.exp(-e)}function Qj(e){return isFinite(e)?+("1e"+e):e<0?0:e}function eq(e){return e===10?Qj:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function tq(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function sM(e){return function(t){return-e(-t)}}function dv(e){var t=e(rM,oM),n=t.domain,i=10,r,o;function s(){return r=tq(i),o=eq(i),n()[0]<0?(r=sM(r),o=sM(o),e(Jj,Zj)):e(rM,oM),t}return t.base=function(a){return arguments.length?(i=+a,s()):i},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=function(a){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=r(l),h=r(c),p,g,m,y=a==null?10:+a,v=[];if(!(i%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(g=1,p=o(d);g<i;++g)if(m=p*g,!(m<l)){if(m>c)break;v.push(m)}}else for(;d<=h;++d)for(g=i-1,p=o(d);g>=1;--g)if(m=p*g,!(m<l)){if(m>c)break;v.push(m)}v.length*2<y&&(v=c1(l,c,y))}else v=c1(d,h,Math.min(h-d,y)).map(o);return f?v.reverse():v},t.tickFormat=function(a,u){if(u==null&&(u=i===10?".0e":","),typeof u!="function"&&(u=jd(u)),a===Infinity)return u;a==null&&(a=10);var l=Math.max(1,i*a/t.ticks().length);return function(c){var f=c/o(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=function(){return n(iM(n(),{floor:function(a){return o(Math.floor(r(a)))},ceil:function(a){return o(Math.ceil(r(a)))}}))},t}function aM(){var e=dv(kh()).domain([1,10]);return e.copy=function(){return fc(e,aM()).base(e.base())},Yi.apply(e,arguments),e}function uM(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function lM(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function hv(e){var t=1,n=e(uM(t),lM(t));return n.constant=function(i){return arguments.length?e(uM(t=+i),lM(t)):t},Bs(n)}function cM(){var e=hv(kh());return e.copy=function(){return fc(e,cM()).constant(e.constant())},Yi.apply(e,arguments)}function fM(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function nq(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function iq(e){return e<0?-e*e:e*e}function pv(e){var t=e(En,En),n=1;function i(){return n===1?e(En,En):n===.5?e(nq,iq):e(fM(n),fM(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},Bs(t)}function gv(){var e=pv(kh());return e.copy=function(){return fc(e,gv()).exponent(e.exponent())},Yi.apply(e,arguments),e}function rq(){return gv.apply(null,arguments).exponent(.5)}function dM(){var e=[],t=[],n=[],i;function r(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=TA(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?i:t[vo(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ya),r()},o.range=function(s){return arguments.length?(t=Array.from(s),r()):t.slice()},o.unknown=function(s){return arguments.length?(i=s,o):i},o.quantiles=function(){return n.slice()},o.copy=function(){return dM().domain(e).range(t).unknown(i)},Yi.apply(o,arguments)}function hM(){var e=0,t=1,n=1,i=[.5],r=[0,1],o;function s(u){return u!=null&&u<=u?r[vo(i,u,0,n)]:o}function a(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return s}return s.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},s.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,a()):r.slice()},s.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},s.unknown=function(u){return arguments.length&&(o=u),s},s.thresholds=function(){return i.slice()},s.copy=function(){return hM().domain([e,t]).range(r).unknown(o)},Yi.apply(Bs(s),arguments)}function pM(){var e=[.5],t=[0,1],n,i=1;function r(o){return o!=null&&o<=o?t[vo(e,o,0,i)]:n}return r.domain=function(o){return arguments.length?(e=Array.from(o),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(o){return arguments.length?(t=Array.from(o),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},r.unknown=function(o){return arguments.length?(n=o,r):n},r.copy=function(){return pM().domain(e).range(t).unknown(n)},Yi.apply(r,arguments)}function oq(e){return new Date(e)}function sq(e){return e instanceof Date?+e:+new Date(+e)}function mv(e,t,n,i,r,o,s,a,u,l){var c=Q$(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),b=l("%B"),w=l("%Y");function E(S){return(u(S)<S?h:a(S)<S?p:s(S)<S?g:o(S)<S?m:i(S)<S?r(S)<S?y:v:n(S)<S?b:w)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,sq)):d().map(oq)},c.ticks=function(S){var _=d();return e(_[0],_[_.length-1],S==null?10:S)},c.tickFormat=function(S,_){return _==null?E:l(_)},c.nice=function(S){var _=d();return(!S||typeof S.range!="function")&&(S=t(_[0],_[_.length-1],S==null?10:S)),S?d(iM(_,S)):c},c.copy=function(){return fc(c,mv(e,t,n,i,r,o,s,a,u,l))},c}function aq(){return Yi.apply(mv(Rz,Lz,Tr,qd,Ll,wo,x1,b1,xo,L1).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function uq(){return Yi.apply(mv(Oz,Nz,Or,Wd,Pl,_o,E1,_1,xo,I1).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ch(){var e=0,t=1,n,i,r,o,s=En,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:s(r===0?.5:(f=(o(f)-n)*r,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),i=o(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(s=f,l):s};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,s=f(h,p),l):[s(0),s(1)]}}return l.range=c(Do),l.rangeRound=c(cc),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function To(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function yv(){var e=Bs(Ch()(En));return e.copy=function(){return To(e,yv())},$o.apply(e,arguments)}function gM(){var e=dv(Ch()).domain([1,10]);return e.copy=function(){return To(e,gM()).base(e.base())},$o.apply(e,arguments)}function mM(){var e=hv(Ch());return e.copy=function(){return To(e,mM()).constant(e.constant())},$o.apply(e,arguments)}function vv(){var e=pv(Ch());return e.copy=function(){return To(e,vv()).exponent(e.exponent())},$o.apply(e,arguments)}function lq(){return vv.apply(null,arguments).exponent(.5)}function $h(){var e=0,t=.5,n=1,i=1,r,o,s,a,u,l=En,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-o)*(i*g<i*o?a:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,r=c(e=+e),o=c(t=+t),s=c(n=+n),a=r===o?0:.5/(o-r),u=o===s?0:.5/(s-o),i=o<r?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(m){var y,v,b;return arguments.length?([y,v,b]=m,l=lv(g,[y,v,b]),h):[l(0),l(.5),l(1)]}}return h.range=p(Do),h.rangeRound=p(cc),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,r=g(e),o=g(t),s=g(n),a=r===o?0:.5/(o-r),u=o===s?0:.5/(s-o),i=o<r?-1:1,h}}function yM(){var e=Bs($h()(En));return e.copy=function(){return To(e,yM())},$o.apply(e,arguments)}function vM(){var e=dv($h()).domain([.1,1,10]);return e.copy=function(){return To(e,vM()).base(e.base())},$o.apply(e,arguments)}function bM(){var e=hv($h());return e.copy=function(){return To(e,bM()).constant(e.constant())},$o.apply(e,arguments)}function bv(){var e=pv($h());return e.copy=function(){return To(e,bv()).exponent(e.exponent())},$o.apply(e,arguments)}function cq(){return bv.apply(null,arguments).exponent(.5)}function xv(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const fq="identity",fu="linear",Lr="log",dc="pow",hc="sqrt",Mh="symlog",Us="time",js="utc",Ji="sequential",du="diverging",hu="quantile",Fh="quantize",Dh="threshold",wv="ordinal",_v="point",xM="band",Ev="bin-ordinal",lt="continuous",pc="discrete",gc="discretizing",Zn="interpolating",Sv="temporal";function dq(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function hq(e){return function(t){const n=e.range();let i=t[0],r=t[1],o=-1,s,a,u,l;for(r<i&&(a=i,i=r,r=a),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(o<0&&(o=u),s=u);if(!(o<0))return i=e.invertExtent(n[o]),r=e.invertExtent(n[s]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function Av(){const e=Yy().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,o,s=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=i[1]<i[0],h=i[1-d],p=xv(f,a,u);let g=i[d-0];r=(h-g)/(p||1),s&&(r=Math.floor(r)),g+=(h-g-r*(f-a))*l,o=r*(1-a),s&&(g=Math.round(g),o=Math.round(o));const m=Ln(f).map(y=>g+r*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return r},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=i[1]<i[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],y,v,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<h[0]||g>i[1-d])))return y=Math.max(0,vo(h,g)-1),v=g===m?y:vo(h,m)-1,g-h[y]>o+1e-10&&++y,d&&(b=y,y=p-v,v=p-b),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return Av().domain(t()).range(i).round(s).paddingInner(a).paddingOuter(u).align(l)},c()}function wM(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return wM(t())},e}function pq(){return wM(Av().paddingInner(1))}var gq=Array.prototype.map;function mq(e){return gq.call(e,Pt)}const yq=Array.prototype.slice;function _M(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(vo(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=mq(i),n):e.slice()},n.range=function(i){return arguments.length?(t=yq.call(i),n):t.slice()},n.tickFormat=function(i,r){return eM(e[0],be(e),i==null?10:i,r)},n.copy=function(){return _M().domain(n.domain()).range(n.range())},n}const Th={};function vq(e,t,n){const i=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?dq(o):o.invertExtent?hq(o):void 0),o.type=e,o};return i.metadata=vt(K(n)),i}function Ae(e,t,n){return arguments.length>1?(Th[e]=vq(e,t,n),this):EM(e)?Th[e]:void 0}Ae(fq,nM),Ae(fu,tM,lt),Ae(Lr,aM,[lt,Lr]),Ae(dc,gv,lt),Ae(hc,rq,lt),Ae(Mh,cM,lt),Ae(Us,aq,[lt,Sv]),Ae(js,uq,[lt,Sv]),Ae(Ji,yv,[lt,Zn]),Ae("".concat(Ji,"-").concat(fu),yv,[lt,Zn]),Ae("".concat(Ji,"-").concat(Lr),gM,[lt,Zn,Lr]),Ae("".concat(Ji,"-").concat(dc),vv,[lt,Zn]),Ae("".concat(Ji,"-").concat(hc),lq,[lt,Zn]),Ae("".concat(Ji,"-").concat(Mh),mM,[lt,Zn]),Ae("".concat(du,"-").concat(fu),yM,[lt,Zn]),Ae("".concat(du,"-").concat(Lr),vM,[lt,Zn,Lr]),Ae("".concat(du,"-").concat(dc),bv,[lt,Zn]),Ae("".concat(du,"-").concat(hc),cq,[lt,Zn]),Ae("".concat(du,"-").concat(Mh),bM,[lt,Zn]),Ae(hu,dM,[gc,hu]),Ae(Fh,hM,gc),Ae(Dh,pM,gc),Ae(Ev,_M,[pc,gc]),Ae(wv,Yy,pc),Ae(xM,Av,pc),Ae(_v,pq,pc);function EM(e){return te(Th,e)}function qs(e,t){const n=Th[e];return n&&n.metadata[t]}function kv(e){return qs(e,lt)}function pu(e){return qs(e,pc)}function Cv(e){return qs(e,gc)}function SM(e){return qs(e,Lr)}function bq(e){return qs(e,Sv)}function AM(e){return qs(e,Zn)}function kM(e){return qs(e,hu)}const xq=["clamp","base","constant","exponent"];function CM(e,t){const n=t[0],i=be(t)-n;return function(r){return e(n+r*i)}}function Oh(e,t,n){return lv($v(t||"rgb",n),e)}function $M(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function MM(e,t,n){const i=n-t;let r,o,s;return!i||!Number.isFinite(i)?zt(.5):(r=(o=e.type).indexOf("-"),o=r<0?o:o.slice(r+1),s=Ae(o)().domain([t,n]).range([0,1]),xq.forEach(a=>e[a]?s[a](e[a]()):0),s)}function $v(e,t){const n=Gj[wq(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function wq(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const _q={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Eq={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function FM(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function DM(e,t){for(const n in e)Mv(n,t(e[n]))}const TM={};DM(Eq,FM),DM(_q,e=>Oh(FM(e)));function Mv(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(TM[e]=t,this):TM[e]}const Nh="symbol",Sq="discrete",Aq="gradient",kq=e=>R(e)?e.map(t=>String(t)):String(e),Cq=(e,t)=>e[1]-t[1],$q=(e,t)=>t[1]-e[1];function Fv(e,t,n){let i;return Oe(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(Dl(e.domain())/n||1)))),J(t)&&(i=t.step,t=t.interval),V(t)&&(t=e.type===Us?Ja(t):e.type==js?Za(t):N("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function OM(e,t,n){let i=e.range(),r=i[0],o=be(i),s=Cq;if(r>o&&(i=o,o=r,r=i,s=$q),r=Math.floor(r),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],be(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function Dv(e,t){return e.bins?OM(e,e.bins):e.ticks?e.ticks(t):e.domain()}function NM(e,t,n,i,r,o){const s=t.type;let a=kq;if(s===Us||r===Us)a=e.timeFormat(i);else if(s===js||r===js)a=e.utcFormat(i);else if(SM(s)){const u=e.formatFloat(i);if(o||t.bins)a=u;else{const l=RM(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(a=e.format(i));return a}function RM(e,t,n){const i=Dv(e,t),r=e.base(),o=Math.log(r),s=Math.max(1,r*t/i.length),a=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/o));return l*r<r-.5&&(l*=r),l<=s};return n?i.filter(a):a}const Tv={[hu]:"quantiles",[Fh]:"thresholds",[Dh]:"domain"},LM={[hu]:"quantiles",[Fh]:"domain"};function IM(e,t){return e.bins?Dq(e.bins):e.type===Lr?RM(e,t,!0):Tv[e.type]?Fq(e[Tv[e.type]]()):Dv(e,t)}function Mq(e,t,n){const i=t[LM[t.type]](),r=i.length;let o=r>1?i[1]-i[0]:i[0],s;for(s=1;s<r;++s)o=Math.min(o,i[s]-i[s-1]);return e.formatSpan(0,o,3*10,n)}function Fq(e){const t=[-Infinity].concat(e);return t.max=Infinity,t}function Dq(e){const t=e.slice(0,-1);return t.max=be(e),t}const Tq=e=>Tv[e.type]||e.bins;function PM(e,t,n,i,r,o,s){const a=LM[t.type]&&o!==Us&&o!==js?Mq(e,t,r):NM(e,t,n,r,o,s);return i===Nh&&Tq(t)?Oq(a):i===Sq?Nq(a):Rq(a)}const Oq=e=>(t,n,i)=>{const r=zM(i[n+1],zM(i.max,Infinity)),o=BM(t,e),s=BM(r,e);return o&&s?o+" \u2013 "+s:s?"< "+s:"\u2265 "+o},zM=(e,t)=>e!=null?e:t,Nq=e=>(t,n)=>n?e(t):null,Rq=e=>t=>e(t),BM=(e,t)=>Number.isFinite(e)?t(e):null;function Lq(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+be(t),o=r-i;if(e.type===Dh){const s=n?o/n:.1;i-=s,r+=s,o=r-i}return s=>(s-i)/o}function Iq(e,t,n,i){const r=i||t.type;return V(n)&&bq(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===Us?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===js?e.utcFormat("%A, %d %B %Y, %X UTC"):PM(e,t,5,null,n,i,!0)}function UM(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=Iq(e,t,n.format,n.formatType);if(Cv(t.type)){const o=IM(t).slice(1).map(r),s=o.length;return"".concat(s," boundar").concat(s===1?"y":"ies",": ").concat(o.join(", "))}else if(pu(t.type)){const o=t.domain(),s=o.length,a=s>i?o.slice(0,i-2).map(r).join(", ")+", ending with "+o.slice(-1).map(r):o.map(r).join(", ");return"".concat(s," value").concat(s===1?"":"s",": ").concat(a)}else{const o=t.domain();return"values from ".concat(r(o[0])," to ").concat(r(be(o)))}}let jM=0;function Pq(){jM=0}const Rh="p_";function Ov(e){return e&&e.gradient}function qM(e,t,n){const i=e.gradient;let r=e.id,o=i==="radial"?Rh:"";return r||(r=e.id="gradient_"+jM++,i==="radial"?(e.x1=Zi(e.x1,.5),e.y1=Zi(e.y1,.5),e.r1=Zi(e.r1,0),e.x2=Zi(e.x2,.5),e.y2=Zi(e.y2,.5),e.r2=Zi(e.r2,.5),o=Rh):(e.x1=Zi(e.x1,0),e.y1=Zi(e.y1,0),e.x2=Zi(e.x2,1),e.y2=Zi(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+o+r+")"}function Zi(e,t){return e!=null?e:t}function WM(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,o){return n.push({offset:r,color:o}),i}}}const HM={basis:{curve:GU},"basis-closed":{curve:YU},"basis-open":{curve:VU},bundle:{curve:XU,tension:"beta",value:.85},cardinal:{curve:KU,tension:"tension",value:0},"cardinal-open":{curve:ZU,tension:"tension",value:0},"cardinal-closed":{curve:JU,tension:"tension",value:0},"catmull-rom":{curve:QU,tension:"alpha",value:.5},"catmull-rom-closed":{curve:ej,tension:"alpha",value:.5},"catmull-rom-open":{curve:tj,tension:"alpha",value:.5},linear:{curve:By},"linear-closed":{curve:nj},monotone:{horizontal:rj,vertical:ij},natural:{curve:oj},step:{curve:sj},"step-after":{curve:uj},"step-before":{curve:aj}};function Nv(e,t,n){var i=te(HM,e)&&HM[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const zq={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},mc=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function gu(e){const t=[];let n,i,r,o,s,a,u,l,c,f;const d=e.slice().replace(mc[0],"###$1").split(mc[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],i=n.slice(1).trim().replace(mc[2],"$1###$2").replace(mc[3],"$1###$2").split(mc[4]),s=n.charAt(0),r=[s],l=0,f=i.length;l<f;++l)(o=+i[l])===o&&r.push(o);if(a=zq[s.toLowerCase()],r.length-1>a){const h=r.length;for(l=1,t.push([s].concat(r.slice(l,l+=a))),s=s==="M"?"L":s==="m"?"l":s;l<h;l+=a)t.push([s].concat(r.slice(l,l+a)))}else t.push(r)}return t}const Oo=Math.PI/180,Bq=1e-14,Ws=Math.PI/2,Qi=Math.PI*2,mu=Math.sqrt(3)/2;var Rv={},Lv={},GM=[].join;function Uq(e,t,n,i,r,o,s,a,u){const l=GM.call(arguments);if(Rv[l])return Rv[l];const c=s*Oo,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5;let g=h*h/(n*n)+p*p/(i*i);g>1&&(g=Math.sqrt(g),n*=g,i*=g);const m=d/n,y=f/n,v=-f/i,b=d/i,w=m*a+y*u,E=v*a+b*u,S=m*e+y*t,_=v*e+b*t,A=(S-w)*(S-w)+(_-E)*(_-E);let C=1/A-.25;C<0&&(C=0);let k=Math.sqrt(C);o==r&&(k=-k);const $=.5*(w+S)-k*(_-E),F=.5*(E+_)+k*(S-w),D=Math.atan2(E-F,w-$);let M=Math.atan2(_-F,S-$)-D;M<0&&o===1?M+=Qi:M>0&&o===0&&(M-=Qi);const I=Math.ceil(Math.abs(M/(Ws+.001))),U=[];for(let Y=0;Y<I;++Y){const Q=D+Y*M/I,ce=D+(Y+1)*M/I;U[Y]=[$,F,Q,ce,n,i,f,d]}return Rv[l]=U}function jq(e){const t=GM.call(e);if(Lv[t])return Lv[t];var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7];const c=l*s,f=-u*a,d=u*s,h=l*a,p=Math.cos(r),g=Math.sin(r),m=Math.cos(o),y=Math.sin(o),v=.5*(o-r),b=Math.sin(v*.5),w=8/3*b*b/Math.sin(v),E=n+p-w*g,S=i+g+w*p,_=n+m,A=i+y,C=_+w*y,k=A-w*m;return Lv[t]=[c*E+f*S,d*E+h*S,c*C+f*k,d*C+h*k,c*_+f*A,d*_+h*A]}const Qn=["l",0,0,0,0,0,0,0];function qq(e,t,n){const i=Qn[0]=e[0];if(i==="a"||i==="A")Qn[1]=t*e[1],Qn[2]=n*e[2],Qn[3]=e[3],Qn[4]=e[4],Qn[5]=e[5],Qn[6]=t*e[6],Qn[7]=n*e[7];else if(i==="h"||i==="H")Qn[1]=t*e[1];else if(i==="v"||i==="V")Qn[1]=n*e[1];else for(var r=1,o=e.length;r<o;++r)Qn[r]=(r%2==1?t:n)*e[r];return Qn}function yc(e,t,n,i,r,o){var s,a=null,u=0,l=0,c=0,f=0,d,h,p,g;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),o==null&&(o=r),e.beginPath&&e.beginPath();for(var m=0,y=t.length;m<y;++m){switch(s=t[m],(r!==1||o!==1)&&(s=qq(s,r,o)),s[0]){case"l":u+=s[1],l+=s[2],e.lineTo(u+n,l+i);break;case"L":u=s[1],l=s[2],e.lineTo(u+n,l+i);break;case"h":u+=s[1],e.lineTo(u+n,l+i);break;case"H":u=s[1],e.lineTo(u+n,l+i);break;case"v":l+=s[1],e.lineTo(u+n,l+i);break;case"V":l=s[1],e.lineTo(u+n,l+i);break;case"m":u+=s[1],l+=s[2],e.moveTo(u+n,l+i);break;case"M":u=s[1],l=s[2],e.moveTo(u+n,l+i);break;case"c":d=u+s[5],h=l+s[6],c=u+s[3],f=l+s[4],e.bezierCurveTo(u+s[1]+n,l+s[2]+i,c+n,f+i,d+n,h+i),u=d,l=h;break;case"C":u=s[5],l=s[6],c=s[3],f=s[4],e.bezierCurveTo(s[1]+n,s[2]+i,c+n,f+i,u+n,l+i);break;case"s":d=u+s[3],h=l+s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+s[1]+n,l+s[2]+i,d+n,h+i),c=u+s[1],f=l+s[2],u=d,l=h;break;case"S":d=s[3],h=s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,s[1]+n,s[2]+i,d+n,h+i),u=d,l=h,c=s[1],f=s[2];break;case"q":d=u+s[3],h=l+s[4],c=u+s[1],f=l+s[2],e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"Q":d=s[3],h=s[4],e.quadraticCurveTo(s[1]+n,s[2]+i,d+n,h+i),u=d,l=h,c=s[1],f=s[2];break;case"t":d=u+s[1],h=l+s[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-p,f=2*l-g):a[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h,c=u+s[1],f=l+s[2];break;case"T":d=s[1],h=s[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"a":YM(e,u+n,l+i,[s[1],s[2],s[3],s[4],s[5],s[6]+u+n,s[7]+l+i]),u+=s[6],l+=s[7];break;case"A":YM(e,u+n,l+i,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+i]),u=s[6],l=s[7];break;case"z":case"Z":e.closePath();break}a=s}}function YM(e,t,n,i){const r=Uq(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let o=0;o<r.length;++o){const s=jq(r[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const VM=.5773502691896257,XM={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Qi)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,o=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-o),e.lineTo(r,-o),e.lineTo(0,-n),e.lineTo(-r,-o),e.lineTo(-i,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=mu*n,r=i-n*VM,o=n/4;e.moveTo(0,-i-r),e.lineTo(-o,i-r),e.lineTo(o,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=mu*n,r=i-n*VM;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=mu*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=mu*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=mu*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=mu*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function KM(e){return te(XM,e)?XM[e]:Wq(e)}var Iv={};function Wq(e){if(!te(Iv,e)){const t=gu(e);Iv[e]={draw:function(n,i){yc(n,t,0,0,Math.sqrt(i)/2)}}}return Iv[e]}const No=.448084975506;function Hq(e){return e.x}function Gq(e){return e.y}function Yq(e){return e.width}function Vq(e){return e.height}function Ir(e){return typeof e=="function"?e:()=>+e}function Lh(e,t,n){return Math.max(t,Math.min(e,n))}function JM(){var e=Hq,t=Gq,n=Yq,i=Vq,r=Ir(0),o=r,s=r,a=r,u=null;function l(c,f,d){var h,p=f!=null?f:+e.call(this,c),g=d!=null?d:+t.call(this,c),m=+n.call(this,c),y=+i.call(this,c),v=Math.min(m,y)/2,b=Lh(+r.call(this,c),0,v),w=Lh(+o.call(this,c),0,v),E=Lh(+s.call(this,c),0,v),S=Lh(+a.call(this,c),0,v);if(u||(u=h=Ls()),b<=0&&w<=0&&E<=0&&S<=0)u.rect(p,g,m,y);else{var _=p+m,A=g+y;u.moveTo(p+b,g),u.lineTo(_-w,g),u.bezierCurveTo(_-No*w,g,_,g+No*w,_,g+w),u.lineTo(_,A-S),u.bezierCurveTo(_,A-No*S,_-No*S,A,_-S,A),u.lineTo(p+E,A),u.bezierCurveTo(p+No*E,A,p,A-No*E,p,A-E),u.lineTo(p,g+b),u.bezierCurveTo(p,g+No*b,p+No*b,g,p+b,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Ir(c),l):e},l.y=function(c){return arguments.length?(t=Ir(c),l):t},l.width=function(c){return arguments.length?(n=Ir(c),l):n},l.height=function(c){return arguments.length?(i=Ir(c),l):i},l.cornerRadius=function(c,f,d,h){return arguments.length?(r=Ir(c),o=f!=null?Ir(f):r,a=d!=null?Ir(d):r,s=h!=null?Ir(h):o,l):r},l.context=function(c){return arguments.length?(u=c==null?null:c,l):u},l}function ZM(){var e,t,n,i,r=null,o,s,a,u;function l(f,d,h){const p=h/2;if(o){var g=a-d,m=f-s;if(g||m){var y=Math.sqrt(g*g+m*m),v=(g/=y)*u,b=(m/=y)*u,w=Math.atan2(m,g);r.moveTo(s-v,a-b),r.lineTo(f-g*p,d-m*p),r.arc(f,d,p,w-Math.PI,w),r.lineTo(s+v,a+b),r.arc(s,a,u,w,w+Math.PI)}else r.arc(f,d,p,0,Qi);r.closePath()}else o=1;s=f,a=d,u=p}function c(f){var d,h=f.length,p,g=!1,m;for(r==null&&(r=m=Ls()),d=0;d<=h;++d)!(d<h&&i(p=f[d],d,f))===g&&(g=!g)&&(o=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return r=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function vc(e,t){return e!=null?e:t}const bc=e=>e.x||0,xc=e=>e.y||0,Xq=e=>e.width||0,Kq=e=>e.height||0,Jq=e=>(e.x||0)+(e.width||0),Zq=e=>(e.y||0)+(e.height||0),Qq=e=>e.startAngle||0,eW=e=>e.endAngle||0,tW=e=>e.padAngle||0,nW=e=>e.innerRadius||0,iW=e=>e.outerRadius||0,rW=e=>e.cornerRadius||0,oW=e=>vc(e.cornerRadiusTopLeft,e.cornerRadius)||0,sW=e=>vc(e.cornerRadiusTopRight,e.cornerRadius)||0,aW=e=>vc(e.cornerRadiusBottomRight,e.cornerRadius)||0,uW=e=>vc(e.cornerRadiusBottomLeft,e.cornerRadius)||0,lW=e=>vc(e.size,64),cW=e=>e.size||1,Ih=e=>e.defined!==!1,fW=e=>KM(e.shape||"circle"),dW=qU().startAngle(Qq).endAngle(eW).padAngle(tW).innerRadius(nW).outerRadius(iW).cornerRadius(rW),hW=QC().x(bc).y1(xc).y0(Zq).defined(Ih),pW=QC().y(xc).x1(bc).x0(Jq).defined(Ih),gW=ZC().x(bc).y(xc).defined(Ih),mW=JM().x(bc).y(xc).width(Xq).height(Kq).cornerRadius(oW,sW,aW,uW),yW=HU().type(fW).size(lW),vW=ZM().x(bc).y(xc).defined(Ih).size(cW);function Pv(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function bW(e,t){return dW.context(e)(t)}function xW(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?pW:hW).curve(Nv(i,n.orient,n.tension)).context(e)(t)}function wW(e,t){const n=t[0],i=n.interpolate||"linear";return gW.curve(Nv(i,n.orient,n.tension)).context(e)(t)}function yu(e,t,n,i){return mW.context(e)(t,n,i)}function _W(e,t){return(t.mark.shape||t.shape).context(e)(t)}function EW(e,t){return yW.context(e)(t)}function SW(e,t){return vW.context(e)(t)}var QM=1;function eF(){QM=1}function zv(e,t,n){var i=t.clip,r=e._defs,o=t.clip_id||(t.clip_id="clip"+QM++),s=r.clipping[o]||(r.clipping[o]={id:o});return fe(i)?s.path=i(null):Pv(n)?s.path=yu(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function ct(e){this.clear(),e&&this.union(e)}ct.prototype={clone(){return new ct(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:o,y2:s}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*i-u*r+l,u*i+a*r+c,a*i-u*s+l,u*i+a*s+c,a*o-u*r+l,u*o+a*r+c,a*o-u*s+l,u*o+a*s+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Ph(e){this.mark=e,this.bounds=this.bounds||new ct}function zh(e){Ph.call(this,e),this.items=this.items||[]}q(zh,Ph);function Bv(e){this._pending=0,this._loader=e||Yd()}function tF(e){e._pending+=1}function wc(e){e._pending-=1}Bv.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return tF(t),t._loader.sanitize(e,{context:"href"}).then(n=>(wc(t),n)).catch(()=>(wc(t),null))},loadImage(e){const t=this,n=lj();return tF(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const o=new n,s=te(i,"crossOrigin")?i.crossOrigin:"anonymous";return s!=null&&(o.crossOrigin=s),o.onload=()=>wc(t),o.onerror=()=>wc(t),o.src=r,o}).catch(i=>(wc(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}n(!1)})}};function Pr(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?AW(t,i):0))}return e}function AW(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const kW=Qi-1e-8;let Bh,Uh,jh,Hs,Uv,qh,jv,qv;const Ro=(e,t)=>Bh.add(e,t),Wh=(e,t)=>Ro(Uh=e,jh=t),nF=e=>Ro(e,Bh.y1),iF=e=>Ro(Bh.x1,e),Gs=(e,t)=>Uv*e+jv*t,Ys=(e,t)=>qh*e+qv*t,Wv=(e,t)=>Ro(Gs(e,t),Ys(e,t)),Hv=(e,t)=>Wh(Gs(e,t),Ys(e,t));function _c(e,t){return Bh=e,t?(Hs=t*Oo,Uv=qv=Math.cos(Hs),qh=Math.sin(Hs),jv=-qh):(Uv=qv=1,Hs=qh=jv=0),CW}const CW={beginPath(){},closePath(){},moveTo:Hv,lineTo:Hv,rect(e,t,n,i){Hs?(Wv(e+n,t),Wv(e+n,t+i),Wv(e,t+i),Hv(e,t)):(Ro(e+n,t+i),Wh(e,t))},quadraticCurveTo(e,t,n,i){const r=Gs(e,t),o=Ys(e,t),s=Gs(n,i),a=Ys(n,i);rF(Uh,r,s,nF),rF(jh,o,a,iF),Wh(s,a)},bezierCurveTo(e,t,n,i,r,o){const s=Gs(e,t),a=Ys(e,t),u=Gs(n,i),l=Ys(n,i),c=Gs(r,o),f=Ys(r,o);oF(Uh,s,u,c,nF),oF(jh,a,l,f,iF),Wh(c,f)},arc(e,t,n,i,r,o){if(i+=Hs,r+=Hs,Uh=n*Math.cos(r)+e,jh=n*Math.sin(r)+t,Math.abs(r-i)>kW)Ro(e-n,t-n),Ro(e+n,t+n);else{const s=l=>Ro(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(s(i),s(r),r!==i)if(i=i%Qi,i<0&&(i+=Qi),r=r%Qi,r<0&&(r+=Qi),r<i&&(o=!o,a=i,i=r,r=a),o)for(r-=Qi,a=i-i%Ws,u=0;u<4&&a>r;++u,a-=Ws)s(a);else for(a=i-i%Ws+Ws,u=0;u<4&&a<r;++u,a=a+Ws)s(a)}}};function rF(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function oF(e,t,n,i,r){const o=i-e+3*t-3*n,s=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(o)>Bq?(c=s*s+a*o,c>=0&&(c=Math.sqrt(c),u=(-s+c)/o,l=(-s-c)/o)):u=.5*a/s,0<u&&u<1&&r(sF(u,e,t,n,i)),0<l&&l<1&&r(sF(l,e,t,n,i))}function sF(e,t,n,i,r){const o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*i+a*e*r}var Lo=(Lo=su(1,1))?Lo.getContext("2d"):null;const Gv=new ct;function Yv(e){return function(t,n){if(!Lo)return!0;e(Lo,t),Gv.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:o,y2:s}=Gv;for(let a=r;a<=s;++a)for(let u=i;u<=o;++u)if(Lo.isPointInPath(u,a))return!0;return!1}}function Vv(e,t){return t.contains(e.x||0,e.y||0)}function aF(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,o=e.height||0;return t.intersects(Gv.set(n,i,n+r,i+o))}function uF(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:i;return vu(t,n,i,r,o)}function vu(e,t,n,i,r){const{x1:o,y1:s,x2:a,y2:u}=e,l=i-t,c=r-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-l,p=-(o-t)),m===1&&(h=l,p=a-t),m===2&&(h=-c,p=-(s-n)),m===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function bu(e,t){e.globalCompositeOperation=t.blend||"source-over"}function wi(e,t){return e==null?t:e}function lF(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function $W(e,t,n){const i=n.width(),r=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+wi(t.x1,.5)*i,n.y1+wi(t.y1,.5)*r,Math.max(i,r)*wi(t.r1,0),n.x1+wi(t.x2,.5)*i,n.y1+wi(t.y2,.5)*r,Math.max(i,r)*wi(t.r2,.5));else{const s=wi(t.x1,0),a=wi(t.y1,0),u=wi(t.x2,1),l=wi(t.y2,0);if(s===u||a===l||i===r)o=e.createLinearGradient(n.x1+s*i,n.y1+a*r,n.x1+u*i,n.y1+l*r);else{const c=su(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=lF(f.createLinearGradient(s,a,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return lF(o,t.stops)}function cF(e,t,n){return Ov(n)?$W(e,n,t.bounds):n}function Hh(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=cF(e,t,t.fill),!0):!1}var MW=[];function xu(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=cF(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||MW),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function FW(e,t){return e.zindex-t.zindex||e.index-t.index}function Xv(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,o;for(r=0,o=t.length;r<o;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(FW)}function _i(e,t){var n=e.items,i,r;if(!n||!n.length)return;const o=Xv(e);if(o&&o.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=o}for(i=0,r=n.length;i<r;++i)t(n[i])}function Gh(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const o=Xv(e);for(o&&o.length&&(n=o),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===o){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function Kv(e){return function(t,n,i){_i(n,r=>{(!i||i.intersects(r.bounds))&&fF(e,t,r,r)})}}function DW(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&fF(e,t,n.items[0],n.items)}}function fF(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(bu(t,n),n.fill&&Hh(t,n,r)&&t.fill(),n.stroke&&xu(t,n,r)&&t.stroke()))}function Yh(e){return e=e||Vn,function(t,n,i,r,o,s){return i*=t.pixelRatio,r*=t.pixelRatio,Gh(n,a=>{const u=a.bounds;if(!(u&&!u.contains(o,s)||!u)&&e(t,a,i,r,o,s))return a})}}function Ec(e,t){return function(n,i,r,o){var s=Array.isArray(i)?i[0]:i,a=t==null?s.fill:t,u=s.stroke&&n.isPointInStroke,l,c;return u&&(l=s.strokeWidth,c=s.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=c!=null?c:"butt"),e(n,i)?!1:a&&n.isPointInPath(r,o)||u&&n.isPointInStroke(r,o)}}function Jv(e){return Yh(Ec(e))}function Vs(e,t){return"translate("+e+","+t+")"}function Zv(e){return"rotate("+e+")"}function TW(e,t){return"scale("+e+","+t+")"}function dF(e){return Vs(e.x||0,e.y||0)}function OW(e){return Vs(e.x||0,e.y||0)+(e.angle?" "+Zv(e.angle):"")}function NW(e){return Vs(e.x||0,e.y||0)+(e.angle?" "+Zv(e.angle):"")+(e.scaleX||e.scaleY?" "+TW(e.scaleX||1,e.scaleY||1):"")}function Qv(e,t,n){function i(s,a){s("transform",OW(a)),s("d",t(null,a))}function r(s,a){return t(_c(s,a.angle),a),Pr(s,a).translate(a.x||0,a.y||0)}function o(s,a){var u=a.x||0,l=a.y||0,c=a.angle||0;s.translate(u,l),c&&s.rotate(c*=Oo),s.beginPath(),t(s,a),c&&s.rotate(-c),s.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:Kv(o),pick:Jv(o),isect:n||Yv(o)}}var RW=Qv("arc",bW);function LW(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,o=Infinity,s,a;--r>=0;)e[r].defined!==!1&&(a=Math.abs(e[r][i]-n),a<o&&(o=a,s=e[r]));return s}function IW(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,o,s;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],o=e[i].y-t[1],s=r*r+o*o,s<n))return e[i];return null}function PW(e,t){for(var n=e.length,i,r,o;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],o=i*i+r*r,i=e[n].size||1,o<i*i))return e[n];return null}function eb(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(_c(u),c),Pr(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}const s=Ec(o);function a(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,s(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:DW(o),pick:a,isect:Vv,tip:n}}var zW=eb("area",xW,LW);function BW(e,t){var n=t.clip;e.save(),fe(n)?(e.beginPath(),n(e),e.clip()):hF(e,t.group)}function hF(e,t){e.beginPath(),Pv(t)?yu(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function pF(e){const t=wi(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function UW(e,t){e("transform",dF(t))}function gF(e,t){const n=pF(t);e("d",yu(null,t,n,n))}function jW(e,t){e("class","background"),e("aria-hidden",!0),gF(e,t)}function qW(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?gF(e,t):e("d","")}function WW(e,t,n){const i=t.clip?zv(n,t,t):null;e("clip-path",i)}function HW(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Pr(e,t),e.translate(t.x||0,t.y||0)}function Sc(e,t,n,i){const r=pF(t);e.beginPath(),yu(e,t,(n||0)+r,(i||0)+r)}const GW=Ec(Sc),YW=Ec(Sc,!1),VW=Ec(Sc,!0);function XW(e,t,n){_i(t,i=>{const r=i.x||0,o=i.y||0,s=i.strokeForeground,a=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&a&&(Sc(e,i,r,o),bu(e,i),i.fill&&Hh(e,i,a)&&e.fill(),i.stroke&&!s&&xu(e,i,a)&&e.stroke()),e.save(),e.translate(r,o),i.clip&&hF(e,i),n&&n.translate(-r,-o),_i(i,u=>{this.draw(e,u,n)}),n&&n.translate(r,o),e.restore(),s&&i.stroke&&a&&(Sc(e,i,r,o),bu(e,i),xu(e,i,a)&&e.stroke())})}function KW(e,t,n,i,r,o){if(t.bounds&&!t.bounds.contains(r,o)||!t.items)return null;const s=n*e.pixelRatio,a=i*e.pixelRatio;return Gh(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(r,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(r<c||r>h||o<f||o>p))return;if(e.save(),e.translate(c,f),c=r-c,f=o-f,g&&Pv(u)&&!VW(e,u,s,a))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&YW(e,u,s,a)?(e.restore(),u):(l=Gh(u,v=>JW(v,c,f)?this.pick(v,n,i,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&GW(e,u,s,a)&&(l=u),e.restore(),l||null)})}function JW(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var ZW={type:"group",tag:"g",nested:!1,attr:UW,bound:HW,draw:XW,pick:KW,isect:aF,content:WW,background:jW,foreground:qW},Ac={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function tb(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function nb(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function ib(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function Vh(e,t){return e==="center"?t/2:e==="right"?t:0}function Xh(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function QW(e,t,n){const i=tb(t,n),r=nb(t,i),o=ib(t,i),s=(t.x||0)-Vh(t.align,r),a=(t.y||0)-Xh(t.baseline,o),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,Ac["xmlns:xlink"],"xlink:href"),e("transform",Vs(s,a)),e("width",r),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function eH(e,t){const n=t.image,i=nb(t,n),r=ib(t,n),o=(t.x||0)-Vh(t.align,i),s=(t.y||0)-Xh(t.baseline,r);return e.set(o,s,o+i,s+r)}function tH(e,t,n){_i(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=tb(i,this);let o=nb(i,r),s=ib(i,r);if(o===0||s===0)return;let a=(i.x||0)-Vh(i.align,o),u=(i.y||0)-Xh(i.baseline,s),l,c,f,d;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(s-d)/2,s=d):(d=s*c,a+=(o-d)/2,o=d))),(r.complete||r.toDataURL)&&(bu(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,a,u,o,s))})}var nH={type:"image",tag:"image",nested:!1,attr:QW,bound:eH,draw:tH,pick:Yh(),isect:Vn,get:tb,xOffset:Vh,yOffset:Xh},iH=eb("line",wW,IW);function rH(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",NW(t)),e("d",t.path)}function Kh(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*Oo,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=gu(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),yc(e,u,0,0,o,s),e.rotate(-a),e.translate(-i,-r)):yc(e,u,i,r,o,s)}function oH(e,t){return Kh(_c(e,t.angle),t)?e.set(0,0,0,0):Pr(e,t,!0)}var sH={type:"path",tag:"path",nested:!1,attr:rH,bound:oH,draw:Kv(Kh),pick:Jv(Kh),isect:Yv(Kh)};function aH(e,t){e("d",yu(null,t))}function uH(e,t){var n,i;return Pr(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function mF(e,t){e.beginPath(),yu(e,t)}var lH={type:"rect",tag:"path",nested:!1,attr:aH,bound:uH,draw:Kv(mF),pick:Jv(mF),isect:aF};function cH(e,t){e("transform",dF(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function fH(e,t){var n,i;return Pr(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function yF(e,t,n){var i,r,o,s;return t.stroke&&xu(e,t,n)?(i=t.x||0,r=t.y||0,o=t.x2!=null?t.x2:i,s=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(o,s),!0):!1}function dH(e,t,n){_i(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&yF(e,i,r)&&(bu(e,i),e.stroke())}})}function hH(e,t,n,i){return e.isPointInStroke?yF(e,t,1)&&e.isPointInStroke(n,i):!1}var pH={type:"rule",tag:"line",nested:!1,attr:cH,bound:fH,draw:dH,pick:Yh(hH),isect:uF},gH=Qv("shape",_W),mH=Qv("symbol",EW,Vv);const vF=dA();var er={height:tr,measureWidth:ob,estimateWidth:rb,width:rb,canvas:bF};bF(!0);function bF(e){er.width=e&&Lo?ob:rb}function rb(e,t){return xF(Po(e,t),tr(e))}function xF(e,t){return~~(.8*e.length*t)}function ob(e,t){return tr(e)<=0||!(t=Po(e,t))?0:wF(t,Jh(e))}function wF(e,t){const n=`(${t}) ${e}`;let i=vF.get(n);return i===void 0&&(Lo.font=t,i=Lo.measureText(e).width,vF.set(n,i)),i}function tr(e){return e.fontSize!=null?+e.fontSize||0:11}function Io(e){return e.lineHeight!=null?e.lineHeight:tr(e)+2}function yH(e){return R(e)?e.length>1?e:e[0]:e}function kc(e){return yH(e.lineBreak&&e.text&&!R(e.text)?e.text.split(e.lineBreak):e.text)}function sb(e){const t=kc(e);return(R(t)?t.length-1:0)*Io(e)}function Po(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?bH(e,n):n}function vH(e){if(er.width===ob){const t=Jh(e);return n=>wF(n,t)}else{const t=tr(e);return n=>xF(n,t)}}function bH(e,t){var n=+e.limit,i=vH(e);if(i(t)<n)return t;var r=e.ellipsis||"\u2026",o=e.dir==="rtl",s=0,a=t.length,u;if(n-=i(r),o){for(;s<a;)u=s+a>>>1,i(t.slice(u))>n?s=u+1:a=u;return r+t.slice(s)}else{for(;s<a;)u=1+(s+a>>>1),i(t.slice(0,u))<n?s=u:a=u-1;return t.slice(0,s)+r}}function Cc(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Jh(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+tr(e)+"px "+Cc(e,t)}function ab(e){var t=e.baseline,n=tr(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Io(e):t==="line-bottom"?.29*n-.5*Io(e):0)}const xH={left:"start",center:"middle",right:"end"},$c=new ct;function Zh(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-Ws,t+=i*Math.cos(r),n+=i*Math.sin(r)),$c.x1=t,$c.y1=n,$c}function wH(e,t){var n=t.dx||0,i=(t.dy||0)+ab(t),r=Zh(t),o=r.x1,s=r.y1,a=t.angle||0,u;e("text-anchor",xH[t.align]||"start"),a?(u=Vs(o,s)+" "+Zv(a),(n||i)&&(u+=" "+Vs(n,i))):u=Vs(o+n,s+i),e("transform",u)}function ub(e,t,n){var i=er.height(t),r=t.align,o=Zh(t),s=o.x1,a=o.y1,u=t.dx||0,l=(t.dy||0)+ab(t)-Math.round(.8*i),c=kc(t),f;if(R(c)?(i+=Io(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,er.width(t,h)),0)):f=er.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=s,l+=a,u+f,l+i),t.angle&&!n)e.rotate(t.angle*Oo,s,a);else if(n===2)return e.rotatedPoints(t.angle*Oo,s,a);return e}function _H(e,t,n){_i(t,i=>{var r=i.opacity==null?1:i.opacity,o,s,a,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=Jh(i),e.textAlign=i.align||"left",o=Zh(i),s=o.x1,a=o.y1,i.angle&&(e.save(),e.translate(s,a),e.rotate(i.angle*Oo),s=a=0),s+=i.dx||0,a+=(i.dy||0)+ab(i),c=kc(i),bu(e,i),R(c))for(l=Io(i),u=0;u<c.length;++u)f=Po(i,c[u]),i.fill&&Hh(e,i,r)&&e.fillText(f,s,a),i.stroke&&xu(e,i,r)&&e.strokeText(f,s,a),a+=l;else f=Po(i,c),i.fill&&Hh(e,i,r)&&e.fillText(f,s,a),i.stroke&&xu(e,i,r)&&e.strokeText(f,s,a);i.angle&&e.restore()}})}function EH(e,t,n,i,r,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=Zh(t),a=s.x1,u=s.y1,l=ub($c,t,1),c=-t.angle*Oo,f=Math.cos(c),d=Math.sin(c),h=f*r-d*o+(a-f*a+d*u),p=d*r+f*o+(u-d*a-f*u);return l.contains(h,p)}function SH(e,t){const n=ub($c,e,2);return vu(t,n[0],n[1],n[2],n[3])||vu(t,n[0],n[1],n[4],n[5])||vu(t,n[4],n[5],n[6],n[7])||vu(t,n[2],n[3],n[6],n[7])}var AH={type:"text",tag:"text",nested:!1,attr:wH,bound:ub,draw:_H,pick:Yh(EH),isect:SH},kH=eb("trail",SW,PW),zn={arc:RW,area:zW,group:ZW,image:nH,line:iH,path:sH,rect:lH,rule:pH,shape:gH,symbol:mH,text:AH,trail:kH};function lb(e,t,n){var i=zn[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new ct),e,n)}var _F={mark:null};function EF(e,t,n){var i=zn[e.marktype],r=i.bound,o=e.items,s=o&&o.length,a,u,l,c;if(i.nested)return s?l=o[0]:(_F.mark=e,l=_F),c=lb(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new ct,s)for(a=0,u=o.length;a<u;++a)t.union(lb(o[a],r,n));return e.bounds=t}const CH=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function SF(e,t){return JSON.stringify(e,CH,t)}function AF(e){const t=typeof e=="string"?JSON.parse(e):e;return kF(t)}function kF(e){var t=e.marktype,n=e.items,i,r,o;if(n)for(r=0,o=n.length;r<o;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&kF(n[r]);return t&&EF(e),e}function cb(e){arguments.length?this.root=AF(e):(this.root=CF({marktype:"group",name:"root",role:"frame"}),this.root.items=[new zh(this.root)])}cb.prototype={toJSON(e){return SF(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const i=CF(e,t);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};function CF(e,t){const n={bounds:new ct,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function zo(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function fb(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Sn(e,t,n,i){var r=e.childNodes[t],o;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(o=r||null,r=zo(e.ownerDocument,n,i),e.insertBefore(r,o)),r}function Ei(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function $F(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Qh(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function $H(e,t,n,i){var r=e&&e.mark,o,s;if(r&&(o=zn[r.marktype]).tip){for(s=Qh(t,n),s[0]-=i[0],s[1]-=i[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(r.items,s)}return e}function Bo(e,t){this._active=null,this._handlers={},this._loader=e||Yd(),this._tooltip=t||MH}function MH(e,t,n,i){e.element().setAttribute("title",i||"")}Bo.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),o=zo(null,"a");for(const s in i)o.setAttribute(s,i[s]);o.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=$H(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,o=r.width(),s=r.height();let a=r.x1+i[0]+n.left,u=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,u+=e.y||0;return{x:a,y:u,width:o,height:s,left:a,top:u,right:a+o,bottom:u+s}}};function nr(e){this._el=null,this._bgcolor=null,this._loader=new Bv(e)}nr.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(o=>{o&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const FH="keydown",DH="keypress",TH="keyup",MF="dragenter",ep="dragleave",FF="dragover",db="mousedown",OH="mouseup",tp="mousemove",Mc="mouseout",DF="mouseover",np="click",NH="dblclick",RH="wheel",TF="mousewheel",ip="touchstart",rp="touchmove",op="touchend",LH=[FH,DH,TH,MF,ep,FF,db,OH,tp,Mc,DF,np,NH,RH,TF,ip,rp,op],hb=tp,Fc=Mc,pb=np;function Dc(e,t){Bo.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const IH=e=>e===ip||e===rp||e===op?[ip,rp,op]:[e];function OF(e,t){IH(t).forEach(n=>PH(e,n))}function PH(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function NF(e,t,n){return function(i){const r=this._active,o=this.pickEvent(i);o===r?this.fire(e,i):((!r||!r.exit)&&this.fire(n,i),this._active=o,this.fire(t,i),this.fire(e,i))}}function RF(e){return function(t){this.fire(e,t),this._active=null}}q(Dc,Bo,{initialize(e,t,n){return this._canvas=e&&fb(e,"canvas"),[np,db,tp,Mc,ep].forEach(i=>OF(this,i)),Bo.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:LH,DOMMouseScroll(e){this.fire(TF,e)},mousemove:NF(tp,DF,Mc),dragover:NF(FF,MF,ep),mouseout:RF(Mc),dragleave:RF(ep),mousedown(e){this._down=this._active,this.fire(db,e)},click(e){this._down===this._active&&(this.fire(np,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(ip,e,!0)},touchmove(e){this.fire(rp,e,!0)},touchend(e){this.fire(op,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===pb&&i&&i.href?this.handleHref(t,i,i.href):(e===hb||e===Fc)&&this.handleTooltip(t,i,e!==Fc),r)for(let o=0,s=r.length;o<s;++o)r[o].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(OF(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=Qh(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const o=this.context();return zn[e.marktype].pick.call(this,o,e,t,n,i,r)}});function zH(){return typeof window!="undefined"&&window.devicePixelRatio||1}var BH=zH();function UH(e,t,n,i,r,o){const s=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=s?BH:r;e.width=t*u,e.height=n*u;for(const l in o)a[l]=o[l];return s&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*i[0],u*i[1]),e}function sp(e){nr.call(this,e),this._options={},this._redraw=!1,this._dirty=new ct,this._tempb=new ct}const LF=nr.prototype,jH=(e,t,n)=>new ct().set(0,0,t,n).translate(-e[0],-e[1]);function qH(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}q(sp,nr,{initialize(e,t,n,i,r,o){return this._options=o||{},this._canvas=this._options.externalContext?null:su(1,1,this._options.type),e&&this._canvas&&(Ei(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),LF.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(LF.resize.call(this,e,t,n,i),this._canvas)UH(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||N("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,o=this._dirty,s=jH(n,i,r);t.save();const a=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):qH(t,s.intersect(o),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,a),t.restore(),o.clear(),this},draw(e,t,n){const i=zn[t.marktype];t.clip&&BW(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,o=this.context();r.type!=="pdf"&&!r.externalContext&&o.clearRect(e,t,n,i),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,i))}});function gb(e,t){Bo.call(this,e,t);const n=this;n._hrefHandler=mb(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=mb(n,(i,r)=>{n.handleTooltip(i,r,i.type!==Fc)})}const mb=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};q(gb,Bo,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(pb,this._hrefHandler),i.removeEventListener(hb,this._tooltipHandler),i.removeEventListener(Fc,this._tooltipHandler)),this._svg=i=e&&fb(e,"svg"),i&&(i.addEventListener(pb,this._hrefHandler),i.addEventListener(hb,this._tooltipHandler),i.addEventListener(Fc,this._tooltipHandler)),Bo.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const o={type:e,handler:t,listener:mb(this,t)};(i[n]||(i[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const IF="aria-hidden",yb="aria-label",vb="role",bb="aria-roledescription",PF="graphics-object",xb="graphics-symbol",zF=(e,t,n)=>({[vb]:e,[bb]:t,[yb]:n||void 0}),WH=vt(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),BF={axis:{desc:"axis",caption:YH},legend:{desc:"legend",caption:VH},"title-text":{desc:"title",caption:e=>`Title text '${WF(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${WF(e)}'`}},UF={ariaRole:vb,ariaRoleDescription:bb,description:yb};function jF(e,t){const n=t.aria===!1;if(e(IF,n||void 0),n||t.description==null)for(const i in UF)e(UF[i],void 0);else{const i=t.mark.marktype;e(yb,t.description),e(vb,t.ariaRole||(i==="group"?PF:xb)),e(bb,t.ariaRoleDescription||`${i} mark`)}}function qF(e){return e.aria===!1?{[IF]:!0}:WH[e.role]?null:BF[e.role]?GH(e,BF[e.role]):HH(e)}function HH(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return zF(n?PF:xb,`${t} mark container`,e.description)}function GH(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return zF(t.role||xb,t.desc,n.description||i(n))}catch(n){return null}}function WF(e){return K(e.text).join(" ")}function YH(e){const t=e.datum,n=e.orient,i=t.title?HF(e):null,r=e.context,o=r.scales[t.scale].value,s=r.dataflow.locale(),a=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${pu(a)?"discrete":a} scale with ${UM(s,o,e)}`}function VH(e){const t=e.datum,n=t.title?HF(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,o=Object.keys(r),s=e.context,a=s.scales[r[o[0]]].value,u=s.dataflow.locale();return KH(i)+(n?` titled '${n}'`:"")+` for ${XH(o)} with ${UM(u,a,e)}`}function HF(e){try{return K(be(e.items).items[0].text).join(" ")}catch(t){return null}}function XH(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+be(e)}function KH(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const GF=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),JH=e=>GF(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function wb(){let e="",t="",n="";const i=[],r=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},s=(u,l)=>(l!=null&&(t+=` ${u}="${JH(l)}"`),a),a={open(u,...l){o(u),t="<"+u;for(const c of l)for(const f in c)s(f,c[f]);return a},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),a},attr:s,text:u=>(n+=GF(u),a),toString:()=>e};return a}const YF=e=>VF(wb(),e)+"";function VF(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes,i=n.length;for(let r=0;r<i;r++){const o=n[r];o.nodeType===3?e.text(o.nodeValue):VF(e,o)}}return e.close()}const ap={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},XF={fill:"none","stroke-miterlimit":10},Tc=0,KF="http://www.w3.org/2000/xmlns/",ft=Ac.xmlns;function _b(e){nr.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const Eb=nr.prototype;q(_b,nr,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=Sn(e,0,"svg",ft),this._svg.setAttributeNS(KF,"xmlns",ft),this._svg.setAttributeNS(KF,"xmlns:xlink",Ac["xmlns:xlink"]),this._svg.setAttribute("version",Ac.version),this._svg.setAttribute("class","marks"),Ei(e,1),this._root=Sn(this._svg,Tc,"g",ft),Uo(this._root,XF),Ei(this._svg,Tc+1)),this.background(this._bgcolor),Eb.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),Eb.background.apply(this,arguments)},resize(e,t,n,i){return Eb.resize.call(this,e,t,n,i),this._svg&&(Uo(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Sn(e,Tc,"rect",ft),Uo(n,{width:this._width,height:this._height,fill:t}));const i=YF(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Ei(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,o,s,a,u;for(s=0,a=e.length;s<a;++s)if(n=e[s],i=n.mark,i.marktype!==r&&(r=i.marktype,o=zn[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,JF(n,t),i.items.forEach(l=>{l.dirty=t})),!i.zdirty){if(n.exit){o.nested&&i.items.length?(u=i.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=o.nested?i.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,JF(n,t)):this._update(o,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=zn[t.marktype],o=t.interactive===!1?"none":null,s=r.tag==="g";let a=null,u=0;const l=ZF(t,e,n,"g",i);l.setAttribute("class",$F(t));const c=qF(t);for(const d in c)en(l,d,c[d]);s||en(l,"pointer-events",o),en(l,"clip-path",t.clip?zv(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),p=ZF(d,l,a,r.tag,i);h&&(this._update(r,p,d),s&&eG(this,p,d)),a=p,++u};return r.nested?t.items.length&&f(t.items[0]):_i(t,f),Ei(l,u),l},_update(e,t,n){zr=t,Wt=t.__values__,jF(Oc,n),e.attr(Oc,n,this);const i=nG[e.type];i&&i.call(this,e,t,n),zr&&this.style(zr,n)},style(e,t){if(t!=null)for(const n in ap){let i=n==="font"?Cc(t):t[n];if(i===Wt[n])continue;const r=ap[n];i==null?e.removeAttribute(r):(Ov(i)&&(i=qM(i,this._defs.gradient,QF())),e.setAttribute(r,i+"")),Wt[n]=i}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=Sn(e,Tc+1,"defs",ft)),i=ZH(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=Sn(e,Tc+1,"defs",ft)),i=QH(n,t.clipping[r],i);n&&(i===0?(e.removeChild(n),t.el=null):Ei(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function JF(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function ZH(e,t,n){let i,r,o;if(t.gradient==="radial"){let s=Sn(e,n++,"pattern",ft);Uo(s,{id:Rh+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=Sn(s,0,"rect",ft),Uo(s,{width:1,height:1,fill:`url(${QF()}#${t.id})`}),e=Sn(e,n++,"radialGradient",ft),Uo(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Sn(e,n++,"linearGradient",ft),Uo(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)o=Sn(e,i,"stop",ft),o.setAttribute("offset",t.stops[i].offset),o.setAttribute("stop-color",t.stops[i].color);return Ei(e,i),n}function QH(e,t,n){let i;return e=Sn(e,n,"clipPath",ft),e.setAttribute("id",t.id),t.path?(i=Sn(e,0,"path",ft),i.setAttribute("d",t.path)):(i=Sn(e,0,"rect",ft),Uo(i,{x:0,y:0,width:t.width,height:t.height})),Ei(e,1),n+1}function eG(e,t,n){t=t.lastChild.previousSibling;let i,r=0;_i(n,o=>{i=e.mark(t,o,i),++r}),Ei(t,1+r)}function ZF(e,t,n,i,r){let o=e._svg,s;if(!o&&(s=t.ownerDocument,o=zo(s,i,ft),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},i==="g"))){const a=zo(s,"path",ft);o.appendChild(a),a.__data__=e;const u=zo(s,"g",ft);o.appendChild(u),u.__data__=e;const l=zo(s,"path",ft);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==r||tG(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function tG(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let zr=null,Wt=null;const nG={group(e,t,n){const i=zr=t.childNodes[2];Wt=i.__values__,e.foreground(Oc,n,this),Wt=t.__values__,zr=t.childNodes[1],e.content(Oc,n,this);const r=zr=t.childNodes[0];e.background(Oc,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==Wt.events&&(en(i,"pointer-events",o),en(r,"pointer-events",o),Wt.events=o),n.strokeForeground&&n.stroke){const s=n.fill;en(i,"display",null),this.style(r,n),en(r,"stroke",null),s&&(n.fill=null),Wt=i.__values__,this.style(i,n),s&&(n.fill=s),zr=null}else en(i,"display","none")},image(e,t,n){n.smooth===!1?(Sb(t,"image-rendering","optimizeSpeed"),Sb(t,"image-rendering","pixelated")):Sb(t,"image-rendering",null)},text(e,t,n){const i=kc(n);let r,o,s,a;R(i)?(o=i.map(u=>Po(n,u)),r=o.join(`
`),r!==Wt.text&&(Ei(t,0),s=t.ownerDocument,a=Io(n),o.forEach((u,l)=>{const c=zo(s,"tspan",ft);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),Wt.text=r)):(o=Po(n,i),o!==Wt.text&&(t.textContent=o,Wt.text=o)),en(t,"font-family",Cc(n)),en(t,"font-size",tr(n)+"px"),en(t,"font-style",n.fontStyle),en(t,"font-variant",n.fontVariant),en(t,"font-weight",n.fontWeight)}};function Oc(e,t,n){t!==Wt[e]&&(n?iG(zr,e,t,n):en(zr,e,t),Wt[e]=t)}function Sb(e,t,n){n!==Wt[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Wt[t]=n)}function Uo(e,t){for(const n in t)en(e,n,t[n])}function en(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function iG(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function QF(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Ab(e){nr.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}q(Ab,nr,{svg(){return this._text},_render(e){const t=wb();t.open("svg",de({},Ac,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",XF,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=zn[t.marktype],i=n.tag,r=[jF,n.attr];e.open("g",{class:$F(t),"clip-path":t.clip?zv(this,t,t.group):null},qF(t),{"pointer-events":i!=="g"&&t.interactive===!1?"none":null});const o=s=>{const a=this.href(s);if(a&&e.open("a",a),e.open(i,this.attr(t,s,r,i!=="g"?i:null)),i==="text"){const u=kc(s);if(R(u)){const l={x:0,dy:Io(s)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Po(s,u[c])).close()}else e.text(Po(s,u))}else if(i==="g"){const u=s.strokeForeground,l=s.fill,c=s.stroke;u&&c&&(s.stroke=null),e.open("path",this.attr(t,s,n.background,"bgrect")).close(),e.open("g",this.attr(t,s,n.content)),_i(s,f=>this.mark(e,f)),e.close(),u&&c?(l&&(s.fill=null),s.stroke=c,e.open("path",this.attr(t,s,n.foreground,"bgrect")).close(),l&&(s.fill=l)):e.open("path",this.attr(t,s,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):_i(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},o=(s,a,u,l)=>{r[l||s]=a};return Array.isArray(n)?n.forEach(s=>s(o,t,this)):n(o,t,this),i&&rG(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const o=t[r],s=o.stops;o.gradient==="radial"?(e.open("pattern",{id:Rh+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:r,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let a=0;a<s.length;++a)e.open("stop",{offset:s[a].offset,"stop-color":s[a].color}).close();e.close()}for(const r in n){const o=n[r];e.open("clipPath",{id:r}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});function rG(e,t,n,i,r){if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),i==="text"&&(e["font-family"]=Cc(t),e["font-size"]=tr(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in ap){let s=t[o];const a=ap[o];s==="transparent"&&(a==="fill"||a==="stroke")||s!=null&&(Ov(s)&&(s=qM(s,r.gradient,"")),e[a]=s)}return e}const e3="canvas",t3="png",n3="svg",i3="none",jo={Canvas:e3,PNG:t3,SVG:n3,None:i3},wu={};wu[e3]=wu[t3]={renderer:sp,headless:sp,handler:Dc},wu[n3]={renderer:_b,headless:Ab,handler:gb},wu[i3]={};function up(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(wu[e]=t,this):wu[e]}function r3(e,t,n){const i=[],r=new ct().union(t),o=e.marktype;return o?o3(e,r,n,i):o==="group"?s3(e,r,n,i):N("Intersect scene must be mark node or group item.")}function o3(e,t,n,i){if(oG(e,t,n)){const r=e.items,o=e.marktype,s=r.length;let a=0;if(o==="group")for(;a<s;++a)s3(r[a],t,n,i);else for(const u=zn[o].isect;a<s;++a){const l=r[a];a3(l,t,u)&&i.push(l)}}return i}function oG(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function s3(e,t,n,i){n&&n(e.mark)&&a3(e,t,zn.group.isect)&&i.push(e);const r=e.items,o=r&&r.length;if(o){const s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let u=0;u<o;++u)o3(r[u],t,n,i);t.translate(s,a)}return i}function a3(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const kb=new ct;function u3(e){const t=e.clip;if(fe(t))t(_c(kb.clear()));else if(t)kb.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(kb)}const sG=1e-9;function Cb(e,t,n){return e===t?!0:n==="path"?l3(e,t):e instanceof Date&&t instanceof Date?+e==+t:Oe(e)&&Oe(t)?Math.abs(e-t)<=sG:!e||!t||!J(e)&&!J(t)?e==t:aG(e,t)}function l3(e,t){return Cb(gu(e),gu(t))}function aG(e,t){var n=Object.keys(e),i=Object.keys(t),r,o;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),o=n.length-1;o>=0;o--)if(n[o]!=i[o])return!1;for(o=n.length-1;o>=0;o--)if(r=n[o],!Cb(e[r],t[r],r))return!1;return typeof e==typeof t}function uG(){eF(),Pq()}const _u="top",Si="left",Ai="right",qo="bottom",lG="top-left",cG="top-right",fG="bottom-left",dG="bottom-right",$b="start",Mb="middle",tn="end",hG="x",pG="y",lp="group",Fb="axis",Db="title",gG="frame",mG="scope",Tb="legend",c3="row-header",f3="row-footer",d3="row-title",h3="column-header",p3="column-footer",g3="column-title",yG="padding",vG="symbol",m3="fit",bG="fit-x",xG="fit-y",wG="pad",Ob="none",cp="all",Nb="each",Rb="flush",Wo="column",Ho="row";function y3(e){T.call(this,null,e)}q(y3,T,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,o=zn[r],s=o.bound;let a=i.bounds,u;if(o.nested)i.items.length&&n.dirty(i.items[0]),a=fp(i,s),i.items.forEach(l=>{l.bounds.clear().union(a)});else if(r===lp||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),i.items.forEach(l=>a.union(fp(l,s))),i.role){case Fb:case Tb:case Db:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(fp(l,s))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(fp(l,s))}),u&&(a.clear(),i.items.forEach(l=>a.union(l.bounds)));return u3(i),t.modifies("bounds")}});function fp(e,t,n){return t(e.bounds.clear(),e,n)}const v3=":vega_identifier:";function Lb(e){T.call(this,0,e)}Lb.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},q(Lb,T,{transform(e,t){const n=_G(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,o=>o[i]=o[i]||++r),n.set(this.value=r),t}});function _G(e){return e._signals[v3]||(e._signals[v3]=e.add(0))}function b3(e){T.call(this,null,e)}q(b3,T,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,EG(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===lp?zh:Ph;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function EG(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function x3(e){T.call(this,null,e)}const w3={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!_3(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},_3=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),E3=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,o;n<i;r=o,++n)if(_3(r,o=e[n].bounds,t))return!0},SG=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},AG=(e,t,n)=>{var i=e.range(),r=new ct;return t===_u||t===qo?r.set(i[0],-Infinity,i[1],Infinity):r.set(-Infinity,i[0],Infinity,i[1]),r.expand(n||1),o=>r.encloses(o.bounds)},S3=e=>(e.forEach(t=>t.opacity=1),e),A3=(e,t)=>e.reflow(t.modified()).modifies("opacity");q(x3,T,{transform(e,t){const n=w3[e.method]||w3.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,o,s;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(S3(r),t=A3(t,e)),t;if(r=r.filter(SG),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),o=S3(r),t=A3(t,e),o.length>=3&&E3(o,i)){do o=n(o,i);while(o.length>=3&&E3(o,i));o.length<3&&!be(r).opacity&&(o.length>1&&(be(o).opacity=0),be(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=AG(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{s(u)||(u.opacity=0)}));const a=o[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function k3(e){T.call(this,null,e)}q(k3,T,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const Ht=new ct;function Eu(e,t,n){return e[t]===n?0:(e[t]=n,1)}function kG(e){var t=e.items[0].orient;return t===Si||t===Ai}function CG(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function $G(e,t,n,i){var r=t.items[0],o=r.datum,s=r.translate!=null?r.translate:.5,a=r.orient,u=CG(o),l=r.range,c=r.offset,f=r.position,d=r.minExtent,h=r.maxExtent,p=o.title&&r.items[u[2]].items[0],g=r.titlePadding,m=r.bounds,y=p&&sb(p),v=0,b=0,w,E;switch(Ht.clear().union(m),m.clear(),(w=u[0])>-1&&m.union(r.items[w].bounds),(w=u[1])>-1&&m.union(r.items[w].bounds),a){case _u:v=f||0,b=-c,E=Math.max(d,Math.min(h,-m.y1)),m.add(0,-E).add(l,0),p&&dp(e,p,E,g,y,0,-1,m);break;case Si:v=-c,b=f||0,E=Math.max(d,Math.min(h,-m.x1)),m.add(-E,0).add(0,l),p&&dp(e,p,E,g,y,1,-1,m);break;case Ai:v=n+c,b=f||0,E=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(E,l),p&&dp(e,p,E,g,y,1,1,m);break;case qo:v=f||0,b=i+c,E=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,E),p&&dp(e,p,E,g,0,0,1,m);break;default:v=r.x,b=r.y}return Pr(m.translate(v,b),r),Eu(r,"x",v+s)|Eu(r,"y",b+s)&&(r.bounds=Ht,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function dp(e,t,n,i,r,o,s,a){const u=t.bounds;if(t.auto){const l=s*(n+r+i);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const C3=(e,t)=>Math.floor(Math.min(e,t)),$3=(e,t)=>Math.ceil(Math.max(e,t));function MG(e){var t=e.items,n=t.length,i=0,r,o;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],o=r.items,r.marktype===lp)switch(r.role){case Fb:case Tb:case Db:break;case c3:s.rowheaders.push(...o);break;case f3:s.rowfooters.push(...o);break;case h3:s.colheaders.push(...o);break;case p3:s.colfooters.push(...o);break;case d3:s.rowtitle=o[0];break;case g3:s.coltitle=o[0];break;default:s.marks.push(...o)}return s}function FG(e){return new ct().set(0,0,e.width||0,e.height||0)}function DG(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function We(e,t,n){const i=J(e)?e[t]:e;return i!=null?i:n!==void 0?n:0}function M3(e){return e<0?Math.ceil(-e):0}function F3(e,t,n){var i=!n.nodirty,r=n.bounds===Rb?FG:DG,o=Ht.set(0,0,0,0),s=We(n.align,Wo),a=We(n.align,Ho),u=We(n.padding,Wo),l=We(n.padding,Ho),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),y=Array(f),v=0,b=Array(d),w=Array(d),E=Array(d),S,_,A,C,k,$,F,D,L,M,I;for(_=0;_<c;++_)p[_]=0;for(_=0;_<f;++_)y[_]=0;for(_=0;_<d;++_)$=t[_],k=E[_]=r($),$.x=$.x||0,b[_]=0,$.y=$.y||0,w[_]=0,A=_%c,C=~~(_/c),g=Math.max(g,F=Math.ceil(k.x2)),v=Math.max(v,D=Math.ceil(k.y2)),p[A]=Math.max(p[A],F),y[C]=Math.max(y[C],D),h[_]=u+M3(k.x1),m[_]=l+M3(k.y1),i&&e.dirty(t[_]);for(_=0;_<d;++_)_%c==0&&(h[_]=0),_<c&&(m[_]=0);if(s===Nb)for(A=1;A<c;++A){for(I=0,_=A;_<d;_+=c)I<h[_]&&(I=h[_]);for(_=A;_<d;_+=c)h[_]=I+p[A-1]}else if(s===cp){for(I=0,_=0;_<d;++_)_%c&&I<h[_]&&(I=h[_]);for(_=0;_<d;++_)_%c&&(h[_]=I+g)}else for(s=!1,A=1;A<c;++A)for(_=A;_<d;_+=c)h[_]+=p[A-1];if(a===Nb)for(C=1;C<f;++C){for(I=0,_=C*c,S=_+c;_<S;++_)I<m[_]&&(I=m[_]);for(_=C*c;_<S;++_)m[_]=I+y[C-1]}else if(a===cp){for(I=0,_=c;_<d;++_)I<m[_]&&(I=m[_]);for(_=c;_<d;++_)m[_]=I+v}else for(a=!1,C=1;C<f;++C)for(_=C*c,S=_+c;_<S;++_)m[_]+=y[C-1];for(L=0,_=0;_<d;++_)L=h[_]+(_%c?L:0),b[_]+=L-t[_].x;for(A=0;A<c;++A)for(M=0,_=A;_<d;_+=c)M+=m[_],w[_]+=M-t[_].y;if(s&&We(n.center,Wo)&&f>1)for(_=0;_<d;++_)k=s===cp?g:p[_%c],L=k-E[_].x2-t[_].x-b[_],L>0&&(b[_]+=L/2);if(a&&We(n.center,Ho)&&c!==1)for(_=0;_<d;++_)k=a===cp?v:y[~~(_/c)],M=k-E[_].y2-t[_].y-w[_],M>0&&(w[_]+=M/2);for(_=0;_<d;++_)o.union(E[_].translate(b[_],w[_]));switch(L=We(n.anchor,hG),M=We(n.anchor,pG),We(n.anchor,Wo)){case tn:L-=o.width();break;case Mb:L-=o.width()/2}switch(We(n.anchor,Ho)){case tn:M-=o.height();break;case Mb:M-=o.height()/2}for(L=Math.round(L),M=Math.round(M),o.clear(),_=0;_<d;++_)t[_].mark.bounds.clear();for(_=0;_<d;++_)$=t[_],$.x+=b[_]+=L,$.y+=w[_]+=M,o.union($.mark.bounds.union($.bounds.translate(b[_],w[_]))),i&&e.dirty($);return o}function TG(e,t,n){var i=MG(t),r=i.marks,o=n.bounds===Rb?OG:NG,s=n.offset,a=n.columns||r.length,u=a<=0?1:Math.ceil(r.length/a),l=u*a,c,f,d,h,p,g,m;const y=F3(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(g=We(n.headerBand,Ho,null),c=hp(e,i.rowheaders,r,a,u,-We(s,"rowHeader"),C3,0,o,"x1",0,a,1,g)),i.colheaders&&(g=We(n.headerBand,Wo,null),f=hp(e,i.colheaders,r,a,a,-We(s,"columnHeader"),C3,1,o,"y1",0,1,a,g)),i.rowfooters&&(g=We(n.footerBand,Ho,null),d=hp(e,i.rowfooters,r,a,u,We(s,"rowFooter"),$3,0,o,"x2",a-1,a,1,g)),i.colfooters&&(g=We(n.footerBand,Wo,null),h=hp(e,i.colfooters,r,a,a,We(s,"columnFooter"),$3,1,o,"y2",l-a,1,a,g)),i.rowtitle&&(p=We(n.titleAnchor,Ho),m=We(s,"rowTitle"),m=p===tn?d+m:c-m,g=We(n.titleBand,Ho,.5),D3(e,i.rowtitle,m,0,y,g)),i.coltitle&&(p=We(n.titleAnchor,Wo),m=We(s,"columnTitle"),m=p===tn?h+m:f-m,g=We(n.titleBand,Wo,.5),D3(e,i.coltitle,m,1,y,g))}function OG(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function NG(e,t){return e.bounds[t]}function hp(e,t,n,i,r,o,s,a,u,l,c,f,d,h){var p=n.length,g=0,m=0,y,v,b,w,E,S,_,A,C;if(!p)return g;for(y=c;y<p;y+=f)n[y]&&(g=s(g,u(n[y],l)));if(!t.length)return g;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),g+=o,v=0,w=t.length;v<w;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,w=t.length;v<w;++v,y+=f){for(S=t[v],E=S.mark.bounds,b=y;b>=0&&(_=n[b])==null;b-=d);a?(A=h==null?_.x:Math.round(_.bounds.x1+h*_.bounds.width()),C=g):(A=g,C=h==null?_.y:Math.round(_.bounds.y1+h*_.bounds.height())),E.union(S.bounds.translate(A-(S.x||0),C-(S.y||0))),S.x=A,S.y=C,e.dirty(S),m=s(m,E[l])}return m}function D3(e,t,n,i,r,o){if(!!t){e.dirty(t);var s=n,a=n;i?s=Math.round(r.x1+o*r.width()):a=Math.round(r.y1+o*r.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function RG(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function LG(e,t){let n=-Infinity;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-Infinity?n:t}function IG(e,t,n,i,r,o,s){const a=RG(n,t),u=LG(e,a("offset",0)),l=a("anchor",$b),c=l===tn?1:l===Mb?.5:0,f={align:Nb,bounds:a("bounds",Rb),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Si:f.anchor={x:Math.floor(i.x1)-u,column:tn,y:c*(s||i.height()+2*i.y1),row:l};break;case Ai:f.anchor={x:Math.ceil(i.x2)+u,y:c*(s||i.height()+2*i.y1),row:l};break;case _u:f.anchor={y:Math.floor(r.y1)-u,row:tn,x:c*(o||r.width()+2*r.x1),column:l};break;case qo:f.anchor={y:Math.ceil(r.y2)+u,x:c*(o||r.width()+2*r.x1),column:l};break;case lG:f.anchor={x:u,y:u};break;case cG:f.anchor={x:o-u,y:u,column:tn};break;case fG:f.anchor={x:u,y:s-u,row:tn};break;case dG:f.anchor={x:o-u,y:s-u,column:tn,row:tn};break}return f}function PG(e,t){var n=t.items[0],i=n.datum,r=n.orient,o=n.bounds,s=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),BG(e,n,n.items[0].items[0]),o=zG(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),i.type===vG&&UG(n.items[0].items[0].items[0].items),r!==Ob&&(n.x=s=0,n.y=a=0),n.width=u,n.height=l,Pr(o.set(s,a,s+u,a+l),n),n.mark.bounds.clear().union(o),n}function zG(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function BG(e,t,n){var i=t.padding,r=i-n.x,o=i-n.y;if(!t.datum.title)(r||o)&&Nc(e,n,r,o);else{var s=t.items[1].items[0],a=s.anchor,u=t.titlePadding||0,l=i-s.x,c=i-s.y;switch(s.orient){case Si:r+=Math.ceil(s.bounds.width())+u;break;case Ai:case qo:break;default:o+=s.bounds.height()+u}switch((r||o)&&Nc(e,n,r,o),s.orient){case Si:c+=Su(t,n,s,a,1,1);break;case Ai:l+=Su(t,n,s,tn,0,0)+u,c+=Su(t,n,s,a,1,1);break;case qo:l+=Su(t,n,s,a,0,0),c+=Su(t,n,s,tn,-1,0,1)+u;break;default:l+=Su(t,n,s,a,0,0)}(l||c)&&Nc(e,s,l,c),(l=Math.round(s.bounds.x1-i))<0&&(Nc(e,n,-l,0),Nc(e,s,-l,0))}}function Su(e,t,n,i,r,o,s){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(o||!u)&&!s?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=r<=0?0:sb(n);return Math.round(i===$b?f:i===tn?d-h:.5*(c-h))}function Nc(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function UG(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function jG(e,t,n,i,r){var o=t.items[0],s=o.frame,a=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=a===Si||a===Ai?i:n,p=0,g=0,m=0,y=0,v=0,b;if(s!==lp?a===Si?(p=r.y2,h=r.y1):a===Ai?(p=r.y1,h=r.y2):(p=r.x1,h=r.x2):a===Si&&(p=i,h=0),b=u===$b?p:u===tn?h:(p+h)/2,d&&d.text){switch(a){case _u:case qo:v=f.bounds.height()+c;break;case Si:y=f.bounds.width()+c;break;case Ai:y=-f.bounds.width()-c;break}Ht.clear().union(d.bounds),Ht.translate(y-(d.x||0),v-(d.y||0)),Eu(d,"x",y)|Eu(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(Ht),d.mark.bounds.clear().union(Ht),e.dirty(d)),Ht.clear().union(d.bounds)}else Ht.clear();switch(Ht.union(f.bounds),a){case _u:g=b,m=r.y1-Ht.height()-l;break;case Si:g=r.x1-Ht.width()-l,m=b;break;case Ai:g=r.x2+Ht.width()+l,m=b;break;case qo:g=b,m=r.y2+l;break;default:g=o.x,m=o.y}return Eu(o,"x",g)|Eu(o,"y",m)&&(Ht.translate(g,m),e.dirty(o),o.bounds.clear().union(Ht),t.bounds.clear().union(Ht),e.dirty(o)),o.bounds}function T3(e){T.call(this,null,e)}q(T3,T,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&TG(n,i,e.layout),WG(n,i,e)}),qG(e.mark.group)?t.reflow():t}});function qG(e){return e&&e.mark.role!=="legend-entry"}function WG(e,t,n){var i=t.items,r=Math.max(0,t.width||0),o=Math.max(0,t.height||0),s=new ct().set(0,0,r,o),a=s.clone(),u=s.clone(),l=[],c,f,d,h,p,g;for(p=0,g=i.length;p<g;++p)switch(f=i[p],f.role){case Fb:h=kG(f)?a:u,h.union($G(e,f,r,o));break;case Db:c=f;break;case Tb:l.push(PG(e,f));break;case gG:case mG:case c3:case f3:case d3:case h3:case p3:case g3:a.union(f.bounds),u.union(f.bounds);break;default:s.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||Ai,d!==Ob&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];F3(e,v,IG(v,y,n.legends,a,u,r,o))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&n.autosize.type===m3)switch(y.orient){case Si:case Ai:s.add(v.x1,0).add(v.x2,0);break;case _u:case qo:s.add(0,v.y1).add(0,v.y2)}else s.union(v)})}s.union(a).union(u),c&&s.union(jG(e,c,r,o,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),HG(e,t,s,n)}function HG(e,t,n,i){const r=i.autosize||{},o=r.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(r.contains===yG){const p=e.padding();s-=p.left+p.right,a-=p.top+p.bottom}o===Ob?(l=0,f=0,u=s,c=a):o===m3?(u=Math.max(0,s-l-d),c=Math.max(0,a-f-h)):o===bG?(u=Math.max(0,s-l-d),a=c+f+h):o===xG?(s=u+l+d,c=Math.max(0,a-f-h)):o===wG&&(s=u+l+d,a=c+f+h),e._resizeView(s,a,u,c,[l,f],r.resize)}var GG=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:y3,identifier:Lb,mark:b3,overlap:x3,render:k3,viewlayout:T3});function O3(e){T.call(this,null,e)}q(O3,T,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.scale,s=e.count==null?e.values?e.values.length:10:e.count,a=Fv(o,s,e.minstep),u=e.format||NM(n,o,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?OM(o,e.values,a):Dv(o,a);return r&&(i.rem=r),r=l.map((c,f)=>Ce({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(Ce({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function N3(e){T.call(this,null,e)}function YG(){return Ce({})}function VG(e){const t=Ha().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}q(N3,T,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||YG,o=e.key||ne,s=this.value;return R(i.encode)&&(i.encode=null),s&&(e.modified("key")||t.modified(o))&&N("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=VG(o)),t.visit(t.ADD,a=>{const u=o(a);let l=s.get(u);l?l.exit?(s.empty--,i.add.push(l)):i.mod.push(l):(l=r(a),s.set(u,l),i.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=o(a),l=s.get(u);l&&(l.datum=a,i.mod.push(l))}),t.visit(t.REM,a=>{const u=o(a),l=s.get(u);a===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),i}});function R3(e){T.call(this,null,e)}q(R3,T,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,o=t.encode;if(R(o))if(n.changed()||o.every(f=>r[f]))o=o[0],n.encode=null;else return t.StopPropagation;var s=o==="enter",a=r.update||po,u=r.enter||po,l=r.exit||po,c=(o&&!s?r[o]:a)||po;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==po&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==po&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),s||c!==po){const f=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(f,d=>{const h=u(d,e)||i;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function L3(e){T.call(this,[],e)}q(L3,T,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.type||Nh,s=e.scale,a=+e.limit,u=Fv(s,e.count==null?5:e.count,e.minstep),l=!!e.values||o===Nh,c=e.format||PM(n,s,u,o,e.formatSpecifier,e.formatType,l),f=e.values||IM(s,u),d,h,p,g,m;return r&&(i.rem=r),o===Nh?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,a-1),m=!0):r=f,fe(p=e.size)?(!e.values&&s(r[0])===0&&(r=r.slice(1)),g=r.reduce((y,v)=>Math.max(y,p(v,e)),0)):p=zt(g=p||8),r=r.map((y,v)=>Ce({index:v,label:c(y,v,r),value:y,offset:g,size:p(y,e)})),m&&(m=f[r.length],r.push(Ce({index:r.length,label:"\u2026".concat(f.length-r.length," entries"),value:m,offset:g,size:p(m,e)})))):o===Aq?(d=s.domain(),h=MM(s,d[0],be(d)),f.length<3&&!e.values&&d[0]!==be(d)&&(f=[d[0],be(d)]),r=f.map((y,v)=>Ce({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(p=f.length-1,h=Lq(s),r=f.map((y,v)=>Ce({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===p?1:h(f[v+1])}))),i.source=r,i.add=r,this.value=r,i}});const XG=e=>e.source.x,KG=e=>e.source.y,JG=e=>e.target.x,ZG=e=>e.target.y;function Ib(e){T.call(this,{},e)}Ib.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},q(Ib,T,{transform(e,t){var n=e.sourceX||XG,i=e.sourceY||KG,r=e.targetX||JG,o=e.targetY||ZG,s=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=B3.get(u+"-"+a)||B3.get(u);return l||N("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[s]=l(n(c),i(c),r(c),o(c))}),t.reflow(e.modified()).modifies(s)}});const I3=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,QG=(e,t,n,i)=>I3(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),P3=(e,t,n,i)=>{var r=n-e,o=i-t,s=Math.sqrt(r*r+o*o)/2,a=180*Math.atan2(o,r)/Math.PI;return"M"+e+","+t+"A"+s+","+s+" "+a+" 0 1 "+n+","+i},eY=(e,t,n,i)=>P3(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),z3=(e,t,n,i)=>{const r=n-e,o=i-t,s=.2*(r+o),a=.2*(o-r);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(i-s)+" "+n+","+i},tY=(e,t,n,i)=>z3(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),nY=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,iY=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,rY=(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*s+","+t*a+"L"+i*s+","+i*a},oY=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},sY=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},aY=(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*o+"C"+u*r+","+u*o+" "+u*s+","+u*a+" "+i*s+","+i*a},B3=Ha({line:I3,"line-radial":QG,arc:P3,"arc-radial":eY,curve:z3,"curve-radial":tY,"orthogonal-horizontal":nY,"orthogonal-vertical":iY,"orthogonal-radial":rY,"diagonal-horizontal":oY,"diagonal-vertical":sY,"diagonal-radial":aY});function Pb(e){T.call(this,null,e)}Pb.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},q(Pb,T,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],o=e.field||qa,s=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=s,d=(a-s)/RA(l),h=Ln(c),p,g,m;for(e.sort&&h.sort((y,v)=>l[y]-l[v]),p=0;p<c;++p)m=l[h[p]],g=u[h[p]],g[i]=f,g[r]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const uY=5;function lY(e){const t=e.type;return!e.bins&&(t===fu||t===dc||t===hc)}function U3(e){return kv(e)&&e!==Ji}const cY=vt(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function j3(e){T.call(this,null,e),this.modified(!0)}q(j3,T,{transform(e,t){var n=t.dataflow,i=this.value,r=fY(e);(!i||r!==i.type)&&(this.value=i=Ae(r)());for(r in e)if(!cY[r]){if(r==="padding"&&U3(i.type))continue;fe(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return yY(i,e,mY(i,e,hY(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function fY(e){var t=e.type,n="",i;return t===Ji?Ji+"-"+fu:(dY(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?Ji+"-":i===3?du+"-":""),(n+t||fu).toLowerCase())}function dY(e){const t=e.type;return kv(t)&&t!==Us&&t!==js&&(e.scheme||e.range&&e.range.length&&e.range.every(V))}function hY(e,t,n){const i=pY(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,o=e.type,s=t.zero||t.zero===void 0&&lY(e),a,u;if(!r)return 0;if(U3(o)&&t.padding&&r[0]!==be(r)&&(r=gY(o,r,t.range,t.padding,t.exponent,t.constant)),(s||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(r=r.slice()).length-1||1,s&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[a]?a+1:u<r[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return e.domain(q3(o,r,n)),o===wv&&e.unknown(t.domainImplicit?Gy:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&Fv(e,t.nice)||null),r.length}function pY(e,t,n){return t?(e.domain(q3(e.type,t,n)),t.length):-1}function gY(e,t,n,i,r,o){var s=Math.abs(be(n)-n[0]),a=s/(s-2*i),u=e===Lr?G0(t,null,a):e===hc?Rd(t,null,a,.5):e===dc?Rd(t,null,a,r||1):e===Mh?Y0(t,null,a,o||1):H0(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function q3(e,t,n){if(SM(e)){var i=Math.abs(t.reduce((r,o)=>r+(o<0?-1:o>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+W(t))}return t}function mY(e,t,n){let i=t.bins;if(i&&!R(i)){const r=e.domain(),o=r[0],s=be(r),a=i.step;let u=i.start==null?o:i.start,l=i.stop==null?s:i.stop;a||N("Scale bins parameter missing step property."),u<o&&(u=a*Math.ceil(o/a)),l>s&&(l=a*Math.floor(s/a)),i=Ln(u,l+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===Ev&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function yY(e,t,n){var i=e.type,r=t.round||!1,o=t.range;if(t.rangeStep!=null)o=vY(i,t,n);else if(t.scheme&&(o=bY(i,t,n),fe(o))){if(e.interpolator)return e.interpolator(o);N("Scale type ".concat(i," does not support interpolating color schemes."))}if(o&&AM(i))return e.interpolator(Oh(zb(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate($v(t.interpolate,t.interpolateGamma)):fe(e.round)?e.round(r):fe(e.rangeRound)&&e.interpolate(r?cc:Do),o&&e.range(zb(o,t.reverse))}function vY(e,t,n){e!==xM&&e!==_v&&N("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===_v?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*xv(n,r,i)]}function bY(e,t,n){var i=t.schemeExtent,r,o;return R(t.scheme)?o=Oh(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),o=Mv(r),o||N("Unrecognized scheme name: ".concat(t.scheme))),n=e===Dh?n+1:e===Ev?n-1:e===hu||e===Fh?+t.schemeCount||uY:n,AM(e)?W3(o,i,t.reverse):fe(o)?$M(W3(o,i),n):e===wv?o:o.slice(0,n)}function W3(e,t,n){return fe(e)&&(t||n)?CM(e,zb(t||[0,1],n)):e}function zb(e,t){return t?e.slice().reverse():e}function H3(e){T.call(this,null,e)}q(H3,T,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Os(e.sort)),this.modified(n),t}});const G3="zero",Y3="center",V3="normalize",X3=["y0","y1"];function Bb(e){T.call(this,null,e)}Bb.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:G3,values:[G3,Y3,V3]},{name:"as",type:"string",array:!0,length:2,default:X3}]},q(Bb,T,{transform(e,t){var n=e.as||X3,i=n[0],r=n[1],o=Os(e.sort),s=e.field||qa,a=e.offset===Y3?xY:e.offset===V3?wY:_Y,u,l,c,f;for(u=EY(t.source,e.groupby,o,s),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,s,i,r);return t.reflow(e.modified()).modifies(n)}});function xY(e,t,n,i,r){for(var o=(t-e.sum)/2,s=e.length,a=0,u;a<s;++a)u=e[a],u[i]=o,u[r]=o+=Math.abs(n(u))}function wY(e,t,n,i,r){for(var o=1/e.sum,s=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[i]=s,c[r]=s=o*(l+=Math.abs(n(c)))}function _Y(e,t,n,i,r){for(var o=0,s=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[i]=s,c[r]=s+=l):(c[i]=o,c[r]=o+=l)}function EY(e,t,n,i){var r=[],o=g=>g(c),s,a,u,l,c,f,d,h,p;if(t==null)r.push(e.slice());else for(s={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(o),d=s[f],d||(s[f]=d=[],r.push(d)),d.push(c);for(f=0,p=0,l=r.length;f<l;++f){for(d=r[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(i(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return r.max=p,r}var SY=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:O3,datajoin:N3,encode:R3,legendentries:L3,linkpath:Ib,pie:Pb,scale:j3,sortitems:H3,stack:Bb}),se=1e-6,pp=1e-12,ge=Math.PI,Ze=ge/2,gp=ge/4,nn=ge*2,it=180/ge,me=ge/180,we=Math.abs,Au=Math.atan,ei=Math.atan2,ae=Math.cos,mp=Math.ceil,K3=Math.exp,Ub=Math.hypot,yp=Math.log,jb=Math.pow,ie=Math.sin,ti=Math.sign||function(e){return e>0?1:e<0?-1:0},rn=Math.sqrt,qb=Math.tan;function J3(e){return e>1?0:e<-1?ge:Math.acos(e)}function An(e){return e>1?Ze:e<-1?-Ze:Math.asin(e)}function Dt(){}function vp(e,t){e&&Q3.hasOwnProperty(e.type)&&Q3[e.type](e,t)}var Z3={Feature:function(e,t){vp(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)vp(n[i].geometry,t)}},Q3={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Wb(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Wb(n[i],t,0)},Polygon:function(e,t){eD(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)eD(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)vp(n[i],t)}};function Wb(e,t,n){var i=-1,r=e.length-n,o;for(t.lineStart();++i<r;)o=e[i],t.point(o[0],o[1],o[2]);t.lineEnd()}function eD(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Wb(e[n],t,1);t.polygonEnd()}function Br(e,t){e&&Z3.hasOwnProperty(e.type)?Z3[e.type](e,t):vp(e,t)}var bp=new Qt,xp=new Qt,tD,nD,Hb,Gb,Yb,ir={point:Dt,lineStart:Dt,lineEnd:Dt,polygonStart:function(){bp=new Qt,ir.lineStart=AY,ir.lineEnd=kY},polygonEnd:function(){var e=+bp;xp.add(e<0?nn+e:e),this.lineStart=this.lineEnd=this.point=Dt},sphere:function(){xp.add(nn)}};function AY(){ir.point=CY}function kY(){iD(tD,nD)}function CY(e,t){ir.point=iD,tD=e,nD=t,e*=me,t*=me,Hb=e,Gb=ae(t=t/2+gp),Yb=ie(t)}function iD(e,t){e*=me,t*=me,t=t/2+gp;var n=e-Hb,i=n>=0?1:-1,r=i*n,o=ae(t),s=ie(t),a=Yb*s,u=Gb*o+a*ae(r),l=a*i*ie(r);bp.add(ei(l,u)),Hb=e,Gb=o,Yb=s}function $Y(e){return xp=new Qt,Br(e,ir),xp*2}function wp(e){return[ei(e[1],e[0]),An(e[2])]}function Xs(e){var t=e[0],n=e[1],i=ae(n);return[i*ae(t),i*ie(t),ie(n)]}function _p(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ku(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Vb(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Ep(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Sp(e){var t=rn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Ve,kn,Qe,Bn,Ks,rD,oD,Cu,Rc,Go,Ur,jr={point:Xb,lineStart:aD,lineEnd:uD,polygonStart:function(){jr.point=lD,jr.lineStart=MY,jr.lineEnd=FY,Rc=new Qt,ir.polygonStart()},polygonEnd:function(){ir.polygonEnd(),jr.point=Xb,jr.lineStart=aD,jr.lineEnd=uD,bp<0?(Ve=-(Qe=180),kn=-(Bn=90)):Rc>se?Bn=90:Rc<-se&&(kn=-90),Ur[0]=Ve,Ur[1]=Qe},sphere:function(){Ve=-(Qe=180),kn=-(Bn=90)}};function Xb(e,t){Go.push(Ur=[Ve=e,Qe=e]),t<kn&&(kn=t),t>Bn&&(Bn=t)}function sD(e,t){var n=Xs([e*me,t*me]);if(Cu){var i=ku(Cu,n),r=[i[1],-i[0],0],o=ku(r,i);Sp(o),o=wp(o);var s=e-Ks,a=s>0?1:-1,u=o[0]*it*a,l,c=we(s)>180;c^(a*Ks<u&&u<a*e)?(l=o[1]*it,l>Bn&&(Bn=l)):(u=(u+360)%360-180,c^(a*Ks<u&&u<a*e)?(l=-o[1]*it,l<kn&&(kn=l)):(t<kn&&(kn=t),t>Bn&&(Bn=t))),c?e<Ks?Un(Ve,e)>Un(Ve,Qe)&&(Qe=e):Un(e,Qe)>Un(Ve,Qe)&&(Ve=e):Qe>=Ve?(e<Ve&&(Ve=e),e>Qe&&(Qe=e)):e>Ks?Un(Ve,e)>Un(Ve,Qe)&&(Qe=e):Un(e,Qe)>Un(Ve,Qe)&&(Ve=e)}else Go.push(Ur=[Ve=e,Qe=e]);t<kn&&(kn=t),t>Bn&&(Bn=t),Cu=n,Ks=e}function aD(){jr.point=sD}function uD(){Ur[0]=Ve,Ur[1]=Qe,jr.point=Xb,Cu=null}function lD(e,t){if(Cu){var n=e-Ks;Rc.add(we(n)>180?n+(n>0?360:-360):n)}else rD=e,oD=t;ir.point(e,t),sD(e,t)}function MY(){ir.lineStart()}function FY(){lD(rD,oD),ir.lineEnd(),we(Rc)>se&&(Ve=-(Qe=180)),Ur[0]=Ve,Ur[1]=Qe,Cu=null}function Un(e,t){return(t-=e)<0?t+360:t}function DY(e,t){return e[0]-t[0]}function cD(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function TY(e){var t,n,i,r,o,s,a;if(Bn=Qe=-(Ve=kn=Infinity),Go=[],Br(e,jr),n=Go.length){for(Go.sort(DY),t=1,i=Go[0],o=[i];t<n;++t)r=Go[t],cD(i,r[0])||cD(i,r[1])?(Un(i[0],r[1])>Un(i[0],i[1])&&(i[1]=r[1]),Un(r[0],i[1])>Un(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(s=-Infinity,n=o.length-1,t=0,i=o[n];t<=n;i=r,++t)r=o[t],(a=Un(i[1],r[0]))>s&&(s=a,Ve=r[0],Qe=i[1])}return Go=Ur=null,Ve===Infinity||kn===Infinity?[[NaN,NaN],[NaN,NaN]]:[[Ve,kn],[Qe,Bn]]}var Lc,Ap,kp,Cp,$p,Mp,Fp,Dp,Kb,Jb,Zb,fD,dD,on,sn,an,ki={sphere:Dt,point:Qb,lineStart:hD,lineEnd:pD,polygonStart:function(){ki.lineStart=RY,ki.lineEnd=LY},polygonEnd:function(){ki.lineStart=hD,ki.lineEnd=pD}};function Qb(e,t){e*=me,t*=me;var n=ae(t);Ic(n*ae(e),n*ie(e),ie(t))}function Ic(e,t,n){++Lc,kp+=(e-kp)/Lc,Cp+=(t-Cp)/Lc,$p+=(n-$p)/Lc}function hD(){ki.point=OY}function OY(e,t){e*=me,t*=me;var n=ae(t);on=n*ae(e),sn=n*ie(e),an=ie(t),ki.point=NY,Ic(on,sn,an)}function NY(e,t){e*=me,t*=me;var n=ae(t),i=n*ae(e),r=n*ie(e),o=ie(t),s=ei(rn((s=sn*o-an*r)*s+(s=an*i-on*o)*s+(s=on*r-sn*i)*s),on*i+sn*r+an*o);Ap+=s,Mp+=s*(on+(on=i)),Fp+=s*(sn+(sn=r)),Dp+=s*(an+(an=o)),Ic(on,sn,an)}function pD(){ki.point=Qb}function RY(){ki.point=IY}function LY(){gD(fD,dD),ki.point=Qb}function IY(e,t){fD=e,dD=t,e*=me,t*=me,ki.point=gD;var n=ae(t);on=n*ae(e),sn=n*ie(e),an=ie(t),Ic(on,sn,an)}function gD(e,t){e*=me,t*=me;var n=ae(t),i=n*ae(e),r=n*ie(e),o=ie(t),s=sn*o-an*r,a=an*i-on*o,u=on*r-sn*i,l=Ub(s,a,u),c=An(l),f=l&&-c/l;Kb.add(f*s),Jb.add(f*a),Zb.add(f*u),Ap+=c,Mp+=c*(on+(on=i)),Fp+=c*(sn+(sn=r)),Dp+=c*(an+(an=o)),Ic(on,sn,an)}function PY(e){Lc=Ap=kp=Cp=$p=Mp=Fp=Dp=0,Kb=new Qt,Jb=new Qt,Zb=new Qt,Br(e,ki);var t=+Kb,n=+Jb,i=+Zb,r=Ub(t,n,i);return r<pp&&(t=Mp,n=Fp,i=Dp,Ap<se&&(t=kp,n=Cp,i=$p),r=Ub(t,n,i),r<pp)?[NaN,NaN]:[ei(n,t)*it,An(i/r)*it]}function ex(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function tx(e,t){return[we(e)>ge?e+Math.round(-e/nn)*nn:e,t]}tx.invert=tx;function mD(e,t,n){return(e%=nn)?t||n?ex(vD(e),bD(t,n)):vD(e):t||n?bD(t,n):tx}function yD(e){return function(t,n){return t+=e,[t>ge?t-nn:t<-ge?t+nn:t,n]}}function vD(e){var t=yD(e);return t.invert=yD(-e),t}function bD(e,t){var n=ae(e),i=ie(e),r=ae(t),o=ie(t);function s(a,u){var l=ae(u),c=ae(a)*l,f=ie(a)*l,d=ie(u),h=d*n+c*i;return[ei(f*r-h*o,c*n-d*i),An(h*r+f*o)]}return s.invert=function(a,u){var l=ae(u),c=ae(a)*l,f=ie(a)*l,d=ie(u),h=d*r-f*o;return[ei(f*r+d*o,c*n+h*i),An(h*n-c*i)]},s}function zY(e){e=mD(e[0]*me,e[1]*me,e.length>2?e[2]*me:0);function t(n){return n=e(n[0]*me,n[1]*me),n[0]*=it,n[1]*=it,n}return t.invert=function(n){return n=e.invert(n[0]*me,n[1]*me),n[0]*=it,n[1]*=it,n},t}function BY(e,t,n,i,r,o){if(!!n){var s=ae(t),a=ie(t),u=i*n;r==null?(r=t+i*nn,o=t-u/2):(r=xD(s,r),o=xD(s,o),(i>0?r<o:r>o)&&(r+=i*nn));for(var l,c=r;i>0?c>o:c<o;c-=u)l=wp([s,-a*ae(c),-a*ie(c)]),e.point(l[0],l[1])}}function xD(e,t){t=Xs(t),t[0]-=e,Sp(t);var n=J3(-t[1]);return((-t[2]<0?-n:n)+nn-se)%nn}function wD(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:Dt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Tp(e,t){return we(e[0]-t[0])<se&&we(e[1]-t[1])<se}function Op(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function _D(e,t,n,i,r){var o=[],s=[],a,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],y=p[g],v;if(Tp(m,y)){if(!m[2]&&!y[2]){for(r.lineStart(),a=0;a<g;++a)r.point((m=p[a])[0],m[1]);r.lineEnd();return}y[0]+=2*se}o.push(v=new Op(m,p,null,!0)),s.push(v.o=new Op(m,null,v,!1)),o.push(v=new Op(y,p,null,!1)),s.push(v.o=new Op(y,null,v,!0))}}),!!o.length){for(s.sort(t),ED(o),ED(s),a=0,u=s.length;a<u;++a)s[a].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)r.point((f=c[a])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)r.point((f=c[a])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}}function ED(e){if(!!(t=e.length)){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function nx(e){return we(e[0])<=ge?e[0]:ti(e[0])*((we(e[0])+ge)%nn-ge)}function UY(e,t){var n=nx(t),i=t[1],r=ie(i),o=[ie(n),-ae(n),0],s=0,a=0,u=new Qt;r===1?i=Ze+se:r===-1&&(i=-Ze-se);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],p=nx(h),g=h[1]/2+gp,m=ie(g),y=ae(g),v=0;v<d;++v,p=w,m=S,y=_,h=b){var b=f[v],w=nx(b),E=b[1]/2+gp,S=ie(E),_=ae(E),A=w-p,C=A>=0?1:-1,k=C*A,$=k>ge,F=m*S;if(u.add(ei(F*C*ie(k),y*_+F*ae(k))),s+=$?A+C*nn:A,$^p>=n^w>=n){var D=ku(Xs(h),Xs(b));Sp(D);var L=ku(o,D);Sp(L);var M=($^A>=0?-1:1)*An(L[2]);(i>M||i===M&&(D[0]||D[1]))&&(a+=$^A>=0?1:-1)}}return(s<-se||s<se&&u<-pp)^a&1}function SD(e,t,n,i){return function(r){var o=t(r),s=wD(),a=t(s),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=NA(c);var w=UY(l,i);c.length?(u||(r.polygonStart(),u=!0),_D(c,qY,w,n,r)):w&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(w,E){e(w,E)&&r.point(w,E)}function p(w,E){o.point(w,E)}function g(){d.point=p,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(w,E){f.push([w,E]),a.point(w,E)}function v(){a.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),a.lineEnd();var w=a.clean(),E=s.result(),S,_=E.length,A,C,k;if(f.pop(),l.push(f),f=null,!!_){if(w&1){if(C=E[0],(A=C.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),S=0;S<A;++S)r.point((k=C[S])[0],k[1]);r.lineEnd()}return}_>1&&w&2&&E.push(E.pop().concat(E.shift())),c.push(E.filter(jY))}}return d}}function jY(e){return e.length>1}function qY(e,t){return((e=e.x)[0]<0?e[1]-Ze-se:Ze-e[1])-((t=t.x)[0]<0?t[1]-Ze-se:Ze-t[1])}var AD=SD(function(){return!0},WY,GY,[-ge,-Ze]);function WY(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(o,s){var a=o>0?ge:-ge,u=we(o-t);we(u-ge)<se?(e.point(t,n=(n+s)/2>0?Ze:-Ze),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(o,n),r=0):i!==a&&u>=ge&&(we(t-i)<se&&(t-=i*se),we(o-a)<se&&(o-=a*se),n=HY(t,n,o,s),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=o,n=s),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function HY(e,t,n,i){var r,o,s=ie(e-n);return we(s)>se?Au((ie(t)*(o=ae(i))*ie(n)-ie(i)*(r=ae(t))*ie(e))/(r*o*s)):(t+i)/2}function GY(e,t,n,i){var r;if(e==null)r=n*Ze,i.point(-ge,r),i.point(0,r),i.point(ge,r),i.point(ge,0),i.point(ge,-r),i.point(0,-r),i.point(-ge,-r),i.point(-ge,0),i.point(-ge,r);else if(we(e[0]-t[0])>se){var o=e[0]<t[0]?ge:-ge;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(t[0],t[1])}function YY(e){var t=ae(e),n=6*me,i=t>0,r=we(t)>se;function o(c,f,d,h){BY(h,e,n,d,c,f)}function s(c,f){return ae(c)*ae(f)>t}function a(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,y){var v=[m,y],b,w=s(m,y),E=i?w?0:l(m,y):w?l(m+(m<0?ge:-ge),y):0;if(!f&&(p=h=w)&&c.lineStart(),w!==h&&(b=u(f,v),(!b||Tp(f,b)||Tp(v,b))&&(v[2]=1)),w!==h)g=0,w?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(r&&f&&i^w){var S;!(E&d)&&(S=u(v,f,!0))&&(g=0,i?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}w&&(!f||!Tp(f,v))&&c.point(v[0],v[1]),f=v,h=w,d=E},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=Xs(c),p=Xs(f),g=[1,0,0],m=ku(h,p),y=_p(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var w=t*y/b,E=-t*v/b,S=ku(g,m),_=Ep(g,w),A=Ep(m,E);Vb(_,A);var C=S,k=_p(_,C),$=_p(C,C),F=k*k-$*(_p(_,_)-1);if(!(F<0)){var D=rn(F),L=Ep(C,(-k-D)/$);if(Vb(L,_),L=wp(L),!d)return L;var M=c[0],I=f[0],U=c[1],Y=f[1],Q;I<M&&(Q=M,M=I,I=Q);var ce=I-M,$e=we(ce-ge)<se,De=$e||ce<se;if(!$e&&Y<U&&(Q=U,U=Y,Y=Q),De?$e?U+Y>0^L[1]<(we(L[0]-M)<se?U:Y):U<=L[1]&&L[1]<=Y:ce>ge^(M<=L[0]&&L[0]<=I)){var qe=Ep(C,(-k+D)/$);return Vb(qe,_),[L,wp(qe)]}}}function l(c,f){var d=i?e:ge-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return SD(s,a,o,i?[0,-e]:[-ge,e-ge])}function VY(e,t,n,i,r,o){var s=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-s,h=l-a,p;if(p=n-s,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=r-s,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=i-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=o-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=s+c*d,e[1]=a+c*h),f<1&&(t[0]=s+f*d,t[1]=a+f*h),!0}}}}}var Pc=1e9,Np=-Pc;function kD(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function o(l,c,f,d){var h=0,p=0;if(l==null||(h=s(l,f))!==(p=s(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function s(l,c){return we(l[0]-e)<se?c>0?0:3:we(l[0]-n)<se?c>0?2:1:we(l[1]-t)<se?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=s(l,1),d=s(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=wD(),d,h,p,g,m,y,v,b,w,E,S,_={point:A,lineStart:F,lineEnd:D,polygonStart:k,polygonEnd:$};function A(M,I){r(M,I)&&c.point(M,I)}function C(){for(var M=0,I=0,U=h.length;I<U;++I)for(var Y=h[I],Q=1,ce=Y.length,$e=Y[0],De,qe,Pe=$e[0],mt=$e[1];Q<ce;++Q)De=Pe,qe=mt,$e=Y[Q],Pe=$e[0],mt=$e[1],qe<=i?mt>i&&(Pe-De)*(i-qe)>(mt-qe)*(e-De)&&++M:mt<=i&&(Pe-De)*(i-qe)<(mt-qe)*(e-De)&&--M;return M}function k(){c=f,d=[],h=[],S=!0}function $(){var M=C(),I=S&&M,U=(d=NA(d)).length;(I||U)&&(l.polygonStart(),I&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),U&&_D(d,a,M,o,l),l.polygonEnd()),c=l,d=h=p=null}function F(){_.point=L,h&&h.push(p=[]),E=!0,w=!1,v=b=NaN}function D(){d&&(L(g,m),y&&w&&f.rejoin(),d.push(f.result())),_.point=A,w&&c.lineEnd()}function L(M,I){var U=r(M,I);if(h&&p.push([M,I]),E)g=M,m=I,y=U,E=!1,U&&(c.lineStart(),c.point(M,I));else if(U&&w)c.point(M,I);else{var Y=[v=Math.max(Np,Math.min(Pc,v)),b=Math.max(Np,Math.min(Pc,b))],Q=[M=Math.max(Np,Math.min(Pc,M)),I=Math.max(Np,Math.min(Pc,I))];VY(Y,Q,e,t,n,i)?(w||(c.lineStart(),c.point(Y[0],Y[1])),c.point(Q[0],Q[1]),U||c.lineEnd(),S=!1):U&&(c.lineStart(),c.point(M,I),S=!1)}v=M,b=I,w=U}return _}}function CD(e,t,n){var i=Ln(e,t-se,n).concat(t);return function(r){return i.map(function(o){return[r,o]})}}function $D(e,t,n){var i=Ln(e,t-se,n).concat(t);return function(r){return i.map(function(o){return[o,r]})}}function XY(){var e,t,n,i,r,o,s,a,u=10,l=u,c=90,f=360,d,h,p,g,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return Ln(mp(i/c)*c,n,c).map(p).concat(Ln(mp(a/f)*f,s,f).map(g)).concat(Ln(mp(t/u)*u,e,u).filter(function(b){return we(b%c)>se}).map(d)).concat(Ln(mp(o/l)*l,r,l).filter(function(b){return we(b%f)>se}).map(h))}return y.lines=function(){return v().map(function(b){return{type:"LineString",coordinates:b}})},y.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(g(s).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},y.extent=function(b){return arguments.length?y.extentMajor(b).extentMinor(b):y.extentMinor()},y.extentMajor=function(b){return arguments.length?(i=+b[0][0],n=+b[1][0],a=+b[0][1],s=+b[1][1],i>n&&(b=i,i=n,n=b),a>s&&(b=a,a=s,s=b),y.precision(m)):[[i,a],[n,s]]},y.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],o=+b[0][1],r=+b[1][1],t>e&&(b=t,t=e,e=b),o>r&&(b=o,o=r,r=b),y.precision(m)):[[t,o],[e,r]]},y.step=function(b){return arguments.length?y.stepMajor(b).stepMinor(b):y.stepMinor()},y.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],y):[c,f]},y.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],y):[u,l]},y.precision=function(b){return arguments.length?(m=+b,d=CD(o,r,90),h=$D(t,e,m),p=CD(a,s,90),g=$D(i,n,m),y):m},y.extentMajor([[-180,-90+se],[180,90-se]]).extentMinor([[-180,-80-se],[180,80+se]])}var zc=e=>e,ix=new Qt,rx=new Qt,MD,FD,ox,sx,qr={point:Dt,lineStart:Dt,lineEnd:Dt,polygonStart:function(){qr.lineStart=KY,qr.lineEnd=ZY},polygonEnd:function(){qr.lineStart=qr.lineEnd=qr.point=Dt,ix.add(we(rx)),rx=new Qt},result:function(){var e=ix/2;return ix=new Qt,e}};function KY(){qr.point=JY}function JY(e,t){qr.point=DD,MD=ox=e,FD=sx=t}function DD(e,t){rx.add(sx*e-ox*t),ox=e,sx=t}function ZY(){DD(MD,FD)}var $u=Infinity,Rp=$u,Bc=-$u,Lp=Bc,Ip={point:QY,lineStart:Dt,lineEnd:Dt,polygonStart:Dt,polygonEnd:Dt,result:function(){var e=[[$u,Rp],[Bc,Lp]];return Bc=Lp=-(Rp=$u=Infinity),e}};function QY(e,t){e<$u&&($u=e),e>Bc&&(Bc=e),t<Rp&&(Rp=t),t>Lp&&(Lp=t)}var ax=0,ux=0,Uc=0,Pp=0,zp=0,Mu=0,lx=0,cx=0,jc=0,TD,OD,rr,or,ni={point:Js,lineStart:ND,lineEnd:RD,polygonStart:function(){ni.lineStart=nV,ni.lineEnd=iV},polygonEnd:function(){ni.point=Js,ni.lineStart=ND,ni.lineEnd=RD},result:function(){var e=jc?[lx/jc,cx/jc]:Mu?[Pp/Mu,zp/Mu]:Uc?[ax/Uc,ux/Uc]:[NaN,NaN];return ax=ux=Uc=Pp=zp=Mu=lx=cx=jc=0,e}};function Js(e,t){ax+=e,ux+=t,++Uc}function ND(){ni.point=eV}function eV(e,t){ni.point=tV,Js(rr=e,or=t)}function tV(e,t){var n=e-rr,i=t-or,r=rn(n*n+i*i);Pp+=r*(rr+e)/2,zp+=r*(or+t)/2,Mu+=r,Js(rr=e,or=t)}function RD(){ni.point=Js}function nV(){ni.point=rV}function iV(){LD(TD,OD)}function rV(e,t){ni.point=LD,Js(TD=rr=e,OD=or=t)}function LD(e,t){var n=e-rr,i=t-or,r=rn(n*n+i*i);Pp+=r*(rr+e)/2,zp+=r*(or+t)/2,Mu+=r,r=or*e-rr*t,lx+=r*(rr+e),cx+=r*(or+t),jc+=r*3,Js(rr=e,or=t)}function ID(e){this._context=e}ID.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,nn);break}}},result:Dt};var fx=new Qt,dx,PD,zD,qc,Wc,Hc={point:Dt,lineStart:function(){Hc.point=oV},lineEnd:function(){dx&&BD(PD,zD),Hc.point=Dt},polygonStart:function(){dx=!0},polygonEnd:function(){dx=null},result:function(){var e=+fx;return fx=new Qt,e}};function oV(e,t){Hc.point=BD,PD=qc=e,zD=Wc=t}function BD(e,t){qc-=e,Wc-=t,fx.add(rn(qc*qc+Wc*Wc)),qc=e,Wc=t}function UD(){this._string=[]}UD.prototype={_radius:4.5,_circle:jD(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=jD(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function jD(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function qD(e,t){var n=4.5,i,r;function o(s){return s&&(typeof n=="function"&&r.pointRadius(+n.apply(this,arguments)),Br(s,i(r))),r.result()}return o.area=function(s){return Br(s,i(qr)),qr.result()},o.measure=function(s){return Br(s,i(Hc)),Hc.result()},o.bounds=function(s){return Br(s,i(Ip)),Ip.result()},o.centroid=function(s){return Br(s,i(ni)),ni.result()},o.projection=function(s){return arguments.length?(i=s==null?(e=null,zc):(e=s).stream,o):e},o.context=function(s){return arguments.length?(r=s==null?(t=null,new UD):new ID(t=s),typeof n!="function"&&r.pointRadius(n),o):t},o.pointRadius=function(s){return arguments.length?(n=typeof s=="function"?s:(r.pointRadius(+s),+s),o):n},o.projection(e).context(t)}function Bp(e){return function(t){var n=new hx;for(var i in e)n[i]=e[i];return n.stream=t,n}}function hx(){}hx.prototype={constructor:hx,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function px(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),Br(n,e.stream(Ip)),t(Ip.result()),i!=null&&e.clipExtent(i),e}function Up(e,t,n){return px(e,function(i){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(r/(i[1][0]-i[0][0]),o/(i[1][1]-i[0][1])),a=+t[0][0]+(r-s*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(o-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([a,u])},n)}function gx(e,t,n){return Up(e,[[0,0],t],n)}function mx(e,t,n){return px(e,function(i){var r=+t,o=r/(i[1][0]-i[0][0]),s=(r-o*(i[1][0]+i[0][0]))/2,a=-o*i[0][1];e.scale(150*o).translate([s,a])},n)}function yx(e,t,n){return px(e,function(i){var r=+t,o=r/(i[1][1]-i[0][1]),s=-o*i[0][0],a=(r-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([s,a])},n)}var WD=16,sV=ae(30*me);function HD(e,t){return+t?uV(e,t):aV(e)}function aV(e){return Bp({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function uV(e,t){function n(i,r,o,s,a,u,l,c,f,d,h,p,g,m){var y=l-i,v=c-r,b=y*y+v*v;if(b>4*t&&g--){var w=s+d,E=a+h,S=u+p,_=rn(w*w+E*E+S*S),A=An(S/=_),C=we(we(S)-1)<se||we(o-f)<se?(o+f)/2:ei(E,w),k=e(C,A),$=k[0],F=k[1],D=$-i,L=F-r,M=v*D-y*L;(M*M/b>t||we((y*D+v*L)/b-.5)>.3||s*d+a*h+u*p<sV)&&(n(i,r,o,s,a,u,$,F,C,w/=_,E/=_,S,g,m),m.point($,F),n($,F,C,w,E,S,l,c,f,d,h,p,g,m))}}return function(i){var r,o,s,a,u,l,c,f,d,h,p,g,m={point:y,lineStart:v,lineEnd:w,polygonStart:function(){i.polygonStart(),m.lineStart=E},polygonEnd:function(){i.polygonEnd(),m.lineStart=v}};function y(A,C){A=e(A,C),i.point(A[0],A[1])}function v(){f=NaN,m.point=b,i.lineStart()}function b(A,C){var k=Xs([A,C]),$=e(A,C);n(f,d,c,h,p,g,f=$[0],d=$[1],c=A,h=k[0],p=k[1],g=k[2],WD,i),i.point(f,d)}function w(){m.point=y,i.lineEnd()}function E(){v(),m.point=S,m.lineEnd=_}function S(A,C){b(r=A,C),o=f,s=d,a=h,u=p,l=g,m.point=b}function _(){n(f,d,c,h,p,g,o,s,r,a,u,l,WD,i),m.lineEnd=w,w()}return m}}var lV=Bp({point:function(e,t){this.stream.point(e*me,t*me)}});function cV(e){return Bp({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function fV(e,t,n,i,r){function o(s,a){return s*=i,a*=r,[t+e*s,n-e*a]}return o.invert=function(s,a){return[(s-t)/e*i,(n-a)/e*r]},o}function GD(e,t,n,i,r,o){if(!o)return fV(e,t,n,i,r);var s=ae(o),a=ie(o),u=s*e,l=a*e,c=s/e,f=a/e,d=(a*n-s*t)/e,h=(a*t+s*n)/e;function p(g,m){return g*=i,m*=r,[u*g-l*m+t,n-l*g-u*m]}return p.invert=function(g,m){return[i*(c*g-f*m+d),r*(h-f*g-c*m)]},p}function sr(e){return YD(function(){return e})()}function YD(e){var t,n=150,i=480,r=250,o=0,s=0,a=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=AD,m=null,y,v,b,w=zc,E=.5,S,_,A,C,k;function $(M){return A(M[0]*me,M[1]*me)}function F(M){return M=A.invert(M[0],M[1]),M&&[M[0]*it,M[1]*it]}$.stream=function(M){return C&&k===M?C:C=lV(cV(c)(g(S(w(k=M)))))},$.preclip=function(M){return arguments.length?(g=M,p=void 0,L()):g},$.postclip=function(M){return arguments.length?(w=M,m=y=v=b=null,L()):w},$.clipAngle=function(M){return arguments.length?(g=+M?YY(p=M*me):(p=null,AD),L()):p*it},$.clipExtent=function(M){return arguments.length?(w=M==null?(m=y=v=b=null,zc):kD(m=+M[0][0],y=+M[0][1],v=+M[1][0],b=+M[1][1]),L()):m==null?null:[[m,y],[v,b]]},$.scale=function(M){return arguments.length?(n=+M,D()):n},$.translate=function(M){return arguments.length?(i=+M[0],r=+M[1],D()):[i,r]},$.center=function(M){return arguments.length?(o=M[0]%360*me,s=M[1]%360*me,D()):[o*it,s*it]},$.rotate=function(M){return arguments.length?(a=M[0]%360*me,u=M[1]%360*me,l=M.length>2?M[2]%360*me:0,D()):[a*it,u*it,l*it]},$.angle=function(M){return arguments.length?(f=M%360*me,D()):f*it},$.reflectX=function(M){return arguments.length?(d=M?-1:1,D()):d<0},$.reflectY=function(M){return arguments.length?(h=M?-1:1,D()):h<0},$.precision=function(M){return arguments.length?(S=HD(_,E=M*M),L()):rn(E)},$.fitExtent=function(M,I){return Up($,M,I)},$.fitSize=function(M,I){return gx($,M,I)},$.fitWidth=function(M,I){return mx($,M,I)},$.fitHeight=function(M,I){return yx($,M,I)};function D(){var M=GD(n,0,0,d,h,f).apply(null,t(o,s)),I=GD(n,i-M[0],r-M[1],d,h,f);return c=mD(a,u,l),_=ex(t,I),A=ex(c,_),S=HD(_,E),L()}function L(){return C=k=null,$}return function(){return t=e.apply(this,arguments),$.invert=t.invert&&F,D()}}function vx(e){var t=0,n=ge/3,i=YD(e),r=i(t,n);return r.parallels=function(o){return arguments.length?i(t=o[0]*me,n=o[1]*me):[t*it,n*it]},r}function dV(e){var t=ae(e);function n(i,r){return[i*t,ie(r)/t]}return n.invert=function(i,r){return[i/t,An(r*t)]},n}function hV(e,t){var n=ie(e),i=(n+ie(t))/2;if(we(i)<se)return dV(e);var r=1+n*(2*i-n),o=rn(r)/i;function s(a,u){var l=rn(r-2*i*ie(u))/i;return[l*ie(a*=i),o-l*ae(a)]}return s.invert=function(a,u){var l=o-u,c=ei(a,we(l))*ti(l);return l*i<0&&(c-=ge*ti(a)*ti(l)),[c/i,An((r-(a*a+l*l)*i*i)/(2*i))]},s}function jp(){return vx(hV).scale(155.424).center([0,33.6442])}function VD(){return jp().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function pV(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function gV(){var e,t,n=VD(),i,r=jp().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=jp().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,i.point(h,p),u||(o.point(h,p),u)||(a.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?r:m>=.166&&m<.234&&g>=-.214&&g<-.115?s:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=pV([n.stream(t=d),r.stream(d),s.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),s.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(d*.35),s.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return i=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),o=r.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+se,g+.12*h+se],[p-.214*h-se,g+.234*h-se]]).stream(l),a=s.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+se,g+.166*h+se],[p-.115*h-se,g+.234*h-se]]).stream(l),f()},c.fitExtent=function(d,h){return Up(c,d,h)},c.fitSize=function(d,h){return gx(c,d,h)},c.fitWidth=function(d,h){return mx(c,d,h)},c.fitHeight=function(d,h){return yx(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function XD(e){return function(t,n){var i=ae(t),r=ae(n),o=e(i*r);return o===Infinity?[2,0]:[o*r*ie(t),o*ie(n)]}}function Gc(e){return function(t,n){var i=rn(t*t+n*n),r=e(i),o=ie(r),s=ae(r);return[ei(t*o,i*s),An(i&&n*o/i)]}}var KD=XD(function(e){return rn(2/(1+e))});KD.invert=Gc(function(e){return 2*An(e/2)});function mV(){return sr(KD).scale(124.75).clipAngle(180-.001)}var JD=XD(function(e){return(e=J3(e))&&e/ie(e)});JD.invert=Gc(function(e){return e});function yV(){return sr(JD).scale(79.4188).clipAngle(180-.001)}function qp(e,t){return[e,yp(qb((Ze+t)/2))]}qp.invert=function(e,t){return[e,2*Au(K3(t))-Ze]};function vV(){return ZD(qp).scale(961/nn)}function ZD(e){var t=sr(e),n=t.center,i=t.scale,r=t.translate,o=t.clipExtent,s=null,a,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?s=a=u=l=null:(s=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):s==null?null:[[s,a],[u,l]]};function c(){var f=ge*i(),d=t(zY(t.rotate()).invert([0,0]));return o(s==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===qp?[[Math.max(d[0]-f,s),a],[Math.min(d[0]+f,u),l]]:[[s,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function Wp(e){return qb((Ze+e)/2)}function bV(e,t){var n=ae(e),i=e===t?ie(e):yp(n/ae(t))/yp(Wp(t)/Wp(e)),r=n*jb(Wp(e),i)/i;if(!i)return qp;function o(s,a){r>0?a<-Ze+se&&(a=-Ze+se):a>Ze-se&&(a=Ze-se);var u=r/jb(Wp(a),i);return[u*ie(i*s),r-u*ae(i*s)]}return o.invert=function(s,a){var u=r-a,l=ti(i)*rn(s*s+u*u),c=ei(s,we(u))*ti(u);return u*i<0&&(c-=ge*ti(s)*ti(u)),[c/i,2*Au(jb(r/l,1/i))-Ze]},o}function xV(){return vx(bV).scale(109.5).parallels([30,30])}function Hp(e,t){return[e,t]}Hp.invert=Hp;function wV(){return sr(Hp).scale(152.63)}function _V(e,t){var n=ae(e),i=e===t?ie(e):(n-ae(t))/(t-e),r=n/i+e;if(we(i)<se)return Hp;function o(s,a){var u=r-a,l=i*s;return[u*ie(l),r-u*ae(l)]}return o.invert=function(s,a){var u=r-a,l=ei(s,we(u))*ti(u);return u*i<0&&(l-=ge*ti(s)*ti(u)),[l/i,r-ti(i)*rn(s*s+u*u)]},o}function EV(){return vx(_V).scale(131.154).center([0,13.9389])}var Yc=1.340264,Vc=-.081106,Xc=893e-6,Kc=.003796,Gp=rn(3)/2,SV=12;function QD(e,t){var n=An(Gp*ie(t)),i=n*n,r=i*i*i;return[e*ae(n)/(Gp*(Yc+3*Vc*i+r*(7*Xc+9*Kc*i))),n*(Yc+Vc*i+r*(Xc+Kc*i))]}QD.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,o=0,s,a,u;o<SV&&(a=n*(Yc+Vc*i+r*(Xc+Kc*i))-t,u=Yc+3*Vc*i+r*(7*Xc+9*Kc*i),n-=s=a/u,i=n*n,r=i*i*i,!(we(s)<pp));++o);return[Gp*e*(Yc+3*Vc*i+r*(7*Xc+9*Kc*i))/ae(n),An(ie(n)/Gp)]};function AV(){return sr(QD).scale(177.158)}function eT(e,t){var n=ae(t),i=ae(e)*n;return[n*ie(e)/i,ie(t)/i]}eT.invert=Gc(Au);function kV(){return sr(eT).scale(144.049).clipAngle(60)}function CV(){var e=1,t=0,n=0,i=1,r=1,o=0,s,a,u=null,l,c,f,d=1,h=1,p=Bp({point:function(w,E){var S=b([w,E]);this.stream.point(S[0],S[1])}}),g=zc,m,y;function v(){return d=e*i,h=e*r,m=y=null,b}function b(w){var E=w[0]*d,S=w[1]*h;if(o){var _=S*s-E*a;E=E*s+S*a,S=_}return[E+t,S+n]}return b.invert=function(w){var E=w[0]-t,S=w[1]-n;if(o){var _=S*s+E*a;E=E*s-S*a,S=_}return[E/d,S/h]},b.stream=function(w){return m&&y===w?m:m=p(g(y=w))},b.postclip=function(w){return arguments.length?(g=w,u=l=c=f=null,v()):g},b.clipExtent=function(w){return arguments.length?(g=w==null?(u=l=c=f=null,zc):kD(u=+w[0][0],l=+w[0][1],c=+w[1][0],f=+w[1][1]),v()):u==null?null:[[u,l],[c,f]]},b.scale=function(w){return arguments.length?(e=+w,v()):e},b.translate=function(w){return arguments.length?(t=+w[0],n=+w[1],v()):[t,n]},b.angle=function(w){return arguments.length?(o=w%360*me,a=ie(o),s=ae(o),v()):o*it},b.reflectX=function(w){return arguments.length?(i=w?-1:1,v()):i<0},b.reflectY=function(w){return arguments.length?(r=w?-1:1,v()):r<0},b.fitExtent=function(w,E){return Up(b,w,E)},b.fitSize=function(w,E){return gx(b,w,E)},b.fitWidth=function(w,E){return mx(b,w,E)},b.fitHeight=function(w,E){return yx(b,w,E)},b}function tT(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}tT.invert=function(e,t){var n=t,i=25,r;do{var o=n*n,s=o*o;n-=r=(n*(1.007226+o*(.015085+s*(-.044475+.028874*o-.005916*s)))-t)/(1.007226+o*(.015085*3+s*(-.044475*7+.028874*9*o-.005916*11*s)))}while(we(r)>se&&--i>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function $V(){return sr(tT).scale(175.295)}function nT(e,t){return[ae(t)*ie(e),ie(t)]}nT.invert=Gc(An);function MV(){return sr(nT).scale(249.5).clipAngle(90+se)}function iT(e,t){var n=ae(t),i=1+ae(e)*n;return[n*ie(e)/i,ie(t)/i]}iT.invert=Gc(function(e){return 2*Au(e)});function FV(){return sr(iT).scale(250).clipAngle(142)}function rT(e,t){return[yp(qb((Ze+t)/2)),-e]}rT.invert=function(e,t){return[-t,2*Au(K3(e))-Ze]};function DV(){var e=ZD(rT),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var TV=Math.abs,bx=Math.cos,Yp=Math.sin,OV=1e-6,oT=Math.PI,xx=oT/2,sT=NV(2);function aT(e){return e>1?xx:e<-1?-xx:Math.asin(e)}function NV(e){return e>0?Math.sqrt(e):0}function RV(e,t){var n=e*Yp(t),i=30,r;do t-=r=(t+Yp(t)-n)/(1+bx(t));while(TV(r)>OV&&--i>0);return t/2}function LV(e,t,n){function i(r,o){return[e*r*bx(o=RV(n,o)),t*Yp(o)]}return i.invert=function(r,o){return o=aT(o/t),[r/(e*bx(o)),aT((2*o+Yp(2*o))/n)]},i}var IV=LV(sT/xx,sT,oT);function PV(){return sr(IV).scale(169.529)}const zV=qD(),wx=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function BV(e,t){return function n(){const i=t();return i.type=e,i.path=qD().projection(i),i.copy=i.copy||function(){const r=n();return wx.forEach(o=>{i[o]&&r[o](i[o]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function _x(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Vp[e]=BV(e,t),this):Vp[e]||null}function uT(e){return e&&e.path||zV}const Vp={albers:VD,albersusa:gV,azimuthalequalarea:mV,azimuthalequidistant:yV,conicconformal:xV,conicequalarea:jp,conicequidistant:EV,equalEarth:AV,equirectangular:wV,gnomonic:kV,identity:CV,mercator:vV,mollweide:PV,naturalEarth1:$V,orthographic:MV,stereographic:FV,transversemercator:DV};for(const e in Vp)_x(e,Vp[e]);function UV(){}const Wr=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function lT(){var e=1,t=1,n=a;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),jV(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(qV((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=new Array,d=new Array,h,p,g,m,y,v;for(h=p=-1,m=u[0]>=l,Wr[m<<1].forEach(b);++h<e-1;)g=m,m=u[h+1]>=l,Wr[g|m<<1].forEach(b);for(Wr[m<<0].forEach(b);++p<t-1;){for(h=-1,m=u[p*e+e]>=l,y=u[p*e]>=l,Wr[m<<1|y<<2].forEach(b);++h<e-1;)g=m,m=u[p*e+e+h+1]>=l,v=y,y=u[p*e+h+1]>=l,Wr[g|m<<1|y<<2|v<<3].forEach(b);Wr[m|y<<3].forEach(b)}for(h=-1,y=u[p*e]>=l,Wr[y<<2].forEach(b);++h<e-1;)v=y,y=u[p*e+h+1]>=l,Wr[y<<2|v<<3].forEach(b);Wr[y<<3].forEach(b);function b(w){var E=[w[0][0]+h,w[0][1]+p],S=[w[1][0]+h,w[1][1]+p],_=s(E),A=s(S),C,k;(C=d[_])?(k=f[A])?(delete d[C.end],delete f[k.start],C===k?(C.ring.push(S),c(C.ring)):f[C.start]=d[k.end]={start:C.start,end:k.end,ring:C.ring.concat(k.ring)}):(delete d[C.end],C.ring.push(S),d[C.end=A]=C):(C=f[A])?(k=d[_])?(delete f[C.start],delete d[k.end],C===k?(C.ring.push(S),c(C.ring)):f[k.start]=d[C.end]={start:k.start,end:C.end,ring:k.ring.concat(C.ring)}):(delete f[C.start],C.ring.unshift(E),f[C.start=_]=C):f[_]=d[A]={start:_,end:A,ring:[E,S]}}}function s(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,y=l[g*e+p];d>0&&d<e&&p===d&&(m=l[g*e+p-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&g===h&&(m=l[(g-1)*e+p],f[1]=h+(c-m)/(y-m)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||N("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?a:UV,i):n===a},i}function jV(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function qV(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=WV(e,t[n]))return r;return 0}function WV(e,t){for(var n=t[0],i=t[1],r=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var u=e[o],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(HV(u,f,t))return 0;c>i!=h>i&&n<(d-l)*(i-c)/(h-c)+l&&(r=-r)}return r}function HV(e,t,n){var i;return GV(e,t,n)&&YV(e[i=+(e[0]===t[0])],n[i],t[i])}function GV(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function YV(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function cT(e,t,n){return function(i){var r=qi(i),o=n?Math.min(r[0],0):r[0],s=r[1],a=s-o,u=t?bo(o,s,e):a/(e+1);return Ln(o+u,s,u)}}function Ex(e){T.call(this,null,e)}Ex.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},q(Ex,T,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||It,o=lT().smooth(e.smooth!==!1),s=e.thresholds||VV(i,r,e),a=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=o.size([c.width,c.height])(c.values,R(s)?s:s(c.values));XV(f,c,l,e),f.forEach(d=>{u.push(Jd(l,Ce(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function VV(e,t,n){const i=cT(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>$s(t(r).values)))}function XV(e,t,n,i){let r=i.scale||t.scale,o=i.translate||t.translate;if(fe(r)&&(r=r(n,i)),fe(o)&&(o=o(n,i)),(r===1||r==null)&&!o)return;const s=(Oe(r)?r:r[0])||1,a=(Oe(r)?r:r[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(fT(t,s,a,u,l))}function fT(e,t,n,i,r){const o=e.x1||0,s=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+i,f[1]=(f[1]-s)*n+r}return function(f){return f.coordinates.forEach(u),f}}function dT(e,t,n){const i=e>=0?e:V1(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function Sx(e){return fe(e)?e:zt(+e)}function hT(){var e=u=>u[0],t=u=>u[1],n=qa,i=[-1,-1],r=960,o=500,s=2;function a(u,l){const c=dT(i[0],u,e)>>s,f=dT(i[1],u,t)>>s,d=c?c+2:0,h=f?f+2:0,p=2*d+(r>>s),g=2*h+(o>>s),m=new Float32Array(p*g),y=new Float32Array(p*g);let v=m;u.forEach(w=>{const E=d+(+e(w)>>s),S=h+(+t(w)>>s);E>=0&&E<p&&S>=0&&S<g&&(m[E+S*p]+=+n(w))}),c>0&&f>0?(Fu(p,g,m,y,c),Du(p,g,y,m,f),Fu(p,g,m,y,c),Du(p,g,y,m,f),Fu(p,g,m,y,c),Du(p,g,y,m,f)):c>0?(Fu(p,g,m,y,c),Fu(p,g,y,m,c),Fu(p,g,m,y,c),v=y):f>0&&(Du(p,g,m,y,f),Du(p,g,y,m,f),Du(p,g,m,y,f),v=y);const b=l?Math.pow(2,-2*s):1/RA(v);for(let w=0,E=p*g;w<E;++w)v[w]*=b;return{values:v,scale:1<<s,width:p,height:g,x1:d,y1:h,x2:d+(r>>s),y2:h+(o>>s)}}return a.x=function(u){return arguments.length?(e=Sx(u),a):e},a.y=function(u){return arguments.length?(t=Sx(u),a):t},a.weight=function(u){return arguments.length?(n=Sx(u),a):n},a.size=function(u){if(!arguments.length)return[r,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||N("invalid size"),r=l,o=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||N("invalid cell size"),s=Math.floor(Math.log(u)/Math.LN2),a):1<<s},a.bandwidth=function(u){return arguments.length?(u=K(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&N("invalid bandwidth"),i=u,a):i},a}function Fu(e,t,n,i,r){const o=(r<<1)+1;for(let s=0;s<t;++s)for(let a=0,u=0;a<e+r;++a)a<e&&(u+=n[a+s*e]),a>=r&&(a>=o&&(u-=n[a-o+s*e]),i[a-r+s*e]=u/Math.min(a+1,e-1+o-a,o))}function Du(e,t,n,i,r){const o=(r<<1)+1;for(let s=0;s<e;++s)for(let a=0,u=0;a<t+r;++a)a<t&&(u+=n[s+a*e]),a>=r&&(a>=o&&(u-=n[s+(a-o)*e]),i[s+(a-r)*e]=u/Math.min(a+1,t-1+o-a,o))}function Ax(e){T.call(this,null,e)}Ax.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const KV=["x","y","weight","size","cellSize","bandwidth"];function pT(e,t){return KV.forEach(n=>t[n]!=null?e[n](t[n]):0),e}q(Ax,T,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=JV(i,e.groupby),o=(e.groupby||[]).map(Je),s=pT(hT(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=r.map(c=>Ce(l({[a]:s(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function JV(e,t){var n=[],i=c=>c(a),r,o,s,a,u,l;if(t==null)n.push(e);else for(r={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function kx(e){T.call(this,null,e)}kx.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},q(kx,T,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=lT().smooth(e.smooth!==!1),r=e.values,o=e.thresholds||cT(e.count||10,e.nice,!!r),s=e.size,a,u;return r||(r=t.materialize(t.SOURCE).source,a=pT(hT(),e)(r,!0),u=fT(a,a.scale||1,a.scale||1,0,0),s=[a.width,a.height],r=a.values),o=R(o)?o:o(r),r=i.size(s)(r,o),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Ce),n}});const Cx="Feature",$x="FeatureCollection",ZV="MultiPoint";function Mx(e){T.call(this,null,e)}Mx.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},q(Mx,T,{transform(e,t){var n=this._features,i=this._points,r=e.fields,o=r&&r[0],s=r&&r[1],a=e.geojson||!r&&It,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Lt(a))||o&&t.modified(Lt(o))||s&&t.modified(Lt(s)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(u,c=>n.push(a(c))),o&&s&&(t.visit(u,c=>{var f=o(c),d=s(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:Cx,geometry:{type:ZV,coordinates:i}})),this.value={type:$x,features:n}}});function Fx(e){T.call(this,null,e)}Fx.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},q(Fx,T,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||It,o=e.as||"path",s=n.SOURCE;!i||e.modified()?(this.value=i=uT(e.projection),n.materialize().reflow()):s=r===It||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=QV(i,e.pointRadius);return n.visit(s,u=>u[o]=i(r(u))),i.pointRadius(a),n.modifies(o)}});function QV(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function Dx(e){T.call(this,null,e)}Dx.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},q(Dx,T,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],o=e.as||["x","y"],s=o[0],a=o[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[s]=f[0],c[a]=f[1]):(c[s]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function Tx(e){T.call(this,null,e)}Tx.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},q(Tx,T,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",o=n.ADD;return(!i||e.modified())&&(this.value=i=eX(uT(e.projection),e.field||bn("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,s=>s[r]=i),n.modifies(r)}});function eX(e,t,n){const i=n==null?r=>e(t(r)):r=>{var o=e.pointRadius(),s=e.pointRadius(n)(t(r));return e.pointRadius(o),s};return i.context=r=>(e.context(r),i),i}function Ox(e){T.call(this,[],e),this.generator=XY()}Ox.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},q(Ox,T,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const o in e)fe(i[o])&&i[o](e[o]);return r=i(),n.length?t.mod.push(qk(n[0],r)):t.add.push(Ce(r)),n[0]=r,t}});function Nx(e){T.call(this,null,e)}Nx.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},q(Nx,T,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||It,o=nX(e.opacity,e),s=tX(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?$s(n.map(l=>$s(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=de({},l,u);i||(f.$max=$s(c.values||[])),l[a]=iX(c,f,s.dep?s:zt(s(f)),o.dep?o:zt(o(f)))}),t.reflow(!0).modifies(a)}});function tX(e,t){let n;return fe(e)?(n=i=>Fo(e(i,t)),n.dep=gT(e)):n=zt(Fo(e||"#888")),n}function nX(e,t){let n;return fe(e)?(n=i=>e(i,t),n.dep=gT(e)):e?n=zt(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function gT(e){if(!fe(e))return!1;const t=vt(Lt(e));return t.$x||t.$y||t.$value||t.$max}function iX(e,t,n,i){const r=e.width,o=e.height,s=e.x1||0,a=e.y1||0,u=e.x2||r,l=e.y2||o,c=e.values,f=c?m=>c[m]:ho,d=su(u-s,l-a),h=d.getContext("2d"),p=h.getImageData(0,0,u-s,l-a),g=p.data;for(let m=a,y=0;m<l;++m){t.$y=m-a;for(let v=s,b=m*r;v<u;++v,y+=4){t.$x=v-s,t.$value=f(v+b);const w=n(t);g[y+0]=w.r,g[y+1]=w.g,g[y+2]=w.b,g[y+3]=~~(255*i(t))}}return h.putImageData(p,0,0),d}function mT(e){T.call(this,null,e),this.modified(!0)}q(mT,T,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=oX(e.type),wx.forEach(i=>{e[i]!=null&&yT(n,i,e[i])})):wx.forEach(i=>{e.modified(i)&&yT(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&rX(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function rX(e,t){const n=sX(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function oX(e){const t=_x((e||"mercator").toLowerCase());return t||N("Unrecognized projection type: "+e),t()}function yT(e,t,n){fe(e[t])&&e[t](n)}function sX(e){return e=K(e),e.length===1?e[0]:{type:$x,features:e.reduce((t,n)=>t.concat(aX(n)),[])}}function aX(e){return e.type===$x?e.features:K(e).filter(t=>t!=null).map(t=>t.type===Cx?t:{type:Cx,geometry:t})}var uX=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:kx,geojson:Mx,geopath:Fx,geopoint:Dx,geoshape:Tx,graticule:Ox,heatmap:Nx,isocontour:Ex,kde2d:Ax,projection:mT});function lX(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var o,s=n.length,a,u=0,l=0;for(o=0;o<s;++o)a=n[o],u+=a.x,l+=a.y;for(u=(u/s-e)*i,l=(l/s-t)*i,o=0;o<s;++o)a=n[o],a.x-=u,a.y-=l}return r.initialize=function(o){n=o},r.x=function(o){return arguments.length?(e=+o,r):e},r.y=function(o){return arguments.length?(t=+o,r):t},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function cX(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return vT(this.cover(t,n),t,n,e)}function vT(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,o=e._root,s={data:i},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,m,y,v;if(!o)return e._root=s,e;for(;o.length;)if((g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,r=o,!(o=o[y=m<<1|g]))return r[y]=s,e;if(h=+e._x.call(null,o.data),p=+e._y.call(null,o.data),t===h&&n===p)return s.next=o,r?r[y]=s:e._root=s,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|g)==(v=(p>=d)<<1|h>=f));return r[v]=o,r[y]=s,e}function fX(e){var t,n,i=e.length,r,o,s=new Array(i),a=new Array(i),u=Infinity,l=Infinity,c=-Infinity,f=-Infinity;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=r,a[n]=o,r<u&&(u=r),r>c&&(c=r),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)vT(this,s[n],a[n],e[n]);return this}function dX(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1;else{for(var s=r-n||1,a=this._root,u,l;n>e||e>=r||i>t||t>=o;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=a,a=u,s*=2,l){case 0:r=n+s,o=i+s;break;case 1:n=r-s,o=i+s;break;case 2:r=n+s,i=o-s;break;case 3:n=r-s,i=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this}function hX(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function pX(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function un(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function gX(e,t,n){var i,r=this._x0,o=this._y0,s,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new un(h,r,o,c,f)),n==null?n=Infinity:(r=e-n,o=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(s=p.x0)>c||(a=p.y0)>f||(u=p.x1)<r||(l=p.y1)<o))if(h.length){var m=(s+u)/2,y=(a+l)/2;d.push(new un(h[3],m,y,u,l),new un(h[2],s,y,m,l),new un(h[1],m,a,u,y),new un(h[0],s,a,m,y)),(g=(t>=y)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var v=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),w=v*v+b*b;if(w<n){var E=Math.sqrt(n=w);r=e-E,o=t-E,c=e+E,f=t+E,i=h.data}}return i}function mX(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,o,s=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,m,y;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(s+u)/2))?s=d:u=d,(g=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,y=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,r?(o?r.next=o:delete r.next,this):t?(o?t[m]=o:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=o,this)}function yX(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function vX(){return this._root}function bX(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function xX(e){var t=[],n,i=this._root,r,o,s,a,u;for(i&&t.push(new un(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&i.length){var l=(o+a)/2,c=(s+u)/2;(r=i[3])&&t.push(new un(r,l,c,a,u)),(r=i[2])&&t.push(new un(r,o,c,l,u)),(r=i[1])&&t.push(new un(r,l,s,a,c)),(r=i[0])&&t.push(new un(r,o,s,l,c))}return this}function wX(e){var t=[],n=[],i;for(this._root&&t.push(new un(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var o,s=i.x0,a=i.y0,u=i.x1,l=i.y1,c=(s+u)/2,f=(a+l)/2;(o=r[0])&&t.push(new un(o,s,a,c,f)),(o=r[1])&&t.push(new un(o,c,a,u,f)),(o=r[2])&&t.push(new un(o,s,f,c,l)),(o=r[3])&&t.push(new un(o,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function _X(e){return e[0]}function EX(e){return arguments.length?(this._x=e,this):this._x}function SX(e){return e[1]}function AX(e){return arguments.length?(this._y=e,this):this._y}function Rx(e,t,n){var i=new Lx(t==null?_X:t,n==null?SX:n,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function Lx(e,t,n,i,r,o){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function bT(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var ln=Rx.prototype=Lx.prototype;ln.copy=function(){var e=new Lx(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=bT(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=bT(i));return e},ln.add=cX,ln.addAll=fX,ln.cover=dX,ln.data=hX,ln.extent=pX,ln.find=gX,ln.remove=mX,ln.removeAll=yX,ln.root=vX,ln.size=bX,ln.visit=xX,ln.visitAfter=wX,ln.x=EX,ln.y=AX;function cn(e){return function(){return e}}function Yo(e){return(e()-.5)*1e-6}function kX(e){return e.x+e.vx}function CX(e){return e.y+e.vy}function $X(e){var t,n,i,r=1,o=1;typeof e!="function"&&(e=cn(e==null?1:+e));function s(){for(var l,c=t.length,f,d,h,p,g,m,y=0;y<o;++y)for(f=Rx(t,kX,CX).visitAfter(a),l=0;l<c;++l)d=t[l],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(v);function v(b,w,E,S,_){var A=b.data,C=b.r,k=g+C;if(A){if(A.index>d.index){var $=h-A.x-A.vx,F=p-A.y-A.vy,D=$*$+F*F;D<k*k&&($===0&&($=Yo(i),D+=$*$),F===0&&(F=Yo(i),D+=F*F),D=(k-(D=Math.sqrt(D)))/D*r,d.vx+=($*=D)*(k=(C*=C)/(m+C)),d.vy+=(F*=D)*k,A.vx-=$*(k=1-k),A.vy-=F*k)}return}return w>h+k||S<h-k||E>p+k||_<p-k}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return s.initialize=function(l,c){t=l,i=c,u()},s.iterations=function(l){return arguments.length?(o=+l,s):o},s.strength=function(l){return arguments.length?(r=+l,s):r},s.radius=function(l){return arguments.length?(e=typeof l=="function"?l:cn(+l),u(),s):e},s}function MX(e){return e.index}function xT(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function FX(e){var t=MX,n=f,i,r=cn(30),o,s,a,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var b=0,w,E,S,_,A,C,k;b<v;++b)w=e[b],E=w.source,S=w.target,_=S.x+S.vx-E.x-E.vx||Yo(l),A=S.y+S.vy-E.y-E.vy||Yo(l),C=Math.sqrt(_*_+A*A),C=(C-o[b])/C*m*i[b],_*=C,A*=C,S.vx-=_*(k=u[b]),S.vy-=A*k,E.vx+=_*(k=1-k),E.vy+=A*k}function h(){if(!!s){var m,y=s.length,v=e.length,b=new Map(s.map((E,S)=>[t(E,S,s),E])),w;for(m=0,a=new Array(y);m<v;++m)w=e[m],w.index=m,typeof w.source!="object"&&(w.source=xT(b,w.source)),typeof w.target!="object"&&(w.target=xT(b,w.target)),a[w.source.index]=(a[w.source.index]||0)+1,a[w.target.index]=(a[w.target.index]||0)+1;for(m=0,u=new Array(v);m<v;++m)w=e[m],u[m]=a[w.source.index]/(a[w.source.index]+a[w.target.index]);i=new Array(v),p(),o=new Array(v),g()}}function p(){if(!!s)for(var m=0,y=e.length;m<y;++m)i[m]=+n(e[m],m,e)}function g(){if(!!s)for(var m=0,y=e.length;m<y;++m)o[m]=+r(e[m],m,e)}return d.initialize=function(m,y){s=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:cn(+m),p(),d):n},d.distance=function(m){return arguments.length?(r=typeof m=="function"?m:cn(+m),g(),d):r},d}var DX={value:()=>{}};function wT(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Xp(n)}function Xp(e){this._=e}function TX(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Xp.prototype=wT.prototype={constructor:Xp,on:function(e,t){var n=this._,i=TX(e+"",n),r,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(e=i[o]).type)&&(r=OX(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(r=(e=i[o]).type)n[r]=_T(n[r],e.name,t);else if(t==null)for(r in n)n[r]=_T(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Xp(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],i=0,r=o.length;i<r;++i)o[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};function OX(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function _T(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=DX,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var Tu=0,Jc=0,Zc=0,ET=1e3,Kp,Qc,Jp=0,Zs=0,Zp=0,ef=typeof performance=="object"&&performance.now?performance:Date,ST=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ix(){return Zs||(ST(NX),Zs=ef.now()+Zp)}function NX(){Zs=0}function Qp(){this._call=this._time=this._next=null}Qp.prototype=AT.prototype={constructor:Qp,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Ix():+n)+(t==null?0:+t),!this._next&&Qc!==this&&(Qc?Qc._next=this:Kp=this,Qc=this),this._call=e,this._time=n,Px()},stop:function(){this._call&&(this._call=null,this._time=Infinity,Px())}};function AT(e,t,n){var i=new Qp;return i.restart(e,t,n),i}function RX(){Ix(),++Tu;for(var e=Kp,t;e;)(t=Zs-e._time)>=0&&e._call.call(null,t),e=e._next;--Tu}function kT(){Zs=(Jp=ef.now())+Zp,Tu=Jc=0;try{RX()}finally{Tu=0,IX(),Zs=0}}function LX(){var e=ef.now(),t=e-Jp;t>ET&&(Zp-=t,Jp=e)}function IX(){for(var e,t=Kp,n,i=Infinity;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Kp=n);Qc=e,Px(i)}function Px(e){if(!Tu){Jc&&(Jc=clearTimeout(Jc));var t=e-Zs;t>24?(e<Infinity&&(Jc=setTimeout(kT,e-ef.now()-Zp)),Zc&&(Zc=clearInterval(Zc))):(Zc||(Jp=ef.now(),Zc=setInterval(LX,ET)),Tu=1,ST(kT))}}function PX(e,t,n){var i=new Qp,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(o,s,a){s=+s,a=a==null?Ix():+a,i._restart(function u(l){l+=r,i._restart(u,r+=s,a),o(l)},s,a)},i.restart(e,t,n),i)}const zX=1664525,BX=1013904223,CT=4294967296;function UX(){let e=1;return()=>(e=(zX*e+BX)%CT)/CT}function jX(e){return e.x}function qX(e){return e.y}var WX=10,HX=Math.PI*(3-Math.sqrt(5));function GX(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=new Map,u=AT(f),l=wT("tick","end"),c=UX();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function d(g){var m,y=e.length,v;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(o-n)*r,a.forEach(function(w){w(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=s:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=s:(v.y=v.fy,v.vy=0);return t}function h(){for(var g=0,m=e.length,y;g<m;++g){if(y=e[g],y.index=g,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=WX*Math.sqrt(.5+g),b=g*HX;y.x=v*Math.cos(b),y.y=v*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(i=+g,t):i},alphaDecay:function(g){return arguments.length?(r=+g,t):+r},alphaTarget:function(g){return arguments.length?(o=+g,t):o},velocityDecay:function(g){return arguments.length?(s=1-g,t):1-s},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?a.delete(g):a.set(g,p(m)),t):a.get(g)},find:function(g,m,y){var v=0,b=e.length,w,E,S,_,A;for(y==null?y=Infinity:y*=y,v=0;v<b;++v)_=e[v],w=g-_.x,E=m-_.y,S=w*w+E*E,S<y&&(A=_,y=S);return A},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}function YX(){var e,t,n,i,r=cn(-30),o,s=1,a=Infinity,u=.81;function l(h){var p,g=e.length,m=Rx(e,jX,qX).visitAfter(f);for(i=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(!!e){var h,p=e.length,g;for(o=new Array(p),h=0;h<p;++h)g=e[h],o[g.index]=+r(g,h,e)}}function f(h){var p=0,g,m,y=0,v,b,w;if(h.length){for(v=b=w=0;w<4;++w)(g=h[w])&&(m=Math.abs(g.value))&&(p+=g.value,y+=m,v+=m*g.x,b+=m*g.y);h.x=v/y,h.y=b/y}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=o[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,b=m-p,w=y*y+v*v;if(b*b/u<w)return w<a&&(y===0&&(y=Yo(n),w+=y*y),v===0&&(v=Yo(n),w+=v*v),w<s&&(w=Math.sqrt(s*w)),t.vx+=y*h.value*i/w,t.vy+=v*h.value*i/w),!0;if(h.length||w>=a)return;(h.data!==t||h.next)&&(y===0&&(y=Yo(n),w+=y*y),v===0&&(v=Yo(n),w+=v*v),w<s&&(w=Math.sqrt(s*w)));do h.data!==t&&(b=o[h.data.index]*i/w,t.vx+=y*b,t.vy+=v*b);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(r=typeof h=="function"?h:cn(+h),c(),l):r},l.distanceMin=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function VX(e){var t=cn(.1),n,i,r;typeof e!="function"&&(e=cn(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*a}function s(){if(!!n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:cn(+a),s(),o):t},o.x=function(a){return arguments.length?(e=typeof a=="function"?a:cn(+a),s(),o):e},o}function XX(e){var t=cn(.1),n,i,r;typeof e!="function"&&(e=cn(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*a}function s(){if(!!n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:cn(+a),s(),o):t},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:cn(+a),s(),o):e},o}const $T={center:lX,collide:$X,nbody:YX,link:FX,x:VX,y:XX},tf="forces",zx=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],KX=["static","iterations"],MT=["x","y","vx","vy"];function Bx(e){T.call(this,null,e)}Bx.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:MT}]},q(Bx,T,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(zx),o=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&FT(n,e,0,t)):(this.value=n=ZX(t.source,e),n.on("tick",JX(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(KX)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==tf||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,o=i.length,s;r<o;++r)if(i[r].name==="links"&&(s=i[r].op.source)){n.pulse(s,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(MT)}});function JX(e,t){return()=>e.touch(t).run()}function ZX(e,t){const n=GX(e),i=n.stop,r=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,r()),n.stop=()=>(o=!0,i()),FT(n,t,!0).on("end",()=>o=!0)}function FT(e,t,n,i){var r=K(t.forces),o,s,a,u;for(o=0,s=zx.length;o<s;++o)a=zx[o],a!==tf&&t.modified(a)&&e[a](t[a]);for(o=0,s=r.length;o<s;++o)u=tf+o,a=n||t.modified(tf,o)?eK(r[o]):i&&QX(r[o],i)?e.force(u):null,a&&e.force(u,a);for(s=e.numForces||0;o<s;++o)e.force(tf+o,null);return e.numForces=r.length,e}function QX(e,t){var n,i;for(n in e)if(fe(i=e[n])&&t.modified(Lt(i)))return 1;return 0}function eK(e){var t,n;te($T,e.force)||N("Unrecognized force: "+e.force),t=$T[e.force]();for(n in e)fe(t[n])&&tK(t[n],e[n],e);return t}function tK(e,t,n){e(fe(t)?i=>t(i,n):t)}var nK=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:Bx});function iK(e,t){return e.parent===t.parent?1:2}function rK(e){return e.reduce(oK,0)/e.length}function oK(e,t){return e+t.x}function sK(e){return 1+e.reduce(aK,0)}function aK(e,t){return Math.max(e,t.y)}function uK(e){for(var t;t=e.children;)e=t[0];return e}function lK(e){for(var t;t=e.children;)e=t[t.length-1];return e}function cK(){var e=iK,t=1,n=1,i=!1;function r(o){var s,a=0;o.eachAfter(function(d){var h=d.children;h?(d.x=rK(h),d.y=sK(h)):(d.x=s?a+=e(d,s):0,d.y=0,s=d)});var u=uK(o),l=lK(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(i?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return r.separation=function(o){return arguments.length?(e=o,r):e},r.size=function(o){return arguments.length?(i=!1,t=+o[0],n=+o[1],r):i?null:[t,n]},r.nodeSize=function(o){return arguments.length?(i=!0,t=+o[0],n=+o[1],r):i?[t,n]:null},r}function fK(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function dK(){return this.eachAfter(fK)}function hK(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function pK(e,t){for(var n=this,i=[n],r,o,s=-1;n=i.pop();)if(e.call(t,n,++s,this),r=n.children)for(o=r.length-1;o>=0;--o)i.push(r[o]);return this}function gK(e,t){for(var n=this,i=[n],r=[],o,s,a,u=-1;n=i.pop();)if(r.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)i.push(o[s]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function mK(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function yK(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function vK(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function bK(e){for(var t=this,n=xK(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function xK(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function wK(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function _K(){return Array.from(this)}function EK(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function SK(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*AK(){var e=this,t,n=[e],i,r,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,o=i.length;r<o;++r)n.push(i[r]);while(n.length)}function Ux(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=$K)):t===void 0&&(t=CK);for(var n=new Ou(e),i,r=[n],o,s,a,u;i=r.pop();)if((s=t(i.data))&&(u=(s=Array.from(s)).length))for(i.children=s,a=u-1;a>=0;--a)r.push(o=s[a]=new Ou(s[a])),o.parent=i,o.depth=i.depth+1;return n.eachBefore(DT)}function kK(){return Ux(this).eachBefore(MK)}function CK(e){return e.children}function $K(e){return Array.isArray(e)?e[1]:null}function MK(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function DT(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Ou(e){this.data=e,this.depth=this.height=0,this.parent=null}Ou.prototype=Ux.prototype={constructor:Ou,count:dK,each:hK,eachAfter:gK,eachBefore:pK,find:mK,sum:yK,sort:vK,path:bK,ancestors:wK,descendants:_K,leaves:EK,links:SK,copy:kK,[Symbol.iterator]:AK};function FK(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function DK(e){for(var t=e.length,n,i;t;)i=Math.random()*t--|0,n=e[t],e[t]=e[i],e[i]=n;return e}function TK(e){for(var t=0,n=(e=DK(Array.from(e))).length,i=[],r,o;t<n;)r=e[t],o&&TT(o,r)?++t:(o=NK(i=OK(i,r)),t=0);return o}function OK(e,t){var n,i;if(jx(t,e))return[t];for(n=0;n<e.length;++n)if(eg(t,e[n])&&jx(nf(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(eg(nf(e[n],e[i]),t)&&eg(nf(e[n],t),e[i])&&eg(nf(e[i],t),e[n])&&jx(OT(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function eg(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function TT(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function jx(e,t){for(var n=0;n<t.length;++n)if(!TT(e,t[n]))return!1;return!0}function NK(e){switch(e.length){case 1:return RK(e[0]);case 2:return nf(e[0],e[1]);case 3:return OT(e[0],e[1],e[2])}}function RK(e){return{x:e.x,y:e.y,r:e.r}}function nf(e,t){var n=e.x,i=e.y,r=e.r,o=t.x,s=t.y,a=t.r,u=o-n,l=s-i,c=a-r,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(i+s+l/f*c)/2,r:(f+r+a)/2}}function OT(e,t,n){var i=e.x,r=e.y,o=e.r,s=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=i-s,h=i-l,p=r-a,g=r-c,m=u-o,y=f-o,v=i*i+r*r-o*o,b=v-s*s-a*a+u*u,w=v-l*l-c*c+f*f,E=h*p-d*g,S=(p*w-g*b)/(E*2)-i,_=(g*m-p*y)/E,A=(h*b-d*w)/(E*2)-r,C=(d*y-h*m)/E,k=_*_+C*C-1,$=2*(o+S*_+A*C),F=S*S+A*A-o*o,D=-(k?($+Math.sqrt($*$-4*k*F))/(2*k):F/$);return{x:i+S+_*D,y:r+A+C*D,r:D}}function NT(e,t,n){var i=e.x-t.x,r,o,s=e.y-t.y,a,u,l=i*i+s*s;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(r=(l+u-o)/(2*l),a=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-a*s,n.y=e.y-r*s+a*i):(r=(l+o-u)/(2*l),a=Math.sqrt(Math.max(0,o/l-r*r)),n.x=t.x+r*i-a*s,n.y=t.y+r*s+a*i)):(n.x=t.x+n.r,n.y=t.y)}function RT(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function LT(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,o=(t.y*n.r+n.y*t.r)/i;return r*r+o*o}function tg(e){this._=e,this.next=null,this.previous=null}function LK(e){if(!(r=(e=FK(e)).length))return 0;var t,n,i,r,o,s,a,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(r>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(r>2))return t.r+n.r;NT(n,t,i=e[2]),t=new tg(t),n=new tg(n),i=new tg(i),t.next=i.previous=n,n.next=t.previous=i,i.next=n.previous=t;e:for(a=3;a<r;++a){NT(t._,n._,i=e[a]),i=new tg(i),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(RT(u._,i._)){n=u,t.next=n,n.previous=t,--a;continue e}c+=u._.r,u=u.next}else{if(RT(l._,i._)){t=l,t.next=n,n.previous=t,--a;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(i.previous=t,i.next=n,t.next=n.previous=n=i,o=LT(t);(i=i.next)!==n;)(s=LT(i))<o&&(t=i,o=s);n=t.next}for(t=[n._],i=n;(i=i.next)!==n;)t.push(i._);for(i=TK(t),a=0;a<r;++a)t=e[a],t.x-=i.x,t.y-=i.y;return i.r}function IK(e){return e==null?null:ng(e)}function ng(e){if(typeof e!="function")throw new Error;return e}function Qs(){return 0}function Nu(e){return function(){return e}}function PK(e){return Math.sqrt(e.value)}function zK(){var e=null,t=1,n=1,i=Qs;function r(o){return o.x=t/2,o.y=n/2,e?o.eachBefore(IT(e)).eachAfter(qx(i,.5)).eachBefore(PT(1)):o.eachBefore(IT(PK)).eachAfter(qx(Qs,1)).eachAfter(qx(i,o.r/Math.min(t,n))).eachBefore(PT(Math.min(t,n)/(2*o.r))),o}return r.radius=function(o){return arguments.length?(e=IK(o),r):e},r.size=function(o){return arguments.length?(t=+o[0],n=+o[1],r):[t,n]},r.padding=function(o){return arguments.length?(i=typeof o=="function"?o:Nu(+o),r):i},r}function IT(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function qx(e,t){return function(n){if(i=n.children){var i,r,o=i.length,s=e(n)*t||0,a;if(s)for(r=0;r<o;++r)i[r].r+=s;if(a=LK(i),s)for(r=0;r<o;++r)i[r].r-=s;n.r=a+s}}}function PT(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function zT(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function rf(e,t,n,i,r){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(i-t)/e.value;++a<u;)s=o[a],s.y0=n,s.y1=r,s.x0=t,s.x1=t+=s.value*l}function BK(){var e=1,t=1,n=0,i=!1;function r(s){var a=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/a,s.eachBefore(o(t,a)),i&&s.eachBefore(zT),s}function o(s,a){return function(u){u.children&&rf(u,u.x0,s*(u.depth+1)/a,u.x1,s*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return r.round=function(s){return arguments.length?(i=!!s,r):i},r.size=function(s){return arguments.length?(e=+s[0],t=+s[1],r):[e,t]},r.padding=function(s){return arguments.length?(n=+s,r):n},r}var UK={depth:-1},BT={};function jK(e){return e.id}function qK(e){return e.parentId}function UT(){var e=jK,t=qK;function n(i){var r=Array.from(i),o=r.length,s,a,u,l,c,f,d,h=new Map;for(a=0;a<o;++a)s=r[a],c=r[a]=new Ou(s),(f=e(s,a,i))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?BT:c)),(f=t(s,a,i))!=null&&(f+="")&&(c.parent=f);for(a=0;a<o;++a)if(c=r[a],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===BT)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=UK,u.eachBefore(function(p){p.depth=p.parent.depth+1,--o}).eachBefore(DT),u.parent=null,o>0)throw new Error("cycle");return u}return n.id=function(i){return arguments.length?(e=ng(i),n):e},n.parentId=function(i){return arguments.length?(t=ng(i),n):t},n}function WK(e,t){return e.parent===t.parent?1:2}function Wx(e){var t=e.children;return t?t[0]:e.t}function Hx(e){var t=e.children;return t?t[t.length-1]:e.t}function HK(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function GK(e){for(var t=0,n=0,i=e.children,r=i.length,o;--r>=0;)o=i[r],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function YK(e,t,n){return e.a.parent===t.parent?e.a:n}function ig(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}ig.prototype=Object.create(Ou.prototype);function VK(e){for(var t=new ig(e,0),n,i=[t],r,o,s,a;n=i.pop();)if(o=n._.children)for(n.children=new Array(a=o.length),s=a-1;s>=0;--s)i.push(r=n.children[s]=new ig(o[s],s)),r.parent=n;return(t.parent=new ig(null,0)).children=[t],t}function XK(){var e=WK,t=1,n=1,i=null;function r(l){var c=VK(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),i)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),y=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+g)*m,v.y=v.depth*y})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){GK(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],m=d.m,y=h.m,v=p.m,b=g.m,w;p=Hx(p),d=Wx(d),p&&d;)g=Wx(g),h=Hx(h),h.a=l,w=p.z+v-d.z-m+e(p._,d._),w>0&&(HK(YK(p,l,f),l,w),m+=w,y+=w),v+=p.m,m+=d.m,b+=g.m,y+=h.m;p&&!Hx(h)&&(h.t=p,h.m+=v-y),d&&!Wx(g)&&(g.t=d,g.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function rg(e,t,n,i,r){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(r-n)/e.value;++a<u;)s=o[a],s.x0=t,s.x1=i,s.y0=n,s.y1=n+=s.value*l}var jT=(1+Math.sqrt(5))/2;function qT(e,t,n,i,r,o){for(var s=[],a=t.children,u,l,c=0,f=0,d=a.length,h,p,g=t.value,m,y,v,b,w,E,S;c<d;){h=r-n,p=o-i;do m=a[f++].value;while(!m&&f<d);for(y=v=m,E=Math.max(p/h,h/p)/(g*e),S=m*m*E,w=Math.max(v/S,S/y);f<d;++f){if(m+=l=a[f].value,l<y&&(y=l),l>v&&(v=l),S=m*m*E,b=Math.max(v/S,S/y),b>w){m-=l;break}w=b}s.push(u={value:m,dice:h<p,children:a.slice(c,f)}),u.dice?rf(u,n,i,r,g?i+=p*m/g:o):rg(u,n,i,g?n+=h*m/g:r,o),g-=m,c=f}return s}var WT=function e(t){function n(i,r,o,s,a){qT(t,i,r,o,s,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(jT);function KK(){var e=WT,t=!1,n=1,i=1,r=[0],o=Qs,s=Qs,a=Qs,u=Qs,l=Qs;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(zT),d}function f(d){var h=r[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,y=d.y1-h;m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=y,d.children&&(h=r[d.depth+1]=o(d)/2,p+=l(d)-h,g+=s(d)-h,m-=a(d)-h,y-=u(d)-h,m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),e(d,p,g,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=ng(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:Nu(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(s=typeof d=="function"?d:Nu(+d),c):s},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:Nu(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:Nu(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:Nu(+d),c):l},c}function JK(e,t,n,i,r){var o=e.children,s,a=o.length,u,l=new Array(a+1);for(l[0]=u=s=0;s<a;++s)l[s+1]=u+=o[s].value;c(0,a,e.value,t,n,i,r);function c(f,d,h,p,g,m,y){if(f>=d-1){var v=o[f];v.x0=p,v.y0=g,v.x1=m,v.y1=y;return}for(var b=l[f],w=h/2+b,E=f+1,S=d-1;E<S;){var _=E+S>>>1;l[_]<w?E=_+1:S=_}w-l[E-1]<l[E]-w&&f+1<E&&--E;var A=l[E]-b,C=h-A;if(m-p>y-g){var k=h?(p*C+m*A)/h:m;c(f,E,A,p,g,k,y),c(E,d,C,k,g,m,y)}else{var $=h?(g*C+y*A)/h:y;c(f,E,A,p,g,m,$),c(E,d,C,p,$,m,y)}}}function ZK(e,t,n,i,r){(e.depth&1?rg:rf)(e,t,n,i,r)}var QK=function e(t){function n(i,r,o,s,a){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=i.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?rf(l,r,o,s,g?o+=(a-o)*l.value/g:a):rg(l,r,o,g?r+=(s-r)*l.value/g:s,a),g-=l.value}else i._squarify=u=qT(t,i,r,o,s,a),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(jT);function Gx(e,t,n){const i={};return e.each(r=>{const o=r.data;n(o)&&(i[t(o)]=r)}),e.lookup=i,e}function Yx(e){T.call(this,null,e)}Yx.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const eJ=e=>e.values;q(Yx,T,{transform(e,t){t.source||N("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),o=this.value;return(!o||i||t.changed())&&(o&&o.each(s=>{s.children&&Kd(s.data)&&r.rem.push(s.data)}),this.value=o=Ux({values:K(e.keys).reduce((s,a)=>(s.key(a),s),tJ()).entries(r.source)},eJ),n&&o.each(s=>{s.children&&(s=Ce(s.data),r.add.push(s),r.source.push(s))}),Gx(o,ne,ne)),r.source.root=o,r}});function tJ(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,o){if(o>=e.length)return r;const s=r.length,a=e[o++],u={},l={};let c=-1,f,d,h;for(;++c<s;)f=a(d=r[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function i(r,o){if(++o>e.length)return r;const s=[];for(const a in r)s.push({key:a,values:i(r[a],o)});return s}return t}function Hr(e){T.call(this,null,e)}const nJ=(e,t)=>e.parent===t.parent?1:2;q(Hr,T,{transform(e,t){(!t.source||!t.source.root)&&N(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,o=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(Os(e.sort,s=>s.data)),iJ(n,this.params,e),n.separation&&n.separation(e.separation!==!1?nJ:qa);try{this.value=n(r)}catch(s){N(s)}return r.each(s=>rJ(s,i,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function iJ(e,t,n){for(let i,r=0,o=t.length;r<o;++r)i=t[r],i in n&&e[i](n[i])}function rJ(e,t,n){const i=e.data,r=t.length-1;for(let o=0;o<r;++o)i[n[o]]=e[t[o]];i[n[r]]=e.children?e.children.length:0}const Vx=["x","y","r","depth","children"];function Xx(e){Hr.call(this,e)}Xx.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Vx.length,default:Vx}]},q(Xx,Hr,{layout:zK,params:["radius","size","padding"],fields:Vx});const Kx=["x0","y0","x1","y1","depth","children"];function Jx(e){Hr.call(this,e)}Jx.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Kx.length,default:Kx}]},q(Jx,Hr,{layout:BK,params:["size","round","padding"],fields:Kx});function Zx(e){T.call(this,null,e)}Zx.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},q(Zx,T,{transform(e,t){t.source||N("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),o=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),o&&(n=r.source.length?Gx(UT().id(e.key).parentId(e.parentKey)(r.source),e.key,Vn):Gx(UT()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const HT={tidy:XK,cluster:cK},Qx=["x","y","depth","children"];function e2(e){Hr.call(this,e)}e2.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:Qx.length,default:Qx}]},q(e2,Hr,{layout(e){const t=e||"tidy";if(te(HT,t))return HT[t]();N("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:Qx});function t2(e){T.call(this,[],e)}t2.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},q(t2,T,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),o={};return i||N("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,s=>o[ne(s)]=1),i.each(s=>{const a=s.data,u=s.parent&&s.parent.data;u&&o[ne(a)]&&o[ne(u)]&&r.add.push(Ce({source:u,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>o[ne(s)]=1),n.forEach(s=>{(o[ne(s.source)]||o[ne(s.target)])&&r.mod.push(s)})),r}});const GT={binary:JK,dice:rf,slice:rg,slicedice:ZK,squarify:WT,resquarify:QK},n2=["x0","y0","x1","y1","depth","children"];function i2(e){Hr.call(this,e)}i2.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:n2.length,default:n2}]},q(i2,Hr,{layout(){const e=KK();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{te(GT,t)?e.tile(GT[t]):N("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:n2});var oJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:Yx,pack:Xx,partition:Jx,stratify:Zx,tree:e2,treelinks:t2,treemap:i2});const sJ=4278190080,aJ=268435456,uJ=.0625;function lJ(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function cJ(e,t,n,i){const r=e.width,o=e.height,s=n||i,a=su(r,o).getContext("2d");t.forEach(m=>YT(a,m,s));const u=new Uint32Array(a.getImageData(0,0,r,o).data.buffer),l=e.bitmap(),c=s&&e.bitmap();let f,d,h,p,g;for(d=0;d<o;++d)for(f=0;f<r;++f)g=u[d*r+f]&sJ,g&&(h=e(f),p=e(d),i||l.set(h,p),s&&g^aJ&&c.set(h,p));return[l,c]}function YT(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(o=>YT(e,o.items,n))}):zn[i].draw(e,{items:n?t.map(fJ):t})}function fJ(e){const t=Jd(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=uJ,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Gr=5,fn=31,of=32,Vo=new Uint32Array(of+1),Ci=new Uint32Array(of+1);Ci[0]=0,Vo[0]=~Ci[0];for(let e=1;e<=of;++e)Ci[e]=Ci[e-1]<<1|1,Vo[e]=~Ci[e];function dJ(e,t){const n=new Uint32Array(~~((e*t+of)/of));function i(o,s){n[o]|=s}function r(o,s){n[o]&=s}return{array:n,get:(o,s)=>{const a=s*e+o;return n[a>>>Gr]&1<<(a&fn)},set:(o,s)=>{const a=s*e+o;i(a>>>Gr,1<<(a&fn))},clear:(o,s)=>{const a=s*e+o;r(a>>>Gr,~(1<<(a&fn)))},getRange:(o,s,a,u)=>{let l=u,c,f,d,h;for(;l>=s;--l)if(c=l*e+o,f=l*e+a,d=c>>>Gr,h=f>>>Gr,d===h){if(n[d]&Vo[c&fn]&Ci[(f&fn)+1])return!0}else{if(n[d]&Vo[c&fn]||n[h]&Ci[(f&fn)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>Gr,d=c>>>Gr,f===d)i(f,Vo[l&fn]&Ci[(c&fn)+1]);else for(i(f,Vo[l&fn]),i(d,Ci[(c&fn)+1]),h=f+1;h<d;++h)i(h,4294967295)},clearRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>Gr,d=c>>>Gr,f===d)r(f,Ci[l&fn]|Vo[(c&fn)+1]);else for(r(f,Ci[l&fn]),r(d,Vo[(c&fn)+1]),h=f+1;h<d;++h)r(h,0)},outOfBounds:(o,s,a,u)=>o<0||s<0||u>=t||a>=e}}function hJ(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),o=~~((t+2*n+i)/i),s=a=>~~((a+n)/i);return s.invert=a=>a*i-n,s.bitmap=()=>dJ(r,o),s.ratio=i,s.padding=n,s.width=e,s.height=t,s}function pJ(e,t,n,i){const r=e.width,o=e.height;return function(s){const a=s.datum.datum.items[i].items,u=a.length,l=s.datum.fontSize,c=er.width(s.datum,s.datum.text);let f=0,d,h,p,g,m,y,v;for(let b=0;b<u;++b)d=a[b].x,p=a[b].y,h=a[b].x2===void 0?d:a[b].x2,g=a[b].y2===void 0?p:a[b].y2,m=(d+h)/2,y=(p+g)/2,v=Math.abs(h-d+g-p),v>=f&&(f=v,s.x=m,s.y=y);return m=c/2,y=l/2,d=s.x-m,h=s.x+m,p=s.y-y,g=s.y+y,s.align="center",d<0&&h<=r?s.align="left":0<=d&&r<h&&(s.align="right"),s.baseline="middle",p<0&&g<=o?s.baseline="top":0<=p&&o<g&&(s.baseline="bottom"),!0}}function og(e,t,n,i,r,o){let s=n/2;return e-s<0||e+s>r||t-(s=i/2)<0||t+s>o}function Xo(e,t,n,i,r,o,s,a){const u=r*o/(i*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return s.outOfBounds(l,f,c,d)||s.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function gJ(e,t,n,i){const r=e.width,o=e.height,s=t[0],a=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let m=f,y=o,v;if(!og(p,g,d,h,r,o)&&!Xo(e,p,g,h,d,m,s,a)&&!Xo(e,p,g,h,d,h,s,null)){for(;y-m>=1;)v=(m+y)/2,Xo(e,p,g,h,d,v,s,a)?y=v:m=v;if(m>f)return[p,g,m,!0]}}return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,h=er.width(l.datum,l.datum.text);let p=n?d:0,g=!1,m=!1,y=0,v,b,w,E,S,_,A,C,k,$,F,D,L,M,I,U,Y;for(let Q=0;Q<f;++Q){for(v=c[Q].x,w=c[Q].y,b=c[Q].x2===void 0?v:c[Q].x2,E=c[Q].y2===void 0?w:c[Q].y2,v>b&&(Y=v,v=b,b=Y),w>E&&(Y=w,w=E,E=Y),k=e(v),F=e(b),$=~~((k+F)/2),D=e(w),M=e(E),L=~~((D+M)/2),A=$;A>=k;--A)for(C=L;C>=D;--C)U=u(A,C,p,h,d),U&&([l.x,l.y,p,g]=U);for(A=$;A<=F;++A)for(C=L;C<=M;++C)U=u(A,C,p,h,d),U&&([l.x,l.y,p,g]=U);!g&&!n&&(I=Math.abs(b-v+E-w),S=(v+b)/2,_=(w+E)/2,I>=y&&!og(S,_,h,d,r,o)&&!Xo(e,S,_,d,h,d,s,null)&&(y=I,l.x=S,l.y=_,m=!0))}return g||m?(S=h/2,_=d/2,s.setRange(e(l.x-S),e(l.y-_),e(l.x+S),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const mJ=[-1,-1,1,1],yJ=[-1,1,-1,1];function vJ(e,t,n,i){const r=e.width,o=e.height,s=t[0],a=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,h=er.width(l.datum,l.datum.text),p=[];let g=n?d:0,m=!1,y=!1,v=0,b,w,E,S,_,A,C,k,$,F,D,L;for(let M=0;M<f;++M){for(b=c[M].x,E=c[M].y,w=c[M].x2===void 0?b:c[M].x2,S=c[M].y2===void 0?E:c[M].y2,p.push([e((b+w)/2),e((E+S)/2)]);p.length;)if([C,k]=p.pop(),!(s.get(C,k)||a.get(C,k)||u.get(C,k))){u.set(C,k);for(let I=0;I<4;++I)_=C+mJ[I],A=k+yJ[I],u.outOfBounds(_,A,_,A)||p.push([_,A]);if(_=e.invert(C),A=e.invert(k),$=g,F=o,!og(_,A,h,d,r,o)&&!Xo(e,_,A,d,h,$,s,a)&&!Xo(e,_,A,d,h,d,s,null)){for(;F-$>=1;)D=($+F)/2,Xo(e,_,A,d,h,D,s,a)?F=D:$=D;$>g&&(l.x=_,l.y=A,g=$,m=!0)}}!m&&!n&&(L=Math.abs(w-b+S-E),_=(b+w)/2,A=(E+S)/2,L>=v&&!og(_,A,h,d,r,o)&&!Xo(e,_,A,d,h,d,s,null)&&(v=L,l.x=_,l.y=A,y=!0))}return m||y?(_=h/2,A=d/2,s.setRange(e(l.x-_),e(l.y-A),e(l.x+_),e(l.y+A)),l.align="center",l.baseline="middle",!0):!1}}const bJ=["right","center","left"],xJ=["bottom","middle","top"];function wJ(e,t,n,i){const r=e.width,o=e.height,s=t[0],a=t[1],u=i.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>r||c[3]>o)return!1;let d=0,h,p,g,m,y,v,b,w,E,S,_,A,C,k,$;for(let F=0;F<u;++F){if(h=(n[F]&3)-1,p=(n[F]>>>2&3)-1,g=h===0&&p===0||i[F]<0,m=h&&p?Math.SQRT1_2:1,y=i[F]<0?-1:1,v=c[1+h]+i[F]*h*m,_=c[4+p]+y*f*p/2+i[F]*p*m,w=_-f/2,E=_+f/2,A=e(v),k=e(w),$=e(E),!d)if(VT(A,A,k,$,s,a,v,v,w,E,c,g))d=er.width(l.datum,l.datum.text);else continue;if(S=v+y*d*h/2,v=S-d/2,b=S+d/2,A=e(v),C=e(b),VT(A,C,k,$,s,a,v,b,w,E,c,g))return l.x=h?h*y<0?b:v:S,l.y=p?p*y<0?E:w:_,l.align=bJ[h*y+1],l.baseline=xJ[p*y+1],s.setRange(A,k,C,$),!0}return!1}}function VT(e,t,n,i,r,o,s,a,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&o?o.getRange(e,n,t,i)||!_J(s,u,a,l,c):r.getRange(e,n,t,i)))}function _J(e,t,n,i,r){return r[0]<=e&&n<=r[2]&&r[3]<=t&&i<=r[5]}const r2=0,o2=4,s2=8,a2=0,u2=1,l2=2,EJ={"top-left":r2+a2,top:r2+u2,"top-right":r2+l2,left:o2+a2,middle:o2+u2,right:o2+l2,"bottom-left":s2+a2,bottom:s2+u2,"bottom-right":s2+l2},SJ={naive:pJ,"reduced-search":gJ,floodfill:vJ};function AJ(e,t,n,i,r,o,s,a,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=kJ(i,f),h=CJ(r,f),p=$J(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,m=g==="area",y=MJ(p,g,a,u),v=hJ(t[0],t[1],l),b=m&&c==="naive",w=e.map(_=>({datum:_,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(_)}));let E;if(!b){n&&w.sort((A,C)=>n(A.datum,C.datum));let _=!1;for(let A=0;A<h.length&&!_;++A)_=h[A]===5||d[A]<0;p&&(s||m)&&(o=[e.map(A=>A.datum)].concat(o)),E=o.length?cJ(v,o,_,m):lJ(v,s&&w)}const S=m?SJ[c](v,E,s,u):wJ(v,E,h,d);return w.forEach(_=>_.opacity=+S(_)),w}function kJ(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function CJ(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=EJ[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function $J(e){return e&&e.mark&&e.mark.marktype}function MJ(e,t,n,i){const r=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>r(o.datum):t==="line"?o=>{const s=o.datum.items[i].items;return r(s.length?s[n==="start"?0:s.length-1]:{x:NaN,y:NaN})}:o=>{const s=o.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:r}const c2=["x","y","opacity","align","baseline"],XT=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function f2(e){T.call(this,null,e)}f2.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:XT},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:c2.length,default:c2}]},q(f2,T,{transform(e,t){function n(o){const s=e[o];return fe(s)&&t.modified(s.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&N("Size parameter should be specified as a [width, height] array.");const r=e.as||c2;return AJ(t.materialize(t.SOURCE).source,e.size,e.sort,K(e.offset||1),K(e.anchor||XT),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(o=>{const s=o.datum;s[r[0]]=o.x,s[r[1]]=o.y,s[r[2]]=o.opacity,s[r[3]]=o.align,s[r[4]]=o.baseline}),t.reflow(i).modifies(r)}});var FJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:f2});function KT(e,t){var n=[],i=function(c){return c(a)},r,o,s,a,u,l;if(t==null)n.push(e);else for(r={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function d2(e){T.call(this,null,e)}d2.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},q(d2,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=KT(i,e.groupby),o=(e.groupby||[]).map(Je),s=o.length,a=e.as||[Je(e.x),Je(e.y)],u=[];r.forEach(l=>{gC(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<s;++d)f[o[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(Ce(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const h2={linear:sy,log:lC,exp:cC,pow:fC,quad:ay,poly:dC},DJ=(e,t)=>e==="poly"?t:e==="quad"?2:1;function p2(e){T.call(this,null,e)}p2.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(h2)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},q(p2,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=KT(i,e.groupby),o=(e.groupby||[]).map(Je),s=e.method||"linear",a=e.order||3,u=DJ(s,a),l=e.as||[Je(e.x),Je(e.y)],c=h2[s],f=[];let d=e.extent;te(h2,s)||N("Invalid regression method: "+s),d!=null&&s==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,a);if(e.params){f.push(Ce({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||qi(h,e.x),y=v=>{const b={};for(let w=0;w<o.length;++w)b[o[w]]=h.dims[w];b[l[0]]=v[0],b[l[1]]=v[1],f.push(Ce(b))};s==="linear"?m.forEach(v=>y([v,g.predict(v)])):ah(g.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var TJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:d2,regression:p2});const JT=Math.pow(2,-52),sg=new Uint32Array(512);class ag{static from(t,n=IJ,i=PJ){const r=t.length,o=new Float64Array(r*2);for(let s=0;s<r;s++){const a=t[s];o[2*s]=n(a),o[2*s+1]=i(a)}return new ag(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:o}=this,s=t.length>>1;let a=Infinity,u=Infinity,l=-Infinity,c=-Infinity;for(let k=0;k<s;k++){const $=t[2*k],F=t[2*k+1];$<a&&(a=$),F<u&&(u=F),$>l&&(l=$),F>c&&(c=F),this._ids[k]=k}const f=(a+l)/2,d=(u+c)/2;let h=Infinity,p,g,m;for(let k=0;k<s;k++){const $=g2(f,d,t[2*k],t[2*k+1]);$<h&&(p=k,h=$)}const y=t[2*p],v=t[2*p+1];h=Infinity;for(let k=0;k<s;k++){if(k===p)continue;const $=g2(y,v,t[2*k],t[2*k+1]);$<h&&$>0&&(g=k,h=$)}let b=t[2*g],w=t[2*g+1],E=Infinity;for(let k=0;k<s;k++){if(k===p||k===g)continue;const $=RJ(y,v,b,w,t[2*k],t[2*k+1]);$<E&&(m=k,E=$)}let S=t[2*m],_=t[2*m+1];if(E===Infinity){for(let F=0;F<s;F++)this._dists[F]=t[2*F]-t[0]||t[2*F+1]-t[1];Ru(this._ids,this._dists,0,s-1);const k=new Uint32Array(s);let $=0;for(let F=0,D=-Infinity;F<s;F++){const L=this._ids[F];this._dists[L]>D&&(k[$++]=L,D=this._dists[L])}this.hull=k.subarray(0,$),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(ug(y,v,b,w,S,_)){const k=g,$=b,F=w;g=m,b=S,w=_,m=k,S=$,_=F}const A=LJ(y,v,b,w,S,_);this._cx=A.x,this._cy=A.y;for(let k=0;k<s;k++)this._dists[k]=g2(t[2*k],t[2*k+1],A.x,A.y);Ru(this._ids,this._dists,0,s-1),this._hullStart=p;let C=3;i[p]=n[m]=g,i[g]=n[p]=m,i[m]=n[g]=p,r[p]=0,r[g]=1,r[m]=2,o.fill(-1),o[this._hashKey(y,v)]=p,o[this._hashKey(b,w)]=g,o[this._hashKey(S,_)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let k=0,$,F;k<this._ids.length;k++){const D=this._ids[k],L=t[2*D],M=t[2*D+1];if(k>0&&Math.abs(L-$)<=JT&&Math.abs(M-F)<=JT||($=L,F=M,D===p||D===g||D===m))continue;let I=0;for(let $e=0,De=this._hashKey(L,M);$e<this._hashSize&&(I=o[(De+$e)%this._hashSize],!(I!==-1&&I!==i[I]));$e++);I=n[I];let U=I,Y;for(;Y=i[U],!ug(L,M,t[2*U],t[2*U+1],t[2*Y],t[2*Y+1]);)if(U=Y,U===I){U=-1;break}if(U===-1)continue;let Q=this._addTriangle(U,D,i[U],-1,-1,r[U]);r[D]=this._legalize(Q+2),r[U]=Q,C++;let ce=i[U];for(;Y=i[ce],ug(L,M,t[2*ce],t[2*ce+1],t[2*Y],t[2*Y+1]);)Q=this._addTriangle(ce,D,Y,r[D],-1,r[ce]),r[D]=this._legalize(Q+2),i[ce]=ce,C--,ce=Y;if(U===I)for(;Y=n[U],ug(L,M,t[2*Y],t[2*Y+1],t[2*U],t[2*U+1]);)Q=this._addTriangle(Y,D,U,-1,r[U],r[Y]),this._legalize(Q+2),r[Y]=Q,i[U]=U,C--,U=Y;this._hullStart=n[D]=U,i[U]=n[ce]=D,i[D]=ce,o[this._hashKey(L,M)]=D,o[this._hashKey(t[2*U],t[2*U+1])]=U}this.hull=new Uint32Array(C);for(let k=0,$=this._hullStart;k<C;k++)this.hull[k]=$,$=i[$];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(OJ(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let o=0,s=0;for(;;){const a=i[t],u=t-t%3;if(s=u+(t+2)%3,a===-1){if(o===0)break;t=sg[--o];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[s],h=n[t],p=n[c],g=n[f];if(NJ(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1],r[2*g],r[2*g+1])){n[t]=g,n[a]=d;const y=i[f];if(y===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,y),this._link(a,i[s]),this._link(s,f);const v=l+(a+1)%3;o<sg.length&&(sg[o++]=v)}else{if(o===0)break;t=sg[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function OJ(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function g2(e,t,n,i){const r=e-n,o=t-i;return r*r+o*o}function m2(e,t,n,i,r,o){const s=(i-t)*(r-e),a=(n-e)*(o-t);return Math.abs(s-a)>=33306690738754716e-32*Math.abs(s+a)?s-a:0}function ug(e,t,n,i,r,o){return(m2(r,o,e,t,n,i)||m2(e,t,n,i,r,o)||m2(n,i,r,o,e,t))<0}function NJ(e,t,n,i,r,o,s,a){const u=e-s,l=t-a,c=n-s,f=i-a,d=r-s,h=o-a,p=u*u+l*l,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+p*(c*h-f*d)<0}function RJ(e,t,n,i,r,o){const s=n-e,a=i-t,u=r-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),h=(l*c-a*f)*d,p=(s*f-u*c)*d;return h*h+p*p}function LJ(e,t,n,i,r,o){const s=n-e,a=i-t,u=r-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),h=e+(l*c-a*f)*d,p=t+(s*f-u*c)*d;return{x:h,y:p}}function Ru(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const o=e[r],s=t[o];let a=r-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{const r=n+i>>1;let o=n+1,s=i;sf(e,r,o),t[e[n]]>t[e[i]]&&sf(e,n,i),t[e[o]]>t[e[i]]&&sf(e,o,i),t[e[n]]>t[e[o]]&&sf(e,n,o);const a=e[o],u=t[a];for(;;){do o++;while(t[e[o]]<u);do s--;while(t[e[s]]>u);if(s<o)break;sf(e,o,s)}e[n+1]=e[s],e[s]=a,i-o+1>=s-n?(Ru(e,t,o,i),Ru(e,t,n,s-1)):(Ru(e,t,n,s-1),Ru(e,t,o,i))}}function sf(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function IJ(e){return e[0]}function PJ(e){return e[1]}const ZT=1e-6;class ea{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,o=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${o}`:(Math.abs(this._x1-r)>ZT||Math.abs(this._y1-o)>ZT)&&(this._+="L"+r+","+o),!!i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=o}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class y2{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class zJ{constructor(t,[n,i,r,o]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((o=+o)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=o,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this,o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let h=0,p=0,g=i.length,m,y;h<g;h+=3,p+=2){const v=i[h]*2,b=i[h+1]*2,w=i[h+2]*2,E=t[v],S=t[v+1],_=t[b],A=t[b+1],C=t[w],k=t[w+1],$=_-E,F=A-S,D=C-E,L=k-S,M=$*$+F*F,I=D*D+L*L,U=($*L-F*D)*2;if(!U)m=(E+C)/2-1e8*L,y=(S+k)/2+1e8*D;else if(Math.abs(U)<1e-8)m=(E+C)/2,y=(S+k)/2;else{const Y=1/U;m=E+(L*M-F*I)*Y,y=S+($*I-D*M)*Y}o[p]=m,o[p+1]=y}let s=n[n.length-1],a,u=s*4,l,c=t[2*s],f,d=t[2*s+1];r.fill(0);for(let h=0;h<n.length;++h)s=n[h],a=u,l=c,f=d,u=s*4,c=t[2*s],d=t[2*s+1],r[a+2]=r[u]=f-d,r[a+3]=r[u+1]=c-l}render(t){const n=t==null?t=new ea:void 0,{delaunay:{halfedges:i,inedges:r,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=s[h],m=s[h+1],y=s[p],v=s[p+1];this._renderSegment(g,m,y,v,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=Math.floor(r[l]/3)*2,d=s[f],h=s[f+1],p=u*4,g=this._project(d,h,a[p+2],a[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new ea:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new ea:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let o=r.length;for(;r[0]===r[o-2]&&r[1]===r[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(r[s]!==r[s-2]||r[s+1]!==r[s-1])&&n.lineTo(r[s],r[s+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new y2;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,o){let s;const a=this._regioncode(t,n),u=this._regioncode(i,r);a===0&&u===0?(o.moveTo(t,n),o.lineTo(i,r)):(s=this._clipSegment(t,n,i,r,a,u))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r)e:for(let o=0,s=n.length;o<s;o+=2)for(let a=0,u=r.length;a<u;a+=2)if(n[o]==r[a]&&n[o+1]==r[a+1]&&n[(o+2)%s]==r[(a+u-2)%u]&&n[(o+3)%s]==r[(a+u-1)%u]){yield i;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:o}}=this,s=i[t];if(s===-1)return null;const a=[];let u=s;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,o[u]!==t)break;u=r[u]}while(u!==s&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n)}_clipFinite(t,n){const i=n.length;let r=null,o,s,a=n[i-2],u=n[i-1],l,c=this._regioncode(a,u),f,d;for(let h=0;h<i;h+=2)if(o=a,s=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,r?r.push(a,u):r=[a,u];else{let p,g,m,y,v;if(l===0){if((p=this._clipSegment(o,s,a,u,l,c))===null)continue;[g,m,y,v]=p}else{if((p=this._clipSegment(a,u,o,s,c,l))===null)continue;[y,v,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(g,m):r=[g,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(y,v):r=[y,v]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,o,s){for(;;){if(o===0&&s===0)return[t,n,i,r];if(o&s)return null;let a,u,l=o||s;l&8?(a=t+(i-t)*(this.ymax-n)/(r-n),u=this.ymax):l&4?(a=t+(i-t)*(this.ymin-n)/(r-n),u=this.ymin):l&2?(u=n+(r-n)*(this.xmax-t)/(i-t),a=this.xmax):(u=n+(r-n)*(this.xmin-t)/(i-t),a=this.xmin),o?(t=a,n=u,o=this._regioncode(t,n)):(i=a,r=u,s=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,o,s){let a=Array.from(n),u;if((u=this._project(a[0],a[1],i,r))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,o){for(;n!==i;){let s,a;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,a=this.ymin;break}(r[o]!==s||r[o+1]!==a)&&this.contains(t,s,a)&&(r.splice(o,0,s,a),o+=2)}if(r.length>4)for(let s=0;s<r.length;s+=2){const a=(s+2)%r.length,u=(s+4)%r.length;(r[s]===r[a]&&r[a]===r[u]||r[s+1]===r[a+1]&&r[a+1]===r[u+1])&&(r.splice(a,2),s-=2)}return o}_project(t,n,i,r){let o=Infinity,s,a,u;if(r<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/r)<o&&(u=this.ymin,a=t+(o=s)*i)}else if(r>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/r)<o&&(u=this.ymax,a=t+(o=s)*i)}if(i>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/i)<o&&(a=this.xmax,u=n+(o=s)*r)}else if(i<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/i)<o&&(a=this.xmin,u=n+(o=s)*r)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const BJ=2*Math.PI,Lu=Math.pow;function UJ(e){return e[0]}function jJ(e){return e[1]}function qJ(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],o=2*t[i+1],s=2*t[i+2];if((n[s]-n[r])*(n[o+1]-n[r+1])-(n[o]-n[r])*(n[s+1]-n[r+1])>1e-10)return!1}return!0}function WJ(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class v2{static from(t,n=UJ,i=jJ,r){return new v2("length"in t?HJ(t,n,i,r):Float64Array.from(GJ(t,n,i,r)))}constructor(t){this._delaunator=new ag(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&qJ(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=WJ(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new ag(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=o[u%3==2?u-2:u+1];(i[u]===-1||s[c]===-1)&&(s[c]=u)}for(let u=0,l=r.length;u<l;++u)a[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],s[r[0]]=1,r.length===2&&(s[r[1]]=0))}voronoi(t){return new zJ(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:o,triangles:s,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=s[l],l=l%3==2?l-2:l+1,s[l]!==t)return;if(l=o[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let o;for(;(o=this._step(i,t,n))>=0&&o!==i&&o!==r;)i=o;return o}_step(t,n,i){const{inedges:r,hull:o,_hullIndex:s,halfedges:a,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=Lu(n-l[t*2],2)+Lu(i-l[t*2+1],2);const d=r[t];let h=d;do{let p=u[h];const g=Lu(n-l[p*2],2)+Lu(i-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=a[h],h===-1){if(h=o[(s[t]+1)%o.length],h!==p&&Lu(n-l[h*2],2)+Lu(i-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new ea:void 0,{points:i,halfedges:r,triangles:o}=this;for(let s=0,a=r.length;s<a;++s){const u=r[s];if(u<s)continue;const l=o[s]*2,c=o[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const i=t==null?t=new ea:void 0,{points:r}=this;for(let o=0,s=r.length;o<s;o+=2){const a=r[o],u=r[o+1];t.moveTo(a+n,u),t.arc(a,u,n,0,BJ)}return i&&i.value()}renderHull(t){const n=t==null?t=new ea:void 0,{hull:i,points:r}=this,o=i[0]*2,s=i.length;t.moveTo(r[o],r[o+1]);for(let a=1;a<s;++a){const u=2*i[a];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new y2;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new ea:void 0,{points:r,triangles:o}=this,s=o[t*=3]*2,a=o[t+1]*2,u=o[t+2]*2;return n.moveTo(r[s],r[s+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new y2;return this.renderTriangle(t,n),n.value()}}function HJ(e,t,n,i){const r=e.length,o=new Float64Array(r*2);for(let s=0;s<r;++s){const a=e[s];o[s*2]=t.call(i,a,s,e),o[s*2+1]=n.call(i,a,s,e)}return o}function*GJ(e,t,n,i){let r=0;for(const o of e)yield t.call(i,o,r,e),yield n.call(i,o,r,e),++r}function b2(e){T.call(this,null,e)}b2.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const YJ=[-1e5,-1e5,1e5,1e5];q(b2,T,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:YJ;const o=this.value=v2.from(i,e.x,e.y).voronoi(r);for(let s=0,a=i.length;s<a;++s){const u=o.cellPolygon(s);i[s][n]=u?VJ(u):null}return t.reflow(e.modified()).modifies(n)}});function VJ(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}var XJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:b2}),x2=Math.PI/180,af=1<<11>>5,lg=1<<11;function KJ(){var e=[256,256],t,n,i,r,o,s,a,u=QT,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(su()),g=nZ((e[0]>>5)*e[1]),m=null,y=l.length,v=-1,b=[],w=l.map(S=>({text:t(S),font:n(S),style:r(S),weight:o(S),rotate:s(S),size:~~(i(S)+1e-14),padding:a(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,_)=>_.size-S.size);++v<y;){var E=w[v];E.x=e[0]*(c()+.5)>>1,E.y=e[1]*(c()+.5)>>1,JJ(p,E,w,v),E.hasText&&h(g,E,m)&&(b.push(E),m?QJ(m,E):m=[{x:E.x+E.x0,y:E.y+E.y0},{x:E.x+E.x1,y:E.y+E.y1}],E.x-=e[0]>>1,E.y-=e[1]>>1)}return b};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(af<<5)/g,p.height=lg/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var y=g.x,v=g.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),w=u(e),E=c()<.5?1:-1,S=-E,_,A,C;(_=w(S+=E))&&(A=~~_[0],C=~~_[1],!(Math.min(Math.abs(A),Math.abs(C))>=b));)if(g.x=y+A,g.y=v+C,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!ZJ(g,p,e[0]))&&(!m||eZ(g,m))){for(var k=g.sprite,$=g.width>>5,F=e[0]>>5,D=g.x-($<<4),L=D&127,M=32-L,I=g.y1-g.y0,U=(g.y+g.y0)*F+(D>>5),Y,Q=0;Q<I;Q++){Y=0;for(var ce=0;ce<=$;ce++)p[U+ce]|=Y<<M|(ce<$?(Y=k[Q*$+ce])>>>L:0);U+=F}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=ta(p),f):n},f.fontStyle=function(p){return arguments.length?(r=ta(p),f):r},f.fontWeight=function(p){return arguments.length?(o=ta(p),f):o},f.rotate=function(p){return arguments.length?(s=ta(p),f):s},f.text=function(p){return arguments.length?(t=ta(p),f):t},f.spiral=function(p){return arguments.length?(u=iZ[p]||p,f):u},f.fontSize=function(p){return arguments.length?(i=ta(p),f):i},f.padding=function(p){return arguments.length?(a=ta(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function JJ(e,t,n,i){if(!t.sprite){var r=e.context,o=e.ratio;r.clearRect(0,0,(af<<5)/o,lg/o);var s=0,a=0,u=0,l=n.length,c,f,d,h,p;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=r.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*x2),m=Math.cos(t.rotate*x2),y=c*m,v=c*g,b=d*m,w=d*g;c=Math.max(Math.abs(y+w),Math.abs(y-w))+31>>5<<5,d=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else c=c+31>>5<<5;if(d>u&&(u=d),s+c>=af<<5&&(s=0,a+=u,u=0),a+d>=lg)break;r.translate((s+(c>>1))/o,(a+(d>>1))/o),t.rotate&&r.rotate(t.rotate*x2),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=s,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=c}for(var E=r.getImageData(0,0,(af<<5)/o,lg/o).data,S=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(s=t.xoff,s==null)return;a=t.yoff;var _=0,A=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var C=f*p+(h>>5),k=E[(a+p)*(af<<5)+(s+h)<<2]?1<<31-h%32:0;S[C]|=k,_|=k}_?A=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+A,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function ZJ(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,o=e.x-(r<<4),s=o&127,a=32-s,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=r;d++)if((c<<a|(d<r?(c=i[f*r+d])>>>s:0))&t[l+d])return!0;l+=n}return!1}function QJ(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function eZ(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function QT(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function tZ(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(o){var s=o<0?-1:1;switch(Math.sqrt(1+4*s*o)-s&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function nZ(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function ta(e){return typeof e=="function"?e:function(){return e}}var iZ={archimedean:QT,rectangular:tZ};const eO=["x","y","font","fontSize","fontStyle","fontWeight","angle"],rZ=["text","font","rotate","fontSize","fontStyle","fontWeight"];function w2(e){T.call(this,KJ(),e)}w2.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:eO}]},q(w2,T,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&N("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return fe(g)&&t.modified(g.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||rZ.some(n)))return;const r=t.materialize(t.SOURCE).source,o=this.value,s=e.as||eO;let a=e.fontSize||14,u;if(fe(a)?u=e.fontSizeRange:a=zt(a),u){const p=a,g=Ae("sqrt")().domain(qi(r,p)).range(u);a=m=>g(p(m))}r.forEach(p=>{p[s[0]]=NaN,p[s[1]]=NaN,p[s[3]]=0});const l=o.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Jn).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,m;p<h;++p)g=l[p],m=g.datum,m[s[0]]=g.x+f,m[s[1]]=g.y+d,m[s[2]]=g.font,m[s[3]]=g.size,m[s[4]]=g.style,m[s[5]]=g.weight,m[s[6]]=g.rotate;return t.reflow(i).modifies(s)}});var oZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:w2});const sZ=e=>new Uint8Array(e),aZ=e=>new Uint16Array(e),uf=e=>new Uint32Array(e);function uZ(){let e=8,t=[],n=uf(0),i=cg(0,e),r=cg(0,e);return{data:()=>t,seen:()=>n=lZ(n,t.length),add(o){for(let s=0,a=t.length,u=o.length,l;s<u;++s)l=o[s],l._index=a++,t.push(l)},remove(o,s){const a=t.length,u=Array(a-o),l=t;let c,f,d;for(f=0;!s[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],s[f]?l[f]=-1:(l[f]=d,i[d]=i[f],r[d]=r[f],u[d]=c,c._index=d++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:o=>r[o]=i[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,s){i[o]|=s},clear(o,s){i[o]&=~s},resize(o,s){const a=i.length;(o>a||s>e)&&(e=Math.max(s,e),i=cg(o,e,i),r=cg(o,e))}}}function lZ(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function cg(e,t,n){const i=(t<257?sZ:t<65537?aZ:uf)(e);return n&&i.set(n),i}function tO(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,o){const s=this,a=s.bisect(s.range,r.value),u=r.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=i;for(d=c;d<f;++d)o[u[d]]|=i;return s}}}function nO(){let e=uf(0),t=[],n=0;function i(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=uf(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=a(u[m]),d[m]=m;if(h=cZ(h,d),c)p=t,g=e,t=Array(c+f),e=uf(c+f),fZ(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function r(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function o(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function s(a,u){let l;return u?l=u.length:(u=t,l=n),[xz(u,a[0],0,l),vo(u,a[1],0,l)]}return{insert:i,remove:r,bisect:s,reindex:o,index:()=>e,size:()=>n}}function cZ(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],o=e[i];return r<o?-1:r>o?1:0}),Ez(e,t)}function fZ(e,t,n,i,r,o,s,a,u){let l=0,c=0,f;for(f=0;l<i&&c<s;++f)t[l]<r[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=r[c],u[f]=o[c++]+e);for(;l<i;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<s;++c,++f)a[f]=r[c],u[f]=o[c]+e}function _2(e){T.call(this,uZ(),e),this._indices=null,this._dims=null}_2.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},q(_2,T,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},o=this._dims=[],s=i.length;let a=0,u,l;for(;a<s;++a)u=n[a].fname,l=r[u]||(r[u]=nO()),o.push(tO(l,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,o=this._indices,s=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=r.length,p={};let g,m,y,v,b,w,E,S,_;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(w={},v=t.mod,E=0,S=v.length;E<S;++E)w[v[E]._index]=1;for(E=0;E<h;++E)_=i[E],(!s[E]||e.modified("fields",E)||t.modified(_.fields))&&(y=_.fname,(g=p[y])||(o[y]=m=nO(),p[y]=g=m.insert(_,t.source,0)),s[E]=tO(m,E,r[E]).onAdd(g,u));for(E=0,S=a.data().length;E<S;++E)b[E]||(l[E]!==u[E]?f.push(E):w[E]&&u[E]!==c&&d.push(E));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,o=this._dims,s=this._indices,a=e.fields,u={},l=n.add,c=r.size()+i.length,f=o.length;let d=r.size(),h,p,g;r.resize(c,f),r.add(i);const m=r.curr(),y=r.prev(),v=r.all();for(h=0;h<f;++h)p=a[h].fname,g=u[p]||(u[p]=s[p].insert(a[h],i,d)),o[h].onAdd(g,m);for(;d<c;++d)y[d]=v,m[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),o=i.all(),s=e.mod;let a,u,l;for(a=0,u=s.length;a<u;++a)l=s[a]._index,r[l]!==o&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,o=r.curr(),s=r.prev(),a=r.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,s[h]=p=o[h],o[h]=a,p!==a&&l.push(h);for(h in i)i[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const o=r.remove(t,n);for(const s in i)i[s].reindex(o)})},update(e,t,n){const i=this._dims,r=e.query,o=t.stamp,s=i.length;let a=0,u,l;for(n.filters=0,l=0;l<s;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,a=0;l<s;++l)!e.modified("query",l)||(a|=i[l].one,this.incrementAll(i[l],r[l],o,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,o=r.seen(),s=r.curr(),a=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,i.push(v)),s[v]^=g;else if(f>h)for(m=h,y=Math.min(f,p);m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,i.push(v)),s[v]^=g;if(d>p)for(m=Math.max(f,p),y=d;m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,i.push(v)),s[v]^=g;else if(d<p)for(m=Math.max(h,d),y=p;m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,i.push(v)),s[v]^=g;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,o=r.curr(),s=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=s[p],o[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=s[p],o[m]^=h,i.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=s[p],o[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=s[p],o[m]^=h,i.push(m);e.range=t.slice()}});function E2(e){T.call(this,null,e)}E2.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},q(E2,T,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if((r&n)==0)return t.StopPropagation;const o=t.fork(t.ALL),s=i.data(),a=i.curr(),u=i.prev(),l=c=>a[c]&n?null:s[c];return o.filter(o.MOD,l),r&r-1?(o.filter(o.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?s[c]:null}),o.filter(o.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?s[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(a[c]&n)===r?s[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});var dZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:_2,resolvefilter:E2});const hZ="RawCode",na="Literal",pZ="Property",gZ="Identifier",mZ="ArrayExpression",yZ="BinaryExpression",iO="CallExpression",vZ="ConditionalExpression",bZ="LogicalExpression",xZ="MemberExpression",wZ="ObjectExpression",_Z="UnaryExpression";function $i(e){this.type=e}$i.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=EZ(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function EZ(e){switch(e.type){case mZ:return e.elements;case yZ:case bZ:return[e.left,e.right];case iO:return[e.callee].concat(e.arguments);case vZ:return[e.test,e.consequent,e.alternate];case xZ:return[e.object,e.property];case wZ:return e.properties;case pZ:return[e.key,e.value];case _Z:return[e.argument];case gZ:case na:case hZ:default:return[]}}var ar,ee,O,Gt,Te,fg=1,lf=2,ia=3,Ko=4,dg=5,ra=6,Cn=7,cf=8,SZ=9;ar={},ar[fg]="Boolean",ar[lf]="<end>",ar[ia]="Identifier",ar[Ko]="Keyword",ar[dg]="Null",ar[ra]="Numeric",ar[Cn]="Punctuator",ar[cf]="String",ar[SZ]="RegularExpression";var AZ="ArrayExpression",kZ="BinaryExpression",CZ="CallExpression",$Z="ConditionalExpression",rO="Identifier",MZ="Literal",FZ="LogicalExpression",DZ="MemberExpression",TZ="ObjectExpression",OZ="Property",NZ="UnaryExpression",_t="Unexpected token %0",RZ="Unexpected number",LZ="Unexpected string",IZ="Unexpected identifier",PZ="Unexpected reserved word",zZ="Unexpected end of input",S2="Invalid regular expression",A2="Invalid regular expression: missing /",oO="Octal literals are not allowed in strict mode.",BZ="Duplicate data property in object literal not allowed in strict mode",Tt="ILLEGAL",ff="Disabled.",UZ=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),jZ=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function hg(e,t){if(!e)throw new Error("ASSERT: "+t)}function Yr(e){return e>=48&&e<=57}function k2(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function df(e){return"01234567".indexOf(e)>=0}function qZ(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function hf(e){return e===10||e===13||e===8232||e===8233}function pf(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&UZ.test(String.fromCharCode(e))}function pg(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&jZ.test(String.fromCharCode(e))}const WZ={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function sO(){for(;O<Gt;){const e=ee.charCodeAt(O);if(qZ(e)||hf(e))++O;else break}}function C2(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)O<Gt&&k2(ee[O])?(i=ee[O++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):ke({},_t,Tt);return String.fromCharCode(r)}function HZ(){var e,t,n,i;for(e=ee[O],t=0,e==="}"&&ke({},_t,Tt);O<Gt&&(e=ee[O++],!!k2(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&ke({},_t,Tt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function aO(){var e,t;for(e=ee.charCodeAt(O++),t=String.fromCharCode(e),e===92&&(ee.charCodeAt(O)!==117&&ke({},_t,Tt),++O,e=C2("u"),(!e||e==="\\"||!pf(e.charCodeAt(0)))&&ke({},_t,Tt),t=e);O<Gt&&(e=ee.charCodeAt(O),!!pg(e));)++O,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ee.charCodeAt(O)!==117&&ke({},_t,Tt),++O,e=C2("u"),(!e||e==="\\"||!pg(e.charCodeAt(0)))&&ke({},_t,Tt),t+=e);return t}function GZ(){var e,t;for(e=O++;O<Gt;){if(t=ee.charCodeAt(O),t===92)return O=e,aO();if(pg(t))++O;else break}return ee.slice(e,O)}function YZ(){var e,t,n;return e=O,t=ee.charCodeAt(O)===92?aO():GZ(),t.length===1?n=ia:WZ.hasOwnProperty(t)?n=Ko:t==="null"?n=dg:t==="true"||t==="false"?n=fg:n=ia,{type:n,value:t,start:e,end:O}}function $2(){var e=O,t=ee.charCodeAt(O),n,i=ee[O],r,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++O,{type:Cn,value:String.fromCharCode(t),start:e,end:O};default:if(n=ee.charCodeAt(O+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return O+=2,{type:Cn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:O};case 33:case 61:return O+=2,ee.charCodeAt(O)===61&&++O,{type:Cn,value:ee.slice(e,O),start:e,end:O}}}if(s=ee.substr(O,4),s===">>>=")return O+=4,{type:Cn,value:s,start:e,end:O};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return O+=3,{type:Cn,value:o,start:e,end:O};if(r=o.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return O+=2,{type:Cn,value:r,start:e,end:O};if(r==="//"&&ke({},_t,Tt),"<>=!+-*%&|^/".indexOf(i)>=0)return++O,{type:Cn,value:i,start:e,end:O};ke({},_t,Tt)}function VZ(e){let t="";for(;O<Gt&&k2(ee[O]);)t+=ee[O++];return t.length===0&&ke({},_t,Tt),pf(ee.charCodeAt(O))&&ke({},_t,Tt),{type:ra,value:parseInt("0x"+t,16),start:e,end:O}}function XZ(e){let t="0"+ee[O++];for(;O<Gt&&df(ee[O]);)t+=ee[O++];return(pf(ee.charCodeAt(O))||Yr(ee.charCodeAt(O)))&&ke({},_t,Tt),{type:ra,value:parseInt(t,8),octal:!0,start:e,end:O}}function uO(){var e,t,n;if(n=ee[O],hg(Yr(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=O,e="",n!=="."){if(e=ee[O++],n=ee[O],e==="0"){if(n==="x"||n==="X")return++O,VZ(t);if(df(n))return XZ(t);n&&Yr(n.charCodeAt(0))&&ke({},_t,Tt)}for(;Yr(ee.charCodeAt(O));)e+=ee[O++];n=ee[O]}if(n==="."){for(e+=ee[O++];Yr(ee.charCodeAt(O));)e+=ee[O++];n=ee[O]}if(n==="e"||n==="E")if(e+=ee[O++],n=ee[O],(n==="+"||n==="-")&&(e+=ee[O++]),Yr(ee.charCodeAt(O)))for(;Yr(ee.charCodeAt(O));)e+=ee[O++];else ke({},_t,Tt);return pf(ee.charCodeAt(O))&&ke({},_t,Tt),{type:ra,value:parseFloat(e),start:t,end:O}}function KZ(){var e="",t,n,i,r,o=!1;for(t=ee[O],hg(t==="'"||t==='"',"String literal must starts with a quote"),n=O,++O;O<Gt;)if(i=ee[O++],i===t){t="";break}else if(i==="\\")if(i=ee[O++],!i||!hf(i.charCodeAt(0)))switch(i){case"u":case"x":ee[O]==="{"?(++O,e+=HZ()):e+=C2(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:df(i)?(r="01234567".indexOf(i),r!==0&&(o=!0),O<Gt&&df(ee[O])&&(o=!0,r=r*8+"01234567".indexOf(ee[O++]),"0123".indexOf(i)>=0&&O<Gt&&df(ee[O])&&(r=r*8+"01234567".indexOf(ee[O++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&ee[O]===`
`&&++O;else{if(hf(i.charCodeAt(0)))break;e+=i}return t!==""&&ke({},_t,Tt),{type:cf,value:e,octal:o,start:n,end:O}}function JZ(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";ke({},S2)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(i){ke({},S2)}try{return new RegExp(e,t)}catch(i){return null}}function ZZ(){var e,t,n,i,r;for(e=ee[O],hg(e==="/","Regular expression literal must start with a slash"),t=ee[O++],n=!1,i=!1;O<Gt;)if(e=ee[O++],t+=e,e==="\\")e=ee[O++],hf(e.charCodeAt(0))&&ke({},A2),t+=e;else if(hf(e.charCodeAt(0)))ke({},A2);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||ke({},A2),r=t.substr(1,t.length-2),{value:r,literal:t}}function QZ(){var e,t,n;for(t="",n="";O<Gt&&(e=ee[O],!!pg(e.charCodeAt(0)));)++O,e==="\\"&&O<Gt?ke({},_t,Tt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&ke({},S2,n),{value:n,literal:t}}function eQ(){var e,t,n,i;return Te=null,sO(),e=O,t=ZZ(),n=QZ(),i=JZ(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:O}}function tQ(e){return e.type===ia||e.type===Ko||e.type===fg||e.type===dg}function lO(){if(sO(),O>=Gt)return{type:lf,start:O,end:O};const e=ee.charCodeAt(O);return pf(e)?YZ():e===40||e===41||e===59?$2():e===39||e===34?KZ():e===46?Yr(ee.charCodeAt(O+1))?uO():$2():Yr(e)?uO():$2()}function $n(){const e=Te;return O=e.end,Te=lO(),O=e.end,e}function cO(){const e=O;Te=lO(),O=e}function nQ(e){const t=new $i(AZ);return t.elements=e,t}function fO(e,t,n){const i=new $i(e==="||"||e==="&&"?FZ:kZ);return i.operator=e,i.left=t,i.right=n,i}function iQ(e,t){const n=new $i(CZ);return n.callee=e,n.arguments=t,n}function rQ(e,t,n){const i=new $i($Z);return i.test=e,i.consequent=t,i.alternate=n,i}function M2(e){const t=new $i(rO);return t.name=e,t}function gf(e){const t=new $i(MZ);return t.value=e.value,t.raw=ee.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function dO(e,t,n){const i=new $i(DZ);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function oQ(e){const t=new $i(TZ);return t.properties=e,t}function hO(e,t,n){const i=new $i(OZ);return i.key=t,i.value=n,i.kind=e,i}function sQ(e,t){const n=new $i(NZ);return n.operator=e,n.argument=t,n.prefix=!0,n}function ke(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(o,s)=>(hg(s<i.length,"Message reference must be in range"),i[s]));throw n=new Error(r),n.index=O,n.description=r,n}function gg(e){e.type===lf&&ke(e,zZ),e.type===ra&&ke(e,RZ),e.type===cf&&ke(e,LZ),e.type===ia&&ke(e,IZ),e.type===Ko&&ke(e,PZ),ke(e,_t,e.value)}function Yt(e){const t=$n();(t.type!==Cn||t.value!==e)&&gg(t)}function je(e){return Te.type===Cn&&Te.value===e}function F2(e){return Te.type===Ko&&Te.value===e}function aQ(){const e=[];for(O=Te.start,Yt("[");!je("]");)je(",")?($n(),e.push(null)):(e.push(oa()),je("]")||Yt(","));return $n(),nQ(e)}function pO(){O=Te.start;const e=$n();return e.type===cf||e.type===ra?(e.octal&&ke(e,oO),gf(e)):M2(e.value)}function uQ(){var e,t,n,i;if(O=Te.start,e=Te,e.type===ia)return n=pO(),Yt(":"),i=oa(),hO("init",n,i);if(e.type===lf||e.type===Cn)gg(e);else return t=pO(),Yt(":"),i=oa(),hO("init",t,i)}function lQ(){var e=[],t,n,i,r={},o=String;for(O=Te.start,Yt("{");!je("}");)t=uQ(),t.key.type===rO?n=t.key.name:n=o(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?ke({},BZ):r[i]=!0,e.push(t),je("}")||Yt(",");return Yt("}"),oQ(e)}function cQ(){Yt("(");const e=D2();return Yt(")"),e}const fQ={if:1};function dQ(){var e,t,n;if(je("("))return cQ();if(je("["))return aQ();if(je("{"))return lQ();if(e=Te.type,O=Te.start,e===ia||fQ[Te.value])n=M2($n().value);else if(e===cf||e===ra)Te.octal&&ke(Te,oO),n=gf($n());else{if(e===Ko)throw new Error(ff);e===fg?(t=$n(),t.value=t.value==="true",n=gf(t)):e===dg?(t=$n(),t.value=null,n=gf(t)):je("/")||je("/=")?(n=gf(eQ()),cO()):gg($n())}return n}function hQ(){const e=[];if(Yt("("),!je(")"))for(;O<Gt&&(e.push(oa()),!je(")"));)Yt(",");return Yt(")"),e}function pQ(){O=Te.start;const e=$n();return tQ(e)||gg(e),M2(e.value)}function gQ(){return Yt("."),pQ()}function mQ(){Yt("[");const e=D2();return Yt("]"),e}function yQ(){var e,t,n;for(e=dQ();;)if(je("."))n=gQ(),e=dO(".",e,n);else if(je("("))t=hQ(),e=iQ(e,t);else if(je("["))n=mQ(),e=dO("[",e,n);else break;return e}function gO(){const e=yQ();if(Te.type===Cn&&(je("++")||je("--")))throw new Error(ff);return e}function mg(){var e,t;if(Te.type!==Cn&&Te.type!==Ko)t=gO();else{if(je("++")||je("--"))throw new Error(ff);if(je("+")||je("-")||je("~")||je("!"))e=$n(),t=mg(),t=sQ(e.value,t);else{if(F2("delete")||F2("void")||F2("typeof"))throw new Error(ff);t=gO()}}return t}function mO(e){let t=0;if(e.type!==Cn&&e.type!==Ko)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function vQ(){var e,t,n,i,r,o,s,a,u,l;if(e=Te,u=mg(),i=Te,r=mO(i),r===0)return u;for(i.prec=r,$n(),t=[e,Te],s=mg(),o=[u,i,s];(r=mO(Te))>0;){for(;o.length>2&&r<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),t.pop(),n=fO(a,u,s),o.push(n);i=$n(),i.prec=r,o.push(i),t.push(Te),n=mg(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=fO(o[l-1].value,o[l-2],n),l-=2;return n}function oa(){var e,t,n;return e=vQ(),je("?")&&($n(),t=oa(),Yt(":"),n=oa(),e=rQ(e,t,n)),e}function D2(){const e=oa();if(je(","))throw new Error(ff);return e}function T2(e){ee=e,O=0,Gt=ee.length,Te=null,cO();const t=D2();if(Te.type!==lf)throw new Error("Unexpect token after expression.");return t}var yO={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function vO(e){function t(s,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+s+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(s,a,u){return l=>t(s,l,a,u)}const i="new Date",r="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&N("Missing arguments to clamp function."),s.length>3&&N("Too many arguments to clamp function.");const a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:o,test:n("test",o),if:function(s){s.length<3&&N("Missing arguments to if function."),s.length>3&&N("Too many arguments to if function.");const a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function bQ(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function bO(e){e=e||{};const t=e.allowed?vt(e.allowed):{},n=e.forbidden?vt(e.forbidden):{},i=e.constants||yO,r=(e.functions||vO)(f),o=e.globalvar,s=e.fieldvar,a=fe(o)?o:p=>"".concat(o,'["').concat(p,'"]');let u={},l={},c=0;function f(p){if(V(p))return p;const g=d[p.type];return g==null&&N("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:te(n,g)?N("Illegal identifier: "+g):te(i,g)?i[g]:te(t,g)?g:(u[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const y=f(p.property);return m===s&&(l[bQ(y)]=1),g&&(c-=1),m+(g?"."+y:"["+y+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&N("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,y=te(r,g)&&r[g];return y||N("Unrecognized function: "+g),fe(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=r,h.constants=i,h}function xQ(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function wQ(e){let t=e,n=e;e.length===1&&(t=(s,a)=>e(s)-a,n=_Q(e));function i(s,a,u,l){for(u==null&&(u=0),l==null&&(l=s.length);u<l;){const c=u+l>>>1;n(s[c],a)<0?u=c+1:l=c}return u}function r(s,a,u,l){for(u==null&&(u=0),l==null&&(l=s.length);u<l;){const c=u+l>>>1;n(s[c],a)>0?l=c:u=c+1}return u}function o(s,a,u,l){u==null&&(u=0),l==null&&(l=s.length);const c=i(s,a,u,l-1);return c>u&&t(s[c-1],a)>-t(s[c],a)?c-1:c}return{left:i,center:o,right:r}}function _Q(e){return(t,n)=>xQ(e(t),n)}const O2="intersect",xO="union",EQ="vlMulti",SQ="vlPoint",wO="or",AQ="and",kQ="_vgsid_",CQ="E",$Q="R",MQ="R-E",FQ="R-LE",DQ="R-RE",yg="index:unit";function _O(e,t){for(var n=t.fields,i=t.values,r=n.length,o=0,s,a;o<r;++o)if(a=n[o],a.getter=bn.getter||bn(a.field),s=a.getter(e),mo(s)&&(s=Pt(s)),mo(i[o])&&(i[o]=Pt(i[o])),mo(i[o][0])&&(i[o]=i[o].map(Pt)),a.type===CQ){if(R(i[o])?i[o].indexOf(s)<0:s!==i[o])return!1}else if(a.type===$Q){if(!Ga(s,i[o]))return!1}else if(a.type===DQ){if(!Ga(s,i[o],!0,!1))return!1}else if(a.type===MQ){if(!Ga(s,i[o],!1,!1))return!1}else if(a.type===FQ&&!Ga(s,i[o],!1,!0))return!1;return!0}function TQ(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],o=i?i[yg]&&i[yg].value:void 0,s=n===O2,a=r.length,u=0,l,c,f,d,h;u<a;++u)if(l=r[u],o&&s){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=_O(t,l),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=_O(t,l),s^h)return h;return a&&s}const N2=bn(kQ),EO=wQ(N2),OQ=EO.left,NQ=EO.right;function RQ(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],o=i?i[yg]&&i[yg].value:void 0,s=n===O2,a=N2(t),u=OQ(r,a);if(u===r.length||N2(r[u])!==a)return!1;if(o&&s){if(o.size===1)return!0;if(NQ(r,a)-u<o.size)return!1}return!0}function LQ(e,t){return e.map(n=>de({values:t.fields.map(i=>(i.getter||(i.getter=bn(i.field)))(n.datum))},t))}function IQ(e,t,n,i){for(var r=this.context.data[e],o=r?r.values.value:[],s={},a={},u={},l,c,f,d,h,p,g,m,y,v=o.length,b=0,w,E;b<v;++b){for(l=o[b],d=l.unit,c=l.fields,f=l.values,w=0,E=c.length;w<E;++w)h=c[w],p=s[h.field]||(s[h.field]={}),g=p[d]||(p[d]=[]),u[h.field]=m=h.type.charAt(0),y=SO[m+"_union"],p[d]=y(g,K(f[w]));n&&(g=a[d]||(a[d]=[]),g.push(K(f).reduce((S,_,A)=>(S[c[A].field]=_,S),{})))}if(t=t||xO,Object.keys(s).forEach(S=>{s[S]=Object.keys(s[S]).map(_=>s[S][_]).reduce((_,A)=>_===void 0?A:SO[u[S]+"_"+t](_,A))}),o=Object.keys(a),n&&o.length){const S=i?SQ:EQ;s[S]=t===xO?{[wO]:o.reduce((_,A)=>(_.push(...a[A]),_),[])}:{[AQ]:o.map(_=>({[wO]:a[_]}))}}return s}var SO={E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Pt(t[0]),i=Pt(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=Pt(t[0]),i=Pt(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const PQ=":",zQ="@";function R2(e,t,n,i){t[0].type!==na&&N("First argument to selection functions must be a string literal.");const r=t[0].value,o=t.length>=2&&be(t).value,s="unit",a=zQ+s,u=PQ+r;o===O2&&!te(i,a)&&(i[a]=n.getData(r).indataRef(n,s)),te(i,u)||(i[u]=n.getData(r).tuplesRef())}function AO(e){const t=this.context.data[e];return t?t.values.value:[]}function BQ(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function UQ(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(Vn).insert(t)),1}function jQ(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const mf=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},qQ=mf("format"),kO=mf("timeFormat"),WQ=mf("utcFormat"),HQ=mf("timeParse"),GQ=mf("utcParse"),vg=new Date(2e3,0,1);function bg(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(vg.setYear(2e3),vg.setMonth(e),vg.setDate(t),kO.call(this,vg,n))}function YQ(e){return bg.call(this,e,1,"%B")}function VQ(e){return bg.call(this,e,1,"%b")}function XQ(e){return bg.call(this,0,2+e,"%A")}function KQ(e){return bg.call(this,0,2+e,"%a")}const JQ=":",ZQ="@",L2="%",CO="$";function I2(e,t,n,i){t[0].type!==na&&N("First argument to data functions must be a string literal.");const r=t[0].value,o=JQ+r;if(!te(o,i))try{i[o]=n.getData(r).tuplesRef()}catch(s){}}function QQ(e,t,n,i){t[0].type!==na&&N("First argument to indata must be a string literal."),t[1].type!==na&&N("Second argument to indata must be a string literal.");const r=t[0].value,o=t[1].value,s=ZQ+o;te(s,i)||(i[s]=n.getData(r).indataRef(n,o))}function Mn(e,t,n,i){if(t[0].type===na)$O(n,i,t[0].value);else for(e in n.scales)$O(n,i,e)}function $O(e,t,n){const i=L2+n;if(!te(t,i))try{t[i]=e.scaleRef(n)}catch(r){}}function Vr(e,t){let n;return fe(e)?e:V(e)?(n=t.scales[e])&&n.value:void 0}function eee(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=Mn,n._range=Mn,n._scale=Mn;const i=r=>"_["+(r.type===na?W(L2+r.value):W(L2)+"+"+e(r))+"]";return{_bandwidth:r=>"this.__bandwidth(".concat(i(r[0]),")"),_range:r=>"".concat(i(r[0]),".range()"),_scale:r=>"".concat(i(r[0]),"(").concat(e(r[1]),")")}}function P2(e,t){return function(n,i,r){if(n){const o=Vr(n,(r||this).context);return o&&o.path[e](i)}else return t(i)}}const tee=P2("area",$Y),nee=P2("bounds",TY),iee=P2("centroid",PY);function ree(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function z2(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function oee(){return z2(this.context.dataflow,"warn",arguments)}function see(){return z2(this.context.dataflow,"info",arguments)}function aee(){return z2(this.context.dataflow,"debug",arguments)}function B2(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function U2(e){const t=Fo(e),n=B2(t.r),i=B2(t.g),r=B2(t.b);return .2126*n+.7152*i+.0722*r}function uee(e,t){const n=U2(e),i=U2(t),r=Math.max(n,i),o=Math.min(n,i);return(r+.05)/(o+.05)}function lee(){const e=[].slice.call(arguments);return e.unshift({}),de(...e)}function MO(e,t){return e===t||e!==e&&t!==t?!0:R(e)?R(t)&&e.length===t.length?cee(e,t):!1:J(e)&&J(t)?FO(e,t):!1}function cee(e,t){for(let n=0,i=e.length;n<i;++n)if(!MO(e[n],t[n]))return!1;return!0}function FO(e,t){for(const n in e)if(!MO(e[n],t[n]))return!1;return!0}function DO(e){return t=>FO(e,t)}function fee(e,t,n,i,r,o){const s=this.context.dataflow,a=this.context.data[e],u=a.input,l=s.stamp();let c=a.changes,f,d;if(s._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(a.changes=c=s.changeset(),c.stamp=l,s.runAfter(()=>{a.modified=!0,s.pulse(u,c).run()},!0,1)),n&&(f=n===!0?Vn:R(n)||Kd(n)?n:DO(n),c.remove(f)),t&&c.insert(t),i&&(f=DO(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(d in o)c.modify(r,d,o[d]);return 1}function dee(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)}function hee(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const TO={};function pee(e,t){const n=TO[t]||(TO[t]=bn(t));return R(e)?e.map(n):n(e)}function j2(e){return R(e)||ArrayBuffer.isView(e)?e:null}function q2(e){return j2(e)||(V(e)?e:null)}function gee(e,...t){return j2(e).join(...t)}function mee(e,...t){return q2(e).indexOf(...t)}function yee(e,...t){return q2(e).lastIndexOf(...t)}function vee(e,...t){return q2(e).slice(...t)}function bee(e,t,n){return fe(n)&&N("Function argument passed to replace."),String(e).replace(t,n)}function xee(e){return j2(e).slice().reverse()}function wee(e,t,n){return xv(e||0,t||0,n||0)}function _ee(e,t){const n=Vr(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Eee(e,t){const n=Vr(e,(t||this).context);return n?n.copy():void 0}function See(e,t){const n=Vr(e,(t||this).context);return n?n.domain():[]}function Aee(e,t,n){const i=Vr(e,(n||this).context);return i?R(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function kee(e,t){const n=Vr(e,(t||this).context);return n&&n.range?n.range():[]}function Cee(e,t,n){const i=Vr(e,(n||this).context);return i?i(t):void 0}function $ee(e,t,n,i,r){e=Vr(e,(r||this).context);const o=WM(t,n);let s=e.domain(),a=s[0],u=be(s),l=It;return u-a?l=MM(e,a,u):e=(e.interpolator?Ae("sequential")().interpolator(e.interpolator()):Ae("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(s=e.ticks(+i||15),a!==s[0]&&s.unshift(a),u!==be(s)&&s.push(u)),s.forEach(c=>o.stop(l(c),e(c))),o}function Mee(e,t,n){const i=Vr(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function Fee(e){let t=null;return function(n){return n?yc(n,t=t||gu(e)):e}}const OO=e=>e.data;function NO(e,t){const n=AO.call(t,e);return n.root&&n.root.lookup||{}}function Dee(e,t,n){const i=NO(e,this),r=i[t],o=i[n];return r&&o?r.path(o).map(OO):void 0}function Tee(e,t){const n=NO(e,this)[t];return n?n.ancestors().map(OO):void 0}const RO=()=>typeof window!="undefined"&&window||null;function Oee(){const e=RO();return e?e.screen:{}}function Nee(){const e=RO();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Ree(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function Lee(e,t,n){if(!e)return[];const[i,r]=e,o=new ct().set(i[0],i[1],r[0],r[1]),s=n||this.context.dataflow.scenegraph().root;return r3(s,o,Iee(t))}function Iee(e){let t=null;if(e){const n=K(e.marktype),i=K(e.markname);t=r=>(!n.length||n.some(o=>r.marktype===o))&&(!i.length||i.some(o=>r.name===o))}return t}const yf={random(){return Jn()},cumulativeNormal:rh,cumulativeLogNormal:ey,cumulativeUniform:ry,densityNormal:X1,densityLogNormal:Q1,densityUniform:iy,quantileNormal:oh,quantileLogNormal:ty,quantileUniform:oy,sampleNormal:ih,sampleLogNormal:Z1,sampleUniform:ny,isArray:R,isBoolean:go,isDate:mo,isDefined(e){return e!==void 0},isNumber:Oe,isObject:J,isRegExp:cA,isString:V,isTuple:Kd,isValid(e){return e!=null&&e===e},toBoolean:J0,toDate:Z0,toNumber:Pt,toString:Q0,indexof:mee,join:gee,lastindexof:yee,replace:bee,reverse:xee,slice:vee,flush:uA,lerp:fA,merge:lee,pad:pA,peek:be,pluck:pee,span:Dl,inrange:Ga,truncate:gA,rgb:Fo,lab:xh,hcl:wh,hsl:vh,luminance:U2,contrast:uee,sequence:Ln,format:qQ,utcFormat:WQ,utcParse:GQ,utcOffset:sk,utcSequence:lk,timeFormat:kO,timeParse:HQ,timeOffset:ok,timeSequence:uk,timeUnitSpecifier:VA,monthFormat:YQ,monthAbbrevFormat:VQ,dayFormat:XQ,dayAbbrevFormat:KQ,quarter:rA,utcquarter:oA,week:KA,utcweek:QA,dayofyear:XA,utcdayofyear:ZA,warn:oee,info:see,debug:aee,extent:qi,inScope:ree,intersect:Lee,clampRange:sA,pinchDistance:dee,pinchAngle:hee,screen:Oee,containerSize:Ree,windowSize:Nee,bandspace:wee,setdata:UQ,pathShape:Fee,panLinear:eA,panLog:tA,panPow:nA,panSymlog:iA,zoomLinear:H0,zoomLog:G0,zoomPow:Rd,zoomSymlog:Y0,encode:jQ,modify:fee},Pee=["view","item","group","xy","x","y"],zee="event.vega.",LO="this.",W2={},IO={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(W(CO+e),"]"),functions:Bee,constants:yO,visitors:W2},H2=bO(IO);function Bee(e){const t=vO(e);Pee.forEach(n=>t[n]=zee+n);for(const n in yf)t[n]=LO+n;return de(t,eee(e,yf,W2)),t}function ot(e,t,n){return arguments.length===1?yf[e]:(yf[e]=t,n&&(W2[e]=n),H2&&(H2.functions[e]=LO+e),this)}ot("bandwidth",_ee,Mn),ot("copy",Eee,Mn),ot("domain",See,Mn),ot("range",kee,Mn),ot("invert",Aee,Mn),ot("scale",Cee,Mn),ot("gradient",$ee,Mn),ot("geoArea",tee,Mn),ot("geoBounds",nee,Mn),ot("geoCentroid",iee,Mn),ot("geoShape",Mee,Mn),ot("indata",BQ,QQ),ot("data",AO,I2),ot("treePath",Dee,I2),ot("treeAncestors",Tee,I2),ot("vlSelectionTest",TQ,R2),ot("vlSelectionIdTest",RQ,R2),ot("vlSelectionResolve",IQ,R2),ot("vlSelectionTuples",LQ);function ur(e,t){const n={};let i;try{e=V(e)?e:W(e)+"",i=T2(e)}catch(o){N("Expression parse error: "+e)}i.visit(o=>{if(o.type!==iO)return;const s=o.callee.name,a=IO.visitors[s];a&&a(s,o.arguments,t,n)});const r=H2(i);return r.globals.forEach(o=>{const s=CO+o;!te(n,s)&&t.getSignal(o)&&(n[s]=t.signalRef(o))}),{$expr:de({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function Uee(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const jee=vt(["rule"]),PO=vt(["group","image","rect"]);function qee(e,t){let n="";return jee[t]||(e.x2&&(e.x?(PO[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(PO[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function G2(e){return(e+"").toLowerCase()}function Wee(e){return G2(e)==="operator"}function Hee(e){return G2(e)==="collect"}function vf(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function Gee(e,t,n,i){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(i,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(i," : ")}var Yee={operator:(e,t)=>vf(e,["_"],t.code),parameter:(e,t)=>vf(e,["datum","_"],t.code),event:(e,t)=>vf(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return vf(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const o in i){const s="o["+W(o)+"]";r+="$=".concat(i[o].code,";if(").concat(s,"!==$)").concat(s,"=$,m=1;")}return r+=qee(i,n),r+="return m;",vf(e,["item","_"],r)},codegen:{get(e){const t="[".concat(e.map(W).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const i=(o,s)=>{const a=t[s];let u,l;return o.path?(u="a".concat(o.path),l="b".concat(o.path)):((n=n||{})["f"+s]=o,u="this.f".concat(s,"(a)"),l="this.f".concat(s,"(b)")),Gee(u,l,-a,a)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function Vee(e){const t=this;Wee(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function Xee(e){const t=this;if(e.params){const n=t.get(e.id);n||N("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Kee(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=R(r)?r.map(o=>zO(o,n,t)):zO(r,n,t)}return t}function zO(e,t,n){if(!e||!J(e))return e;for(let i=0,r=BO.length,o;i<r;++i)if(o=BO[i],te(e,o.key))return o.parse(e,t,n);return e}var BO=[{key:"$ref",parse:Jee},{key:"$key",parse:Qee},{key:"$expr",parse:Zee},{key:"$field",parse:ete},{key:"$encode",parse:nte},{key:"$compare",parse:tte},{key:"$context",parse:ite},{key:"$subflow",parse:rte},{key:"$tupleid",parse:ote}];function Jee(e,t){return t.get(e.$ref)||N("Operator not defined: "+e.$ref)}function Zee(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=vn(t.parameterExpression(e.$expr),e.$fields,e.$name))}function Qee(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=K0(e.$key,e.$flat,t.expr.codegen))}function ete(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=bn(e.$field,e.$name,t.expr.codegen))}function tte(e,t){const n="c:"+e.$compare+"_"+e.$order,i=K(e.$compare).map(r=>r&&r.$tupleid?ne:r);return t.fn[n]||(t.fn[n]=V0(i,e.$order,t.expr.codegen))}function nte(e,t){const n=e.$encode,i={};for(const r in n){const o=n[r];i[r]=vn(t.encodeExpression(o.$expr),o.$fields),i[r].output=o.$output}return i}function ite(e,t){return t}function rte(e,t){const n=e.$subflow;return function(i,r,o){const s=t.fork().parse(n),a=s.get(n.operators[0].id),u=s.signals.parent;return u&&u.set(o),a.detachSubflow=()=>t.detach(s),a}}function ote(){return ne}function ste(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(o=>t.get(o)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(o=>t.get(o)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&N("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function ate(e){var t=this,n=J(n=e.source)?n.$ref:n,i=t.get(n),r=null,o=e.update,s=void 0;i||N("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(s=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,i,r,o,s)}const ute={skip:!0};function lte(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(o=>{const s=t.signals[o];e.signals(o,s)&&(i[o]=s.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(o=>{const s=t.data[o];e.data(o,s)&&(r[o]=s.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function cte(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(o=>{n.update(t.signals[o],r[o],ute)}),Object.keys(i||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(Vn).insert(i[o]))}),(e.subcontext||[]).forEach((o,s)=>{const a=t.subcontext[s];a&&a.setState(o)})}function UO(e,t,n,i){return new jO(e,t,n,i)}function jO(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||Yee,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function qO(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}jO.prototype=qO.prototype={fork(){const e=new qO(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),Hee(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(i.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),i.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const s=n.data[o]||(n.data[o]={});e.data[o].forEach(a=>s[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[G2(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Uee,parseOperator:Vee,parseOperatorParameters:Xee,parseParameters:Kee,parseStream:ste,parseUpdate:ate,getState:lte,setState:cte};function fte(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),WO(t,e.description()))}function WO(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function dte(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const Y2="default";function hte(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:Y2,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,o=r?V(r)?r:r.user:Y2,s=i.item&&i.item.cursor||null;return r&&o===r.user&&s==r.item?r:{user:o,item:s}}),e.add(null,function(n){let i=n.cursor,r=this.value;return V(i)||(r=i.item,i=i.user),V2(e,i&&i!==Y2?i:r||i),r},{cursor:t})}function V2(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function xg(e,t){var n=e._runtime.data;return te(n,t)||N("Unrecognized data set: "+t),n[t]}function pte(e,t){return arguments.length<2?xg(this,e).values.value:wg.call(this,e,Ns().remove(Vn).insert(t))}function wg(e,t){Wk(t)||N("Second argument to changes must be a changeset.");const n=xg(this,e);return n.modified=!0,this.pulse(n.input,t)}function gte(e,t){return wg.call(this,e,Ns().insert(t))}function mte(e,t){return wg.call(this,e,Ns().remove(t))}function HO(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function GO(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function _g(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function yte(e){var t=_g(e),n=HO(e),i=GO(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(o){e.error(o)}})}function vte(e,t,n){var i=e._renderer,r=i&&i.canvas(),o,s,a;return r&&(a=_g(e),s=t.changedTouches?t.changedTouches[0]:t,o=Qh(s,r),o[0]-=a[0],o[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=bte(e,n,o),t}function bte(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(s){var a=i,u;if(s){for(u=t;u;u=u.mark.group)if(u.mark.name===s){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function o(s){if(!s)return n;V(s)&&(s=r(s));const a=n.slice();for(;s;)a[0]-=s.x||0,a[1]-=s.y||0,s=s.mark&&s.mark.group;return a}return{view:zt(e),item:zt(t||{}),group:r,xy:o,x:s=>o(s)[0],y:s=>o(s)[1]}}const YO="view",xte="timer",wte="window",_te={trap:!1};function Ete(e){const t=de({defaults:{}},e),n=(i,r)=>{r.forEach(o=>{R(i[o])&&(i[o]=vt(i[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function VO(e,t,n,i){e._eventListeners.push({type:n,sources:K(t),handler:i})}function Ste(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function Eg(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||J(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Ate(e,t,n){var i=this,r=new eh(n),o=function(l,c){i.runAsync(null,()=>{e===YO&&Ste(i,t)&&l.preventDefault(),r.receive(vte(i,l,c))})},s;if(e===xte)Eg(i,"timer",t)&&i.timer(o,t);else if(e===YO)Eg(i,"view",t)&&i.addEventListener(t,o,_te);else if(e===wte?Eg(i,"window",t)&&typeof window!="undefined"&&(s=[window]):typeof document!="undefined"&&Eg(i,"selector",t)&&(s=document.querySelectorAll(e)),!s)i.warn("Can not resolve event source: "+e);else{for(var a=0,u=s.length;a<u;++a)s[a].addEventListener(t,o);VO(i,s,t,o)}return r}function XO(e){return e.item}function KO(e){return e.item.mark.source}function JO(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function kte(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",XO),KO,JO(e)),this.on(this.events("view","mouseout",XO),KO,JO(t)),this}function Cte(){var e=this._tooltip,t=this._timers,n=this._eventListeners,i,r,o;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(o=n[i],r=o.sources.length;--r>=0;)o.sources[r].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function jn(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const $te="vega-bind",Mte="vega-bind-name",Fte="vega-bind-radio";function Dte(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,s)})}},i.debounce&&(r.update=X0(i.debounce,r.update))),(i.input==null&&i.element?Tte:Nte)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function Tte(e,t,n,i){const r=n.event||"input",o=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,o),VO(i,t,r,o),e.set=s=>{t.value=s,t.dispatchEvent(Ote(r))}}function Ote(e){return typeof Event!="undefined"?new Event(e):{type:e}}function Nte(e,t,n,i){const r=i.signal(n.signal),o=jn("div",{class:$te}),s=n.input==="radio"?o:o.appendChild(jn("label"));s.appendChild(jn("span",{class:Mte},n.name||n.signal)),t.appendChild(o);let a=Rte;switch(n.input){case"checkbox":a=Lte;break;case"select":a=Ite;break;case"radio":a=Pte;break;case"range":a=zte;break}a(e,s,n,r)}function Rte(e,t,n,i){const r=jn("input");for(const o in n)o!=="signal"&&o!=="element"&&r.setAttribute(o==="input"?"type":o,n[o]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=o=>r.value=o}function Lte(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const o=jn("input",r);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=s=>o.checked=!!s||null}function Ite(e,t,n,i){const r=jn("select",{name:n.signal}),o=n.labels||[];n.options.forEach((s,a)=>{const u={value:s};Sg(s,i)&&(u.selected=!0),r.appendChild(jn("option",u,(o[a]||s)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=s=>{for(let a=0,u=n.options.length;a<u;++a)if(Sg(n.options[a],s)){r.selectedIndex=a;return}}}function Pte(e,t,n,i){const r=jn("span",{class:Fte}),o=n.labels||[];t.appendChild(r),e.elements=n.options.map((s,a)=>{const u={type:"radio",name:n.signal,value:s};Sg(s,i)&&(u.checked=!0);const l=jn("input",u);l.addEventListener("change",()=>e.update(s));const c=jn("label",{},(o[a]||s)+"");return c.prepend(l),r.appendChild(c),l}),e.set=s=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)Sg(a[l].value,s)&&(a[l].checked=!0)}}function zte(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,o=n.min||Math.min(0,r,+i)||0,s=n.step||bo(o,r,100),a=jn("input",{type:"range",name:n.signal,min:o,max:r,step:s});a.value=i;const u=jn("span",{},+i);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function Sg(e,t){return e===t||e+""==t+""}function ZO(e,t,n,i,r,o){return t=t||new i(e.loader()),t.initialize(n,HO(e),GO(e),_g(e),r,o).background(e.background())}function X2(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Bte(e,t,n,i){const r=new i(e.loader(),X2(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,_g(e),e);return t&&t.handlers().forEach(o=>{r.on(o.type,o.handler)}),r}function Ute(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,o=up(i);e=n._el=e?K2(n,e,!0):null,fte(n),o||n.error("Unrecognized renderer type: "+i);const s=o.handler||Dc,a=e?o.renderer:o.headless;return n._renderer=a?ZO(n,n._renderer,e,a):null,n._handler=Bte(n,n._handler,e,s),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=K2(n,t,!0):e.appendChild(jn("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=K2(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Dte(n,u.element||t,u)})),n}function K2(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(i){t=null,e.error(i)}return t}const bf=e=>+e||0,jte=e=>({top:e,bottom:e,left:e,right:e});function QO(e){return J(e)?{top:bf(e.top),bottom:bf(e.bottom),left:bf(e.left),right:bf(e.right)}:jte(bf(e))}async function J2(e,t,n,i){const r=up(t),o=r&&r.headless;return o||N("Unrecognized renderer type: "+t),await e.runAsync(),ZO(e,null,null,o,n,i).renderAsync(e._scenegraph.root)}async function qte(e,t){e!==jo.Canvas&&e!==jo.SVG&&e!==jo.PNG&&N("Unrecognized image type: "+e);const n=await J2(this,e,t);return e===jo.SVG?Wte(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Wte(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Hte(e,t){return(await J2(this,jo.Canvas,e,t)).canvas()}async function Gte(e){return(await J2(this,jo.SVG,e)).svg()}function Yte(e,t,n){return UO(e,nu,yf,n).parse(t)}function Vte(e){var t=this._runtime.scales;return te(t,e)||N("Unrecognized scale or projection: "+e),t[e].value}var eN="width",tN="height",Z2="padding",nN={skip:!0};function iN(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Z2?i.left+i.right:0)}function rN(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Z2?i.top+i.bottom:0)}function Xte(e){var t=e._signals,n=t[eN],i=t[tN],r=t[Z2];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=iN(e,a.size),o()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=rN(e,a.size),o()},{size:i});const s=e.add(null,o,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,s.rank=r.rank+1}function Kte(e,t,n,i,r,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(eN,n,nN),s._resizeWidth.skip(!0)),s.height()!==i&&(a=1,s.signal(tN,i,nN),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==r[0]||s._origin[1]!==r[1])&&(s._resize=1,s._origin=r),a&&s.run("enter"),o&&s.runAfter(u=>u.resize())},!1,1)}function Jte(e){return this._runtime.getState(e||{data:Zte,signals:Qte,recurse:!0})}function Zte(e,t){return t.modified&&R(t.input.value)&&e.indexOf("_:vega:_")}function Qte(e,t){return!(e==="parent"||t instanceof nu.proxy)}function ene(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function tne(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(PX(n,t))}function nne(e,t,n,i){const r=e.element();r&&r.setAttribute("title",ine(i))}function ine(e){return e==null?"":R(e)?oN(e):J(e)&&!mo(e)?rne(e):e+""}function rne(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(R(n)?oN(n):sN(n))}).join(`
`)}function oN(e){return"["+e.map(sN).join(", ")+"]"}function sN(e){return R(e)?"[\u2026]":J(e)&&!mo(e)?"{\u2026}":e}function aN(e,t){const n=this;if(t=t||{},tu.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=de({},e.locale,t.locale);n.locale(zk(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||jo.Canvas,n._scenegraph=new cb;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||nne,n._redraw=!0,n._handler=new Dc().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Ete(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=Yte(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:de({},o)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=iN(n,n._width),n._viewHeight=rN(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Xte(n),dte(n),hte(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function Ag(e,t){return te(e._signals,t)?e._signals[t]:N("Unrecognized signal name: "+W(t))}function uN(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function lN(e,t,n,i){let r=uN(n,i);return r||(r=X2(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function cN(e,t,n){const i=uN(t,n);return i&&t._targets.remove(i),e}q(aN,tu,{async evaluate(e,t,n){if(await tu.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,yte(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&Xd(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&WO(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=Ag(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",QO(e)):QO(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(up(e)||N("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(tu.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Ag(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Kte,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=X2(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,o;--i>=0;)if(o=n[i].type,r=n[i].handler,e===o&&(t===r||t===r.raw)){this._handler.off(o,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return lN(this,e,Ag(this,e),t)},removeSignalListener(e,t){return cN(this,Ag(this,e),t)},addDataListener(e,t){return lN(this,e,xg(this,e).values,t)},removeDataListener(e,t){return cN(this,xg(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=V2(this,null);this._globalCursor=!!e,t&&V2(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:tne,events:Ate,finalize:Cte,hover:kte,data:pte,change:wg,insert:gte,remove:mte,scale:Vte,initialize:Ute,toImageURL:qte,toCanvas:Hte,toSVG:Gte,getState:Jte,setState:ene});const one="view",kg="[",Cg="]",fN="{",dN="}",sne=":",hN=",",ane="@",une=">",lne=/[[\]{}]/,cne={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let pN,gN;function Jo(e,t,n){return pN=t||one,gN=n||cne,mN(e.trim()).map(Q2)}function fne(e){return gN[e]}function xf(e,t,n,i,r){const o=e.length;let s=0,a;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;r&&r.indexOf(a)>=0?--s:i&&i.indexOf(a)>=0&&++s}return t}function mN(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=xf(e,r,hN,kg+fN,Cg+dN),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function Q2(e){return e[0]==="["?dne(e):hne(e)}function dne(e){const t=e.length;let n=1,i;if(n=xf(e,n,Cg,kg,Cg),n===t)throw"Empty between selector: "+e;if(i=mN(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==une)throw"Expected '>' after between selector: "+e;i=i.map(Q2);const r=Q2(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function hne(e){const t={source:pN},n=[];let i=[0,0],r=0,o=0,s=e.length,a=0,u,l;if(e[s-1]===dN){if(a=e.lastIndexOf(fN),a>=0){try{i=pne(e.substring(a+1,s-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),s=e.length}else throw"Unmatched right brace: "+e;a=0}if(!s)throw e;if(e[0]===ane&&(r=++a),u=xf(e,a,sne),u<s&&(n.push(e.substring(o,u).trim()),o=a=++u),a=xf(e,a,kg),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),l=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=xf(e,a,Cg),a===s)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,a).trim()),a<s-1&&e[++a]!==kg)throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||lne.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],r?t.markname=n[0].slice(1):fne(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function pne(e){const t=e.split(hN);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function gne(e){return J(e)?e:{type:e||"pad"}}const wf=e=>+e||0,mne=e=>({top:e,bottom:e,left:e,right:e});function yne(e){return J(e)?e.signal?e:{top:wf(e.top),bottom:wf(e.bottom),left:wf(e.left),right:wf(e.right)}:mne(wf(e))}const Et=e=>J(e)&&!R(e)?de({},e):{value:e};function yN(e,t,n,i){return n!=null?(J(n)&&!R(n)||R(n)&&n.length&&J(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function Ot(e,t,n){for(const i in t)yN(e,i,t[i]);for(const i in n)yN(e,i,n[i],"update")}function Iu(e,t,n){for(const i in t)n&&te(n,i)||(e[i]=de(e[i]||{},t[i]));return e}function Pu(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const ew="mark",tw="frame",nw="scope",vne="axis",bne="axis-domain",xne="axis-grid",wne="axis-label",_ne="axis-tick",Ene="axis-title",Sne="legend",Ane="legend-band",kne="legend-entry",Cne="legend-gradient",vN="legend-label",$ne="legend-symbol",Mne="legend-title",Fne="title",Dne="title-text",Tne="title-subtitle";function One(e,t,n,i,r){const o={},s={};let a,u,l,c;u="lineBreak",t==="text"&&r[u]!=null&&!Pu(u,e)&&iw(o,u,r[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===tw?r.group:n===ew?de({},r.mark,r[t]):null;for(u in c)l=Pu(u,e)||(u==="fill"||u==="stroke")&&(Pu("fill",e)||Pu("stroke",e)),l||iw(o,u,c[u]);K(i).forEach(f=>{const d=r.style&&r.style[f];for(const h in d)Pu(h,e)||iw(o,h,d[h])}),e=de({},e);for(u in o)c=o[u],c.signal?(a=a||{})[u]=c:s[u]=c;return e.enter=de(s,e.enter),a&&(e.update=de(a,e.update)),e}function iw(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const bN=e=>V(e)?W(e):e.signal?"(".concat(e.signal,")"):xN(e);function $g(e){if(e.gradient!=null)return Rne(e);let t=e.signal?"(".concat(e.signal,")"):e.color?Nne(e.color):e.field!=null?xN(e.field):e.value!==void 0?W(e.value):void 0;return e.scale!=null&&(t=Lne(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t="pow(".concat(t,",").concat(Fg(e.exponent),")")),e.mult!=null&&(t+="*".concat(Fg(e.mult))),e.offset!=null&&(t+="+".concat(Fg(e.offset))),e.round&&(t="round(".concat(t,")")),t}const Mg=(e,t,n,i)=>"(".concat(e,"(").concat([t,n,i].map($g).join(","),")+'')");function Nne(e){return e.c?Mg("hcl",e.h,e.c,e.l):e.h||e.s?Mg("hsl",e.h,e.s,e.l):e.l||e.a?Mg("lab",e.l,e.a,e.b):e.r||e.g||e.b?Mg("rgb",e.r,e.g,e.b):null}function Rne(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:W(n));for(;t.length&&be(t)==null;)t.pop();return t.unshift(bN(e.gradient)),"gradient(".concat(t.join(","),")")}function Fg(e){return J(e)?"("+$g(e)+")":e}function xN(e){return wN(J(e)?e:{datum:e})}function wN(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):N("Invalid field reference: "+W(e));return e.signal||(i=V(i)?ji(i).map(W).join("]["):wN(i)),t+"["+i+"]"}function Lne(e,t){const n=bN(e.scale);return e.range!=null?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(t!==void 0&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(+e.band==1?"":"*"+Fg(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),t==null&&(t="0")),t}function Ine(e){let t="";return e.forEach(n=>{const i=$g(n);t+=n.test?"(".concat(n.test,")?").concat(i,":"):i}),be(t)===":"&&(t+="null"),t}function _N(e,t,n,i,r,o){const s={};o=o||{},o.encoders={$encode:s},e=One(e,t,n,i,r.config);for(const a in e)s[a]=Pne(e[a],t,o,r);return o}function Pne(e,t,n,i){const r={},o={};for(const s in e)e[s]!=null&&(r[s]=Bne(zne(e[s]),i,n,o));return{$expr:{marktype:t,channels:r},$fields:Object.keys(o),$output:Object.keys(e)}}function zne(e){return R(e)?Ine(e):$g(e)}function Bne(e,t,n,i){const r=ur(e,t);return r.$fields.forEach(o=>i[o]=1),de(n,r.$params),r.$expr}const Une="outer",jne=["value","update","init","react","bind"];function EN(e,t){N(e+' for "outer" push: '+W(t))}function SN(e,t){const n=e.name;if(e.push===Une)t.signals[n]||EN("No prior signal definition",n),jne.forEach(i=>{e[i]!==void 0&&EN("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function rw(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function Dg(e,t,n,i){return new rw(e,t,n,i)}function Tg(e,t){return Dg("operator",e,t)}function re(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function _f(e,t){return t?{$field:e,$name:t}:{$field:e}}const ow=_f("key");function AN(e,t){return{$compare:e,$order:t}}function qne(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const Wne="ascending",Hne="descending";function Gne(e){return J(e)?(e.order===Hne?"-":"+")+Og(e.op,e.field):""}function Og(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const sw="scope",aw="view";function dt(e){return e&&e.signal}function Yne(e){return e&&e.expr}function Ng(e){if(dt(e))return!0;if(J(e)){for(const t in e)if(Ng(e[t]))return!0}return!1}function Mi(e,t){return e!=null?e:t}function sa(e){return e&&e.signal||e}const kN="timer";function Ef(e,t){return(e.merge?Xne:e.stream?Kne:e.type?Jne:N("Invalid stream specification: "+W(e)))(e,t)}function Vne(e){return e===sw?aw:e||aw}function Xne(e,t){const n=e.merge.map(r=>Ef(r,t)),i=uw({merge:n},e,t);return t.addStream(i).id}function Kne(e,t){const n=Ef(e.stream,t),i=uw({stream:n},e,t);return t.addStream(i).id}function Jne(e,t){let n;e.type===kN?(n=t.event(kN,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Vne(e.source),e.type);const i=uw({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function uw(e,t,n){let i=t.between;return i&&(i.length!==2&&N('Stream "between" parameter must have 2 entries: '+W(t)),e.between=[Ef(i[0],n),Ef(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(Zne(t.marktype,t.markname,t.markrole)),t.source===sw&&i.push("inScope(event.item)"),i.length&&(e.filter=ur("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function Zne(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const Qne={code:"_.$value",ast:{type:"Identifier",value:"value"}};function eie(e,t,n){const i=e.encode,r={target:n};let o=e.events,s=e.update,a=[];o||N("Signal update missing events specification."),V(o)&&(o=Jo(o,t.isSubscope()?sw:aw)),o=K(o).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[nie(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),i!=null&&(s&&N("Signal encode and update are mutually exclusive."),s="encode(item(),"+W(i)+")"),r.update=V(s)?ur(s,t):s.expr!=null?ur(s.expr,t):s.value!=null?s.value:s.signal!=null?{$expr:Qne,$params:{$value:t.signalRef(s.signal)}}:N("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(u=>t.addUpdate(de(tie(u,t),r)))}function tie(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Ef(e,t)}}function nie(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function iie(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?N("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=ur(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>eie(r,t,n.id))}const Ne=e=>(t,n,i)=>Dg(e,n,t||void 0,i),CN=Ne("aggregate"),rie=Ne("axisticks"),$N=Ne("bound"),Fi=Ne("collect"),MN=Ne("compare"),oie=Ne("datajoin"),FN=Ne("encode"),sie=Ne("expression"),aie=Ne("facet"),uie=Ne("field"),lie=Ne("key"),cie=Ne("legendentries"),fie=Ne("load"),die=Ne("mark"),hie=Ne("multiextent"),pie=Ne("multivalues"),gie=Ne("overlap"),mie=Ne("params"),DN=Ne("prefacet"),yie=Ne("projection"),vie=Ne("proxy"),bie=Ne("relay"),TN=Ne("render"),xie=Ne("scale"),aa=Ne("sieve"),wie=Ne("sortitems"),ON=Ne("viewlayout"),_ie=Ne("values");let Eie=0;const NN={min:"min",max:"max",count:"sum"};function Sie(e,t){const n=e.type||"linear";EM(n)||N("Unrecognized scale type: "+W(n)),t.addScale(e.name,{type:n,domain:void 0})}function Aie(e,t){const n=t.getScale(e.name).params;let i;n.domain=RN(e.domain,e,t),e.range!=null&&(n.range=IN(e,t,n)),e.interpolate!=null&&Rie(e.interpolate,n),e.nice!=null&&(n.nice=Nie(e.nice)),e.bins!=null&&(n.bins=Oie(e.bins,t));for(i in e)te(n,i)||i==="name"||(n[i]=ii(e[i],t))}function ii(e,t){return J(e)?e.signal?t.signalRef(e.signal):N("Unsupported object: "+W(e)):e}function Rg(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>ii(n,t))}function Lg(e){N("Can not find data set: "+W(e))}function RN(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&N("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(R(e)?kie:e.fields?$ie:Cie)(e,t,n)}function kie(e,t,n){return e.map(i=>ii(i,n))}function Cie(e,t,n){const i=n.getData(e.data);return i||Lg(e.data),pu(t.type)?i.valuesRef(n,e.field,LN(e.sort,!1)):kM(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function $ie(e,t,n){const i=e.data,r=e.fields.reduce((o,s)=>(s=V(s)?{data:i,field:s}:R(s)||s.signal?Mie(s,n):s,o.push(s),o),[]);return(pu(t.type)?Fie:kM(t.type)?Die:Tie)(e,n,r)}function Mie(e,t){const n="_:vega:_"+Eie++,i=Fi({});if(R(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+W(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,aa({})]),{data:n,field:"data"}}function Fie(e,t,n){const i=LN(e.sort,!0);let r,o;const s=n.map(l=>{const c=t.getData(l.data);return c||Lg(l.data),c.countsRef(t,l.field,i)}),a={groupby:ow,pulse:s};i&&(r=i.op||"count",o=i.field?Og(r,i.field):"count",a.ops=[NN[r]],a.fields=[t.fieldRef(o)],a.as=[o]),r=t.add(CN(a));const u=t.add(Fi({pulse:re(r)}));return o=t.add(_ie({field:ow,sort:t.sortRef(i),pulse:re(u)})),re(o)}function LN(e,t){return e&&(!e.field&&!e.op?J(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?N("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!NN[e.op]&&N("Multiple domain scales can not be sorted using "+e.op)),e}function Die(e,t,n){const i=n.map(r=>{const o=t.getData(r.data);return o||Lg(r.data),o.domainRef(t,r.field)});return re(t.add(pie({values:i})))}function Tie(e,t,n){const i=n.map(r=>{const o=t.getData(r.data);return o||Lg(r.data),o.extentRef(t,r.field)});return re(t.add(hie({extents:i})))}function Oie(e,t){return e.signal||R(e)?Rg(e,t):t.objectProperty(e)}function Nie(e){return J(e)?{interval:ii(e.interval),step:ii(e.step)}:ii(e)}function Rie(e,t){t.interpolate=ii(e.type||e),e.gamma!=null&&(t.interpolateGamma=ii(e.gamma))}function IN(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(V(r)){if(i&&te(i,r))return e=de({},e,{range:i[r]}),IN(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=pu(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:N("Unrecognized scale range value: "+W(r))}else if(r.scheme){n.scheme=R(r.scheme)?Rg(r.scheme,t):ii(r.scheme,t),r.extent&&(n.schemeExtent=Rg(r.extent,t)),r.count&&(n.schemeCount=ii(r.count,t));return}else if(r.step){n.rangeStep=ii(r.step,t);return}else{if(pu(e.type)&&!R(r))return RN(r,e,t);R(r)||N("Unsupported range type: "+W(r))}return r.map(o=>(R(o)?Rg:ii)(o,t))}function Lie(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=lw(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=lw(n[r],r,t));t.addProjection(e.name,i)}function lw(e,t,n){return R(e)?e.map(i=>lw(i,t,n)):J(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:N("Unsupported parameter object: "+W(e)):e}const Di="top",zu="left",Bu="right",Zo="bottom",PN="center",Iie="vertical",Pie="start",zie="middle",Bie="end",cw="index",fw="label",Uie="offset",Uu="perc",jie="perc2",ri="value",Sf="guide-label",dw="guide-title",qie="group-title",Wie="group-subtitle",zN="symbol",Ig="gradient",hw="discrete",pw="size",Hie="shape",Gie="fill",Yie="stroke",Vie="strokeWidth",Xie="strokeDash",Kie="opacity",gw=[pw,Hie,Gie,Yie,Vie,Xie,Kie],Af={name:1,style:1,interactive:1},_e={value:0},oi={value:1},Pg="group",BN="rect",mw="rule",Jie="symbol",ua="text";function kf(e){return e.type=Pg,e.interactive=e.interactive||!1,e}function Fn(e,t){const n=(i,r)=>Mi(e[i],Mi(t[i],r));return n.isVertical=i=>Iie===Mi(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Mi(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Mi(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Mi(e.columns,Mi(t.columns,+n.isVertical(!0))),n}function UN(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Zie(e,t,n){const i=t.config.style[n];return i&&i[e]}function zg(e,t,n){return"item.anchor === '".concat(Pie,"' ? ").concat(e," : item.anchor === '").concat(Bie,"' ? ").concat(t," : ").concat(n)}const yw=zg(W(zu),W(Bu),W(PN));function Qie(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:"(".concat(t.signal,") === 'extent' ? 1 : 0.5")},r={signal:"(".concat(t.signal,") === 'extent'")},J(n)||(n={signal:"(".concat(t.signal,") === 'extent' ? 0 : ").concat(n)})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function jN(e,t){return t?e?J(e)?Object.assign({},e,{offset:jN(e.offset,t)}):{value:e,offset:t}:t:e}function qn(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Iu(e.encode,t,Af)):e.interactive=!1,e}function ere(e,t,n,i){const r=Fn(e,n),o=r.isVertical(),s=r.gradientThickness(),a=r.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=s,d=a):(l=[0,0],c=[1,0],f=a,d=s);const h={enter:u={opacity:_e,x:_e,y:_e,width:Et(f),height:Et(d)},update:de({},u,{opacity:oi,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:_e}};return Ot(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),qn({type:BN,role:Cne,encode:h},i)}function tre(e,t,n,i,r){const o=Fn(e,n),s=o.isVertical(),a=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";s?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:_e,fill:{scale:t,field:ri}};p[l]={signal:h+"datum."+Uu,mult:u},p[c]=_e,p[f]={signal:h+"datum."+jie,mult:u},p[d]=Et(a);const g={enter:p,update:de({},p,{opacity:oi}),exit:{opacity:_e}};return Ot(g,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),qn({type:BN,role:Ane,key:ri,from:r,encode:g},i)}const nre="datum.".concat(Uu,'<=0?"').concat(zu,'":datum.').concat(Uu,'>=1?"').concat(Bu,'":"').concat(PN,'"'),ire="datum.".concat(Uu,'<=0?"').concat(Zo,'":datum.').concat(Uu,'>=1?"').concat(Di,'":"').concat(zie,'"');function qN(e,t,n,i){const r=Fn(e,t),o=r.isVertical(),s=Et(r.gradientThickness()),a=r.gradientLength();let u=r("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:_e},update:c={opacity:oi,text:{field:fw}},exit:{opacity:_e}};return Ot(p,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:Mi(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:ire},f="y",d="x",h="1-"):(l.align=c.align={signal:nre},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+Uu,mult:a},l[d]=c[d]=s,s.offset=Mi(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:r("labelSeparation"),method:u,order:"datum."+cw}:void 0,qn({type:ua,role:vN,style:Sf,key:ri,from:i,encode:p,overlap:u},n)}function rre(e,t,n,i,r){const o=Fn(e,t),s=n.entries,a=!!(s&&s.interactive),u=s?s.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d="(".concat(r,") ? datum.").concat(Uie," : datum.").concat(pw),h=l?Et(l):{field:pw},p="datum.".concat(cw),g="max(1, ".concat(r,")");let m,y,v,b,w;h.mult=.5,m={enter:y={opacity:_e,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:oi,x:y.x,y:y.y},exit:{opacity:_e}};let E=null,S=null;e.fill||(E=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),Ot(m,{fill:o("symbolFillColor",E),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",S),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),gw.forEach(k=>{e[k]&&(v[k]=y[k]={scale:e[k],field:ri})});const _=qn({type:Jie,role:$ne,key:ri,from:f,clip:l?!0:void 0,encode:m},n.symbols),A=Et(c);A.offset=o("labelOffset"),m={enter:y={opacity:_e,x:{signal:d,offset:A},y:h},update:v={opacity:oi,text:{field:fw},x:y.x,y:y.y},exit:{opacity:_e}},Ot(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const C=qn({type:ua,role:vN,style:Sf,key:ri,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:_e,height:l?Et(l):_e,opacity:_e},exit:{opacity:_e},update:v={opacity:oi,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(g,")"),v.row.signal="".concat(p,"%").concat(b),v.column.signal="floor(".concat(p," / ").concat(b,")"),w={field:["row",p]}):(v.row.signal="floor(".concat(p," / ").concat(g,")"),v.column.signal="".concat(p," % ").concat(g),w={field:p}),v.column.signal="(".concat(r,")?").concat(v.column.signal,":").concat(p),i={facet:{data:i,name:"value",groupby:cw}},kf({role:nw,from:i,encode:Iu(m,s,Af),marks:[_,C],name:u,interactive:a,sort:w})}function ore(e,t){const n=Fn(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const vw='item.orient === "left"',bw='item.orient === "right"',Bg="(".concat(vw," || ").concat(bw,")"),sre="datum.vgrad && ".concat(Bg),are=zg('"top"','"bottom"','"middle"'),ure=zg('"right"','"left"','"center"'),lre="datum.vgrad && ".concat(bw," ? (").concat(ure,") : (").concat(Bg," && !(datum.vgrad && ").concat(vw,')) ? "left" : ').concat(yw),cre="item._anchor || (".concat(Bg,' ? "middle" : "start")'),fre="".concat(sre," ? (").concat(vw," ? -90 : 90) : 0"),dre="".concat(Bg," ? (datum.vgrad ? (").concat(bw,' ? "bottom" : "top") : ').concat(are,') : "top"');function hre(e,t,n,i){const r=Fn(e,t),o={enter:{opacity:_e},update:{opacity:oi,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:_e}};return Ot(o,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:cre},angle:{signal:fre},align:{signal:lre},baseline:{signal:dre},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),qn({type:ua,role:Mne,style:dw,from:i,encode:o},n)}function pre(e,t){let n;return J(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+WN(e.path)+")":e.sphere&&(n="geoShape("+WN(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function WN(e){return J(e)&&e.signal?e.signal:W(e)}function HN(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===Pg?nw:t||ew}function gre(e){return{marktype:e.type,name:e.name||void 0,role:e.role||HN(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function mre(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function xw(e,t){const n=Qk(e.type);n||N("Unrecognized transform type: "+W(e.type));const i=Dg(n.type.toLowerCase(),null,GN(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function GN(e,t,n){const i={},r=e.params.length;for(let o=0;o<r;++o){const s=e.params[o];i[s.name]=yre(s,t,n)}return i}function yre(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return vre(e,t,n);if(r===void 0){e.required&&N("Missing required "+W(t.type)+" parameter: "+W(e.name));return}else{if(i==="param")return bre(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!dt(r)?r.map(o=>YN(e,o,n)):YN(e,r,n)}function YN(e,t,n){const i=e.type;if(dt(t))return XN(i)?N("Expression references can not be signals."):ww(i)?n.fieldRef(t):KN(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||ww(i);return r&&xre(t)?n.exprRef(t.expr,t.as):r&&wre(t)?_f(t.field,t.as):XN(i)?ur(t,n):_re(i)?re(n.getData(t).values):ww(i)?_f(t):KN(i)?n.compareRef(t):t}}function vre(e,t,n){return V(t.from)||N('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function bre(e,t,n){const i=t[e.name];return e.array?(R(i)||N("Expected an array of sub-parameters. Instead: "+W(i)),i.map(r=>VN(e,r,n))):VN(e,i,n)}function VN(e,t,n){const i=e.params.length;let r;for(let s=0;s<i;++s){r=e.params[s];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||N("Unsupported parameter: "+W(t));const o=de(GN(r,t,n),r.key);return re(n.add(mie(o)))}const xre=e=>e&&e.expr,wre=e=>e&&e.field,_re=e=>e==="data",XN=e=>e==="expr",ww=e=>e==="field",KN=e=>e==="compare";function Ere(e,t,n){let i,r,o,s,a;return e?(i=e.facet)&&(t||N("Only group marks can be faceted."),i.field!=null?s=a=Ug(i,n):(e.data?a=re(n.getData(e.data).aggregate):(o=xw(de({type:"aggregate",groupby:K(i.groupby)},i.aggregate),n),o.params.key=n.keyRef(i.groupby),o.params.pulse=Ug(i,n),s=a=re(n.add(o))),r=n.keyRef(i.groupby,!0))):s=re(n.add(Fi(null,[{}]))),s||(s=Ug(e,n)),{key:r,pulse:s,parent:a}}function Ug(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:re(t.getData(e.data).output)}function la(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}la.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let o=t[0],s=null,a=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=re(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(s=t[a]);return new la(e,o,r,i,s)};function JN(e){return V(e)?e:null}function ZN(e,t,n){const i=Og(n.op,n.field);let r;if(t.ops){for(let o=0,s=t.as.length;o<s;++o)if(t.as[o]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function Cf(e,t,n,i,r,o,s){const a=t[n]||(t[n]={}),u=Gne(o);let l=JN(r),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){const d=o?{field:ow,pulse:t.countsRef(e,r,o)}:{field:e.fieldRef(r),pulse:re(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(Dg(i,void 0,d)),s&&(t.index[r]=f),c=re(f),l!=null&&(a[l]=c)}return c}la.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),o=JN(t);let s,a,u;return o!=null&&(e=i.scope,s=r[o]),s?n&&n.field&&ZN(e,s.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:re(i.output)},n&&n.field&&ZN(e,u,n),a=e.add(CN(u)),s=e.add(Fi({pulse:re(a)})),s={agg:a,ref:re(s)},o!=null&&(r[o]=s)),s.ref},tuplesRef(){return re(this.values)},extentRef(e,t){return Cf(e,this,"extent","extent",t,!1)},domainRef(e,t){return Cf(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return Cf(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return Cf(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return Cf(e,this,"indata","tupleindex",t,!0,!0)}};function Sre(e,t,n){const i=e.from.facet,r=i.name,o=Ug(i,t);let s;i.name||N("Facet must have a name: "+W(i)),i.data||N("Facet must reference a data set: "+W(i)),i.field?s=t.add(DN({field:t.fieldRef(i.field),pulse:o})):i.groupby?s=t.add(aie({key:t.keyRef(i.groupby),group:re(t.proxy(n.parent)),pulse:o})):N("Facet must specify groupby or field: "+W(i));const a=t.fork(),u=a.add(Fi()),l=a.add(aa({pulse:re(u)}));a.addData(r,new la(a,u,u,l)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(e).toRuntime()}}function Are(e,t,n){const i=t.add(DN({pulse:n.pulse})),r=t.fork();r.add(aa()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function QN(e,t,n){const i=e.remove,r=e.insert,o=e.toggle,s=e.modify,a=e.values,u=t.add(Tg()),l="if("+e.trigger+',modify("'+n+'",'+[r,i,o,s,a].map(f=>f==null?"null":f).join(",")+"),0)",c=ur(l,t);u.update=c.$expr,u.params=c.$params}function jg(e,t){const n=HN(e),i=e.type===Pg,r=e.from&&e.from.facet,o=e.overlap;let s=e.layout||n===nw||n===tw,a,u,l,c,f,d,h;const p=n===ew||s||r,g=Ere(e.from,i,t);u=t.add(oie({key:g.key||(e.key?_f(e.key):void 0),pulse:g.pulse,clean:!i}));const m=re(u);u=l=t.add(Fi({pulse:m})),u=t.add(die({markdef:gre(e),interactive:mre(e.interactive,t),clip:pre(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:re(u)}));const y=re(u);u=c=t.add(FN(_N(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const _=xw(S,t),A=_.metadata;(A.generates||A.changes)&&N("Mark transforms should not generate new data."),A.nomod||(c.params.mod=!0),_.params.pulse=re(u),t.add(u=_)}),e.sort&&(u=t.add(wie({sort:t.compareRef(e.sort),pulse:re(u)})));const v=re(u);(r||s)&&(s=t.add(ON({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),d=re(s));const b=t.add($N({mark:y,pulse:d||v}));h=re(b),i&&(p&&(a=t.operators,a.pop(),s&&a.pop()),t.pushState(v,d||h,m),r?Sre(e,t,g):p?Are(e,t,g):t.parse(e),t.popState(),p&&(s&&a.push(s),a.push(b))),o&&(h=kre(o,h,t));const w=t.add(TN({pulse:h})),E=t.add(aa({pulse:re(w)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new la(t,l,w,E)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&N("Marks only support modify triggers."),QN(S,t,f)}))}function kre(e,t,n){const i=e.method,r=e.bound,o=e.separation,s={separation:dt(o)?n.signalRef(o.signal):o,method:dt(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;s.boundTolerance=dt(a)?n.signalRef(a.signal):+a,s.boundScale=n.scaleRef(r.scale),s.boundOrient=r.orient}return re(n.add(gie(s)))}function Cre(e,t){const n=t.config.legend,i=e.encode||{},r=Fn(e,n),o=i.legend||{},s=o.name||void 0,a=o.interactive,u=o.style,l={};let c=0,f,d,h;gw.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||N("Missing valid scale for legend.");const p=$re(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&r.isVertical()},m=re(t.add(Fi(null,[g]))),y={enter:{x:{value:0},y:{value:0}}},v=re(t.add(cie(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===Ig?(h=[ere(e,c,n,i.gradient),qN(e,n,i.labels,v)],d.count=d.count||t.signalRef("max(2,2*floor((".concat(sa(r.gradientLength()),")/100))"))):p===hw?h=[tre(e,c,n,i.gradient,v),qN(e,n,i.labels,v)]:(f=ore(e,n),h=[rre(e,n,i,v,sa(f.columns))],d.size=Dre(e,t,h[0].marks)),h=[kf({role:kne,from:m,encode:y,marks:h,layout:f,interactive:a})],g.title&&h.push(hre(e,n,i.title,m)),jg(kf({role:Sne,from:m,encode:Iu(Fre(r,e,n),o,Af),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:s,interactive:a,style:u}),t)}function $re(e,t){let n=e.type||zN;return!e.type&&Mre(e)===1&&(e.fill||e.stroke)&&(n=kv(t)?Ig:Cv(t)?hw:zN),n!==Ig?n:Cv(t)?hw:Ig}function Mre(e){return gw.reduce((t,n)=>t+(e[n]?1:0),0)}function Fre(e,t,n){const i={enter:{},update:{}};return Ot(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function Dre(e,t,n){const i=sa(eR("size",e,n)),r=sa(eR("strokeWidth",e,n)),o=sa(Tre(n[1].encode,t,Sf));return ur("max(ceil(sqrt(".concat(i,")+").concat(r,"),").concat(o,")"),t)}function eR(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):UN(e,n[0].encode)}function Tre(e,t,n){return UN("fontSize",e)||Zie("fontSize",t,n)}const Ore='item.orient==="'.concat(zu,'"?-90:item.orient==="').concat(Bu,'"?90:0');function Nre(e,t){e=V(e)?{text:e}:e;const n=Fn(e,t.config.title),i=e.encode||{},r=i.group||{},o=r.name||void 0,s=r.interactive,a=r.style,u=[],l={},c=re(t.add(Fi(null,[l])));return u.push(Ire(e,n,Rre(e),c)),e.subtitle&&u.push(Pre(e,n,i.subtitle,c)),jg(kf({role:Fne,from:c,encode:Lre(n,r),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),t)}function Rre(e){const t=e.encode;return t&&t.title||de({name:e.name,interactive:e.interactive,style:e.style},t)}function Lre(e,t){const n={enter:{},update:{}};return Ot(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:yw},angle:{signal:Ore},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Iu(n,t,Af)}function Ire(e,t,n,i){const r={value:0},o=e.text,s={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Ot(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),qn({type:ua,role:Dne,style:qie,from:i,encode:s},n)}function Pre(e,t,n,i){const r={value:0},o=e.subtitle,s={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Ot(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),qn({type:ua,role:Tne,style:Wie,from:i,encode:s},n)}function zre(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(xw(i,t))}),e.on&&e.on.forEach(i=>{QN(i,t,e.name)}),t.addDataPipeline(e.name,Bre(e,t,n))}function Bre(e,t,n){const i=[];let r=null,o=!1,s=!1,a,u,l,c,f;for(e.values?dt(e.values)||Ng(e.format)?(i.push(tR(t,e)),i.push(r=ca())):i.push(r=ca({$ingest:e.values,$format:e.format})):e.url?Ng(e.url)||Ng(e.format)?(i.push(tR(t,e)),i.push(r=ca())):i.push(r=ca({$request:e.url,$format:e.format})):e.source&&(r=a=K(e.source).map(d=>re(t.getData(d).output)),i.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!r&&!f.source&&i.push(r=ca()),i.push(c),f.generates&&(s=!0),f.modifies&&!s&&(o=!0),f.source?r=c:f.changes&&(r=null);return a&&(l=a.length-1,i[0]=bie({derive:o,pulse:l?a:a[0]}),(o||l)&&i.splice(1,0,ca())),r||i.push(ca()),i.push(aa({})),i}function ca(e){const t=Fi({},e);return t.metadata={source:!0},t}function tR(e,t){return fie({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const nR=e=>e===Zo||e===Di,qg=(e,t,n)=>dt(e)?Wre(e.signal,t,n):e===zu||e===Di?t:n,St=(e,t,n)=>dt(e)?jre(e.signal,t,n):nR(e)?t:n,Ti=(e,t,n)=>dt(e)?qre(e.signal,t,n):nR(e)?n:t,iR=(e,t,n)=>dt(e)?Hre(e.signal,t,n):e===Di?{value:t}:{value:n},Ure=(e,t,n)=>dt(e)?Gre(e.signal,t,n):e===Bu?{value:t}:{value:n},jre=(e,t,n)=>rR("".concat(e," === '").concat(Di,"' || ").concat(e," === '").concat(Zo,"'"),t,n),qre=(e,t,n)=>rR("".concat(e," !== '").concat(Di,"' && ").concat(e," !== '").concat(Zo,"'"),t,n),Wre=(e,t,n)=>_w("".concat(e," === '").concat(zu,"' || ").concat(e," === '").concat(Di,"'"),t,n),Hre=(e,t,n)=>_w("".concat(e," === '").concat(Di,"'"),t,n),Gre=(e,t,n)=>_w("".concat(e," === '").concat(Bu,"'"),t,n),rR=(e,t,n)=>(t=t!=null?Et(t):t,n=n!=null?Et(n):n,oR(t)&&oR(n)?(t=t?t.signal||W(t.value):null,n=n?n.signal||W(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[de({test:e},t)].concat(n||[])),oR=e=>e==null||Object.keys(e).length===1,_w=(e,t,n)=>({signal:"".concat(e," ? (").concat(ju(t),") : (").concat(ju(n),")")}),Yre=(e,t,n,i,r)=>({signal:(i!=null?"".concat(e," === '").concat(zu,"' ? (").concat(ju(i),") : "):"")+(n!=null?"".concat(e," === '").concat(Zo,"' ? (").concat(ju(n),") : "):"")+(r!=null?"".concat(e," === '").concat(Bu,"' ? (").concat(ju(r),") : "):"")+(t!=null?"".concat(e," === '").concat(Di,"' ? (").concat(ju(t),") : "):"")+"(null)"}),ju=e=>dt(e)?e.signal:e==null?null:W(e),Vre=(e,t)=>t===0?0:dt(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t},qu=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Wu(e,t,n,i){let r;if(t&&te(t,e))return t[e];if(te(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[dw][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[Sf][r]}return null}function sR(e){const t={};for(const n of e)if(!!n)for(const i in n)t[i]=1;return Object.keys(t)}function Xre(e,t){var n=t.config,i=n.style,r=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,s=e.orient,a,u,l;if(dt(s)){const f=sR([n.axisX,n.axisY]),d=sR([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=St(s,Wu(l,n.axisX,r,i),Wu(l,n.axisY,r,i));u={};for(l of d)u[l]=Yre(s.signal,Wu(l,n.axisTop,r,i),Wu(l,n.axisBottom,r,i),Wu(l,n.axisLeft,r,i),Wu(l,n.axisRight,r,i))}else a=s===Di||s===Zo?n.axisX:n.axisY,u=n["axis"+s[0].toUpperCase()+s.slice(1)];return a||u||o?de({},r,a,u,o):r}function Kre(e,t,n,i){const r=Fn(e,t),o=e.orient;let s,a;const u={enter:s={opacity:_e},update:a={opacity:oi},exit:{opacity:_e}};Ot(u,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=aR(e,0),c=aR(e,1);return s.x=a.x=St(o,l,_e),s.x2=a.x2=St(o,c),s.y=a.y=Ti(o,l,_e),s.y2=a.y2=Ti(o,c),qn({type:mw,role:bne,from:i,encode:u},n)}function aR(e,t){return{scale:e.scale,range:t}}function Jre(e,t,n,i,r){const o=Fn(e,t),s=e.orient,a=e.gridScale,u=qg(s,1,-1),l=Zre(e.offset,u);let c,f,d;const h={enter:c={opacity:_e},update:d={opacity:oi},exit:f={opacity:_e}};Ot(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:e.scale,field:ri,band:r.band,extra:r.extra,offset:r.offset,round:o("tickRound")},g=St(s,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},y=a?{scale:a,range:1,mult:u,offset:l}:de(g,{mult:u,offset:l});return c.x=d.x=St(s,p,m),c.y=d.y=Ti(s,p,m),c.x2=d.x2=Ti(s,y),c.y2=d.y2=St(s,y),f.x=St(s,p),f.y=Ti(s,p),qn({type:mw,role:xne,key:ri,from:i,encode:h},n)}function Zre(e,t){if(t!==1)if(!J(e))e=dt(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);else{let n=e=de({},e);for(;n.mult!=null;)if(J(n.mult))n=n.mult=de({},n.mult);else return n.mult=dt(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n.mult=t}return e}function Qre(e,t,n,i,r,o){const s=Fn(e,t),a=e.orient,u=qg(a,-1,1);let l,c,f;const d={enter:l={opacity:_e},update:f={opacity:oi},exit:c={opacity:_e}};Ot(d,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const h=Et(r);h.mult=u;const p={scale:e.scale,field:ri,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return f.y=l.y=St(a,_e,p),f.y2=l.y2=St(a,h),c.x=St(a,p),f.x=l.x=Ti(a,_e,p),f.x2=l.x2=Ti(a,h),c.y=Ti(a,p),qn({type:mw,role:_ne,key:ri,from:i,encode:d},n)}function Ew(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function eoe(e,t,n,i,r,o){const s=Fn(e,t),a=e.orient,u=e.scale,l=qg(a,-1,1),c=sa(s("labelFlush")),f=sa(s("labelFlushOffset")),d=s("labelAlign"),h=s("labelBaseline");let p=c===0||!!c,g;const m=Et(r);m.mult=l,m.offset=Et(s("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:ri,band:.5,offset:jN(o.offset,s("labelOffset"))},v=St(a,p?Ew(u,c,'"left"','"right"','"center"'):{value:"center"},Ure(a,"left","right")),b=St(a,iR(a,"bottom","top"),p?Ew(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),w=Ew(u,c,"-(".concat(f,")"),f,0);p=p&&f;const E={opacity:_e,x:St(a,y,m),y:Ti(a,y,m)},S={enter:E,update:g={opacity:oi,text:{field:fw},x:E.x,y:E.y,align:v,baseline:b},exit:{opacity:_e,x:E.x,y:E.y}};Ot(S,{dx:!d&&p?St(a,w):null,dy:!h&&p?Ti(a,w):null}),Ot(S,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:d,baseline:h});const _=s("labelBound");let A=s("labelOverlap");return A=A||_?{separation:s("labelSeparation"),method:A,order:"datum.index",bound:_?{scale:u,orient:a,tolerance:_}:null}:void 0,g.align!==v&&(g.align=qu(g.align,v)),g.baseline!==b&&(g.baseline=qu(g.baseline,b)),qn({type:ua,role:wne,style:Sf,key:ri,from:i,encode:S,overlap:A},n)}function toe(e,t,n,i){const r=Fn(e,t),o=e.orient,s=qg(o,-1,1);let a,u;const l={enter:a={opacity:_e,anchor:Et(r("titleAnchor",null)),align:{signal:yw}},update:u=de({},a,{opacity:oi,text:Et(e.title)}),exit:{opacity:_e}},c={signal:'lerp(range("'.concat(e.scale,'"), ').concat(zg(0,1,.5),")")};return u.x=St(o,c),u.y=Ti(o,c),a.angle=St(o,_e,Vre(s,90)),a.baseline=St(o,iR(o,Zo,Di),{value:Zo}),u.angle=a.angle,u.baseline=a.baseline,Ot(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),noe(r,o,l,n),l.update.align=qu(l.update.align,a.align),l.update.angle=qu(l.update.angle,a.angle),l.update.baseline=qu(l.update.baseline,a.baseline),qn({type:ua,role:Ene,style:dw,from:i,encode:l},n)}function noe(e,t,n,i){const r=(a,u)=>a!=null?(n.update[u]=qu(Et(a),n.update[u]),!1):!Pu(u,i),o=r(e("titleX"),"x"),s=r(e("titleY"),"y");n.enter.auto=s===o?Et(s):St(t,Et(s),Et(o))}function ioe(e,t){const n=Xre(e,t),i=e.encode||{},r=i.axis||{},o=r.name||void 0,s=r.interactive,a=r.style,u=Fn(e,n),l=Qie(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=re(t.add(Fi({},[c]))),d=re(t.add(rie({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(Jre(e,n,i.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(Qre(e,n,i.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(eoe(e,n,i.labels,d,p,l))),c.domain&&h.push(Kre(e,n,i.domain,f)),c.title&&h.push(toe(e,n,i.title,f)),jg(kf({role:vne,from:f,encode:Iu(roe(u,e),r,Af),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:s,style:a}),t)}function roe(e,t){const n={enter:{},update:{}};return Ot(n,{orient:e("orient"),offset:e("offset")||0,position:Mi(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function uR(e,t,n){const i=K(e.signals),r=K(e.scales);return n||i.forEach(o=>SN(o,t)),K(e.projections).forEach(o=>Lie(o,t)),r.forEach(o=>Sie(o,t)),K(e.data).forEach(o=>zre(o,t)),r.forEach(o=>Aie(o,t)),(n||i).forEach(o=>iie(o,t)),K(e.axes).forEach(o=>ioe(o,t)),K(e.marks).forEach(o=>jg(o,t)),K(e.legends).forEach(o=>Cre(o,t)),e.title&&Nre(e.title,t),t.parseLambdas(),t}const ooe=e=>Iu({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function soe(e,t){const n=t.config,i=re(t.root=t.add(Tg())),r=aoe(e,n);r.forEach(l=>SN(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(Fi()),s=t.add(FN(_N(ooe(e.encode),Pg,tw,e.style,t,{pulse:re(o)}))),a=t.add(ON({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:re(s)}));t.operators.pop(),t.pushState(re(s),re(a),null),uR(e,t,r),t.operators.push(a);let u=t.add($N({mark:i,pulse:re(a)}));return u=t.add(TN({pulse:re(u)})),u=t.add(aa({pulse:re(u)})),t.addData("root",new la(t,o,o,u)),t}function $f(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function aoe(e,t){const n=s=>Mi(e[s],t[s]),i=[$f("background",n("background")),$f("autosize",gne(n("autosize"))),$f("padding",yne(n("padding"))),$f("width",n("width")||0),$f("height",n("height")||0)],r=i.reduce((s,a)=>(s[a.name]=a,s),{}),o={};return K(e.signals).forEach(s=>{te(r,s.name)?s=de(r[s.name],s):i.push(s),o[s.name]=s}),K(t.signals).forEach(s=>{!te(o,s.name)&&!te(r,s.name)&&i.push(s)}),i}function lR(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function cR(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}lR.prototype=cR.prototype={parse(e){return uR(e,this)},fork(){return new cR(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof rw?re(e):e;return this.add(vie({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,o){let s,a;i&&(s=i.data||(i.data={}),a=s[r]||(s[r]=[]),a.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(re(this.add(aa({pulse:e})))),this._parent.push(t),this._lookup.push(n?re(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return be(this._parent)},encode(){return be(this._encode)},lookup(){return be(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(V(e))return _f(e,t);e.signal||N("Unsupported field reference: "+W(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=re(this.add(uie(r)))}return i},compareRef(e){let t=!1;const n=o=>dt(o)?(t=!0,this.signalRef(o.signal)):Yne(o)?(t=!0,this.exprRef(o.expr)):o,i=K(e.field).map(n),r=K(e.order).map(n);return t?re(this.add(MN({fields:i,orders:r}))):AN(i,r)},keyRef(e,t){let n=!1;const i=o=>dt(o)?(n=!0,re(r[o.signal])):o,r=this.signals;return e=K(e).map(i),n?re(this.add(lie({fields:e,flat:t}))):qne(e,t)},sortRef(e){if(!e)return e;const t=Og(e.op,e.field),n=e.order||Wne;return n.signal?re(this.add(MN({fields:t,orders:this.signalRef(n.signal)}))):AN(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return te(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&N("Duplicate signal name: "+W(e));const n=t instanceof rw?t:this.add(Tg(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||N("Unrecognized signal name: "+W(e)),this.signals[e]},signalRef(e){return this.signals[e]?re(this.signals[e]):(te(this.lambdas,e)||(this.lambdas[e]=this.add(Tg(null))),re(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=ur(i,this),o=this.lambdas[i];o.params=r.$params,o.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!J(e)?e:this.signalRef(e.signal||Sw(e))},exprRef(e,t){const n={expr:ur(e,this)};return t&&(n.expr.$name=t),re(this.add(sie(n)))},addBinding(e,t){this.bindings||N("Nested signals do not support binding: "+W(e)),this.bindings.push(de({signal:e},t))},addScaleProj(e,t){te(this.scales,e)&&N("Duplicate scale or projection name: "+W(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,xie(t))},addProjection(e,t){this.addScaleProj(e,yie(t))},getScale(e){return this.scales[e]||N("Unrecognized scale name: "+W(e)),this.scales[e]},scaleRef(e){return re(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return te(this.data,e)&&N("Duplicate data set name: "+W(e)),this.data[e]=t},getData(e){return this.data[e]||N("Undefined data set name: "+W(e)),this.data[e]},addDataPipeline(e,t){return te(this.data,e)&&N("Duplicate data set name: "+W(e)),this.addData(e,la.fromEntries(this,t))}};function Sw(e){return(R(e)?uoe:loe)(e)}function uoe(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(J(r)?r.signal||Sw(r):W(r))}return n+"]"}function loe(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+W(i)+":"+(J(r)?r.signal||Sw(r):W(r));return t+"}"}function coe(){const e="sans-serif",t=30,n=2,i="#4c78a8",r="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:n},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:n},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:s}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function foe(e,t,n){return J(e)||N("Input Vega specification must be an object."),t=Wa(coe(),t,e.config),soe(e,new lR(t,n)).toRuntime()}var doe="vega",hoe="5.20.2",poe="The Vega visualization grammar.",goe=["vega","visualization","interaction","dataflow","library","data","d3"],moe="BSD-3-Clause",yoe="UW Interactive Data Lab (http://idl.cs.washington.edu)",voe="build/vega-node.js",boe="build/vega.module.js",xoe="build/vega.min.js",woe="build/vega.min.js",_oe="index.d.ts",Eoe="vega/vega",Soe={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Aoe={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.21.0","vega-util":"~1.16.1","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},koe={"vega-schema":"*"},Coe="e251dbc61ab6645689d9f349e7dd9d15ddb85bce",$oe={name:doe,version:hoe,description:poe,keywords:goe,license:moe,author:yoe,main:voe,module:boe,unpkg:xoe,jsdelivr:woe,types:_oe,repository:Eoe,scripts:Soe,dependencies:Aoe,devDependencies:koe,gitHead:Coe};de(nu,OU,GG,SY,uX,nK,FJ,oJ,TJ,XJ,oZ,dZ);const Moe=$oe.version;var Foe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Moe,Dataflow:tu,EventStream:eh,MultiPulse:W1,Operator:Ie,Parameters:Qd,Pulse:Ao,Transform:T,changeset:Ns,definition:Qk,ingest:Ce,isTuple:Kd,transform:eC,transforms:nu,tupleid:ne,interpolate:$v,interpolateColors:Oh,interpolateRange:CM,quantizeInterpolator:$M,scale:Ae,scheme:Mv,projection:_x,View:aN,defaultLocale:U1,formatLocale:Gd,locale:zk,resetDefaultLocale:Z7,timeFormatLocale:Jl,expressionFunction:ot,parse:foe,runtimeContext:UO,codegenExpression:bO,parseExpression:T2,parseSelector:Jo,Debug:VS,Error:j0,Info:YS,None:GS,Warn:q0,accessor:vn,accessorFields:Lt,accessorName:Je,array:K,ascending:Ld,clampRange:sA,compare:V0,constant:zt,debounce:X0,error:N,extend:de,extent:qi,extentIndex:aA,falsy:po,fastmap:Ha,field:bn,flush:uA,hasOwnProperty:te,id:$l,identity:It,inherits:q,inrange:Ga,isArray:R,isBoolean:go,isDate:mo,isFunction:fe,isIterable:lA,isNumber:Oe,isObject:J,isRegExp:cA,isString:V,key:K0,lerp:fA,logger:W0,lruCache:dA,merge:hA,mergeConfig:Wa,one:qa,pad:pA,panLinear:eA,panLog:tA,panPow:nA,panSymlog:iA,peek:be,quarter:rA,repeat:Fl,span:Dl,splitAccessPath:ji,stringValue:W,toBoolean:J0,toDate:Z0,toNumber:Pt,toSet:vt,toString:Q0,truncate:gA,truthy:Vn,utcquarter:oA,visitArray:yo,writeConfig:Ml,zero:ho,zoomLinear:H0,zoomLog:G0,zoomPow:Rd,zoomSymlog:Y0,bandwidthNRD:V1,bin:nC,bootstrapCI:iC,cumulativeLogNormal:ey,cumulativeNormal:rh,cumulativeUniform:ry,densityLogNormal:Q1,densityNormal:X1,densityUniform:iy,dotbin:rC,quantileLogNormal:ty,quantileNormal:oh,quantileUniform:oy,quantiles:G1,quartiles:Y1,get random(){return Jn},randomInteger:PB,randomKDE:J1,randomLCG:IB,randomLogNormal:sC,randomMixture:aC,randomNormal:K1,randomUniform:uC,regressionExp:cC,regressionLinear:sy,regressionLoess:gC,regressionLog:lC,regressionPoly:dC,regressionPow:fC,regressionQuad:ay,sampleCurve:ah,sampleLogNormal:Z1,sampleNormal:ih,sampleUniform:ny,setRandom:RB,DATE:_n,DAY:Ut,DAYOFYEAR:Wi,HOURS:In,MILLISECONDS:bi,MINUTES:Pn,MONTH:Bt,QUARTER:wn,SECONDS:Kn,TIME_UNITS:A1,WEEK:ut,YEAR:$t,dayofyear:XA,timeBin:pk,timeFloor:nk,timeInterval:Ja,timeOffset:ok,timeSequence:uk,timeUnitSpecifier:VA,timeUnits:C1,utcFloor:ik,utcInterval:Za,utcOffset:sk,utcSequence:lk,utcdayofyear:ZA,utcweek:QA,week:KA,read:Bk,inferType:vA,inferTypes:bA,typeParsers:e1,format:zd,formats:s1,responseType:CA,loader:Yd,Bounds:ct,CanvasHandler:Dc,CanvasRenderer:sp,Gradient:WM,GroupItem:zh,Handler:Bo,Item:Ph,Marks:zn,RenderType:jo,Renderer:nr,ResourceLoader:Bv,SVGHandler:gb,SVGRenderer:_b,SVGStringRenderer:Ab,Scenegraph:cb,boundClip:u3,boundContext:_c,boundItem:lb,boundMark:EF,boundStroke:Pr,domChild:Sn,domClear:Ei,domCreate:zo,domFind:fb,font:Jh,fontFamily:Cc,fontSize:tr,intersect:r3,intersectBoxLine:vu,intersectPath:Yv,intersectPoint:Vv,intersectRule:uF,lineHeight:Io,markup:wb,multiLineOffset:sb,pathCurves:Nv,pathEqual:l3,pathParse:gu,pathRectangle:JM,pathRender:yc,pathSymbols:KM,pathTrail:ZM,point:Qh,renderModule:up,resetSVGClipId:eF,resetSVGDefIds:uG,sceneEqual:Cb,sceneFromJSON:AF,scenePickVisit:Gh,sceneToJSON:SF,sceneVisit:_i,sceneZOrder:Xv,serializeXML:YF,textMetrics:er});const Doe="vega-lite",Toe='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',Ooe="5.1.0",Noe=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],Roe="https://vega.github.io/vega-lite/",Loe="Vega-Lite is a concise high-level language for interactive visualization.",Ioe="build/vega-lite.js",Poe="build/vega-lite.min.js",zoe="build/vega-lite.min.js",Boe="build/src/index",Uoe="build/src/index.d.ts",joe={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},qoe={test:"test"},Woe=["bin","build","src","vega-lite*","tsconfig.json"],Hoe={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:cover":"jest --collectCoverage test/","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"jest --watch test/"},Goe={type:"git",url:"https://github.com/vega/vega-lite.git"},Yoe="BSD-3-Clause",Voe={url:"https://github.com/vega/vega-lite/issues"},Xoe={"@babel/core":"^7.13.15","@babel/preset-env":"^7.13.15","@babel/preset-typescript":"^7.13.0","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^18.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.1","@types/chai":"^4.2.16","@types/d3":"^6.3.0","@types/jest":"^26.0.22","@types/mkdirp":"^1.0.1","@types/pako":"^1.0.1","@typescript-eslint/eslint-plugin":"^4.22.0","@typescript-eslint/parser":"^4.22.0",ajv:"^8.1.0","ajv-formats":"^2.0.2",chai:"^4.3.4",cheerio:"^1.0.0-rc.6","conventional-changelog-cli":"^2.1.1",d3:"^6.7.0","del-cli":"^3.0.1",eslint:"^7.24.0","eslint-config-prettier":"^8.2.0","eslint-plugin-jest":"^24.3.5","eslint-plugin-prettier":"^3.4.0","gh-pages":"^3.1.0","highlight.js":"^10.7.2",jest:"^26.6.3","jest-dev-server":"^5.0.0",mkdirp:"^1.0.4",pako:"^2.0.3",prettier:"^2.2.1",puppeteer:"^8.0.0",rollup:"^2.45.2","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^11.3.2",terser:"^5.6.1","ts-json-schema-generator":"^0.90.0",typescript:"~4.2.4","vega-cli":"^5.20.2","vega-datasets":"~2.2.0","vega-embed":"^6.17.0","vega-tooltip":"^0.25.1","yaml-front-matter":"^4.1.1"},Koe={"@types/clone":"~2.1.0","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.2.0","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-util":"~1.16.1",yargs:"~16.2.0"},Joe={vega:"^5.20.0"},Zoe={testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1,setupFiles:["./test/jest.overrides.ts"]};var Qoe={name:Doe,author:Toe,version:Ooe,collaborators:Noe,homepage:Roe,description:Loe,main:Ioe,unpkg:Poe,jsdelivr:zoe,module:Boe,types:Uoe,bin:joe,directories:qoe,files:Woe,scripts:Hoe,repository:Goe,license:Yoe,bugs:Voe,devDependencies:Xoe,dependencies:Koe,peerDependencies:Joe,jest:Zoe};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var fR={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var i;try{i=Map}catch(d){i=function(){}}var r;try{r=Set}catch(d){r=function(){}}var o;try{o=Promise}catch(d){o=function(){}}function s(d,h,p,g,m){typeof h=="object"&&(p=h.depth,g=h.prototype,m=h.includeNonEnumerable,h=h.circular);var y=[],v=[],b=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof p=="undefined"&&(p=Infinity);function w(E,S){if(E===null)return null;if(S===0)return E;var _,A;if(typeof E!="object")return E;if(n(E,i))_=new i;else if(n(E,r))_=new r;else if(n(E,o))_=new o(function(U,Y){E.then(function(Q){U(w(Q,S-1))},function(Q){Y(w(Q,S-1))})});else if(s.__isArray(E))_=[];else if(s.__isRegExp(E))_=new RegExp(E.source,f(E)),E.lastIndex&&(_.lastIndex=E.lastIndex);else if(s.__isDate(E))_=new Date(E.getTime());else{if(b&&Buffer.isBuffer(E))return Buffer.allocUnsafe?_=Buffer.allocUnsafe(E.length):_=new Buffer(E.length),E.copy(_),_;n(E,Error)?_=Object.create(E):typeof g=="undefined"?(A=Object.getPrototypeOf(E),_=Object.create(A)):(_=Object.create(g),A=g)}if(h){var C=y.indexOf(E);if(C!=-1)return v[C];y.push(E),v.push(_)}n(E,i)&&E.forEach(function(U,Y){var Q=w(Y,S-1),ce=w(U,S-1);_.set(Q,ce)}),n(E,r)&&E.forEach(function(U){var Y=w(U,S-1);_.add(Y)});for(var k in E){var $;A&&($=Object.getOwnPropertyDescriptor(A,k)),!($&&$.set==null)&&(_[k]=w(E[k],S-1))}if(Object.getOwnPropertySymbols)for(var F=Object.getOwnPropertySymbols(E),k=0;k<F.length;k++){var D=F[k],L=Object.getOwnPropertyDescriptor(E,D);L&&!L.enumerable&&!m||(_[D]=w(E[D],S-1),L.enumerable||Object.defineProperty(_,D,{enumerable:!1}))}if(m)for(var M=Object.getOwnPropertyNames(E),k=0;k<M.length;k++){var I=M[k],L=Object.getOwnPropertyDescriptor(E,I);L&&L.enumerable||(_[I]=w(E[I],S-1),Object.defineProperty(_,I,{enumerable:!1}))}return _}return w(d,p)}s.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function a(d){return Object.prototype.toString.call(d)}s.__objToStr=a;function u(d){return typeof d=="object"&&a(d)==="[object Date]"}s.__isDate=u;function l(d){return typeof d=="object"&&a(d)==="[object Array]"}s.__isArray=l;function c(d){return typeof d=="object"&&a(d)==="[object RegExp]"}s.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return s.__getRegExpFlags=f,s}();e.exports&&(e.exports=t)})(fR);var ese=fR.exports,tse=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;r--!=0;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),i=o.length,i!==Object.keys(n).length)return!1;for(r=i;r--!=0;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;r--!=0;){var s=o[r];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n},Aw=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.cmp&&function(o){return function(s){return function(a,u){var l={key:a,value:s[a]},c={key:u,value:s[u]};return o(l,c)}}}(t.cmp),r=[];return function o(s){if(s&&s.toJSON&&typeof s.toJSON=="function"&&(s=s.toJSON()),s!==void 0){if(typeof s=="number")return isFinite(s)?""+s:"null";if(typeof s!="object")return JSON.stringify(s);var a,u;if(Array.isArray(s)){for(u="[",a=0;a<s.length;a++)a&&(u+=","),u+=o(s[a])||"null";return u+"]"}if(s===null)return"null";if(r.indexOf(s)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=r.push(s)-1,c=Object.keys(s).sort(i&&i(s));for(u="",a=0;a<c.length;a++){var f=c[a],d=o(s[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return r.splice(l,1),"{"+u+"}"}}(e)};function kw(e){return!!e.or}function Cw(e){return!!e.and}function $w(e){return!!e.not}function Wg(e,t){if($w(e))Wg(e.not,t);else if(Cw(e))for(const n of e.and)Wg(n,t);else if(kw(e))for(const n of e.or)Wg(n,t);else t(e)}function Hu(e,t){return $w(e)?{not:Hu(e.not,t)}:Cw(e)?{and:e.and.map(n=>Hu(n,t))}:kw(e)?{or:e.or.map(n=>Hu(n,t))}:t(e)}const lr=tse,he=ese;function Gu(e,t){const n={};for(const i of t)te(e,i)&&(n[i]=e[i]);return n}function Wn(e,t){const n=x({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>Aw(e)).join(",")})`};const ze=Aw;function xe(e){if(Oe(e))return e;const t=V(e)?e:Aw(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function Mw(e){return e===!1||e===null}function pe(e,t){return e.includes(t)}function Yu(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function Fw(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function dR(e,...t){for(const n of t)nse(e,n!=null?n:{});return e}function nse(e,t){for(const n of B(t))Ml(e,n,t[n],!0)}function cr(e,t){const n=[],i={};let r;for(const o of e)r=t(o),!(r in i)&&(i[r]=1,n.push(o));return n}function ise(e,t){const n=B(e),i=B(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function hR(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Dw(e,t){for(const n of e)if(t.has(n))return!0;return!1}function Tw(e){const t=new Set;for(const n of e){const r=ji(n).map((s,a)=>a===0?s:`[${s}]`),o=r.map((s,a)=>r.slice(0,a+1).join(""));for(const s of o)t.add(s)}return t}function Ow(e,t){return e===void 0||t===void 0?!0:Dw(Tw(e),Tw(t))}function Re(e){return B(e).length===0}const B=Object.keys,dn=Object.values,Qo=Object.entries;function Mf(e){return e===!0||e===!1}function He(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Ff(e,t){return $w(e)?`!(${Ff(e.not,t)})`:Cw(e)?`(${e.and.map(n=>Ff(n,t)).join(") && (")})`:kw(e)?`(${e.or.map(n=>Ff(n,t)).join(") || (")})`:t(e)}function Hg(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&Hg(e[n],t)&&delete e[n],Re(e)}function Df(e){return e.charAt(0).toUpperCase()+e.substr(1)}function Nw(e,t="datum"){const n=ji(e),i=[];for(let r=1;r<=n.length;r++){const o=`[${n.slice(0,r).map(W).join("][")}]`;i.push(`${t}${o}`)}return i.join(" && ")}function pR(e,t="datum"){return`${t}[${W(ji(e).join("."))}]`}function rse(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function si(e){return`${ji(e).map(rse).join("\\.")}`}function fa(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Rw(e){return`${ji(e).join(".")}`}function Vu(e){return e?ji(e).length:0}function st(...e){for(const t of e)if(t!==void 0)return t}let gR=42;function mR(e){const t=++gR;return e?String(e)+t:t}function ose(){gR=42}function yR(e){return vR(e)?e:`__${e}`}function vR(e){return e.startsWith("__")}function Tf(e){if(e!==void 0)return(e%360+360)%360}function Gg(e){return Oe(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const Xr="row",Kr="column",Yg="facet",Xe="x",ht="y",Oi="x2",fr="y2",dr="radius",Jr="radius2",Ni="theta",Zr="theta2",hr="latitude",pr="longitude",Ri="latitude2",ai="longitude2",Dn="color",gr="fill",mr="stroke",Tn="shape",Qr="size",da="angle",eo="opacity",es="fillOpacity",ts="strokeOpacity",ns="strokeWidth",is="strokeDash",Of="text",Nf="order",Rf="detail",Vg="key",ha="tooltip",Xg="href",Kg="url",Jg="description",sse={x:1,y:1,x2:1,y2:1},bR={theta:1,theta2:1,radius:1,radius2:1};function xR(e){return e in bR}const Lw={longitude:1,longitude2:1,latitude:1,latitude2:1};function ase(e){switch(e){case hr:return"y";case Ri:return"y2";case pr:return"x";case ai:return"x2"}}function use(e){return e in Lw}const lse=B(Lw),wR=P(x(x(x({},sse),bR),Lw),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Xu(e){return e===Dn||e===gr||e===mr}const _R={row:1,column:1,facet:1},ui=B(_R),Iw=x(x({},wR),_R),cse=B(Iw),G4=Iw,{order:jge,detail:qge,tooltip:Wge}=G4,fse=Z(G4,["order","detail","tooltip"]),Y4=fse,{row:Hge,column:Gge,facet:Yge}=Y4,dse=Z(Y4,["row","column","facet"]);function hse(e){return!!dse[e]}function ER(e){return!!Iw[e]}const pse=[Oi,fr,Ri,ai,Zr,Jr];function SR(e){return pa(e)!==e}function pa(e){switch(e){case Oi:return Xe;case fr:return ht;case Ri:return hr;case ai:return pr;case Zr:return Ni;case Jr:return dr}return e}function rs(e){if(xR(e))switch(e){case Ni:return"startAngle";case Zr:return"endAngle";case dr:return"outerRadius";case Jr:return"innerRadius"}return e}function to(e){switch(e){case Xe:return Oi;case ht:return fr;case hr:return Ri;case pr:return ai;case Ni:return Zr;case dr:return Jr}}function li(e){switch(e){case Xe:case Oi:return"width";case ht:case fr:return"height"}}function gse(e){switch(e){case Xe:return"xOffset";case ht:return"yOffset";case Oi:return"x2Offset";case fr:return"y2Offset";case Ni:return"thetaOffset";case dr:return"radiusOffset";case Zr:return"theta2Offset";case Jr:return"radius2Offset"}}const V4=wR,{x:Vge,y:Xge,x2:Kge,y2:Jge,latitude:Zge,longitude:Qge,latitude2:eme,longitude2:tme,theta:nme,theta2:ime,radius:rme,radius2:ome}=V4,Pw=Z(V4,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),mse=B(Pw),os={x:1,y:1},yr=B(os);function vr(e){return e in os}const zw={theta:1,radius:1},yse=B(zw);function Zg(e){return e==="width"?Xe:ht}const X4=Pw,{text:sme,tooltip:ame,href:ume,url:lme,description:cme,detail:fme,key:dme,order:hme}=X4,AR=Z(X4,["text","tooltip","href","url","description","detail","key","order"]),vse=B(AR);function bse(e){return!!Pw[e]}function xse(e){switch(e){case Dn:case gr:case mr:case Qr:case Tn:case eo:case ns:case is:return!0;case es:case ts:case da:return!1}}const kR=x(x(x({},os),zw),AR),Qg=B(kR);function ss(e){return!!kR[e]}function wse(e,t){return Ese(e)[t]}const CR={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},K4=CR,{geoshape:pme}=K4,_se=Z(K4,["geoshape"]);function Ese(e){switch(e){case Dn:case gr:case mr:case Jg:case Rf:case Vg:case ha:case Xg:case Nf:case eo:case es:case ts:case ns:case Yg:case Xr:case Kr:return CR;case Xe:case ht:case hr:case pr:return _se;case Oi:case fr:case Ri:case ai:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Qr:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case is:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Tn:return{point:"always",geoshape:"always"};case Of:return{text:"always"};case da:return{point:"always",square:"always",text:"always"};case Kg:return{image:"always"};case Ni:return{text:"always",arc:"always"};case dr:return{text:"always",arc:"always"};case Zr:case Jr:return{arc:"always"}}}function Bw(e){switch(e){case Xe:case ht:case Ni:case dr:case Qr:case da:case ns:case eo:case es:case ts:case Oi:case fr:case Zr:case Jr:return;case Yg:case Xr:case Kr:case Tn:case is:case Of:case ha:case Xg:case Kg:case Jg:return"discrete";case Dn:case gr:case mr:return"flexible";case hr:case pr:case Ri:case ai:case Rf:case Vg:case Nf:return}}const Sse={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Ase={count:1,min:1,max:1};function no(e){return!!e&&!!e.argmin}function as(e){return!!e&&!!e.argmax}function Uw(e){return V(e)&&!!Sse[e]}const kse=["count","valid","missing","distinct"];function $R(e){return V(e)&&pe(kse,e)}function Cse(e){return V(e)&&pe(["min","max"],e)}const $se=["count","sum","distinct","valid","missing"],Mse=["mean","average","median","q1","q3","min","max"],Fse=vt(Mse);function MR(e){return go(e)&&(e=bm(e,void 0)),"bin"+B(e).map(t=>em(e[t])?He(`_${t}_${Qo(e[t])}`):He(`_${t}_${e[t]}`)).join("")}function Be(e){return e===!0||ga(e)&&!e.binned}function hn(e){return e==="binned"||ga(e)&&e.binned===!0}function ga(e){return J(e)}function em(e){return e==null?void 0:e.param}function FR(e){switch(e){case Xr:case Kr:case Qr:case Dn:case gr:case mr:case ns:case eo:case es:case ts:case Tn:return 6;case is:return 4;default:return 10}}function Lf(e){return e&&!!e.expr}function On(e){const t=B(e||{}),n={};for(const i of t)n[i]=Hn(e[i]);return n}function DR(e){const v=e,{anchor:t,frame:n,offset:i,orient:r,color:o,subtitleColor:s,subtitleFont:a,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d}=v,h=Z(v,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=x(x({},h),o?{fill:o}:{}),g=x(x(x(x({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),m=x(x(x(x(x(x(x({},s?{subtitleColor:s}:{}),a?{subtitleFont:a}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{}),y=Gu(p,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:p,subtitleMarkConfig:y,nonMark:g,subtitle:m}}function us(e){return V(e)||R(e)&&V(e[0])}function oe(e){return e&&!!e.signal}function ls(e){return!!e.step}function Dse(e){return R(e)?!1:"fields"in e&&!("data"in e)}function Tse(e){return R(e)?!1:"fields"in e&&"data"in e}function io(e){return R(e)?!1:"field"in e&&"data"in e}const Ose={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},Nse=B(Ose),Rse={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},jw=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function TR(e){const t=R(e.condition)?e.condition.map(OR):OR(e.condition);return P(x({},Hn(e)),{condition:t})}function Hn(e){if(Lf(e)){const t=e,{expr:n}=t,i=Z(t,["expr"]);return x({signal:n},i)}return e}function OR(e){if(Lf(e)){const t=e,{expr:n}=t,i=Z(t,["expr"]);return x({signal:n},i)}return e}function Ge(e){if(Lf(e)){const t=e,{expr:n}=t,i=Z(t,["expr"]);return x({signal:n},i)}return oe(e)?e:e!==void 0?{value:e}:void 0}function NR(e){return oe(e)?e.signal:W(e.value)}function ro(e){return oe(e)?e.signal:e==null?null:W(e)}function Lse(e,t,n){for(const i of n){const r=ma(i,t.markDef,t.config);r!==void 0&&(e[i]=Ge(r))}return e}function RR(e){var t;return[].concat(e.type,(t=e.style)!=null?t:[])}function Fe(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:o}=i;return r&&t[r]!==void 0?t[r]:t[e]!==void 0?t[e]:o&&(!r||r===e)?void 0:ma(e,t,n,i)}function ma(e,t,n,{vgChannel:i}={}){return st(i?tm(e,t,n.style):void 0,tm(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function tm(e,t,n){return LR(e,RR(t),n)}function LR(e,t,n){t=K(t);let i;for(const r of t){const o=n[r];o&&o[e]!==void 0&&(i=o[e])}return i}function IR(e,t){return K(e).reduce((n,i)=>{var r;return n.field.push(H(i,t)),n.order.push((r=i.sort)!=null?r:"ascending"),n},{field:[],order:[]})}function PR(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(lr(r,i))return;n.push(i)}),n}function zR(e,t){return lr(e,t)||!t?e:e?[...K(e),...K(t)].join(", "):t}function BR(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((us(n)||oe(n))&&(us(i)||oe(i)))return{explicit:e.explicit,value:zR(n,i)};if(us(n)||oe(n))return{explicit:e.explicit,value:n};if(us(i)||oe(i))return{explicit:e.explicit,value:i};if(!us(n)&&!oe(n)&&!us(i)&&!oe(i))return{explicit:e.explicit,value:PR(n,i)};throw new Error("It should never reach here")}function qw(e){return`Invalid specification ${ze(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Ise='Autosize "fit" only works for single views and layered views.';function UR(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function jR(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function qR(e){return e?`Dropping "fit-${e}" because spec has discrete ${li(e)}.`:'Dropping "fit" because spec has discrete size.'}function Ww(e){return`Unknown field for ${e}. Cannot calculate view size.`}function WR(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Pse(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function zse(e){return`The "nearest" transform is not supported for ${e} marks.`}function HR(e){return`Selection not supported for ${e} yet.`}function Bse(e){return`Cannot find a selection named "${e}".`}const Use="Scale bindings are currently only supported for scales with unbinned, continuous domains.",jse="Legend bindings are only supported for selections over an individual field or encoding channel.";function qse(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function Wse(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Hse="The same selection must be used to override scale domains in a layered view.",Gse='Interval selections should be initialized using "x" and/or "y" keys.';function Yse(e){return`Unknown repeated value "${e}".`}function GR(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Vse="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Xse(e){return`Unrecognized parse "${e}".`}function YR(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const Kse="Attempt to add the same child twice.";function Jse(e){return`Ignoring an invalid transform: ${ze(e)}.`}const Zse='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function VR(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Qse(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${ze(t)} is overridden by a child projection ${ze(n)}.`}const eae="Arc marks uses theta channel rather than angle, replacing angle with theta.";function tae(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${ze(n)}}.`}function XR(e){return`Invalid field type "${e}".`}function nae(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function iae(e){return`Invalid aggregation operator "${e}".`}function KR(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function rae(e){return`Position range does not support relative band size for ${e}.`}function Hw(e,t){return`Dropping ${ze(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const oae="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function nm(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function sae(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function aae(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function uae(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function lae(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Gw(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function cae(e){return`The ${e} for range marks cannot be an expression`}function fae(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function dae(e,t){return`Specified orient "${e}" overridden with "${t}".`}function hae(e){return`Cannot use the scale property "${e}" with non-color channel.`}function pae(e){return`Cannot use the relative band size with ${e} scale.`}function gae(e){return`Using unaggregated domain with raw field has no effect (${ze(e)}).`}function mae(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function yae(e){return`Unaggregated domain is currently unsupported for log scale (${ze(e)}).`}function vae(e){return`Cannot apply size to non-oriented mark "${e}".`}function bae(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function xae(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function JR(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function ZR(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function wae(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${ze(n)} and ${ze(i)}). Using ${ze(n)}.`}function _ae(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${ze(n)} and ${ze(i)}). Using the union of the two domains.`}function Eae(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Sae(e){return`Dropping sort property ${ze(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const QR="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Aae="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",kae="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",Cae="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function $ae(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Mae(e){return`Cannot stack non-linear scale (${e}).`}function Fae(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function im(e,t){return`Invalid ${e}: ${ze(t)}.`}function Dae(e){return`Dropping day from datetime ${ze(e)} as day cannot be combined with other units.`}function Tae(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Oae(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Nae(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function e5(e){return`1D error band does not support ${e}.`}function t5(e){return`Channel ${e} is required for "binned" bin.`}function Rae(e){return`Channel ${e} should not be used with "binned" bin.`}function Lae(e){return`Domain for ${e} is required for threshold scale.`}const n5=W0(q0);let Ku=n5;function Iae(e){return Ku=e,Ku}function Pae(){return Ku=n5,Ku}function j(...e){Ku.warn(...e)}function zae(...e){Ku.debug(...e)}function ya(e){if(e&&J(e)){for(const t of Vw)if(t in e)return!0}return!1}const i5=["january","february","march","april","may","june","july","august","september","october","november","december"],Bae=i5.map(e=>e.substr(0,3)),r5=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Uae=r5.map(e=>e.substr(0,3));function jae(e){if(Gg(e)&&(e=+e),Oe(e))return e>4&&j(im("quarter",e)),e-1;throw new Error(im("quarter",e))}function qae(e){if(Gg(e)&&(e=+e),Oe(e))return e-1;{const t=e.toLowerCase(),n=i5.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Bae.indexOf(i);if(r!==-1)return r;throw new Error(im("month",e))}}function Wae(e){if(Gg(e)&&(e=+e),Oe(e))return e%7;{const t=e.toLowerCase(),n=r5.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Uae.indexOf(i);if(r!==-1)return r;throw new Error(im("day",e))}}function Yw(e,t){const n=[];if(t&&e.day!==void 0&&B(e).length>1&&(j(Dae(e)),e=he(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?qae(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?jae(e.quarter):e.quarter;n.push(Oe(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?Wae(e.day):e.day;n.push(Oe(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r=="undefined"?0:r)}return n}function If(e){const n=Yw(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Hae(e){const n=Yw(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Gae(e){const t=Yw(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const o5={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Vw=B(o5);function Yae(e){return!!o5[e]}function Xw(e){return e.startsWith("utc")}function Vae(e){return e.substr(3)}const Xae={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Kw(e){return Vw.filter(t=>s5(e,t))}function s5(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Kae(e,t,{end:n}={end:!1}){const i=Nw(t),r=Xw(e)?"utc":"";function o(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let s;const a={};for(const u of Vw)s5(e,u)&&(a[u]=o(u),s=u);return n&&(a[s]+="+1"),Hae(a)}function a5(e){if(!e)return;const t=Kw(e);return`timeUnitSpecifier(${ze(t)}, ${ze(Xae)})`}function Jae(e,t,n){if(!e)return;const i=a5(e);return`${n||Xw(e)?"utc":"time"}Format(${t}, ${i})`}function pn(e){if(!e)return;let t;return V(e)?t={unit:e}:J(e)&&(t=x(x({},e),e.unit?{unit:e.unit}:{})),Xw(t.unit)&&(t.utc=!0,t.unit=Vae(t.unit)),t}function Zae(e){const i=pn(e),{utc:t}=i,n=Z(i,["utc"]);return n.unit?(t?"utc":"")+B(n).map(r=>He(`${r==="unit"?"":`_${r}_`}${n[r]}`)).join(""):(t?"utc":"")+"timeunit"+B(n).map(r=>He(`_${r}_${n[r]}`)).join("")}function Qae(e){return e==null?void 0:e.param}function Jw(e){return e&&!!e.field&&e.equal!==void 0}function Zw(e){return e&&!!e.field&&e.lt!==void 0}function Qw(e){return e&&!!e.field&&e.lte!==void 0}function e_(e){return e&&!!e.field&&e.gt!==void 0}function t_(e){return e&&!!e.field&&e.gte!==void 0}function n_(e){if(e&&e.field){if(R(e.range)&&e.range.length===2)return!0;if(oe(e.range))return!0}return!1}function i_(e){return e&&!!e.field&&(R(e.oneOf)||R(e.in))}function eue(e){return e&&!!e.field&&e.valid!==void 0}function u5(e){return i_(e)||Jw(e)||n_(e)||Zw(e)||e_(e)||Qw(e)||t_(e)}function br(e,t){return xm(e,{timeUnit:t,wrapTime:!0})}function tue(e,t){return e.map(n=>br(n,t))}function l5(e,t=!0){var o;const{field:n}=e,i=(o=pn(e.timeUnit))==null?void 0:o.unit,r=i?`time(${Kae(i,n)})`:H(e,{expr:"datum"});if(Jw(e))return`${r}===${br(e.equal,i)}`;if(Zw(e)){const s=e.lt;return`${r}<${br(s,i)}`}else if(e_(e)){const s=e.gt;return`${r}>${br(s,i)}`}else if(Qw(e)){const s=e.lte;return`${r}<=${br(s,i)}`}else if(t_(e)){const s=e.gte;return`${r}>=${br(s,i)}`}else{if(i_(e))return`indexof([${tue(e.oneOf,i).join(",")}], ${r}) !== -1`;if(eue(e))return r_(r,e.valid);if(n_(e)){const{range:s}=e,a=oe(s)?{signal:`${s.signal}[0]`}:s[0],u=oe(s)?{signal:`${s.signal}[1]`}:s[1];if(a!==null&&u!==null&&t)return"inrange("+r+", ["+br(a,i)+", "+br(u,i)+"])";const l=[];return a!==null&&l.push(`${r} >= ${br(a,i)}`),u!==null&&l.push(`${r} <= ${br(u,i)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${ze(e)}`)}function r_(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function nue(e){var t;return u5(e)&&e.timeUnit?P(x({},e),{timeUnit:(t=pn(e.timeUnit))==null?void 0:t.unit}):e}const Pf={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},va=Pf.quantitative,o_=Pf.ordinal,Ju=Pf.temporal,s_=Pf.nominal,Zu=Pf.geojson;function iue(e){if(e)switch(e=e.toLowerCase(),e){case"q":case va:return"quantitative";case"t":case Ju:return"temporal";case"o":case o_:return"ordinal";case"n":case s_:return"nominal";case Zu:return"geojson"}}const pt={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},a_={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function rue(e,t){const n=a_[e],i=a_[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const oue={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function c5(e){return oue[e]}const f5=["linear","log","pow","sqrt","symlog","time","utc"],sue=vt(f5),aue=["linear","log","pow","sqrt","symlog"],uue=vt(aue);function lue(e){return e in uue}const cue=["quantile","quantize","threshold"],fue=vt(cue),due=f5.concat(["quantile","quantize","threshold","sequential","identity"]),hue=vt(due),pue=["ordinal","bin-ordinal","point","band"],gue=vt(pue);function Vt(e){return e in gue}function Gn(e){return e in hue}function Li(e){return e in sue}function zf(e){return e in fue}const mue={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function yue(e){return!V(e)&&!!e.name}function d5(e){return e==null?void 0:e.param}function vue(e){return e&&e.unionWith}const bue={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},J4=bue,{type:gme,domain:mme,range:yme,rangeMax:vme,rangeMin:bme,scheme:xme}=J4,xue=Z(J4,["type","domain","range","rangeMax","rangeMin","scheme"]),wue=B(xue);function u_(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Li(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return Li(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return Li(e);case"nice":return Li(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Gn(e)&&!pe(["log","time","utc","threshold","quantile"],e)}}function h5(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Xu(e)?void 0:hae(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function _ue(e,t){return pe([o_,s_],t)?e===void 0||Vt(e):t===Ju?pe([pt.TIME,pt.UTC,void 0],e):t===va?pe([pt.LOG,pt.POW,pt.SQRT,pt.SYMLOG,pt.QUANTILE,pt.QUANTIZE,pt.THRESHOLD,pt.LINEAR,void 0],e):!0}function Eue(e,t){if(!ss(e))return!1;switch(e){case Xe:case ht:case Ni:case dr:return Li(t)||pe(["band","point"],t);case Qr:case ns:case eo:case es:case ts:case da:return Li(t)||zf(t)||pe(["band","point","ordinal"],t);case Dn:case gr:case mr:return t!=="band";case is:case Tn:return t==="ordinal"||zf(t)}}const gn={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},p5=gn.arc,rm=gn.area,om=gn.bar,Sue=gn.image,sm=gn.line,am=gn.point,Aue=gn.rect,um=gn.rule,g5=gn.text,l_=gn.tick,kue=gn.trail,c_=gn.circle,f_=gn.square,m5=gn.geoshape;function cs(e){return["line","area","trail"].includes(e)}function y5(e){return["rect","bar","image","arc"].includes(e)}const v5=B(gn);function xr(e){return e.type}vt(v5);const Cue=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],$ue=["fill","fillOpacity"],Mue=[...Cue,...$ue],Fue={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},b5=B(Fue),Due={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},Tue={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},Oue={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},x5=B(Oue);function Qu(e){return e&&e.band!=null}const Nue={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},w5=5,Rue={binSpacing:1,continuousBandSize:w5,timeUnitBandPosition:.5},Lue={binSpacing:0,continuousBandSize:w5,timeUnitBandPosition:.5},Iue={thickness:1};function Pue(e){return xr(e)?e.type:e}function d_(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:o}=e,s=E5(e);return G(n)&&!$R(n.aggregate)&&r&&Li(r.get("type"))&&r.get("zero")===!1?_5({fieldDef:n,channel:t,markDef:i,ref:s,config:o}):s}function _5({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return cs(n.type)||Fe("invalid",n,r)===null?i:[zue(e,t),i]}function zue(e,t){const n=h_(e,!0),r=pa(t)==="y"?{field:{group:"height"}}:{value:0};return x({test:n},r)}function h_(e,t=!0){return r_(V(e)?e:H(e,{expr:"datum"}),!t)}function Bue(e){const{datum:t}=e;return ya(t)?If(t):`${ze(t)}`}function ba(e,t,n,i){const r={};if(t&&(r.scale=t),ds(e)){const{datum:o}=e;ya(o)?r.signal=If(o):oe(o)?r.signal=o.signal:Lf(o)?r.signal=o.expr:r.value=o}else r.field=H(e,n);if(i){const{offset:o,band:s}=i;o&&(r.offset=o),s&&(r.band=s)}return r}function lm({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:o=.5}){const s=0<o&&o<1?"datum":void 0,a=H(t,{expr:s,suffix:r}),u=n!==void 0?H(n,{expr:s}):H(t,{suffix:"end",expr:s}),l={};if(o===0||o===1){l.scale=e;const c=o===0?a:u;l.field=c}else{const c=oe(o)?`${o.signal} * ${a} + (1-${o.signal}) * ${u}`:`${o} * ${a} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${c})`}return i&&(l.offset=i),l}function E5({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l,bandPosition:c}){var f;if(t){if(le(t)){if(ci(t)){c!=null||(c=R5({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:p,type:g}=t;if(Be(h)||c&&p&&g===Ju)return a&&a.impute?ba(t,o,{binSuffix:"mid"},{offset:u}):c?lm({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):ba(t,o,jf(t,e)?{binSuffix:"range"}:{},{offset:u});if(hn(h)){if(G(n))return lm({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});j(t5(e===Xe?Oi:fr))}}const d=s==null?void 0:s.get("type");return ba(t,o,Vt(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c!=null?c:t.bandPosition)!=null?f:.5:void 0})}else if(Ii(t)){const d=t.value,h=u?{offset:u}:{};return x(x({},Bf(e,d)),h)}}return fe(l)&&(l=l()),l&&x(x({},l),u?{offset:u}:{})}function Bf(e,t){return pe(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:pe(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Ge(t)}function xa(e){return e&&e!=="number"&&e!=="time"}function S5(e,t,n){return`${e}(${t}${n?`, ${ze(n)}`:""})`}const Uue=" \u2013 ";function p_({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o}){var a,u;if(xa(n))return g_({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:o});const s=A5(e,i,r);if(il(e)){const l=que(s,G(e)?(a=pn(e.timeUnit))==null?void 0:a.unit:void 0,t,o.timeFormat,el(e)&&((u=e.scale)==null?void 0:u.type)===pt.UTC);return l?{signal:l}:void 0}if(t=$5(fs(e),t,o),G(e)&&Be(e.bin)){const l=H(e,{expr:i,binSuffix:"end"});return{signal:cm(s,l,t,n,o)}}else return t||fs(e)==="quantitative"?{signal:`${M5(s,t)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function A5(e,t,n){return G(e)?n?`${H(e,{expr:t,suffix:"end"})}-${H(e,{expr:t,suffix:"start"})}`:H(e,{expr:t}):Bue(e)}function g_({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o,field:s}){if(s!=null||(s=A5(e,i,r)),G(e)&&Be(e.bin)){const a=H(e,{expr:i,binSuffix:"end"});return{signal:cm(s,a,t,n,o)}}return{signal:S5(n,s,t)}}function k5(e,t,n,i,r,o){var s;if(!xa(i)){if(il(e)){const a=G(e)?(s=pn(e.timeUnit))==null?void 0:s.unit:void 0;return jue(n,a,r,o)}return $5(t,n,r)}}function C5(e,t,n){if(e&&(oe(e)||e==="number"||e==="time"))return e;if(il(t)&&n!=="time"&&n!=="utc")return"time"}function $5(e,t,n){if(V(t))return t;if(e===va)return n.numberFormat}function jue(e,t,n,i){return e||(t?{signal:a5(t)}:i?void 0:n.timeFormat)}function M5(e,t){return`format(${e}, "${t||""}")`}function F5(e,t,n,i){var r;return xa(n)?S5(n,e,t):M5(e,(r=V(t)?t:void 0)!=null?r:i.numberFormat)}function cm(e,t,n,i,r){const o=F5(e,n,i,r),s=F5(t,n,i,r);return`${r_(e,!1)} ? "null" : ${o} + "${Uue}" + ${s}`}function que(e,t,n,i,r){return!t||n?(n=V(n)?n:i,`${r?"utc":"time"}Format(${e}, '${n}')`):Jae(t,e,r)}const fm="min",Wue={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function D5(e){return e in Wue}function T5(e){return!!e&&!!e.encoding}function wr(e){return!!e&&(e.op==="count"||!!e.field)}function O5(e){return!!e&&R(e)}function Uf(e){return"row"in e||"column"in e}function m_(e){return!!e&&"header"in e}function dm(e){return"facet"in e}function Hue(e){return e.param}function Gue(e){return e&&!V(e)&&"repeat"in e}function N5(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return P(x(x(x({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function y_(e){return"sort"in e}function R5({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(le(e)&&e.bandPosition!==void 0)return e.bandPosition;if(G(e)){const{timeUnit:r,bin:o}=e;if(r&&!t)return y5(n.type)?0:ma("timeUnitBandPosition",n,i);if(Be(o))return .5}}function L5({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:o,useVlSizeChannel:s}){var l,c,f;const a=li(e),u=Fe(s?"size":a,i,r,{vgChannel:a});if(u!==void 0)return u;if(G(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:ma("timeUnitBandSize",i,r)};if(Be(h)&&!Vt(o))return{band:1}}if(y5(i.type))return o?Vt(o)?((l=r[i.type])==null?void 0:l.discreteBandSize)||{band:1}:(c=r[i.type])==null?void 0:c.continuousBandSize:(f=r[i.type])==null?void 0:f.discreteBandSize}function I5(e,t,n,i){return Be(e.bin)||e.timeUnit&&ci(e)&&e.type==="temporal"?R5({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function hm(e){return!!e&&"condition"in e}function pm(e){const t=e&&e.condition;return!!t&&!R(t)&&G(t)}function gm(e){const t=e&&e.condition;return!!t&&!R(t)&&le(t)}function Yue(e){const t=e&&e.condition;return!!t&&(R(t)||Ii(t))}function G(e){return!!e&&(!!e.field||e.aggregate==="count")}function fs(e){return e&&e.type}function ds(e){return!!e&&"datum"in e}function _r(e){return ci(e)&&!mm(e)||v_(e)}function v_(e){return ds(e)&&Oe(e.datum)}function le(e){return G(e)||ds(e)}function ci(e){return!!e&&("field"in e||e.aggregate==="count")&&"type"in e}function Ii(e){return e&&"value"in e&&"value"in e}function el(e){return!!e&&("scale"in e||"sort"in e)}function b_(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function P5(e){return!!e&&"legend"in e}function z5(e){return!!e&&("format"in e||"formatType"in e)}function Vue(e){return Wn(e,["legend","axis","header","scale"])}function Xue(e){return"op"in e}function H(e,t={}){var s,a,u;let n=e.field;const i=t.prefix;let r=t.suffix,o="";if(Jue(e))n=yR("count");else{let l;if(!t.nofn)if(Xue(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Be(c)?(l=MR(c),r=((s=t.binSuffix)!=null?s:"")+((a=t.suffix)!=null?a:"")):f?as(f)?(o=`["${n}"]`,n=`argmax_${f.argmax}`):no(f)?(o=`["${n}"]`,n=`argmin_${f.argmin}`):l=String(f):d&&(l=Zae(d),r=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+((u=t.suffix)!=null?u:""))}l&&(n=n?`${l}_${n}`:l)}return r&&(n=`${n}_${r}`),i&&(n=`${i}_${n}`),t.forAs?Rw(n):t.expr?pR(n,t.expr)+o:si(n)+o}function mm(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return G(e)&&!!e.bin;case"temporal":return!1}throw new Error(XR(e.type))}function Kue(e){var t;return el(e)&&zf((t=e.scale)==null?void 0:t.type)}function Jue(e){return e.aggregate==="count"}function Zue(e,t){var s;const{field:n,bin:i,timeUnit:r,aggregate:o}=e;if(o==="count")return t.countTitle;if(Be(i))return`${n} (binned)`;if(r){const a=(s=pn(r))==null?void 0:s.unit;if(a)return`${n} (${Kw(a).join("-")})`}else if(o)return as(o)?`${n} for max ${o.argmax}`:no(o)?`${n} for min ${o.argmin}`:`${Df(o)} of ${n}`;return n}function Que(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(as(t))return`${r} for argmax(${t.argmax})`;if(no(t))return`${r} for argmin(${t.argmin})`;const o=pn(i),s=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||Be(n)&&"bin";return s?`${s.toUpperCase()}(${r})`:r}const B5=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Que(e);default:return Zue(e,t)}};let U5=B5;function j5(e){U5=e}function ele(){j5(B5)}function tl(e,t,{allowDisabling:n,includeDefault:i=!0}){var a,u;const r=(a=x_(e))==null?void 0:a.title;if(!G(e))return r;const o=e,s=i?w_(o,t):void 0;return n?st(r,o.title,s):(u=r!=null?r:o.title)!=null?u:s}function x_(e){if(b_(e)&&e.axis)return e.axis;if(P5(e)&&e.legend)return e.legend;if(m_(e)&&e.header)return e.header}function w_(e,t){return U5(e,t)}function ym(e){var t;if(z5(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}else{const n=(t=x_(e))!=null?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function tle(e,t){var o;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(y_(e)&&R(e.sort))return"ordinal";const{aggregate:n,bin:i,timeUnit:r}=e;if(r)return"temporal";if(i||n&&!as(n)&&!no(n))return"quantitative";if(el(e)&&((o=e.scale)==null?void 0:o.type))switch(a_[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function Er(e){if(G(e))return e;if(pm(e))return e.condition}function gt(e){if(le(e))return e;if(gm(e))return e.condition}function q5(e,t,n,i={}){if(V(e)||Oe(e)||go(e)){const r=V(e)?"string":Oe(e)?"number":"boolean";return j(tae(t,r,e)),{value:e}}return le(e)?vm(e,t,n,i):gm(e)?P(x({},e),{condition:vm(e.condition,t,n,i)}):e}function vm(e,t,n,i){if(z5(e)){const r=e,{format:s,formatType:a}=r,u=Z(r,["format","formatType"]);if(xa(a)&&!n.customFormatTypes)return j(VR(t)),vm(u,t,n,i)}else{const s=b_(e)?"axis":P5(e)?"legend":m_(e)?"header":null;if(s&&e[s]){const o=e[s],{format:a,formatType:u}=o,l=Z(o,["format","formatType"]);if(xa(u)&&!n.customFormatTypes)return j(VR(t)),vm(P(x({},e),{[s]:l}),t,n,i)}}return G(e)?__(e,t,i):nle(e)}function nle(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Oe(n)?"quantitative":V(n)?"nominal":ya(n)?"temporal":void 0,P(x({},e),{type:t})}function __(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:o,field:s}=e,a=x({},e);if(!n&&i&&!Uw(i)&&!as(i)&&!no(i)&&(j(iae(i)),delete a.aggregate),r&&(a.timeUnit=pn(r)),s&&(a.field=`${s}`),Be(o)&&(a.bin=bm(o,t)),hn(o)&&!vr(t)&&j(Rae(t)),ci(a)){const{type:l}=a,c=iue(l);l!==c&&(a.type=c),l!=="quantitative"&&$R(i)&&(j(nae(l,i)),a.type="quantitative")}else if(!SR(t)){const l=tle(a,t);a.type=l}if(ci(a)){const{compatible:l,warning:c}=ile(a,t)||{};l===!1&&j(c)}if(y_(a)&&V(a.sort)){const{sort:l}=a;if(D5(l))return P(x({},a),{sort:{encoding:l}});const c=l.substr(1);if(l.charAt(0)==="-"&&D5(c))return P(x({},a),{sort:{encoding:c,order:"descending"}})}if(m_(a)){const{header:l}=a;if(l){const u=l,{orient:c}=u,f=Z(u,["orient"]);if(c)return P(x({},a),{header:P(x({},f),{labelOrient:l.labelOrient||c,titleOrient:l.titleOrient||c})})}}return a}function bm(e,t){return go(e)?{maxbins:FR(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?P(x({},e),{maxbins:FR(t)}):e}const nl={compatible:!0};function ile(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Xr:case Kr:case Yg:return mm(e)?nl:{compatible:!1,warning:aae(t)};case Xe:case ht:case Dn:case gr:case mr:case Of:case Rf:case Vg:case ha:case Xg:case Kg:case da:case Ni:case dr:case Jg:return nl;case pr:case ai:case hr:case Ri:return n!==va?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:nl;case eo:case es:case ts:case ns:case Qr:case Zr:case Jr:case Oi:case fr:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:nl;case Tn:case is:return!mm(e)&&!Kue(e)?{compatible:!1,warning:uae(t)}:nl;case Nf:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:nl}}function il(e){const{formatType:t}=ym(e);return t==="time"||!t&&rle(e)}function rle(e){return e&&(e.type==="temporal"||G(e)&&!!e.timeUnit)}function xm(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var u;const o=t&&((u=pn(t))==null?void 0:u.unit);let s=o||n==="temporal",a;return Lf(e)?a=e.expr:oe(e)?a=e.signal:ya(e)?(s=!0,a=If(e)):(V(e)||Oe(e))&&s&&(a=`datetime(${ze(e)})`,Yae(o)&&(Oe(e)&&e<1e4||V(e)&&isNaN(Date.parse(e)))&&(a=If({[o]:e}))),a?i&&s?`time(${a})`:a:r?void 0:ze(e)}function W5(e,t){const{type:n}=e;return t.map(i=>{const r=xm(i,{timeUnit:G(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return r!==void 0?{signal:r}:i})}function jf(e,t){return Be(e.bin)?ss(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const H5={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function qf(e){return e&&e.condition}const G5=["domain","grid","labels","ticks","title"],ole={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},Y5={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},sle=P(x({},Y5),{style:1,labelExpr:1,encoding:1});function V5(e){return!!sle[e]}const ale={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},X5=B(ale);function oo(e){return"mark"in e}class wm{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return oo(t)?Pue(t.mark)===this.name:!1}}function wa(e,t){const n=e&&e[t];return n?R(n)?Yu(n,i=>!!i.field):G(n)||pm(n):!1}function E_(e){return Yu(cse,t=>{if(wa(e,t)){const n=e[t];if(R(n))return Yu(n,i=>!!i.aggregate);{const i=Er(n);return i&&!!i.aggregate}}return!1})}function K5(e,t){const n=[],i=[],r=[],o=[],s={};return S_(e,(a,u)=>{if(G(a)){const l=a,{field:c,aggregate:f,bin:d,timeUnit:h}=l,p=Z(l,["field","aggregate","bin","timeUnit"]);if(f||h||d){const g=x_(a),m=g&&g.title;let y=H(a,{forAs:!0});const v=P(x(x({},m?[]:{title:tl(a,t,{allowDisabling:!0})}),p),{field:y});if(f){let b;if(as(f)?(b="argmax",y=H({op:"argmax",field:f.argmax},{forAs:!0}),v.field=`${y}.${c}`):no(f)?(b="argmin",y=H({op:"argmin",field:f.argmin},{forAs:!0}),v.field=`${y}.${c}`):f!=="boxplot"&&f!=="errorbar"&&f!=="errorband"&&(b=f),b){const w={op:b,as:y};c&&(w.field=c),o.push(w)}}else if(n.push(y),ci(a)&&Be(d)){if(i.push({bin:d,field:c,as:y}),n.push(H(a,{binSuffix:"end"})),jf(a,u)&&n.push(H(a,{binSuffix:"range"})),vr(u)){const b={field:`${y}_end`};s[`${u}2`]=b}v.bin="binned",SR(u)||(v.type=va)}else if(h){r.push({timeUnit:h,field:c,as:y});const b=ci(a)&&a.type!==Ju&&"time";b&&(u===Of||u===ha?v.formatType=b:bse(u)?v.legend=x({formatType:b},v.legend):vr(u)&&(v.axis=x({formatType:b},v.axis)))}s[u]=v}else n.push(c),s[u]=e[u]}else s[u]=e[u]}),{bins:i,timeUnits:r,aggregate:o,groupby:n,encoding:s}}function ule(e,t,n){const i=wse(t,n);if(i){if(i==="binned"){const r=e[t===Oi?Xe:ht];return!!(G(r)&&G(e[t])&&hn(r.bin))}}else return!1;return!0}function lle(e,t,n,i){return B(e).reduce((r,o)=>{if(!ER(o))return j(sae(o)),r;const s=e[o];if(o==="angle"&&t==="arc"&&!e.theta&&(j(eae),o=Ni),!ule(e,o,t))return j(nm(o,t)),r;if(o===Qr&&t==="line"){const a=Er(e[o]);if(a==null?void 0:a.aggregate)return j(oae),r}if(o===Dn&&(n?"fill"in e:"stroke"in e))return j(KR("encoding",{fill:"fill"in e,stroke:"stroke"in e})),r;if(o===Rf||o===Nf&&!R(s)&&!Ii(s)||o===ha&&R(s))s&&(r[o]=K(s).reduce((a,u)=>(G(u)?a.push(__(u,o)):j(Hw(u,o)),a),[]));else{if(o===ha&&s===null)r[o]=null;else if(!G(s)&&!ds(s)&&!Ii(s)&&!hm(s)&&!oe(s))return j(Hw(s,o)),r;r[o]=q5(s,o,i)}return r},{})}function _m(e,t){const n={};for(const i of B(e)){const r=q5(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function cle(e){const t=[];for(const n of B(e))if(wa(e,n)){const i=e[n],r=K(i);for(const o of r)G(o)?t.push(o):pm(o)&&t.push(o.condition)}return t}function S_(e,t,n){if(!!e)for(const i of B(e)){const r=e[i];if(R(r))for(const o of r)t.call(n,o,i);else t.call(n,r,i)}}function fle(e,t,n,i){return e?B(e).reduce((r,o)=>{const s=e[o];return R(s)?s.reduce((a,u)=>t.call(i,a,u,o),r):t.call(i,r,s,o)},n):n}function J5(e,t){return B(t).reduce((n,i)=>{switch(i){case Xe:case ht:case Xg:case Jg:case Kg:case Oi:case fr:case Ni:case Zr:case dr:case Jr:case hr:case pr:case Ri:case ai:case Of:case Tn:case da:case ha:return n;case Nf:if(e==="line"||e==="trail")return n;case Rf:case Vg:{const r=t[i];if(R(r)||G(r))for(const o of K(r))o.aggregate||n.push(H(o,{}));return n}case Qr:if(e==="trail")return n;case Dn:case gr:case mr:case eo:case es:case ts:case is:case ns:{const r=Er(t[i]);return r&&!r.aggregate&&n.push(H(r,{})),n}}},[])}function dle(e){const o=e,{tooltip:t}=o,n=Z(o,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(R(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return R(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function A_(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:s,titlePrefix:a})=>{const u=i?` of ${k_(t)}`:"";return{field:s+t.field,type:t.type,title:oe(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),o=cle(n).map(Vue);return{tooltip:[...r,...cr(o,xe)]}}function k_(e){const{title:t,field:n}=e;return st(t,n)}function C_(e,t,n,i,r){const{scale:o,axis:s}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=k_(n);return Z5(e,a,r,{mark:u,encoding:x(x(x({[t]:x(x(x({field:`${l}_${n.field}`,type:n.type},d!==void 0?{title:d}:{}),o!==void 0?{scale:o}:{}),s!==void 0?{axis:s}:{})},V(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),i),f)})}}function Z5(e,t,n,i){const{clip:r,color:o,opacity:s}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[P(x({},i),{mark:x(P(x(x(x(x(x({},n[t]),r?{clip:r}:{}),o?{color:o}:{}),s?{opacity:s}:{}),xr(i.mark)?i.mark:{type:i.mark}),{style:`${a}-${t}`}),go(e[t])?{}:e[t])})]:[]}function Q5(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",o=i[r],s=i[`${r}2`],a=i[`${r}Error`],u=i[`${r}Error2`];return{continuousAxisChannelDef:Em(o,n),continuousAxisChannelDef2:Em(s,n),continuousAxisChannelDefError:Em(a,n),continuousAxisChannelDefError2:Em(u,n),continuousAxis:r}}function Em(e,t){if(e&&e.aggregate){const n=e,{aggregate:i}=n,r=Z(n,["aggregate"]);return i!==t&&j(Nae(i,t)),r}else return e}function e6(e,t){const{mark:n,encoding:i}=e,{x:r,y:o}=i;if(xr(n)&&n.orient)return n.orient;if(_r(r)){if(_r(o)){const s=G(r)&&r.aggregate,a=G(o)&&o.aggregate;if(!s&&a===t)return"vertical";if(!a&&s===t)return"horizontal";if(s===t&&a===t)throw new Error("Both x and y cannot have aggregate");return il(o)&&!il(r)?"horizontal":"vertical"}return"horizontal"}else{if(_r(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const Sm="boxplot",hle=["box","median","outliers","rule","ticks"],ple=new wm(Sm,n6);function t6(e){return Oe(e)?"tukey":e}function n6(e,{config:t}){var Ye,rt;e=P(x({},e),{encoding:_m(e.encoding,t)});const kt=e,{mark:n,encoding:i,params:r,projection:o}=kt,s=Z(kt,["mark","encoding","params","projection"]),a=xr(n)?n:{type:n};r&&j(HR("boxplot"));const u=(Ye=a.extent)!=null?Ye:t.boxplot.extent,l=Fe("size",a,t),c=t6(u),{bins:f,timeUnits:d,transform:h,continuousAxisChannelDef:p,continuousAxis:g,groupby:m,aggregate:y,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:w,customTooltipWithoutAggregatedField:E}=gle(e,u,t),et=v,{color:S,size:_}=et,A=Z(et,["color","size"]),C=co=>C_(a,g,p,co,t.boxplot),k=C(A),$=C(v),F=C(x(x({},A),_?{size:_}:{})),D=A_([{fieldPrefix:c==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:c==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],p,v),L={type:"tick",color:"black",opacity:1,orient:b,invalid:null,aria:!1},M=c==="min-max"?D:A_([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,v),I=[...k({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:M}),...k({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:M}),...k({partName:"ticks",mark:L,positionPrefix:"lower_whisker",extraEncoding:M}),...k({partName:"ticks",mark:L,positionPrefix:"upper_whisker",extraEncoding:M})],U=[...c!=="tukey"?I:[],...$({partName:"box",mark:P(x({type:"bar"},l?{size:l}:{}),{orient:w,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:D}),...F({partName:"median",mark:P(x(x({type:"tick",invalid:null},J(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),l?{size:l}:{}),{orient:b,aria:!1}),positionPrefix:"mid_box",extraEncoding:D})];if(c==="min-max")return P(x({},s),{transform:((rt=s.transform)!=null?rt:[]).concat(h),layer:U});const Y=`datum["lower_box_${p.field}"]`,Q=`datum["upper_box_${p.field}"]`,ce=`(${Q} - ${Y})`,$e=`${Y} - ${u} * ${ce}`,De=`${Q} + ${u} * ${ce}`,qe=`datum["${p.field}"]`,Pe={joinaggregate:i6(p.field),groupby:m},mt={transform:[{filter:`(${$e} <= ${qe}) && (${qe} <= ${De})`},{aggregate:[{op:"min",field:p.field,as:`lower_whisker_${p.field}`},{op:"max",field:p.field,as:`upper_whisker_${p.field}`},{op:"min",field:`lower_box_${p.field}`,as:`lower_box_${p.field}`},{op:"max",field:`upper_box_${p.field}`,as:`upper_box_${p.field}`},...y],groupby:m}],layer:I},Nt=A,{tooltip:hi}=Nt,pi=Z(Nt,["tooltip"]),{scale:yn,axis:X}=p,ue=k_(p),ye=Wn(X,["title"]),z=Z5(a,"outliers",t.boxplot,{transform:[{filter:`(${qe} < ${$e}) || (${qe} > ${De})`}],mark:"point",encoding:x(x(x({[g]:x(x(x({field:p.field,type:p.type},ue!==void 0?{title:ue}:{}),yn!==void 0?{scale:yn}:{}),Re(ye)?{}:{axis:ye})},pi),S?{color:S}:{}),E?{tooltip:E}:{})})[0];let Ke;const ve=[...f,...d,Pe];return z?Ke={transform:ve,layer:[z,mt]}:(Ke=mt,Ke.transform.unshift(...ve)),P(x({},s),{layer:[Ke,{transform:h,layer:U}]})}function i6(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function gle(e,t,n){const i=e6(e,Sm),{continuousAxisChannelDef:r,continuousAxis:o}=Q5(e,i,Sm),s=r.field,a=t6(t),u=[...i6(s),{op:"median",field:s,as:`mid_box_${s}`},{op:"min",field:s,as:(a==="min-max"?"lower_whisker_":"min_")+s},{op:"max",field:s,as:(a==="min-max"?"upper_whisker_":"max_")+s}],l=a==="min-max"||a==="tukey"?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:`iqr_${s}`},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:`upper_whisker_${s}`},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:`lower_whisker_${s}`}],S=e.encoding,{[o]:c}=S,f=Z(S,[La(o)]),{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=dle(f),{bins:p,timeUnits:g,aggregate:m,groupby:y,encoding:v}=K5(h,n),b=i==="vertical"?"horizontal":"vertical",w=i,E=[...p,...g,{aggregate:[...m,...u],groupby:y},...l];return{bins:p,timeUnits:g,transform:E,groupby:y,aggregate:m,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:w,customTooltipWithoutAggregatedField:d}}const $_="errorbar",mle=["ticks","rule"],yle=new wm($_,r6);function r6(e,{config:t}){e=P(x({},e),{encoding:_m(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:u,tooltipEncoding:l}=o6(e,$_,t);delete o.size;const c=C_(a,r,i,o,t.errorbar),f=a.thickness,d=a.size,h=x(x({type:"tick",orient:s,aria:!1},f!==void 0?{thickness:f}:{}),d!==void 0?{size:d}:{}),p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:x({type:"rule",ariaRoleDescription:"errorbar"},f!==void 0?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return x(P(x({},u),{transform:n}),p.length>1?{layer:p}:x({},p[0]))}function vle(e,t){const{encoding:n}=e;if(ble(n))return{orient:e6(e,t),inputType:"raw"};const i=xle(n),r=wle(n),o=n.x,s=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(le(a)&&le(u))throw new Error(`${t} cannot have both x2 and y2`);if(le(a)){if(_r(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(le(u)){if(_r(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(le(u)&&!le(a))throw new Error(`${t} cannot have xError2 without xError`);if(le(c)&&!le(l))throw new Error(`${t} cannot have yError2 without yError`);if(le(a)&&le(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(le(a)){if(_r(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(le(l)){if(_r(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function ble(e){return(le(e.x)||le(e.y))&&!le(e.x2)&&!le(e.y2)&&!le(e.xError)&&!le(e.xError2)&&!le(e.yError)&&!le(e.yError2)}function xle(e){return le(e.x2)||le(e.y2)}function wle(e){return le(e.xError)||le(e.xError2)||le(e.yError)||le(e.yError2)}function o6(e,t,n){var Y,Q,ce,De;const U=e,{mark:i,encoding:r,params:o,projection:s}=U,a=Z(U,["mark","encoding","params","projection"]),u=xr(i)?i:{type:i};o&&j(HR(t));const{orient:l,inputType:c}=vle(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:g}=Q5(e,l,t),{errorBarSpecificAggregate:m,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=_le(u,f,d,h,p,c,t,n),$e=r,{[g]:w,[Y=g==="x"?"x2":"y2"]:E,[Q=g==="x"?"xError":"yError"]:S,[ce=g==="x"?"xError2":"yError2"]:_}=$e,A=Z($e,[La(g),La(Y),La(Q),La(ce)]),{bins:C,timeUnits:k,aggregate:$,groupby:F,encoding:D}=K5(A,n),L=[...$,...m],M=c!=="raw"?[]:F,I=A_(v,f,D,b);return{transform:[...(De=a.transform)!=null?De:[],...C,...k,...L.length===0?[]:[{aggregate:L,groupby:M}],...y],groupby:M,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:D,ticksOrient:l==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:a,tooltipEncoding:I}}function _le(e,t,n,i,r,o,s,a){let u=[],l=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&j(Oae(h,p,s)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:Df(h)},{fieldPrefix:"upper_",titlePrefix:s6(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:s6(h,p,"-")}],d=!0;else{let g,m,y;p==="ci"?(g="mean",m="ci0",y="ci1"):(g="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:tl({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:tl({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:tl({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&j(Tae(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`upper_${c}`}],r?l.push({calculate:`datum["${c}"] + datum["${r.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${i.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:fa(fa(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function s6(e,t,n){return`${Df(e)} ${n} ${t}`}const M_="errorband",Ele=["band","borders"],Sle=new wm(M_,a6);function a6(e,{config:t}){e=P(x({},e),{encoding:_m(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:u}=o6(e,M_,t),l=s,c=C_(l,r,i,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p=x(x({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=P(x(x({},d),p),{ariaRoleDescription:"errorband"}),h=P(x(x({},h),p),{aria:!1})):l.interpolate?j(e5("interpolate")):l.tension&&j(e5("tension")),P(x({},a),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]})}const u6={};function F_(e,t,n){const i=new wm(e,t);u6[e]={normalizer:i,parts:n}}function Ale(){return B(u6)}F_(Sm,n6,hle),F_($_,r6,mle),F_(M_,a6,Ele);const kle=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],l6={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},c6={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Cle=B(l6),$le=B(c6),Mle={header:1,headerRow:1,headerColumn:1,headerFacet:1},f6=B(Mle),d6=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Fle={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},Dle={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Wf="_vgsid_",Tle={point:{on:"click",fields:[Wf],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function D_(e){return!!e&&(e==="legend"||!!e.legend)}function T_(e){return D_(e)&&J(e)}function O_(e){return!!e.select}function h6(e){const t=[];for(const i of e||[]){if(O_(i))continue;const n=i,{expr:r,bind:o}=n,s=Z(n,["expr","bind"]);if(o&&r){const a=P(x({},s),{bind:o,init:r});t.push(a)}else{const a=x(x(x({},s),r?{update:r}:{}),o?{bind:o}:{});t.push(a)}}return t}function Ole(e){return Am(e)||R_(e)||N_(e)}function N_(e){return"concat"in e}function Am(e){return"vconcat"in e}function R_(e){return"hconcat"in e}function Sr(e){return J(e)&&e.step!==void 0}function p6(e){return e.view||e.width||e.height}const g6=20,Nle={align:1,bounds:1,center:1,columns:1,spacing:1},Rle=B(Nle);function Lle(e,t,n){var a,u;const i=n[t],r={},{spacing:o,columns:s}=i;o!==void 0&&(r.spacing=o),s!==void 0&&(dm(e)&&!Uf(e.facet)||N_(e))&&(r.columns=s),Am(e)&&(r.columns=1);for(const l of Rle)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];r[l]=Oe(c)?c:{row:(a=c.row)!=null?a:o,column:(u=c.column)!=null?u:o}}else r[l]=e[l];return r}function L_(e,t){var n;return(n=e[t])!=null?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function km(e,t){const n=Hf(e,t);return Sr(n)?n.step:m6}function Hf(e,t){var i;const n=(i=e[t])!=null?i:e[t==="width"?"discreteWidth":"discreteHeight"];return st(n,{step:e.step})}const m6=20,Ile={continuousWidth:200,continuousHeight:200,step:m6},Ple={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Ile,mark:Tue,arc:{},area:{},bar:Rue,circle:{},geoshape:{},image:{},line:{},point:{},rect:Lue,rule:{color:"black"},square:{},text:{color:"black"},tick:Iue,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:mue,projection:{},legend:Fle,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Tle,style:{},title:{},facet:{spacing:g6},concat:{spacing:g6}},so=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],y6={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},v6={blue:so[0],orange:so[1],red:so[2],teal:so[3],green:so[4],yellow:so[5],purple:so[6],pink:so[7],brown:so[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function zle(e={}){return{signals:[{name:"color",value:J(e)?x(x({},v6),e):v6}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Ble(e){return{signals:[{name:"fontSize",value:J(e)?x(x({},y6),e):y6}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Ule(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function b6(e){const t=B(e||{}),n={};for(const i of t){const r=e[i];n[i]=qf(r)?TR(r):Hn(r)}return n}function jle(e){const t=B(e),n={};for(const i of t)n[i]=b6(e[i]);return n}const qle=[...x5,...X5,...f6,"background","padding","legend","lineBreak","scale","style","title","view"];function x6(e={}){const a=e,{color:t,font:n,fontSize:i}=a,r=Z(a,["color","font","fontSize"]),o=Wa({},Ple,n?Ule(n):{},t?zle(t):{},i?Ble(i):{},r||{}),s=Wn(o,qle);for(const u of["background","lineBreak","padding"])o[u]&&(s[u]=Hn(o[u]));for(const u of x5)o[u]&&(s[u]=On(o[u]));for(const u of X5)o[u]&&(s[u]=b6(o[u]));for(const u of f6)o[u]&&(s[u]=On(o[u]));return o.legend&&(s.legend=On(o.legend)),o.scale&&(s.scale=On(o.scale)),o.style&&(s.style=jle(o.style)),o.title&&(s.title=On(o.title)),o.view&&(s.view=On(o.view)),s}const Wle=["view",...v5],Hle=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Gle=x({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},Due);function Yle(e){e=he(e);for(const t of Hle)delete e[t];if(e.axis)for(const t in e.axis)qf(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of kle)delete e.legend[t];if(e.mark){for(const t of b5)delete e.mark[t];e.mark.tooltip&&J(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(h6(e.params)),delete e.params);for(const t of Wle){for(const i of b5)delete e[t][i];const n=Gle[t];if(n)for(const i of n)delete e[t][i];Xle(e,t)}for(const t of Ale())delete e[t];Vle(e);for(const t in e)J(e[t])&&Re(e[t])&&delete e[t];return Re(e)?void 0:e}function Vle(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=DR(e.title);Re(t)||(e.style["group-title"]=x(x({},e.style["group-title"]),t)),Re(n)||(e.style["group-subtitle"]=x(x({},e.style["group-subtitle"]),n)),Re(i)?delete e.title:e.title=i}function Xle(e,t,n,i){const r=i?e[t][i]:e[t];t==="view"&&(n="cell");const o=x(x({},r),e.style[n!=null?n:t]);Re(o)||(e.style[n!=null?n:t]=o),i||delete e[t]}function Cm(e){return"layer"in e}function Kle(e){return"repeat"in e}function Jle(e){return!R(e.repeat)&&e.repeat.layer}class I_{map(t,n){return dm(t)?this.mapFacet(t,n):Kle(t)?this.mapRepeat(t,n):R_(t)?this.mapHConcat(t,n):Am(t)?this.mapVConcat(t,n):N_(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(Cm(t))return this.mapLayer(t,n);if(oo(t))return this.mapUnit(t,n);throw new Error(qw(t))}mapLayer(t,n){return P(x({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return P(x({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return P(x({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const o=t,{concat:i}=o,r=Z(o,["concat"]);return P(x({},r),{concat:i.map(s=>this.map(s,n))})}mapFacet(t,n){return P(x({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return P(x({},t),{spec:this.map(t.spec,n)})}}const Zle={zero:1,center:1,normalize:1};function Qle(e){return e in Zle}const ece=new Set([p5,om,rm,um,am,c_,f_,sm,g5,l_]),tce=new Set([om,rm,p5]);function w6(e,t){var o,s;const n=t==="x"?"y":"radius",i=e[t],r=e[n];if(G(i)&&G(r))if(fs(i)==="quantitative"&&fs(r)==="quantitative"){if(i.stack)return t;if(r.stack)return n;const a=G(i)&&!!i.aggregate,u=G(r)&&!!r.aggregate;if(a!==u)return a?t:n;{const l=(o=i.scale)==null?void 0:o.type,c=(s=r.scale)==null?void 0:s.type;if(l&&l!=="linear")return n;if(c&&c!=="linear")return t}}else{if(fs(i)==="quantitative")return t;if(fs(r)==="quantitative")return n}else{if(fs(i)==="quantitative")return t;if(fs(r)==="quantitative")return n}}function nce(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function _6(e,t,n={}){var d,h;const i=xr(e)?e.type:e;if(!ece.has(i))return null;const r=w6(t,"x")||w6(t,"theta");if(!r)return null;const o=t[r],s=G(o)?H(o,{}):void 0;let a=nce(r),u=t[a],l=G(u)?H(u,{}):void 0;l===s&&(l=void 0,u=void 0,a=void 0);const c=mse.reduce((p,g)=>{if(g!=="tooltip"&&wa(t,g)){const m=t[g];for(const y of K(m)){const v=Er(y);if(v.aggregate)continue;const b=H(v,{});(!b||b!==l)&&p.push({channel:g,fieldDef:v})}}return p},[]);let f;if(o.stack!==void 0?go(o.stack)?f=o.stack?"zero":null:f=o.stack:tce.has(i)&&(f="zero"),!f||!Qle(f)||E_(t)&&c.length===0)return null;if(((d=o==null?void 0:o.scale)==null?void 0:d.type)&&((h=o==null?void 0:o.scale)==null?void 0:h.type)!==pt.LINEAR){if(n.disallowNonLinearStack)return null;j(Mae(o.scale.type))}return le(t[to(r)])?(o.stack!==void 0&&j($ae(r)),null):(G(o)&&o.aggregate&&!pe($se,o.aggregate)&&j(Fae(o.aggregate)),{groupbyChannel:u?a:void 0,groupbyField:l,fieldChannel:r,impute:o.impute===null?!1:cs(i),stackBy:c,offset:f})}function ice(e){const r=e,{point:t,line:n}=r,i=Z(r,["point","line"]);return B(i).length>1?i:i.type}function rce(e){for(const t of["line","area","rule","trail"])e[t]&&(e=P(x({},e),{[t]:Wn(e[t],["point","line"])}));return e}function P_(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?J(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?J(t.point)?t.point:{}:void 0}function E6(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class oce{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(oo(t)){const{mark:i,encoding:r}=t,o=xr(i)?i:{type:i};switch(o.type){case"line":case"rule":case"trail":return!!P_(o,n[o.type],r);case"area":return!!P_(o,n[o.type],r)||!!E6(o,n[o.type])}}return!1}run(t,n,i){const{config:r}=n,y=t,{params:o,projection:s,mark:a,encoding:u}=y,l=Z(y,["params","projection","mark","encoding"]),c=_m(u,r),f=xr(a)?a:{type:a},d=P_(f,r[f.type],c),h=f.type==="area"&&E6(f,r[f.type]),p=[P(x({},o?{params:o}:{}),{mark:ice(x(x({},f.type==="area"&&f.opacity===void 0&&f.fillOpacity===void 0?{opacity:.7}:{}),f)),encoding:Wn(c,["shape"])})],g=_6(f,c);let m=c;if(g){const{fieldChannel:v,offset:b}=g;m=P(x({},c),{[v]:x(x({},c[v]),b?{stack:b}:{})})}return h&&p.push(P(x({},s?{projection:s}:{}),{mark:x(x({type:"line"},Gu(f,["clip","interpolate","tension","tooltip"])),h),encoding:m})),d&&p.push(P(x({},s?{projection:s}:{}),{mark:x(x({type:"point",opacity:1,filled:!0},Gu(f,["clip","tooltip"])),d),encoding:m})),i(P(x({},l),{layer:p}),P(x({},n),{config:rce(r)}))}}function sce(e,t){return t?Uf(e)?C6(e,t):S6(e,t):e}function z_(e,t){return t?C6(e,t):e}function B_(e,t,n){const i=t[e];if(Gue(i)){if(i.repeat in n)return P(x({},t),{[e]:n[i.repeat]});j(Yse(i.repeat));return}return t}function S6(e,t){if(e=B_("field",e,t),e!==void 0){if(e===null)return null;if(y_(e)&&wr(e.sort)){const n=B_("field",e.sort,t);e=x(x({},e),n?{sort:n}:{})}return e}}function A6(e,t){if(G(e))return S6(e,t);{const n=B_("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function k6(e,t){if(le(e)){const i=A6(e,t);if(i)return i;if(hm(e))return{condition:e.condition}}else{if(gm(e)){const i=A6(e.condition,t);if(i)return P(x({},e),{condition:i});{const n=e,{condition:r}=n;return Z(n,["condition"])}}return e}}function C6(e,t){const n={};for(const i in e)if(te(e,i)){const r=e[i];if(R(r))n[i]=r.map(o=>k6(o,t)).filter(o=>o);else{const o=k6(r,t);o!==void 0&&(n[i]=o)}}return n}class ace{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(oo(t)){const{encoding:n,mark:i}=t;if(i==="line"||xr(i)&&i.type==="line")for(const r of pse){const o=pa(r),s=n[o];if(n[r]&&(G(s)&&!hn(s.bin)||ds(s)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:o}=t;return j(fae(!!r.x2,!!r.y2)),console.log(o),i(P(x({},t),{mark:J(o)?P(x({},o),{type:"rule"}):"rule"}),n)}}class uce extends I_{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[ple,yle,Sle,new oce,new ace]}map(t,n){if(oo(t)){const i=wa(t.encoding,Xr),r=wa(t.encoding,Kr),o=wa(t.encoding,Yg);if(i||r||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,o=z_(t.encoding,n.repeater),s=x(x({},t),o?{encoding:o}:{});if(i||r)return this.mapUnitWithParentEncodingOrProjection(s,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(s,n.config))return u.run(s,n,a);return s}mapRepeat(t,n){return Jle(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const f=t,{repeat:i,spec:r}=f,o=Z(f,["repeat","spec"]),{row:s,column:a,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return s||a?this.mapRepeat(P(x({},t),{repeat:x(x({},s?{row:s}:{}),a?{column:a}:{}),spec:{repeat:{layer:u},spec:r}}),n):P(x({},o),{layer:u.map(d=>{const h=P(x({},l),{layer:d}),p=`${(r.name||"")+c}child__layer_${He(d)}`,g=this.mapLayerOrUnit(r,P(x({},n),{repeater:h,repeaterPrefix:p}));return g.name=p,g})})}mapNonLayerRepeat(t,n){var g;const p=t,{repeat:i,spec:r,data:o}=p,s=Z(p,["repeat","spec","data"]);!R(i)&&t.columns&&(t=Wn(t,["columns"]),j(GR("repeat")));const a=[],{repeater:u={},repeaterPrefix:l=""}=n,c=!R(i)&&i.row||[u?u.row:null],f=!R(i)&&i.column||[u?u.column:null],d=R(i)&&i||[u?u.repeat:null];for(const m of d)for(const y of c)for(const v of f){const b={repeat:m,row:y,column:v,layer:u.layer},w=(r.name||"")+l+"child__"+(R(i)?`${He(m)}`:(i.row?`row_${He(y)}`:"")+(i.column?`column_${He(v)}`:"")),E=this.map(r,P(x({},n),{repeater:b,repeaterPrefix:w}));E.name=w,a.push(Wn(E,["data"]))}const h=R(i)?t.columns:i.column?i.column.length:1;return P(x({data:(g=r.data)!=null?g:o,align:"all"},s),{columns:h,concat:a})}mapFacet(t,n){const{facet:i}=t;return Uf(i)&&t.columns&&(t=Wn(t,["columns"]),j(GR("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:o,parentProjection:s,config:a}=n,u=M6({parentProjection:s,projection:r}),l=$6({parentEncoding:o,encoding:z_(i,n.repeater)});return this.mapUnit(x(x(x({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:a})}mapFacetedUnit(t,n){const v=t.encoding,{row:i,column:r,facet:o}=v,s=Z(v,["row","column","facet"]),b=t,{mark:a,width:u,projection:l,height:c,view:f,params:d,encoding:h}=b,p=Z(b,["mark","width","projection","height","view","params","encoding"]),{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:i,column:r,facet:o},n),y=z_(s,n.repeater);return this.mapFacet(P(x(x({},p),m),{facet:g,spec:x(P(x(x(x(x({},u?{width:u}:{}),c?{height:c}:{}),f?{view:f}:{}),l?{projection:l}:{}),{mark:a,encoding:y}),d?{params:d}:{})}),n)}getFacetMappingAndLayout(t,n){var a;const{row:i,column:r,facet:o}=t;if(i||r){o&&j(lae([...i?[Xr]:[],...r?[Kr]:[]]));const l={},c={};for(const f of[Xr,Kr]){const d=t[f];if(d){const s=d,{align:h,center:p,spacing:g,columns:m}=s,y=Z(s,["align","center","spacing","columns"]);l[f]=y;for(const v of["align","center","spacing"])d[v]!==void 0&&((a=c[v])!=null||(c[v]={}),c[v][f]=d[v])}}return{facetMapping:l,layout:c}}else{const u=o,{align:l,center:c,spacing:f,columns:d}=u,h=Z(u,["align","center","spacing","columns"]);return{facetMapping:sce(h,n.repeater),layout:x(x(x(x({},l?{align:l}:{}),c?{center:c}:{}),f?{spacing:f}:{}),d?{columns:d}:{})}}}mapLayer(t,o){var s=o,{parentEncoding:n,parentProjection:i}=s,r=Z(s,["parentEncoding","parentProjection"]);const f=t,{encoding:a,projection:u}=f,l=Z(f,["encoding","projection"]),c=P(x({},r),{parentEncoding:$6({parentEncoding:n,encoding:a,layer:!0}),parentProjection:M6({parentProjection:i,projection:u})});return super.mapLayer(l,c)}}function $6({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...B(e),...B(t)]);for(const o of r){const s=t[o],a=e[o];if(le(s)){const u=x(x({},a),s);i[o]=u}else gm(s)?i[o]=P(x({},s),{condition:x(x({},a),s.condition)}):s||s===null?i[o]=s:(n||Ii(a)||oe(a)||le(a)||R(a))&&(i[o]=a)}}else i=t;return!i||Re(i)?void 0:i}function M6(e){const{parentProjection:t,projection:n}=e;return t&&n&&j(Qse({parentProjection:t,projection:n})),n!=null?n:t}function U_(e){return"filter"in e}function lce(e){return(e==null?void 0:e.stop)!==void 0}function F6(e){return"lookup"in e}function cce(e){return"data"in e}function fce(e){return"param"in e}function dce(e){return"pivot"in e}function hce(e){return"density"in e}function pce(e){return"quantile"in e}function gce(e){return"regression"in e}function mce(e){return"loess"in e}function yce(e){return"sample"in e}function vce(e){return"window"in e}function bce(e){return"joinaggregate"in e}function xce(e){return"flatten"in e}function wce(e){return"calculate"in e}function D6(e){return"bin"in e}function _ce(e){return"impute"in e}function Ece(e){return"timeUnit"in e}function Sce(e){return"aggregate"in e}function Ace(e){return"stack"in e}function kce(e){return"fold"in e}function Cce(e){return e.map(t=>U_(t)?{filter:Hu(t.filter,nue)}:t)}class $ce extends I_{map(t,n){var i,r;return(i=n.emptySelections)!=null||(n.emptySelections={}),(r=n.selectionPredicates)!=null||(n.selectionPredicates={}),t=T6(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=T6(t,n),t.encoding){const i={};for(const[r,o]of Qo(t.encoding))i[r]=O6(o,n);t=P(x({},t),{encoding:i})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const o=t,{selection:i}=o,r=Z(o,["selection"]);return i?P(x({},r),{params:Qo(i).map(([s,a])=>{var h;const d=a,{init:u,bind:l,empty:c}=d,f=Z(d,["init","bind","empty"]);f.type==="single"?(f.type="point",f.toggle=!1):f.type==="multi"&&(f.type="point"),n.emptySelections[s]=c!=="none";for(const p of dn((h=n.selectionPredicates[s])!=null?h:{}))p.empty=c!=="none";return{name:s,value:u,select:f,bind:l}})}):t}}function T6(e,t){const r=e,{transform:n}=r,i=Z(r,["transform"]);if(n){const o=n.map(s=>{if(U_(s))return{filter:j_(s,t)};if(D6(s)&&ga(s.bin))return P(x({},s),{bin:N6(s.bin)});if(F6(s)){const a=s.from,{selection:u}=a,l=Z(a,["selection"]);return u?P(x({},s),{from:x({param:u},l)}):s}return s});return P(x({},i),{transform:o})}return e}function O6(e,t){var i,r;const n=he(e);if(G(n)&&ga(n.bin)&&(n.bin=N6(n.bin)),el(n)&&((r=(i=n.scale)==null?void 0:i.domain)==null?void 0:r.selection)){const o=n.scale.domain,{selection:a}=o,u=Z(o,["selection"]);n.scale.domain=x(x({},u),a?{param:a}:{})}if(hm(n))if(R(n.condition))n.condition=n.condition.map(a=>{const d=a,{selection:u,param:l,test:c}=d,f=Z(d,["selection","param","test"]);return l?a:P(x({},f),{test:j_(a,t)})});else{const s=O6(n.condition,t),{selection:a,param:u,test:l}=s,c=Z(s,["selection","param","test"]);n.condition=u?n.condition:P(x({},c),{test:j_(n.condition,t)})}return n}function N6(e){const t=e.extent;if(t==null?void 0:t.selection){const n=t,{selection:i}=n,r=Z(n,["selection"]);return P(x({},e),{extent:P(x({},r),{param:i})})}return e}function j_(e,t){const n=i=>Hu(i,r=>{var u,l;var o;const s=(u=t.emptySelections[r])!=null?u:!0,a={param:r,empty:s};return(l=(o=t.selectionPredicates)[r])!=null||(o[r]=[]),t.selectionPredicates[r].push(a),a});return e.selection?n(e.selection):Hu(e.test||e.filter,i=>i.selection?n(i.selection):i)}class q_ extends I_{map(t,n){var r;const i=(r=n.selections)!=null?r:[];if(t.params&&!oo(t)){const o=[];for(const s of t.params)O_(s)?i.push(s):o.push(s);t.params=o}return n.selections=i,super.map(t,R6(t,n))}mapUnit(t,n){var s;const i=n.selections;if(!i||!i.length)return t;const r=((s=n.path)!=null?s:[]).concat(t.name),o=[];for(const a of i)if(!a.views||!a.views.length)o.push(a);else for(const u of a.views)(V(u)&&(u===t.name||r.indexOf(u)>=0)||R(u)&&u.map(l=>r.indexOf(l)).every((l,c,f)=>l!==-1&&(c===0||l>f[c-1])))&&o.push(a);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=q_.prototype[e];q_.prototype[e]=function(n,i){return t.call(this,n,R6(n,i))}}function R6(e,t){var n;return e.name?P(x({},t),{path:((n=t.path)!=null?n:[]).concat(e.name)}):t}function L6(e,t){t===void 0&&(t=x6(e.config));const n=Tce(e,t),{width:i,height:r}=e,o=Oce(n,{width:i,height:r,autosize:e.autosize},t);return x(x({},n),o?{autosize:o}:{})}const Mce=new uce,Fce=new $ce,Dce=new q_;function Tce(e,t={}){const n={config:t};return Dce.map(Mce.map(Fce.map(e,n),n),n)}function I6(e){return V(e)?{type:e}:e!=null?e:{}}function Oce(e,t,n){let{width:i,height:r}=t;const o=oo(e)||Cm(e),s={};o?i=="container"&&r=="container"?(s.type="fit",s.contains="padding"):i=="container"?(s.type="fit-x",s.contains="padding"):r=="container"&&(s.type="fit-y",s.contains="padding"):(i=="container"&&(j(UR("width")),i=void 0),r=="container"&&(j(UR("height")),r=void 0));const a=x(x(x({type:"pad"},s),n?I6(n.autosize):{}),I6(e.autosize));if(a.type==="fit"&&!o&&(j(Ise),a.type="pad"),i=="container"&&!(a.type=="fit"||a.type=="fit-x")&&j(jR("width")),r=="container"&&!(a.type=="fit"||a.type=="fit-y")&&j(jR("height")),!lr(a,{type:"pad"}))return a}function Nce(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Rce(e){return e?`fit-${Zg(e)}`:"fit"}const Lce=["background","padding"];function P6(e,t){const n={};for(const i of Lce)e&&e[i]!==void 0&&(n[i]=Hn(e[i]));return t&&(n.params=e.params),n}class ao{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new ao(he(this.explicit),he(this.implicit))}combine(){return x(x({},this.explicit),this.implicit)}get(t){return st(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of B(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function uo(e){return{explicit:!0,value:e}}function Yn(e){return{explicit:!1,value:e}}function z6(e){return(t,n,i,r)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:$m(t,n,i,r)}}function $m(e,t,n,i){return e.explicit&&t.explicit&&j(wae(n,i,e.value,t.value)),e}function hs(e,t,n,i,r=$m){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:lr(e.value,t.value)?e:r(e,t,n,i)}class Ice extends ao{constructor(t={},n={},i=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Gf(e){return"url"in e}function Mm(e){return"values"in e}function B6(e){return"name"in e&&!Gf(e)&&!Mm(e)&&!_a(e)}function _a(e){return e&&(U6(e)||j6(e)||W_(e))}function U6(e){return"sequence"in e}function j6(e){return"sphere"in e}function W_(e){return"graticule"in e}var Ue;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(Ue||(Ue={}));function rl(e,t=!0,n=It){if(R(e)){const i=e.map(r=>rl(r,t,n));return t?`[${i.join(", ")}]`:i}else if(ya(e))return n(t?If(e):Gae(e));return t?n(ze(e)):e}function Pce(e,t){var n;for(const i of dn((n=e.component.selection)!=null?n:{})){const r=i.name;let o=`${r}${ms}, ${i.resolve==="global"?"true":`{unit: ${sl(e)}}`}`;for(const s of Nm)!s.defined(i)||(s.signals&&(t=s.signals(e,i,t)),s.modifyExpr&&(o=s.modifyExpr(e,i,o)));t.push({name:r+gfe,on:[{events:{signal:i.name+ms},update:`modify(${W(i.name+Ea)}, ${o})`}]})}return H_(t)}function zce(e,t){if(e.component.selection&&B(e.component.selection).length){const n=W(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Jo("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return H_(t)}function Bce(e,t){var i;let n=!1;for(const r of dn((i=e.component.selection)!=null?i:{})){const o=r.name,s=W(o+Ea);if(t.filter(u=>u.name===o).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${fL}(${s}, ${W(u)}${l}`})}n=!0;for(const u of Nm)u.defined(r)&&u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))}return n&&t.filter(o=>o.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),H_(t)}function Uce(e,t){var i;const n=[...t];for(const r of dn((i=e.component.selection)!=null?i:{})){const o={name:r.name+Ea};if(r.init){const a=r.project.items.map(u=>{const f=u,{signals:l}=f;return Z(f,["signals"])});o.values=r.init.map(u=>({unit:sl(e,{escape:!1}),fields:a,values:rl(u,!1)}))}n.filter(a=>a.name===r.name+Ea).length||n.push(o)}return n}function q6(e,t){var n;for(const i of dn((n=e.component.selection)!=null?n:{}))for(const r of Nm)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function jce(e,t){for(const n of e.children)at(n)&&(t=q6(n,t));return t}function qce(e,t,n,i){const r=mL(e,t.param,t);return{signal:Gn(n.get("type"))&&R(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function H_(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class Le{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){j(Kse);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class mn extends Le{constructor(t,n,i,r){super(t,n);this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${mR()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class Ar extends Le{constructor(t,n){super(t);this.formula=n}clone(){return new Ar(null,he(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,o)=>{const{field:s,timeUnit:a}=o;if(a){const u=H(o,{forAs:!0});r[xe({as:u,field:s,timeUnit:a})]={as:u,field:s,timeUnit:a}}return r},{});return Re(i)?null:new Ar(t,i)}static makeFromTransform(t,n){const a=x({},n),{timeUnit:i}=a,r=Z(a,["timeUnit"]),o=pn(i),s=P(x({},r),{timeUnit:o});return new Ar(t,{[xe(s)]:s})}merge(t){this.formula=x({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of Qo(this.formula))t.has(r.as)||(n[i]=r);this.formula=n}producedFields(){return new Set(dn(this.formula).map(t=>t.as))}dependentFields(){return new Set(dn(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${xe(this.formula)}`}assemble(){const t=[];for(const i of dn(this.formula)){const{field:r,as:o,timeUnit:s}=i,n=pn(s),{unit:a,utc:u}=n,l=Z(n,["unit","utc"]);t.push(P(x(x(x({field:si(r),type:"timeunit"},a?{units:Kw(a)}:{}),u?{timezone:"utc"}:{}),l),{as:[o,`${o}_end`]}))}return t}}const Yf="_tuple_fields";class Wce{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const Hce={defined:()=>!0,parse:(e,t,n)=>{var p;const i=t.name,r=(p=t.project)!=null?p:t.project=new Wce,o={},s={},a=new Set,u=(g,m)=>{const y=m==="visual"?g.channel:g.field;let v=He(`${i}_${y}`);for(let b=1;a.has(v);b++)v=He(`${i}_${y}_${b}`);return a.add(v),{[m]:v}},l=t.type,c=e.config.selection[l],f=n.value!==void 0?K(n.value):null;let{fields:d,encodings:h}=J(n.select)?n.select:{};if(!d&&!h&&f){for(const g of f)if(!!J(g))for(const m of B(g))hse(m)?(h||(h=[])).push(m):l==="interval"?(j(Gse),h=c.encodings):(d||(d=[])).push(m)}!d&&!h&&(h=c.encodings,d=c.fields);for(const g of h!=null?h:[]){const m=e.fieldDef(g);if(m){let y=m.field;if(m.aggregate){j(Pse(g,m.aggregate));continue}else if(!y){j(WR(g));continue}if(m.timeUnit){y=e.vgField(g);const v={timeUnit:m.timeUnit,as:y,field:m.field};s[xe(v)]=v}if(!o[y]){let v="E";if(l==="interval"){const w=e.getScaleComponent(g).get("type");Gn(w)&&(v="R")}else m.bin&&(v="R-RE");const b={field:y,channel:g,type:v};b.signals=x(x({},u(b,"data")),u(b,"visual")),r.items.push(o[y]=b),r.hasField[y]=r.hasChannel[g]=o[y]}}else j(WR(g))}for(const g of d!=null?d:[]){if(r.hasField[g])continue;const m={type:"E",field:g};m.signals=x({},u(m,"data")),r.items.push(m),r.hasField[g]=m}f&&(t.init=f.map(g=>r.items.map(m=>J(g)?g[m.channel]!==void 0?g[m.channel]:g[m.field]:g))),Re(s)||(r.timeUnit=new Ar(null,s))},signals:(e,t,n)=>{const i=t.name+Yf;return n.filter(o=>o.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(o=>{const l=o,{signals:s,hasLegend:a}=l,u=Z(l,["signals","hasLegend"]);return u.field=si(u.field),u})})}},ps={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!ss(r))continue;const o=e.getScaleComponent(r),s=o?o.get("type"):void 0;if(!o||!Gn(s)){j(Use);continue}o.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(s=>n.filter(a=>a.name===s.signals.data).length===0);if(!e.parent||W6(e)||i.length===0)return n;const r=n.filter(s=>s.name===t.name)[0];let o=r.update;if(o.indexOf(fL)>=0)r.update=`{${i.map(s=>`${W(si(s.field))}: ${s.signals.data}`).join(", ")}}`;else{for(const s of i){const a=`${W(si(s.field))}: ${s.signals.data}`;o.includes(a)||(o=`${o.substring(0,o.length-1)}, ${a}}`)}r.update=o}return n.concat(i.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!W6(e))for(const i of t.scales){const r=n.filter(o=>o.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function G_(e,t){return`domain(${W(e.scaleName(t))})`}function W6(e){return e.parent&&hl(e.parent)&&!e.parent.parent}const Vf="_brush",Y_="_scale_trigger",Gce={defined:e=>e.type==="interval",signals:(e,t,n)=>{const i=t.name,r=i+Yf,o=ps.defined(t),s=t.init?t.init[0]:null,a=[],u=[];if(t.translate&&!o){const c=`!event.item || event.item.mark.name !== ${W(i+Vf)}`;H6(t,(f,d)=>{var g;var h;const p=K((g=(h=d.between[0]).filter)!=null?g:h.filter=[]);return p.includes(c)||p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==Xe&&d!==ht){j("Interval selections only support x and y encoding channels.");return}const h=s?s[f]:null,p=Yce(e,t,c,h),g=c.signals.data,m=c.signals.visual,y=W(e.scaleName(d)),v=e.getScaleComponent(d).get("type"),b=Gn(v)?"+":"";n.push(...p),a.push(g),u.push({scaleName:e.scaleName(d),expr:`(!isArray(${g}) || (${b}invert(${y}, ${m})[0] === ${b}${g}[0] && ${b}invert(${y}, ${m})[1] === ${b}${g}[1]))`})}),o||n.push({name:i+Y_,value:{},on:[{events:u.map(c=>({scale:c.scaleName})),update:`${u.map(c=>c.expr).join(" && ")} ? ${i+Y_} : {}`}]});const l=`unit: ${sl(e)}, fields: ${r}, values`;return n.concat(P(x({name:i+ms},s?{init:`{${l}: ${rl(s)}}`}:{}),{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${l}: [${a}]} : null`}]}))},marks:(e,t,n)=>{const i=t.name,{x:r,y:o}=t.project.hasChannel,s=r&&r.signals.visual,a=o&&o.signals.visual,u=`data(${W(t.name+Ea)})`;if(ps.defined(t))return n;const l={x:r!==void 0?{signal:`${s}[0]`}:{value:0},y:o!==void 0?{signal:`${a}[0]`}:{value:0},x2:r!==void 0?{signal:`${s}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of B(l))l[m]=[x({test:`${u}.length && ${u}[0].unit === ${sl(e)}`},l[m]),{value:0}];const g=t.mark,{fill:c,fillOpacity:f,cursor:d}=g,h=Z(g,["fill","fillOpacity","cursor"]),p=B(h).reduce((m,y)=>(m[y]=[{test:[r!==void 0&&`${s}[0] !== ${s}[1]`,o!==void 0&&`${a}[0] !== ${a}[1]`].filter(v=>v).join(" && "),value:h[y]},{value:null}],m),{});return[{name:`${i+Vf}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:l}},...n,{name:i+Vf,type:"rect",clip:!0,encode:{enter:P(x({},d?{cursor:{value:d}}:{}),{fill:{value:"transparent"}}),update:x(x({},l),p)}}]}};function Yce(e,t,n,i){const r=n.channel,o=n.signals.visual,s=n.signals.data,a=ps.defined(t),u=W(e.scaleName(r)),l=e.getScaleComponent(r),c=l?l.get("type"):void 0,f=g=>`scale(${u}, ${g})`,d=e.getSizeSignalRef(r===Xe?"width":"height").signal,h=`${r}(unit)`,p=H6(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${o}[0], clamp(${h}, 0, ${d})]`}]);return p.push({events:{signal:t.name+Y_},update:Gn(c)?`[${f(`${s}[0]`)}, ${f(`${s}[1]`)}]`:"[0, 0]"}),a?[{name:s,on:[]}]:[P(x({name:o},i?{init:rl(i,!0,f)}:{value:[]}),{on:p}),P(x({name:s},i?{init:rl(i)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}function H6(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(j(`${i} is not an ordered event stream for interval selections.`),n),[])}const Vce={defined:e=>e.type==="point",signals:(e,t,n)=>{const i=t.name,r=i+Yf,o=t.project,s="(item().isVoronoi ? datum.datum : datum)",a=o.items.map(c=>{const f=e.fieldDef(c.channel);return f&&f.bin?`[${s}[${W(e.vgField(c.channel,{}))}], ${s}[${W(e.vgField(c.channel,{binSuffix:"end"}))}]]`:`${s}[${W(c.field)}]`}).join(", "),u=`unit: ${sl(e)}, fields: ${r}, values`,l=t.events;return n.concat([{name:i+ms,on:l?[{events:l,update:`datum && item().mark.marktype !== 'group' ? {${u}: [${a}]} : null`,force:!0}]:[]}])}};function ol(e,t,n,i){const r=hm(t)&&t.condition,o=i(t);if(r){const a=K(r).map(u=>{const l=i(u);if(Hue(u)){const{param:c,empty:f}=u,d=gL(e,{param:c,empty:f});return x({test:d},l)}else{const c=Rm(e,u.test);return x({test:c},l)}});return{[n]:[...a,...o!==void 0?[o]:[]]}}else return o!==void 0?{[n]:o}:{}}function V_(e,t="text"){const n=e.encoding[t];return ol(e,n,t,i=>Fm(i,e.config))}function Fm(e,t,n="datum"){if(e){if(Ii(e))return Ge(e.value);if(le(e)){const{format:i,formatType:r}=ym(e);return p_({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function G6(e,t={}){const{encoding:n,markDef:i,config:r,stack:o}=e,s=n.tooltip;if(R(s))return{tooltip:V6({tooltip:s},o,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return ol(e,s,"tooltip",u=>{const l=Fm(u,r,a);if(l)return l;if(u===null)return;let c=Fe("tooltip",i,r);if(c===!0&&(c={content:"encoding"}),V(c))return{value:c};if(J(c))return oe(c)?c:c.content==="encoding"?V6(n,o,r,t):{signal:a}})}}function Y6(e,t,n,{reactiveGeom:i}={}){const r={},o=i?"datum.datum":"datum",s=[];function a(l,c){const f=pa(c),d=ci(l)?l:P(x({},l),{type:e[f].type}),h=d.title||w_(d,n),p=K(h).join(", ");let g;if(vr(c)){const m=c==="x"?"x2":"y2",y=Er(e[m]);if(hn(d.bin)&&y){const v=H(d,{expr:o}),b=H(y,{expr:o}),{format:w,formatType:E}=ym(d);g=cm(v,b,w,E,n),r[m]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:b}=ym(d);g=p_({fieldOrDatumDef:d,format:v,formatType:b,expr:o,config:n,normalizeStack:!0}).signal}}g!=null||(g=Fm(d,n,o).signal),s.push({channel:c,key:p,value:g})}S_(e,(l,c)=>{G(l)?a(l,c):pm(l)&&a(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of s)!r[l]&&!u[c]&&(u[c]=f);return u}function V6(e,t,n,{reactiveGeom:i}={}){const r=Y6(e,t,n,{reactiveGeom:i}),o=Qo(r).map(([s,a])=>`"${s}": ${a}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function Xce(e){const{markDef:t,config:n}=e,i=Fe("aria",t,n);return i===!1?{}:x(x(x({},i?{aria:i}:{}),Kce(e)),Jce(e))}function Kce(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=Fe("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:t in Rse?{}:{ariaRoleDescription:{value:t}}}function Jce(e){const{encoding:t,markDef:n,config:i,stack:r}=e,o=t.description;if(o)return ol(e,o,"description",u=>Fm(u,e.config));const s=Fe("description",n,i);if(s!=null)return{description:Ge(s)};if(i.aria===!1)return{};const a=Y6(t,r,i);if(!Re(a))return{description:{signal:Qo(a).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function At(e,t,n={}){const{markDef:i,encoding:r,config:o}=t,{vgChannel:s}=n;let{defaultRef:a,defaultValue:u}=n;a===void 0&&(u!=null||(u=Fe(e,i,o,{vgChannel:s,ignoreVgConfig:!0})),u!==void 0&&(a=Ge(u)));const l=r[e];return ol(t,l,s!=null?s:e,c=>E5({channel:e,channelDef:c,markDef:i,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function X6(e,t={filled:void 0}){var d,h,p,g;const{markDef:n,encoding:i,config:r}=e,{type:o}=n,s=(d=t.filled)!=null?d:Fe("filled",n,r),a=pe(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,u=(p=(h=Fe(s===!0?"color":void 0,n,r,{vgChannel:"fill"}))!=null?h:r.mark[s===!0&&"color"])!=null?p:a,l=(g=Fe(s===!1?"color":void 0,n,r,{vgChannel:"stroke"}))!=null?g:r.mark[s===!1&&"color"],c=s?"fill":"stroke",f=x(x({},u?{fill:Ge(u)}:{}),l?{stroke:Ge(l)}:{});return n.color&&(s?n.fill:n.stroke)&&j(KR("property",{fill:"fill"in n,stroke:"stroke"in n})),x(x(x(x({},f),At("color",e,{vgChannel:c,defaultValue:s?u:l})),At("fill",e,{defaultValue:i.fill?u:void 0})),At("stroke",e,{defaultValue:i.stroke?l:void 0}))}function Zce(e){const{encoding:t,mark:n}=e,i=t.order;return!cs(n)&&Ii(i)?ol(e,i,"zindex",r=>Ge(r.value)):{}}function Xf(e,t){const n=gse(e),i=t[n];if(i)return i}function Xt(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:o,config:s,stack:a}=t,u=r[e],l=r[to(e)],c=t.scaleName(e),f=t.getScaleComponent(e),d=Xf(e,o),h=X_({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),p=!u&&vr(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:Qce({channel:e,channelDef:u,channel2Def:l,markDef:o,config:s,scaleName:c,scale:f,stack:a,offset:d,defaultRef:h});return p?{[i||e]:p}:void 0}function Qce(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:o,markDef:s}=e;if(le(n)&&r&&t===r.fieldChannel){if(G(n)){let a=n.bandPosition;if(a===void 0&&s.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return lm({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:o})}return ba(n,i,{suffix:"end"},{offset:o})}return d_(e)}function X_({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:o,config:s}=e;return()=>{const a=pa(n),u=rs(n),l=Fe(n,o,s,{vgChannel:u});if(l!==void 0)return Bf(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){const c=r.get("type");if(!pe([pt.LOG,pt.TIME,pt.UTC],c)){if(r.domainDefinitelyIncludesZero())return{scale:i,value:0}}}if(t==="zeroOrMin")return a==="y"?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[li(n)];return P(x({},c),{mult:.5})}}}}const efe={left:"x",center:"xc",right:"x2"},tfe={top:"y",middle:"yc",bottom:"y2"};function K6(e,t,n,i="middle"){if(e==="radius"||e==="theta")return rs(e);const r=e==="x"?"align":"baseline",o=Fe(r,t,n);let s;return oe(o)?(j(cae(r)),s=void 0):s=o,e==="x"?efe[s||(i==="top"?"left":"center")]:tfe[s||i]}function Dm(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?J6(e,t,{defaultPos:n,defaultPos2:i}):Xt(e,t,{defaultPos:n})}function J6(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:o}=t,s=to(e),a=li(e),u=nfe(t,i,s),l=u[a]?K6(e,r,o):rs(e);return x(x({},Xt(e,t,{defaultPos:n,vgChannel:l})),u)}function nfe(e,t,n){const{encoding:i,mark:r,markDef:o,stack:s,config:a}=e,u=pa(n),l=li(n),c=rs(n),f=i[u],d=e.scaleName(u),h=e.getScaleComponent(u),p=n in i||n in o?Xf(n,e.markDef):Xf(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const m=li(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const g=ife({channel:n,channelDef:f,channel2Def:i[n],markDef:o,config:a,scaleName:d,scale:h,stack:s,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:Tm(n,o)||Tm(n,{[n]:tm(n,o,a.style),[l]:tm(l,o,a.style)})||Tm(n,a[r])||Tm(n,a.mark)||{[c]:X_({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function ife({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l}){return le(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?ba(t,o,{suffix:"start"},{offset:u}):d_({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:i,config:r,offset:u,defaultRef:l})}function Tm(e,t){const n=li(e),i=rs(e);if(t[i]!==void 0)return{[i]:Bf(e,t[i])};if(t[e]!==void 0)return{[i]:Bf(e,t[e])};if(t[n]){const r=t[n];if(Qu(r))j(rae(n));else return{[n]:Bf(e,r)}}}function gs(e,t,n){var m,y,v,b;const{config:i,encoding:r,markDef:o}=e,s=to(t),a=li(t),u=r[t],l=r[s],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=e.scaleName(t),h=o.orient,p=(y=(m=r[a])!=null?m:r.size)!=null?y:Fe("size",o,i,{vgChannel:a}),g=n==="bar"&&(t==="x"?h==="vertical":h==="horizontal");if(G(u)&&(Be(u.bin)||hn(u.bin)||u.timeUnit&&!l)&&!(p&&!Qu(p))&&!Vt(f)){const w=L5({channel:t,fieldDef:u,markDef:o,config:i,scaleType:f}),E=(v=e.component.axes[t])==null?void 0:v[0],S=(b=E==null?void 0:E.get("translate"))!=null?b:.5;return sfe({fieldDef:u,fieldDef2:l,channel:t,markDef:o,scaleName:d,bandSize:w,axisTranslate:S,spacing:vr(t)?Fe("binSpacing",o,i):void 0,reverse:c.get("reverse"),config:i})}else return(le(u)&&Vt(f)||g)&&!l?ofe(u,t,e):J6(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function rfe(e,t,n,i,r){if(Qu(r))if(n){const s=n.get("type");if(s==="band")return{scale:t,band:r.band};r.band!==1&&(j(pae(s)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(oe(r))return r;if(r)return{value:r}}if(n){const s=n.get("range");if(ls(s)&&Oe(s.step))return{value:s.step-2}}return{value:km(i.view,e)-2}}function ofe(e,t,n){const{markDef:i,encoding:r,config:o,stack:s}=n,a=i.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=li(t),f=to(t),d=a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let h;(r.size||i.size)&&(d?h=At("size",n,{vgChannel:c,defaultRef:Ge(i.size)}):j(vae(i.type)));const p=L5({channel:t,fieldDef:e,markDef:i,config:o,scaleType:l==null?void 0:l.get("type"),useVlSizeChannel:d});h=h||{[c]:rfe(c,u,l,o,p)};const g=(l==null?void 0:l.get("type"))!=="band"||!("band"in h[c])?"middle":"top",m=K6(t,i,o,g),y=m==="xc"||m==="yc",v=Xf(t,i),b=d_({channel:t,channelDef:e,markDef:i,config:o,scaleName:u,scale:l,stack:s,offset:v,defaultRef:X_({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:y?.5:oe(p)?{signal:`(1-${p})/2`}:Qu(p)?(1-p.band)/2:0});if(c)return x({[m]:b},h);{const w=rs(f),E=h[c],S=v?P(x({},E),{offset:v}):E;return{[m]:b,[w]:R(b)?[b[0],P(x({},b[1]),{offset:S})]:P(x({},b),{offset:S})}}}function Kf(e,t,n,i,r){if(xR(e))return 0;const o=e==="x"||e==="y2"?-t/2:t/2;if(oe(n)||oe(r)||oe(i)){const s=ro(n),a=ro(r),u=ro(i),l=u?`${u} + `:"",c=s?`(${s} ? -1 : 1) * `:"",f=a?`(${a} + ${o})`:o;return{signal:l+c+f}}else return r=r||0,i+(n?-r-o:+r+o)}function sfe({fieldDef:e,fieldDef2:t,channel:n,bandSize:i,scaleName:r,markDef:o,spacing:s=0,axisTranslate:a,reverse:u,config:l}){const c=to(n),f=rs(n),d=rs(c),h=Xf(n,o),p=oe(i)?{signal:`(1-${i.signal})/2`}:Qu(i)?(1-i.band)/2:.5;if(Be(e.bin)||e.timeUnit)return{[d]:Z6({channel:n,fieldDef:e,scaleName:r,markDef:o,bandPosition:p,offset:Kf(c,s,u,a,h),config:l}),[f]:Z6({channel:n,fieldDef:e,scaleName:r,markDef:o,bandPosition:oe(p)?{signal:`1-${p.signal}`}:1-p,offset:Kf(n,s,u,a,h),config:l})};if(hn(e.bin)){const g=ba(e,r,{},{offset:Kf(c,s,u,a,h)});if(G(t))return{[d]:g,[f]:ba(t,r,{},{offset:Kf(n,s,u,a,h)})};if(ga(e.bin)&&e.bin.step)return{[d]:g,[f]:{signal:`scale("${r}", ${H(e,{expr:"datum"})} + ${e.bin.step})`,offset:Kf(n,s,u,a,h)}}}j(t5(c))}function Z6({channel:e,fieldDef:t,scaleName:n,markDef:i,bandPosition:r,offset:o,config:s}){const a=lm({scaleName:n,fieldOrDatumDef:t,bandPosition:r,offset:o});return _5({fieldDef:t,channel:e,markDef:i,ref:a,config:s})}const afe=new Set(["aria","width","height"]);function fi(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?X6(e):{};return x(x(x(x(x(x(x(x(x(x(x(x({},ufe(e.markDef,t)),Q6(e,"fill",n)),Q6(e,"stroke",i)),At("opacity",e)),At("fillOpacity",e)),At("strokeOpacity",e)),At("strokeWidth",e)),At("strokeDash",e)),Zce(e)),G6(e)),V_(e,"href")),Xce(e))}function Q6(e,t,n){const{config:i,mark:r,markDef:o}=e;if(Fe("invalid",o,i)==="hide"&&n&&!cs(r)){const a=lfe(e,{invalid:!0,channels:Qg});if(a)return{[t]:[{test:a,value:null},...K(n)]}}return n?{[t]:n}:{}}function ufe(e,t){return Nse.reduce((n,i)=>(!afe.has(i)&&e[i]!==void 0&&t[i]!=="ignore"&&(n[i]=Ge(e[i])),n),{})}function lfe(e,{invalid:t=!1,channels:n}){const i=n.reduce((o,s)=>{const a=e.getScaleComponent(s);if(a){const u=a.get("type"),l=e.vgField(s,{expr:"datum"});l&&Gn(u)&&(o[l]=!0)}return o},{}),r=B(i);if(r.length>0){const o=t?"||":"&&";return r.map(s=>h_(s,t)).join(` ${o} `)}}function K_(e){const{config:t,markDef:n}=e;if(Fe("invalid",n,t)){const r=cfe(e,{channels:yr});if(r)return{defined:{signal:r}}}return{}}function cfe(e,{invalid:t=!1,channels:n}){const i=n.reduce((o,s)=>{const a=e.getScaleComponent(s);if(a){const u=a.get("type"),l=e.vgField(s,{expr:"datum"});l&&Gn(u)&&(o[l]=!0)}return o},{}),r=B(i);if(r.length>0){const o=t?"||":"&&";return r.map(s=>h_(s,t)).join(` ${o} `)}}function eL(e,t){if(t!==void 0)return{[e]:Ge(t)}}const J_="voronoi",tL={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(J_)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,o=e.mark;if(cs(o))return j(zse(o)),n;const s={name:e.getName(J_),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:x({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},G6(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{var d;const f=(d=l.name)!=null?d:"";f===e.component.mark[0].name?a=c:f.indexOf(J_)>=0&&(u=!0)}),u||n.splice(a+1,0,s),n}},nL={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!D_(e.bind),parse:(e,t,n)=>dL(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,o=t.bind,s=t.init&&t.init[0],a=tL.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{var d,h;const c=He(`${i}_${u.field}`);n.filter(p=>p.name===c).length||n.unshift(P(x({name:c},s?{init:rl(s[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${W(u.field)}] : null`}]:[],bind:(h=(d=o[u.field])!=null?d:o[u.channel])!=null?h:o}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.filter(l=>l.name===i+ms)[0],s=i+Yf,a=r.items.map(l=>He(`${i}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(o.update=`${u} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},Om="_toggle",iL={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Om,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+ms,i=t.name+Om;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${sl(e)}}, `)+`${i} ? ${n} : null`}},ffe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=V(t.clear)?Jo(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(nL.defined(t))for(const i of t.project.items){const r=n.findIndex(o=>o.name===He(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,o){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const r of t.project.items){const o=n.findIndex(s=>s.name===r.signals.visual);if(i(o,"[0, 0]"),o===-1){const s=n.findIndex(a=>a.name===r.signals.data);i(s,"null")}}else{let r=n.findIndex(o=>o.name===t.name+ms);i(r,"null"),iL.defined(t)&&(r=n.findIndex(o=>o.name===t.name+Om),i(r,"false"))}return n}},rL={defined:e=>{const t=e.resolve==="global"&&e.bind&&D_(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Wf;return t&&!n&&j(jse),t&&n},parse:(e,t,n)=>{var s;const i=he(n);if(i.select=V(i.select)?{type:i.select,toggle:t.toggle}:P(x({},i.select),{toggle:t.toggle}),dL(t,i),J(n.select)&&(n.select.on||n.select.clear)){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=K((s=u.filter)!=null?s:[]),u.filter.includes(a)||u.filter.push(a)}const r=T_(t.bind)?t.bind.legend:"click",o=V(r)?Jo(r,"view"):K(r);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=T_(t.bind)&&t.bind.legend,o=s=>a=>{const u=he(a);return u.markname=s,u};for(const s of t.project.items){if(!s.hasLegend)continue;const a=`${He(s.field)}_legend`,u=`${i}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(o(`${a}_symbols`)).concat(r.merge.map(o(`${a}_labels`))).concat(r.merge.map(o(`${a}_entries`)));n.unshift(P(x({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.find(d=>d.name===i+ms),s=i+Yf,a=r.items.filter(d=>d.hasLegend).map(d=>He(`${i}_${He(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===i+Om),f=T_(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(P(x({},c.on[0]),{events:f})):c.on[0].events=f),n}};function dfe(e,t,n){var r,o,s,a;const i=(r=e.fieldDef(t))==null?void 0:r.field;for(const u of dn((o=e.component.selection)!=null?o:{})){const l=(s=u.project.hasField[i])!=null?s:u.project.hasChannel[t];if(l&&rL.defined(u)){const c=(a=n.get("selections"))!=null?a:[];c.push(u.name),n.set("selections",c,!1),l.hasLegend=!0}}}const oL="_translate_anchor",sL="_translate_delta",hfe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=ps.defined(t),o=i+oL,{x:s,y:a}=t.project.hasChannel;let u=Jo(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+Vf,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(s!==void 0?`, extent_x: ${r?G_(e,Xe):`slice(${s.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${r?G_(e,ht):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:i+sL,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),s!==void 0&&aL(e,t,s,"width",n),a!==void 0&&aL(e,t,a,"height",n),n}};function aL(e,t,n,i,r){var E,S;const o=t.name,s=o+oL,a=o+sL,u=n.channel,l=ps.defined(t),c=r.filter(_=>_.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(u),h=d.get("type"),p=d.get("reverse"),g=l?u===Xe?p?"":"-":p?"-":"":"",m=`${s}.extent_${u}`,y=`${g}${a}.${u} / ${l?`${f}`:`span(${m})`}`,v=l?h==="log"?"panLog":h==="symlog"?"panSymlog":h==="pow"?"panPow":"panLinear":"panLinear",b=l?h==="pow"?`, ${(E=d.get("exponent"))!=null?E:1}`:h==="symlog"?`, ${(S=d.get("constant"))!=null?S:1}`:"":"",w=`${v}(${m}, ${y}${b})`;c.on.push({events:{signal:a},update:l?w:`clampRange(${w}, 0, ${f})`})}const uL="_zoom_anchor",lL="_zoom_delta",pfe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=ps.defined(t),o=i+lL,{x:s,y:a}=t.project.hasChannel,u=W(e.scaleName(Xe)),l=W(e.scaleName(ht));let c=Jo(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+Vf,f))),n.push({name:i+uL,on:[{events:c,update:r?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),s!==void 0&&cL(e,t,s,"width",n),a!==void 0&&cL(e,t,a,"height",n),n}};function cL(e,t,n,i,r){var v,b;const o=t.name,s=n.channel,a=ps.defined(t),u=r.filter(w=>w.name===n.signals[a?"data":"visual"])[0],l=e.getSizeSignalRef(i).signal,c=e.getScaleComponent(s),f=c.get("type"),d=a?G_(e,s):u.name,h=o+lL,p=`${o}${uL}.${s}`,g=a?f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear":"zoomLinear",m=a?f==="pow"?`, ${(v=c.get("exponent"))!=null?v:1}`:f==="symlog"?`, ${(b=c.get("constant"))!=null?b:1}`:"":"",y=`${g}(${d}, ${p}, ${h}${m})`;u.on.push({events:{signal:h},update:a?y:`clampRange(${y}, 0, ${l})`})}const Ea="_store",ms="_tuple",gfe="_modify",fL="vlSelectionResolve",Nm=[Vce,Gce,Hce,iL,nL,ps,rL,ffe,hfe,pfe,tL];function mfe(e){let t=e.parent;for(;t&&!Bi(t);)t=t.parent;return t}function sl(e,{escape:t}={escape:!0}){let n=t?W(e.name):e.name;const i=mfe(e);if(i){const{facet:r}=i;for(const o of ui)r[o]&&(n+=` + '__facet_${o}_' + (facet[${W(i.vgField(o))}])`)}return n}function Z_(e){var t;return dn((t=e.component.selection)!=null?t:{}).reduce((n,i)=>n||i.project.items.some(r=>r.field===Wf),!1)}function dL(e,t){(V(t.select)||!t.select.on)&&delete e.events,(V(t.select)||!t.select.clear)&&delete e.clear,(V(t.select)||!t.select.toggle)&&delete e.toggle}function Q_(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...Q_(e.object)),t.push(...Q_(e.property))),t)}function hL(e){return e.object.type==="MemberExpression"?hL(e.object):e.object.name==="datum"}function pL(e){const t=T2(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&hL(i)&&n.add(Q_(i).slice(1).join("."))}),n}class al extends Le{constructor(t,n,i){super(t);this.model=n,this.filter=i,this.expr=Rm(this.model,this.filter,this),this._dependentFields=pL(this.expr)}clone(){return new al(null,this.model,he(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function yfe(e,t){var o;const n={},i=e.config.selection;if(!t||!t.length)return n;for(const s of t){const a=He(s.name),u=s.select,l=V(u)?u:u.type,c=J(u)?he(u):{type:l},r=i[l],{fields:f,encodings:d}=r,h=Z(r,["fields","encodings"]);for(const g in h)g==="mark"&&(c[g]=x(x({},h[g]),c[g])),(c[g]===void 0||c[g]===!0)&&(c[g]=(o=h[g])!=null?o:c[g]);const p=n[a]=P(x({},c),{name:a,type:l,init:s.value,bind:s.bind,events:V(c.on)?Jo(c.on,"scope"):K(he(c.on))});for(const g of Nm)g.defined(p)&&g.parse&&g.parse(e,p,s)}return n}function gL(e,t,n,i="datum"){const r=V(t)?t:t.param,o=He(r),s=W(o+Ea);let a;try{a=e.getSelectionComponent(o,r)}catch(c){return`!!${o}`}if(a.project.timeUnit){const c=n!=null?n:e.component.data.raw,f=a.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const u=`vlSelectionTest(${s}, ${i}${a.resolve==="global"?")":`, ${W(a.resolve)})`}`,l=`length(data(${s}))`;return t.empty===!1?`${l} && ${u}`:`!${l} || ${u}`}function mL(e,t,n){const i=He(t),r=n.encoding;let o=n.field,s;try{s=e.getSelectionComponent(i,t)}catch(a){return i}if(!r&&!o)o=s.project.items[0].field,s.project.items.length>1&&j(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${W(o)}.`);else if(r&&!o){const a=s.project.items.filter(u=>u.channel===r);!a.length||a.length>1?(o=s.project.items[0].field,j((a.length?"Multiple ":"No ")+`matching ${W(r)} encoding found for selection ${W(n.param)}. Using "field": ${W(o)}.`)):o=a[0].field}return`${s.name}[${W(si(o))}]`}function vfe(e,t){var n;for(const[i,r]of Qo((n=e.component.selection)!=null?n:{})){const o=e.getName(`lookup_${i}`);e.component.data.outputNodes[o]=r.materialized=new mn(new al(t,e,{param:i}),o,Ue.Lookup,e.component.data.outputNodeRefCounts)}}function Rm(e,t,n){return Ff(t,i=>V(i)?i:Qae(i)?gL(e,i,n):l5(i))}function bfe(e,t){if(!!e)return R(e)&&!us(e)?e.map(n=>w_(n,t)).join(", "):e}function eE(e,t,n,i){var s,a,u;var r,o;(s=e.encode)!=null||(e.encode={}),(a=(r=e.encode)[t])!=null||(r[t]={}),(u=(o=e.encode[t]).update)!=null||(o.update={}),e.encode[t].update[n]=i}function Jf(e,t,n,i={header:!1}){var h,p;const f=e.combine(),{disable:r,orient:o,scale:s,labelExpr:a,title:u,zindex:l}=f,c=Z(f,["disable","orient","scale","labelExpr","title","zindex"]);if(!r){for(const g in c){const m=ole[g],y=c[g];if(m&&m!==t&&m!=="both")delete c[g];else if(qf(y)){const d=y,{condition:v}=d,b=Z(d,["condition"]),w=K(v),E=H5[g];if(E){const{vgProp:S,part:_}=E,A=[...w.map(C=>{const F=C,{test:k}=F,$=Z(F,["test"]);return x({test:Rm(null,k)},$)}),b];eE(c,_,S,A),delete c[g]}else if(E===null){const S={signal:w.map(_=>{const k=_,{test:A}=k,C=Z(k,["test"]);return`${Rm(null,A)} ? ${NR(C)} : `}).join("")+NR(b)};c[g]=S}}else if(oe(y)){const v=H5[g];if(v){const{vgProp:b,part:w}=v;eE(c,w,b,y),delete c[g]}}pe(["labelAlign","labelBaseline"],g)&&c[g]===null&&delete c[g]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:g}=c.encode;c.encode=x({},g?{grid:g}:{}),Re(c.encode)&&delete c.encode}return P(x({scale:s,orient:o},c),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:st(l,0)})}else{if(!i.header&&e.mainExtracted)return;if(a!==void 0){let m=a;((p=(h=c.encode)==null?void 0:h.labels)==null?void 0:p.update)&&oe(c.encode.labels.update.text)&&(m=fa(a,"datum.label",c.encode.labels.update.text.signal)),eE(c,"labels","text",{signal:m})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const m of G5)e.hasAxisPart(m)||delete c.encode[m];Re(c.encode)&&delete c.encode}const g=bfe(u,n);return P(x(x(x({scale:s,orient:o,grid:!1},g?{title:g}:{}),c),n.aria===!1?{aria:!1}:{}),{zindex:st(l,0)})}}}function yL(e){const{axes:t}=e.component,n=[];for(const i of yr)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const o=i==="x"?"height":"width",s=e.getSizeSignalRef(o).signal;o!==s&&n.push({name:o,update:s})}}return n}function xfe(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>Jf(r,"grid",t)),...i.map(r=>Jf(r,"grid",t)),...n.map(r=>Jf(r,"main",t)),...i.map(r=>Jf(r,"main",t))].filter(r=>r)}function vL(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const o=n==="x"?"bottom":"left",s=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...B(s),...B(a)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${o}" ? ${ro(s[c])} : ${ro(a[c])}`};return l}return t[r]})])}function wfe(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:lue(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",s=oe(n)?"axisOrient":`axis${Df(n)}`,a=[...r,...r.map(l=>o+l.substr(4))],u=["axis",s,o];return{vlOnlyAxisConfig:vL(a,i,e,n),vgAxisConfig:vL(u,i,e,n),axisConfigStyle:_fe([...u,...a],i)}}function _fe(e,t){var i;const n=[{}];for(const r of e){let o=(i=t[r])==null?void 0:i.style;if(o){o=K(o);for(const s of o)n.push(t.style[s])}}return Object.assign.apply(null,n)}function tE(e,t,n,i={}){var o;const r=LR(e,n,t);if(r!==void 0)return{configFrom:"style",configValue:r};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((o=i[s])==null?void 0:o[e])!==void 0)return{configFrom:s,configValue:i[s][e]};return{}}const bL={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return k5(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return C5(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return(i=t.grid)!=null?i:Efe(n,e)},gridScale:({model:e,channel:t})=>Sfe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||wL(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||xL(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return(i=e.labelFlush)!=null?i:kfe(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return(i=e.labelOverlap)!=null?i:Cfe(t.type,n,G(t)&&!!t.timeUnit,G(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var a;const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return(a=n.tickCount)!=null?a:Mfe({fieldOrDatumDef:i,scaleType:r,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=_L(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),o=n==="x"?"x2":"y2",s=t.fieldDef(o);return PR(r?[N5(r)]:[],G(s)?[N5(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Ffe(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return(i=e.zindex)!=null?i:Dfe(n,t)}};function Efe(e,t){return!Vt(e)&&G(t)&&!Be(t==null?void 0:t.bin)&&!hn(t==null?void 0:t.bin)}function Sfe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function Afe(e,t,n,i,r){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return oe(o)?o:Tf(o);{const{configValue:s}=tE("labelAngle",i,t==null?void 0:t.style,r);return s!==void 0?Tf(s):n===Xe&&pe([s_,o_],e.type)&&!(G(e)&&e.timeUnit)?270:void 0}}function nE(e){return`(((${e.signal} % 360) + 360) % 360)`}function xL(e,t,n,i){if(e!==void 0)if(n==="x"){if(oe(e)){const r=nE(e),o=oe(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(oe(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(oe(e)){const r=nE(e),o=oe(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(oe(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function wL(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,o=i?"bottom":"left";if(oe(e)){const s=nE(e),a=oe(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${r?`(${s} + 90)`:s} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${s} && ${s} < ${180+r}) === ${a} ? "left" : "right"`}}if((e+r)%180==0)return i?null:"center";if(oe(t)){const s=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${s} "${o}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===o)?"left":"right"}function kfe(e,t){if(t==="x"&&pe(["quantitative","temporal"],e))return!0}function Cfe(e,t,n,i){if(n&&!J(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function $fe(e){return e==="x"?"bottom":"left"}function Mfe({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!Vt(t)&&t!=="log"){if(G(e)){if(Be(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&pe(["month","hours","day","quarter"],(r=pn(e.timeUnit))==null?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function _L(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),o=i?i.title:void 0,s=r?r.title:void 0;if(o&&s)return zR(o,s);if(o)return o;if(s)return s;if(o!==void 0)return o;if(s!==void 0)return s}function Ffe(e,t){const n=e.values;if(R(n))return W5(t,n);if(oe(n))return n}function Dfe(e,t){return e==="rect"&&mm(t)?1:0}class ul extends Le{constructor(t,n){super(t);this.transform=n,this._dependentFields=pL(this.transform.calculate)}clone(){return new ul(null,he(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(!!el(i)&&O5(i.sort)){const{field:o,timeUnit:s}=i,a=i.sort,u=a.map((l,c)=>`${l5({field:o,timeUnit:s,equal:l})} ? ${c} : `).join("")+a.length;t=new ul(t,{calculate:u,as:ll(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${xe(this.transform)}`}}function ll(e,t,n){return H(e,x({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function Lm(e,t){return pe(["top","bottom"],t)?"column":pe(["left","right"],t)||e==="row"?"row":"column"}function cl(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return st((t||{})[e],r[e],n.header[e])}function Im(e,t,n,i){const r={};for(const o of e){const s=cl(o,t||{},n,i);s!==void 0&&(r[o]=s)}return r}const iE=["row","column"],rE=["header","footer"];function Tfe(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=Im(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),u=Lm(t,a),l=Tf(s);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:x(x(x(P(x({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),SL(l,u)),EL(u,l,o)),AL(i,r,t,Cle,l6))}}function EL(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=wL(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function SL(e,t){const n=xL(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Ofe(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of rE)if(n[r])for(const o of n[r]){const s=Rfe(e,t,r,n,o);s!=null&&i.push(s)}return i}function Nfe(e,t){var i;const{sort:n}=e;return wr(n)?{field:H(n,{expr:"datum"}),order:(i=n.order)!=null?i:"ascending"}:R(n)?{field:ll(e,t,{expr:"datum"}),order:"ascending"}:{field:H(e,{expr:"datum"}),order:n!=null?n:"ascending"}}function oE(e,t,n){const{format:i,formatType:r,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:u}=Im(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=p_({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=Lm(t,a);return x(x(x(P(x({text:{signal:u?fa(fa(u,"datum.label",l),"datum.value",H(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),SL(o,c)),EL(c,o,s)),AL(n,e,t,$le,c6))}function Rfe(e,t,n,i,r){if(r){let o=null;const{facetFieldDef:s}=i,a=e.config?e.config:void 0;if(s&&r.labels){const{labelOrient:f}=Im(["labelOrient"],s.header,a,t);(t==="row"&&!pe(["top","bottom"],f)||t==="column"&&!pe(["left","right"],f))&&(o=oE(s,t,a))}const u=Bi(e)&&!Uf(e.facet),l=r.axes,c=(l==null?void 0:l.length)>0;if(o||c){const f=t==="row"?"height":"width";return x(x(x(x(x({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:Nfe(s,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),o?{title:o}:{}),r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const Lfe={column:{start:0,end:1},row:{start:1,end:0}};function Ife(e,t){return Lfe[t][e]}function Pfe(e,t){const n={};for(const i of ui){const r=e[i];if(r==null?void 0:r.facetFieldDef){const{titleAnchor:o,titleOrient:s}=Im(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=Lm(i,s),u=Ife(o,a);u!==void 0&&(n[a]=u)}}return Re(n)?void 0:n}function AL(e,t,n,i,r){const o={};for(const s of i){if(!r[s])continue;const a=cl(s,t==null?void 0:t.header,e,n);a!==void 0&&(o[r[s]]=a)}return o}function sE(e){return[...Pm(e,"width"),...Pm(e,"height"),...Pm(e,"childWidth"),...Pm(e,"childHeight")]}function Pm(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const o=e.getScaleComponent(n);if(o){const s=o.get("type"),a=o.get("range");if(Vt(s)&&ls(a)){const u=e.scaleName(n);return Bi(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[kL(u,a)]:[kL(u,a),{name:r,update:CL(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const o=r.endsWith("width"),s=o?"containerSize()[0]":"containerSize()[1]",a=L_(e.config.view,o?"width":"height"),u=`isFinite(${s}) ? ${s} : ${a}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function kL(e,t){return{name:`${e}_step`,value:t.step}}function CL(e,t,n){const i=t.get("type"),r=t.get("padding"),o=st(t.get("paddingOuter"),r);let s=t.get("paddingInner");return s=i==="band"?s!==void 0?s:r:1,`bandspace(${n}, ${ro(s)}, ${ro(o)}) * ${e}_step`}function $L(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function ML(e,t){return B(e).reduce((n,i)=>{const r=e[i];return x(x({},n),ol(t,r,i,o=>Ge(o.value)))},{})}function FL(e,t){if(hl(t)||Bi(t))return"shared";if(wE(t))return vr(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function aE(e,t){const n=e.scale[t],i=vr(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&j(Eae(t)),"independent"):e[i][t]||"shared"}const zfe=P(x({},Dle),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),DL=B(zfe);class Bfe extends ao{}const TL={symbols:Ufe,gradient:jfe,labels:qfe,entries:Wfe};function Ufe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:o}){var m,y,v,b,w,E,S,_;if(o!=="symbol")return;const{markDef:s,encoding:a,config:u,mark:l}=n,c=s.filled&&l!=="trail";let f=x(x({},Lse({},n,Mue)),X6(n,{filled:c}));const d=(m=r.get("symbolOpacity"))!=null?m:u.legend.symbolOpacity,h=(y=r.get("symbolFillColor"))!=null?y:u.legend.symbolFillColor,p=(v=r.get("symbolStrokeColor"))!=null?v:u.legend.symbolStrokeColor,g=d===void 0?(b=OL(a.opacity))!=null?b:s.opacity:void 0;if(f.fill){if(i==="fill"||c&&i===Dn)delete f.fill;else if(f.fill.field)h?delete f.fill:(f.fill=Ge((w=u.legend.symbolBaseFillColor)!=null?w:"black"),f.fillOpacity=Ge(g!=null?g:1));else if(R(f.fill)){const A=(_=(S=uE((E=a.fill)!=null?E:a.color))!=null?S:s.fill)!=null?_:c&&s.color;A&&(f.fill=Ge(A))}}if(f.stroke){if(i==="stroke"||!c&&i===Dn)delete f.stroke;else if(f.stroke.field||p)delete f.stroke;else if(R(f.stroke)){const A=st(uE(a.stroke||a.color),s.stroke,c?s.color:void 0);A&&(f.stroke={value:A})}}if(i!==eo){const A=G(t)&&RL(n,r,t);A?f.opacity=[x({test:A},Ge(g!=null?g:1)),Ge(u.legend.unselectedOpacity)]:g&&(f.opacity=Ge(g))}return f=x(x({},f),e),Re(f)?void 0:f}function jfe(e,{model:t,legendType:n,legendCmpt:i}){var c;if(n!=="gradient")return;const{config:r,markDef:o,encoding:s}=t;let a={};const l=((c=i.get("gradientOpacity"))!=null?c:r.legend.gradientOpacity)===void 0?OL(s.opacity)||o.opacity:void 0;return l&&(a.opacity=Ge(l)),a=x(x({},a),e),Re(a)?void 0:a}function qfe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const o=n.legend(i)||{},s=n.config,a=G(t)?RL(n,r,t):void 0,u=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,f=xa(c)?g_({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:s}):void 0,d=x(x(x({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Re(d)?void 0:d}function Wfe(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?P(x({},e),{fill:{value:"transparent"}}):e}function OL(e){return NL(e,(t,n)=>Math.max(t,n.value))}function uE(e){return NL(e,(t,n)=>st(t,n.value))}function NL(e,t){if(Yue(e))return K(e.condition).reduce(t,e.value);if(Ii(e))return e.value}function RL(e,t,n){const i=t.get("selections");if(!(i==null?void 0:i.length))return;const r=W(n.field);return i.map(o=>`(!length(data(${W(He(o)+Ea)})) || (${o}[${r}] && indexof(${o}[${r}], datum.value) >= 0))`).join(" || ")}const LL={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return k5(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return C5(i,t,n)},gradientLength:e=>{var i,r;const{legend:t,legendConfig:n}=e;return(r=(i=t.gradientLength)!=null?i:n.gradientLength)!=null?r:Jfe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return(r=(i=e.labelOverlap)!=null?i:t.labelOverlap)!=null?r:Zfe(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return(r=e.symbolType)!=null?r:Gfe(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>tl(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Xu(n)&&Li(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>Hfe(t,e)};function Hfe(e,t){const n=e.values;if(R(n))return W5(t,n);if(oe(n))return n}function Gfe(e,t,n,i){var r;if(t!=="shape"){const o=(r=uE(n))!=null?r:i;if(o)return o}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function Yfe(e){const{legend:t}=e;return st(t.type,Vfe(e))}function Vfe({channel:e,timeUnit:t,scaleType:n}){if(Xu(e)){if(pe(["quarter","month","day"],t))return"symbol";if(Li(n))return"gradient"}return"symbol"}function Xfe({legendConfig:e,legendType:t,orient:n,legend:i}){var r,o;return(o=(r=i.direction)!=null?r:e[t?"gradientDirection":"symbolDirection"])!=null?o:Kfe(n,t)}function Kfe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function Jfe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(Li(r))return n==="horizontal"?i==="top"||i==="bottom"?IL(t,"width",s,o):s:IL(t,"height",u,a)}function IL(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function Zfe(e){if(pe(["quantile","threshold","log","symlog"],e))return"greedy"}function PL(e){const t=at(e)?Qfe(e):ide(e);return e.component.legends=t,t}function Qfe(e){const{encoding:t}=e,n={};for(const i of[Dn,...d6]){const r=gt(t[i]);!r||!e.getScaleComponent(i)||i===Tn&&G(r)&&r.type===Zu||(n[i]=nde(e,i))}return n}function ede(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function tde(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(i==null?void 0:i.title))return!0}return e===(n||{})[t]}function nde(e,t){var w,E,S;let n=e.legend(t);const{markDef:i,encoding:r,config:o}=e,s=o.legend,a=new Bfe({},ede(e,t));dfe(e,t,a);const u=n!==void 0?!n:s.disable;if(a.set("disable",u,n!==void 0),u)return a;n=n||{};const l=e.getScaleComponent(t).get("type"),c=gt(r[t]),f=G(c)?(w=pn(c.timeUnit))==null?void 0:w.unit:void 0,d=n.orient||o.legend.orient||"right",h=Yfe({legend:n,channel:t,timeUnit:f,scaleType:l}),p=Xfe({legend:n,legendType:h,orient:d,legendConfig:s}),g={legend:n,channel:t,model:e,markDef:i,encoding:r,fieldOrDatumDef:c,legendConfig:s,config:o,scaleType:l,orient:d,legendType:h,direction:p};for(const _ of DL){if(h==="gradient"&&_.startsWith("symbol")||h==="symbol"&&_.startsWith("gradient"))continue;const A=_ in LL?LL[_](g):n[_];if(A!==void 0){const C=tde(A,_,n,e.fieldDef(t));(C||o.legend[_]===void 0)&&a.set(_,A,C)}}const m=(E=n==null?void 0:n.encoding)!=null?E:{},y=a.get("selections"),v={},b={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:h};for(const _ of["labels","legend","title","symbols","gradient","entries"]){const A=ML((S=m[_])!=null?S:{},e),C=_ in TL?TL[_](A,b):A;C!==void 0&&!Re(C)&&(v[_]=P(x(x({},(y==null?void 0:y.length)&&G(c)?{name:`${He(c.field)}_legend_${_}`}:{}),(y==null?void 0:y.length)?{interactive:!!y}:{}),{update:C}))}return Re(v)||a.set("encode",v,!!(n==null?void 0:n.encoding)),a}function ide(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){PL(i);for(const r of B(i.component.legends))n.legend[r]=aE(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=zL(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of B(t))for(const r of e.children)!r.component.legends[i]||n.legend[i]==="shared"&&delete r.component.legends[i];return t}function zL(e,t){var o,s,a,u;if(!e)return t.clone();const n=e.getWithExplicit("orient"),i=t.getWithExplicit("orient");if(n.explicit&&i.explicit&&n.value!==i.value)return;let r=!1;for(const l of DL){const c=hs(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return rde(f,d);case"title":return BR(f,d);case"type":return r=!0,Yn("symbol")}return $m(f,d,l,"legend")});e.setWithExplicit(l,c)}return r&&(((s=(o=e.implicit)==null?void 0:o.encode)==null?void 0:s.gradient)&&Hg(e.implicit,["encode","gradient"]),((u=(a=e.explicit)==null?void 0:a.encode)==null?void 0:u.gradient)&&Hg(e.explicit,["encode","gradient"])),e}function rde(e,t){return t.value==="circle"?t:e}function ode(e,t,n,i){var s,a,u;var r,o;(s=e.encode)!=null||(e.encode={}),(a=(r=e.encode)[t])!=null||(r[t]={}),(u=(o=e.encode[t]).update)!=null||(o.update={}),e.encode[t].update[n]=i}function BL(e){const t=e.component.legends,n={};for(const r of B(t)){const o=e.getScaleComponent(r),s=ze(o.get("domains"));if(n[s])for(const a of n[s])zL(a,t[r])||n[s].push(t[r]);else n[s]=[t[r].clone()]}return dn(n).flat().map(r=>sde(r,e.config)).filter(r=>r!==void 0)}function sde(e,t){var a,u,l;const s=e.combine(),{disable:n,labelExpr:i,selections:r}=s,o=Z(s,["disable","labelExpr","selections"]);if(!n){if(t.aria===!1&&o.aria==null&&(o.aria=!1),(a=o.encode)==null?void 0:a.symbols){const c=o.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!o.stroke&&(c.stroke={value:"transparent"});for(const f of d6)o[f]&&delete c[f]}if(o.title||delete o.title,i!==void 0){let c=i;((l=(u=o.encode)==null?void 0:u.labels)==null?void 0:l.update)&&oe(o.encode.labels.update.text)&&(c=fa(i,"datum.label",o.encode.labels.update.text.signal)),ode(o,"labels","text",{signal:c})}return o}}function ade(e){return hl(e)||wE(e)?ude(e):UL(e)}function ude(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),UL(e))}function UL(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},o=t.data.reduce((s,a)=>{const u=oe(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return pe(s,u)||s.push(u),s},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[x({name:i,size:r,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}else return[x({name:i,translate:{signal:"[width / 2, height / 2]"}},n)]}const lde=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class jL extends ao{constructor(t,n,i,r){super(x({},n),{name:t});this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function qL(e){e.component.projection=at(e)?cde(e):hde(e)}function cde(e){var t;if(e.hasProjection){const n=On(e.specifiedProjection),i=!(n&&(n.scale!=null||n.translate!=null)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=i?fde(e):void 0,s=new jL(e.projectionName(!0),x(x({},(t=On(e.config.projection))!=null?t:{}),n!=null?n:{}),r,o);return s.get("type")||s.set("type","equalEarth",!1),s}}function fde(e){const t=[],{encoding:n}=e;for(const i of[[pr,hr],[ai,Ri]])(gt(n[i[0]])||gt(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Tn)&&e.typedFieldDef(Tn).type===Zu&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Ue.Main)),t}function dde(e,t){const n=Fw(lde,r=>!!(!te(e.explicit,r)&&!te(t.explicit,r)||te(e.explicit,r)&&te(t.explicit,r)&&lr(e.get(r),t.get(r))));if(lr(e.size,t.size)){if(n)return e;if(lr(e.explicit,{}))return t;if(lr(t.explicit,{}))return e}return null}function hde(e){if(e.children.length===0)return;let t;for(const i of e.children)qL(i);const n=Fw(e.children,i=>{const r=i.component.projection;if(r)if(t){const o=dde(t,r);return o&&(t=o),!!o}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new jL(i,t.specifiedProjection,t.size,he(t.data));for(const o of e.children){const s=o.component.projection;s&&(s.isFit&&r.data.push(...o.component.projection.data),o.renameProjection(s.get("name"),i),s.merged=!0)}return r}}function pde(e,t,n,i){var r,o;if(jf(t,n)){const s=at(e)?(o=(r=e.axis(n))!=null?r:e.legend(n))!=null?o:{}:{},a=H(t,{expr:"datum"}),u=H(t,{expr:"datum",binSuffix:"end"});return{formulaAs:H(t,{binSuffix:"range",forAs:!0}),formula:cm(a,u,s.format,s.formatType,i)}}return{}}function WL(e,t){return`${MR(e)}_${t}`}function gde(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function lE(e,t,n){var o;const i=(o=bm(n,void 0))!=null?o:{},r=WL(i,t);return e.getName(`${r}_bins`)}function mde(e){return"as"in e}function HL(e,t,n){let i,r;mde(e)?i=V(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[H(e,{forAs:!0}),H(e,{binSuffix:"end",forAs:!0})];const o=x({},bm(t,void 0)),s=WL(o,e.field),{signal:a,extentSignal:u}=gde(n,s);if(em(o.extent)){const c=o.extent;r=mL(n,c.param,c),delete o.extent}const l=x(x(x({bin:o,field:e.field,as:[i]},a?{signal:a}:{}),u?{extentSignal:u}:{}),r?{span:r}:{});return{key:s,binComponent:l}}class kr extends Le{constructor(t,n){super(t);this.bins=n}clone(){return new kr(null,he(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,o,s)=>{if(ci(o)&&Be(o.bin)){const{key:a,binComponent:u}=HL(o,o.bin,n);r[a]=x(x(x({},u),r[a]),pde(n,o,s,n.config))}return r},{});return Re(i)?null:new kr(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:o}=HL(n,n.bin,i);return new kr(t,{[r]:o})}merge(t,n){for(const i of B(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=cr([...this.bins[i].as,...t.bins[i].as],xe)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(dn(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(dn(this.bins).map(t=>t.field))}hash(){return`Bin ${xe(this.bins)}`}assemble(){return dn(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,u=t.bin,{extent:o}=u,s=Z(u,["extent"]),a=x(x(x({type:"bin",field:si(t.field),as:i,signal:t.signal},em(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!o&&t.extentSignal&&(n.push({type:"extent",field:si(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const l of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:H({field:i[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function yde(e,t,n,i){const r=at(i)?i.encoding[to(t)]:void 0;if(ci(n)&&at(i)&&I5(n,r,i.markDef,i.config))e.add(H(n,{})),e.add(H(n,{suffix:"end"})),n.bin&&jf(n,t)&&e.add(H(n,{binSuffix:"range"}));else if(use(t)){const o=ase(t);e.add(i.getName(o))}else e.add(H(n));return e}function vde(e,t){var n;for(const i of B(t)){const r=t[i];for(const o of B(r))i in e?e[i][o]=new Set([...(n=e[i][o])!=null?n:[],...r[o]]):e[i]={[o]:r[o]}}}class Pi extends Le{constructor(t,n,i){super(t);this.dimensions=n,this.measures=i}clone(){return new Pi(null,new Set(this.dimensions),he(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(s=>{s.aggregate&&(i=!0)});const r={},o=new Set;return!i||(n.forEachFieldDef((s,a)=>{var c,f,d,h;const{aggregate:u,field:l}=s;if(u)if(u==="count")(c=r["*"])!=null||(r["*"]={}),r["*"].count=new Set([H(s,{forAs:!0})]);else{if(no(u)||as(u)){const p=no(u)?"argmin":"argmax",g=u[p];(f=r[g])!=null||(r[g]={}),r[g][p]=new Set([H({op:p,field:g},{forAs:!0})])}else(d=r[l])!=null||(r[l]={}),r[l][u]=new Set([H(s,{forAs:!0})]);ss(a)&&n.scaleDomain(a)==="unaggregated"&&((h=r[l])!=null||(r[l]={}),r[l].min=new Set([H({field:l,aggregate:"min"},{forAs:!0})]),r[l].max=new Set([H({field:l,aggregate:"max"},{forAs:!0})]))}else yde(o,a,s,n)}),o.size+B(r).length===0)?null:new Pi(t,o,r)}static makeFromTransform(t,n){var o,s,a;const i=new Set,r={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?((o=r["*"])!=null||(r["*"]={}),r["*"].count=new Set([f||H(u,{forAs:!0})])):((s=r[c])!=null||(r[c]={}),r[c][l]=new Set([f||H(u,{forAs:!0})])))}for(const u of(a=n.groupby)!=null?a:[])i.add(u);return i.size+B(r).length===0?null:new Pi(t,i,r)}merge(t){return hR(this.dimensions,t.dimensions)?(vde(this.measures,t.measures),!0):(zae("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...B(this.measures)])}producedFields(){const t=new Set;for(const n of B(this.measures))for(const i of B(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${xe({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const o of B(this.measures))for(const s of B(this.measures[o]))for(const a of this.measures[o][s])i.push(a),t.push(s),n.push(o==="*"?null:si(o));return{type:"aggregate",groupby:[...this.dimensions].map(si),ops:t,fields:n,as:i}}}class fl extends Le{constructor(t,n,i,r){super(t);this.model=n,this.name=i,this.data=r;for(const o of ui){const s=n.facet[o];if(s){const{bin:a,sort:u}=s;this[o]=x({name:n.getName(`${o}_domain`),fields:[H(s),...Be(a)?[H(s,{binSuffix:"end"})]:[]]},wr(u)?{sortField:u}:R(u)?{sortIndexField:ll(s,o)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of ui)this[n]&&(t+=` ${n.charAt(0)}:${xe(this[n])}`);return t}get fields(){var n;const t=[];for(const i of ui)((n=this[i])==null?void 0:n.fields)&&t.push(...this[i].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of ui)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of yr){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),o=i.get("range");if(Vt(r)&&ls(o)){const s=Bm(this.childModel,n),a=bE(s);a?t[n]=a:j(Ww(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],o=[],s=[],a=[];r&&i&&i[r]&&(n?(o.push(`distinct_${i[r]}`),s.push("max")):(o.push(i[r]),s.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=fm,field:f}=u;o.push(f),s.push(c),a.push(H(u,{forAs:!0}))}else l&&(o.push(l),s.push("max"),a.push(l));return{name:this[t].name,source:n!=null?n:this.data,transform:[x({type:"aggregate",groupby:this[t].fields},o.length?{fields:o,ops:s,as:a}:{})]}}assembleFacetHeaderData(t){var u,l;const{columns:n}=this.model.layout,{layoutHeaders:i}=this.model.component,r=[],o={};for(const c of iE){for(const f of rE){const d=(u=i[c]&&i[c][f])!=null?u:[];for(const h of d)if(((l=h.axes)==null?void 0:l.length)>0){o[c]=!0;break}}if(o[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?n?{signal:`ceil(${f} / ${n})`}:1:n?{signal:`min(${f}, ${n})`}:{signal:f};r.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:s,column:a}=o;return(s||a)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,t)),r}assemble(){var a,u;const t=[];let n=null;const i=this.getChildIndependentFieldsWithStep(),{column:r,row:o,facet:s}=this;if(r&&o&&(i.x||i.y)){n=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((a=i.x)!=null?a:[],(u=i.y)!=null?u:[]),c=l.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[Kr,Xr])this[l]&&t.push(this.assembleRowColumnHeaderData(l,n,i));if(s){const l=this.assembleFacetHeaderData(i);l&&t.push(...l)}return t}}function GL(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function bde(e,t){const n=Nw(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=GL(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=GL(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return j(Xse(t)),null}function xde(e){const t={};return Wg(e.filter,n=>{var i;if(u5(n)){let r=null;Jw(n)?r=Hn(n.equal):Qw(n)?r=Hn(n.lte):Zw(n)?r=Hn(n.lt):e_(n)?r=Hn(n.gt):t_(n)?r=Hn(n.gte):n_(n)?r=n.range[0]:i_(n)&&(r=((i=n.oneOf)!=null?i:n.in)[0]),r&&(ya(r)?t[n.field]="date":Oe(r)?t[n.field]="number":V(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function wde(e){const t={};function n(i){il(i)?t[i.field]="date":i.type==="quantitative"&&Cse(i.aggregate)?t[i.field]="number":Vu(i.field)>1?i.field in t||(t[i.field]="flatten"):el(i)&&wr(i.sort)&&Vu(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((at(e)||Bi(e))&&e.forEachFieldDef((i,r)=>{if(ci(i))n(i);else{const o=pa(r),s=e.fieldDef(o);n(P(x({},i),{type:s.type}))}}),at(e)){const{mark:i,markDef:r,encoding:o}=e;if(cs(i)&&!e.encoding.order){const s=r.orient==="horizontal"?"y":"x",a=o[s];G(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function _de(e){const t={};if(at(e)&&e.component.selection)for(const n of B(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&Vu(r.field)>1&&(t[r.field]="flatten")}return t}class Kt extends Le{constructor(t,n){super(t);this._parse=n}clone(){return new Kt(null,he(this._parse))}hash(){return`Parse ${xe(this._parse)}`}static makeExplicit(t,n,i){let r={};const o=n.data;return!_a(o)&&o&&o.format&&o.format.parse&&(r=o.format.parse),this.makeWithAncestors(t,r,{},i)}static makeWithAncestors(t,n,i,r){for(const a of B(i)){const u=r.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===i[a]||u.value==="derived"||i[a]==="flatten"?delete i[a]:j(YR(a,i[a],u.value)))}for(const a of B(n)){const u=r.get(a);u!==void 0&&(u===n[a]?delete n[a]:j(YR(a,n[a],u)))}const o=new ao(n,i);r.copyAll(o);const s={};for(const a of B(o.combine())){const u=o.get(a);u!==null&&(s[a]=u)}return B(s).length===0||r.parseNothing?null:new Kt(t,s)}get parse(){return this._parse}merge(t){this._parse=x(x({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of B(this._parse)){const i=this._parse[n];Vu(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(B(this._parse))}dependentFields(){return new Set(B(this._parse))}assembleTransforms(t=!1){return B(this._parse).filter(n=>t?Vu(n)>1:!0).map(n=>{const i=bde(n,this._parse[n]);return i?{type:"formula",expr:i,as:Rw(n)}:null}).filter(n=>n!==null)}}class ys extends Le{clone(){return new ys(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Wf])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Wf}}}class Zf extends Le{constructor(t,n){super(t);this.params=n}clone(){return new Zf(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${xe(this.params)}`}assemble(){return x({type:"graticule"},this.params===!0?{}:this.params)}}class Qf extends Le{constructor(t,n){super(t);this.params=n}clone(){return new Qf(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!=null?t:"data"])}hash(){return`Hash ${xe(this.params)}`}assemble(){return x({type:"sequence"},this.params)}}class Sa extends Le{constructor(t){super(null);t!=null||(t={name:"source"});let n;if(_a(t)||(n=t.format?x({},Wn(t.format,["parse"])):{}),Mm(t))this._data={values:t.values};else if(Gf(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];pe(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else j6(t)?this._data={values:[{type:"Sphere"}]}:(B6(t)||_a(t))&&(this._data={});this._generator=_a(t),t.name&&(this._name=t.name),n&&!Re(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return P(x({name:this._name},this._data),{transform:[]})}}var YL=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},Ede=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},ed;function cE(e){return e instanceof Sa||e instanceof Zf||e instanceof Qf}class fE{constructor(){ed.set(this,void 0),YL(this,ed,!1)}setModified(){YL(this,ed,!0)}get modifiedFlag(){return Ede(this,ed)}}ed=new WeakMap;class Aa extends fE{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,o)=>o[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class dE extends fE{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class Sde extends dE{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of B(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class Ade extends dE{constructor(t){super();this.requiresSelectionId=t&&Z_(t)}run(t){t instanceof ys&&(this.requiresSelectionId&&(cE(t.parent)||t.parent instanceof Pi||t.parent instanceof Kt)||(this.setModified(),t.remove()))}}class kde extends fE{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof Ar&&(i=t.producedFields(),Dw(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class Cde extends dE{constructor(){super()}run(t){t instanceof mn&&!t.isRequired()&&(this.setModified(),t.remove())}}class $de extends Aa{run(t){if(!cE(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof Kt)if(t instanceof Kt)this.setModified(),t.merge(n);else{if(Ow(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class Mde extends Aa{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof Kt);if(t.numChildren()>1&&i.length>=1){const r={},o=new Set;for(const s of i){const a=s.parse;for(const u of B(a))u in r?r[u]!==a[u]&&o.add(u):r[u]=a[u]}for(const s of o)delete r[s];if(!Re(r)){this.setModified();const s=new Kt(t,r);for(const a of n){if(a instanceof Kt)for(const u of B(r))delete a.parse[u];t.removeChild(a),a.parent=s,a instanceof Kt&&B(a.parse).length===0&&a.remove()}}}}}class Fde extends Aa{run(t){t instanceof mn||t.numChildren()>0||t instanceof fl||t instanceof Sa||(this.setModified(),t.remove())}}class Dde extends Aa{run(t){const n=t.children.filter(r=>r instanceof Ar),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class Tde extends Aa{run(t){const n=t.children.filter(r=>r instanceof Pi),i={};for(const r of n){const o=xe(r.groupBy);o in i||(i[o]=[]),i[o].push(r)}for(const r of B(i)){const o=i[r];if(o.length>1){const s=o.pop();for(const a of o)s.merge(a)&&(t.removeChild(a),a.parent=s,a.remove(),this.setModified())}}}}class Ode extends Aa{constructor(t){super();this.model=t}run(t){const n=!(cE(t)||t instanceof al||t instanceof Kt||t instanceof ys),i=[],r=[];for(const o of t.children)o instanceof kr&&(n&&!Ow(t.producedFields(),o.dependentFields())?i.push(o):r.push(o));if(i.length>0){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof kr?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(r.length>1){const o=r.pop();for(const s of r)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified()}}}class Nde extends Aa{run(t){const n=[...t.children];if(!Yu(n,s=>s instanceof mn)||t.numChildren()<=1)return;const r=[];let o;for(const s of n)if(s instanceof mn){let a=s;for(;a.numChildren()===1;){const[u]=a.children;if(u instanceof mn)a=u;else break}r.push(...a.children),o?(t.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=a,this.setModified()):o=a}else r.push(s);if(r.length){this.setModified();for(const s of r)s.parent.removeChild(s),s.parent=o}}}class ka extends Le{constructor(t,n){super(t);this.transform=n}clone(){return new ka(null,he(this.transform))}addDimensions(t){this.transform.groupby=cr(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!=null?n:H(t)}hash(){return`JoinAggregateTransform ${xe(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const o of this.transform.joinaggregate)n.push(o.op),i.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const r=this.transform.groupby;return x({type:"joinaggregate",as:i,ops:n,fields:t},r!==void 0?{groupby:r}:{})}}function Rde(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=H(i);return r&&t.push(r),t},[])}function Lde(e){return R(e)&&e.every(t=>V(t))&&e.length>1}class lo extends Le{constructor(t,n){super(t);this._stack=n}clone(){return new lo(null,he(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:o,offset:s="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(st(f.order,"ascending"));const l={field:a,order:u};let c;return Lde(o)?c=o:V(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new lo(t,{stackField:i,groupby:r,offset:s,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannel:o,fieldChannel:s,offset:a,impute:u}=i;let l;if(o){const h=r[o];l=Er(h)}const c=Rde(n),f=n.encoding.order;let d;return R(f)||G(f)?d=IR(f):d=c.reduce((h,p)=>(h.field.push(p),h.order.push(s==="y"?"descending":"ascending"),h),{field:[],order:[]}),new lo(t,{dimensionFieldDef:l,stackField:n.vgField(s),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(s,{suffix:"start",forAs:!0}),n.vgField(s,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${xe(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:i}=this._stack;return t?t.bin?n?[H(t,{binSuffix:"mid"})]:[H(t,{}),H(t,{binSuffix:"end"})]:[H(t)]:i!=null?i:[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:i,stackField:r,stackby:o,sort:s,offset:a,impute:u,as:l}=this._stack;if(u&&i){const{bandPosition:c=.5,bin:f}=i;f&&t.push({type:"formula",expr:`${c}*`+H(i,{expr:"datum"})+`+${1-c}*`+H(i,{expr:"datum",binSuffix:"end"}),as:H(i,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...o,...n],key:H(i,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:s,as:l,offset:a}),t}}class dl extends Le{constructor(t,n){super(t);this.transform=n}clone(){return new dl(null,he(this.transform))}addDimensions(t){this.transform.groupby=cr(this.transform.groupby.concat(t),n=>n)}dependentFields(){var n,i;const t=new Set;return((n=this.transform.groupby)!=null?n:[]).forEach(t.add,t),((i=this.transform.sort)!=null?i:[]).forEach(r=>t.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>r!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!=null?n:H(t)}hash(){return`WindowTransform ${xe(this.transform)}`}assemble(){var f;const t=[],n=[],i=[],r=[];for(const d of this.transform.window)n.push(d.op),i.push(this.getDefaultName(d)),r.push(d.param===void 0?null:d.param),t.push(d.field===void 0?null:d.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&n.every(d=>Uw(d)))return x({type:"joinaggregate",as:i,ops:n,fields:t},s!==void 0?{groupby:s}:{});const a=[],u=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)a.push(d.field),u.push((f=d.order)!=null?f:"ascending");const l={field:a,order:u},c=this.transform.ignorePeers;return x(x(x({type:"window",params:r,as:i,ops:n,fields:t,sort:l},c!==void 0?{ignorePeers:c}:{}),s!==void 0?{groupby:s}:{}),o!==void 0?{frame:o}:{})}}function Ide(e){function t(n){if(!(n instanceof fl)){const i=n.clone();if(i instanceof mn){const r=pE+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof Pi||i instanceof lo||i instanceof dl||i instanceof ka)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function hE(e){if(e instanceof fl)if(e.numChildren()===1&&!(e.children[0]instanceof mn)){const t=e.children[0];(t instanceof Pi||t instanceof lo||t instanceof dl||t instanceof ka)&&t.addDimensions(e.fields),t.swapWithParent(),hE(e)}else{const t=e.model.component.data.main;VL(t);const n=Ide(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(hE)}function VL(e){if(e instanceof mn&&e.type===Ue.Main&&e.numChildren()===1){const t=e.children[0];t instanceof fl||(t.swapWithParent(),VL(e))}}const pE="scale_",zm=5;function gE(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!gE(t.children))return!1}return!0}function zi(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function XL(e,t,n){let i=e.sources,r=!1;return r=zi(new Cde,i)||r,r=zi(new Ade(t),i)||r,i=i.filter(o=>o.numChildren()>0),r=zi(new Fde,i)||r,i=i.filter(o=>o.numChildren()>0),n||(r=zi(new $de,i)||r,r=zi(new Ode(t),i)||r,r=zi(new kde,i)||r,r=zi(new Mde,i)||r,r=zi(new Tde,i)||r,r=zi(new Dde,i)||r,r=zi(new Sde,i)||r,r=zi(new Nde,i)||r),e.sources=i,r}function Pde(e,t){gE(e.sources);let n=0,i=0;for(let r=0;r<zm&&XL(e,t,!0);r++)n++;e.sources.map(hE);for(let r=0;r<zm&&XL(e,t,!1);r++)i++;gE(e.sources),Math.max(n,i)===zm&&j(`Maximum optimization runs(${zm}) reached.`)}class Nn{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Nn(()=>t(n))}}function KL(e){at(e)?zde(e):Bde(e)}function zde(e){const t=e.component.scales;for(const n of B(t)){const i=jde(e,n);if(t[n].setWithExplicit("domains",i),Wde(e,n),e.component.data.isFaceted){let o=e;for(;!Bi(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const a of i.value)io(a)&&(a.data=pE+a.data.replace(pE,""))}}}function Bde(e){for(const n of e.children)KL(n);const t=e.component.scales;for(const n of B(t)){let i,r=null;for(const o of e.children){const s=o.component.scales[n];if(s){i===void 0?i=s.getWithExplicit("domains"):i=hs(i,s.getWithExplicit("domains"),"domains","scale",vE);const a=s.get("selectionExtent");r&&a&&r.param!==a.param&&j(Hse),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function Ude(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:o}=JL(t,n);if(!r){j(o);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=JL(t,n);if(r)return"unaggregated"}return e}function jde(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=Ude(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=P(x({},e.specifiedScales[t]),{domain:r})),t==="x"&&gt(i.x2)?gt(i.x)?hs(vs(n,r,e,"x"),vs(n,r,e,"x2"),"domain","scale",vE):vs(n,r,e,"x2"):t==="y"&&gt(i.y2)?gt(i.y)?hs(vs(n,r,e,"y"),vs(n,r,e,"y2"),"domain","scale",vE):vs(n,r,e,"y2"):vs(n,r,e,t)}function qde(e,t,n){return e.map(i=>({signal:`{data: ${xm(i,{timeUnit:n,type:t})}}`}))}function mE(e,t,n){var r;const i=(r=pn(n))==null?void 0:r.unit;return t==="temporal"||i?qde(e,t,i):[e]}function vs(e,t,n,i){const{encoding:r}=n,o=gt(r[i]),{type:s}=o,a=o.timeUnit;if(vue(t)){const f=vs(e,void 0,n,i),d=mE(t.unionWith,s,a);return uo([...f.value,...d])}else{if(oe(t))return uo([t]);if(t&&t!=="unaggregated"&&!d5(t))return uo(mE(t,s,a))}const u=n.stack;if(u&&i===u.fieldChannel){if(u.offset==="normalize")return Yn([[0,1]]);const f=n.requestDataName(Ue.Main);return Yn([{data:f,field:n.vgField(i,{suffix:"start"})},{data:f,field:n.vgField(i,{suffix:"end"})}])}const l=ss(i)&&G(o)?Hde(n,i,e):void 0;if(ds(o)){const f=mE([o.datum],s,a);return Yn(f)}const c=o;if(t==="unaggregated"){const f=n.requestDataName(Ue.Main),{field:d}=o;return Yn([{data:f,field:H({field:d,aggregate:"min"})},{data:f,field:H({field:d,aggregate:"max"})}])}else if(Be(c.bin)){if(Vt(e))return Yn(e==="bin-ordinal"?[]:[{data:Mf(l)?n.requestDataName(Ue.Main):n.requestDataName(Ue.Raw),field:n.vgField(i,jf(c,i)?{binSuffix:"range"}:{}),sort:l===!0||!J(l)?{field:n.vgField(i,{}),op:"min"}:l}]);{const{bin:f}=c;if(Be(f)){const d=lE(n,c.field,f);return Yn([new Nn(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return Yn([{data:n.requestDataName(Ue.Main),field:n.vgField(i,{})}])}}else if(c.timeUnit&&pe(["time","utc"],e)&&I5(c,at(n)?n.encoding[to(i)]:void 0,n.markDef,n.config)){const f=n.requestDataName(Ue.Main);return Yn([{data:f,field:n.vgField(i)},{data:f,field:n.vgField(i,{suffix:"end"})}])}else return Yn(l?[{data:Mf(l)?n.requestDataName(Ue.Main):n.requestDataName(Ue.Raw),field:n.vgField(i),sort:l}]:[{data:n.requestDataName(Ue.Main),field:n.vgField(i)}])}function yE(e,t){const{op:n,field:i,order:r}=e;return x(x({op:n!=null?n:t?"sum":fm},i?{field:si(i)}:{}),r?{order:r}:{})}function Wde(e,t){var a;const n=e.component.scales[t],i=e.specifiedScales[t].domain,r=(a=e.fieldDef(t))==null?void 0:a.bin,o=d5(i)&&i,s=ga(r)&&em(r.extent)&&r.extent;(o||s)&&n.set("selectionExtent",o!=null?o:s,!0)}function Hde(e,t,n){if(!Vt(n))return;const i=e.fieldDef(t),r=i.sort;if(O5(r))return{op:"min",field:ll(i,t),order:"ascending"};const{stack:o}=e,s=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map(a=>a.fieldDef.field)]:void 0;if(wr(r)){const a=o&&!pe(s,r.field);return yE(r,a)}else if(T5(r)){const{encoding:a,order:u}=r,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=o&&!pe(s,f);if(no(c)||as(c))return yE({field:H(l),order:u},d);if(Uw(c)||!c)return yE({op:c,field:f,order:u},d)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(pe(["ascending",void 0],r))return!0}}function JL(e,t){const{aggregate:n,type:i}=e;return n?V(n)&&!Fse[n]?{valid:!1,reason:mae(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:yae(e)}:{valid:!0}:{valid:!1,reason:gae(e)}}function vE(e,t,n,i){return e.explicit&&t.explicit&&j(_ae(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Gde(e){const t=cr(e.map(s=>{if(io(s)){const a=s,{sort:u}=a;return Z(a,["sort"])}return s}),xe),n=cr(e.map(s=>{if(io(s)){const a=s.sort;return a!==void 0&&!Mf(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(s=>s!==void 0),xe);if(t.length===0)return;if(t.length===1){const s=e[0];if(io(s)&&n.length>0){let a=n[0];if(n.length>1)j(QR),a=!0;else if(J(a)&&"field"in a){const u=a.field;s.field===u&&(a=a.order?{order:a.order}:!0)}return P(x({},s),{sort:a})}return s}const i=cr(n.map(s=>Mf(s)||!("op"in s)||V(s.op)&&s.op in Ase?s:(j(Sae(s)),!0)),xe);let r;i.length===1?r=i[0]:i.length>1&&(j(QR),r=!0);const o=cr(e.map(s=>io(s)?s.data:null),s=>s);return o.length===1&&o[0]!==null?x({data:o[0],fields:t.map(a=>a.field)},r?{sort:r}:{}):x({fields:t},r?{sort:r}:{})}function bE(e){if(io(e)&&V(e.field))return e.field;if(Dse(e)){let t;for(const n of e.fields)if(io(n)&&V(n.field)){if(!t)t=n.field;else if(t!==n.field)return j(Aae),t}return j(kae),t}else if(Tse(e)){j(Cae);const t=e.fields[0];return V(t)?t:void 0}}function Bm(e,t){const i=e.component.scales[t].get("domains").map(r=>(io(r)&&(r.data=e.lookupDataSource(r.data)),r));return Gde(i)}function ZL(e){return hl(e)||wE(e)?e.children.reduce((t,n)=>t.concat(ZL(n)),QL(e)):QL(e)}function QL(e){return B(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),g=r,{name:o,type:s,selectionExtent:a,domains:u,range:l,reverse:c}=g,f=Z(g,["name","type","selectionExtent","domains","range","reverse"]),d=Yde(r.range,o,n,e),h=Bm(e,n),p=a?qce(e,a,i,h):null;return t.push(x(x(P(x(x({name:o,type:s},h?{domain:h}:{}),p?{domainRaw:p}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function Yde(e,t,n,i){if(vr(n)){if(ls(e))return{step:{signal:`${t}_step`}}}else if(J(e)&&io(e))return P(x({},e),{data:i.lookupDataSource(e.data)});return e}class e4 extends ao{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:Yu(this.get("domains"),t=>R(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const Vde=["range","scheme"];function t4(e){return e==="x"?"width":e==="y"?"height":void 0}function Xde(e){const t=e.component.scales;for(const n of Qg){const i=t[n];if(!i)continue;const r=Kde(n,e);i.setWithExplicit("range",r)}}function n4(e,t){const n=e.fieldDef(t);if(n==null?void 0:n.bin){const{bin:i,field:r}=n,o=t4(t),s=e.getName(o);if(J(i)&&i.binned&&i.step!==void 0)return new Nn(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(s)} / (${u})`});if(Be(i)){const a=lE(e,r,i);return new Nn(()=>{const u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(s)} / (${l})`})}}}function Kde(e,t){const n=t.specifiedScales[e],{size:i}=t,o=t.getScaleComponent(e).get("type");for(const l of Vde)if(n[l]!==void 0){const c=u_(o,l),f=h5(e,l);if(!c)j(JR(o,l,e));else if(f)j(f);else switch(l){case"range":{const d=n.range;if(R(d)){if(vr(e))return uo(d.map(h=>{if(h==="width"||h==="height"){const p=t.getName(h),g=t.getSignalName.bind(t);return Nn.fromName(g,p)}return h}))}else if(J(d))return uo({data:t.requestDataName(Ue.Main),field:d.field,sort:{op:"min",field:t.vgField(e)}});return uo(d)}case"scheme":return uo(Jde(n[l]))}}if(e===Xe||e===ht){const l=e===Xe?"width":"height",c=i[l];if(Sr(c)){if(Vt(o))return uo({step:c.step});j(ZR(l))}}const{rangeMin:s,rangeMax:a}=n,u=Zde(e,t);return(s!==void 0||a!==void 0)&&u_(o,"rangeMin")&&R(u)&&u.length===2?uo([s!=null?s:u[0],a!=null?a:u[1]]):Yn(u)}function Jde(e){return yue(e)?x({scheme:e.name},Wn(e,["name"])):{scheme:e}}function Zde(e,t){const{size:n,config:i,mark:r,encoding:o}=t,s=t.getSignalName.bind(t),{type:a}=gt(o[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case Xe:case ht:{if(pe(["point","band"],l)){if(e===Xe&&!n.width){const p=Hf(i.view,"width");if(Sr(p))return p}else if(e===ht&&!n.height){const p=Hf(i.view,"height");if(Sr(p))return p}}const d=t4(e),h=t.getName(d);return e===ht&&Gn(l)?[Nn.fromName(s,h),0]:[0,Nn.fromName(s,h)]}case Qr:{const d=t.component.scales[e].get("zero"),h=i4(r,d,i),p=the(r,n,t,i);return zf(l)?ehe(h,p,Qde(l,i,c,e)):[h,p]}case Ni:return[0,Math.PI*2];case da:return[0,360];case dr:return[0,new Nn(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case ns:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case is:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Tn:return"symbol";case Dn:case gr:case mr:return l==="ordinal"?a==="nominal"?"category":"ordinal":f!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case eo:case es:case ts:return[i.scale.minOpacity,i.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function Qde(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&R(n)?n.length+1:(j(Lae(i)),3)}}function ehe(e,t,n){const i=()=>{const r=ro(t),o=ro(e),s=`(${r} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${r} + ${s}, ${s})`};return oe(t)?new Nn(i):{signal:i()}}function i4(e,t,n){if(t)return oe(t)?{signal:`${t.signal} ? 0 : ${i4(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(nm("size",e))}const r4=.95;function the(e,t,n,i){const r={x:n4(n,"x"),y:n4(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const o=o4(t,r,i.view);return Oe(o)?o-1:new Nn(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const o=o4(t,r,i.view);return Oe(o)?Math.pow(r4*o,2):new Nn(()=>`pow(${r4} * ${o.signal}, 2)`)}}throw new Error(nm("size",e))}function o4(e,t,n){const i=Sr(e.width)?e.width.step:km(n,"width"),r=Sr(e.height)?e.height.step:km(n,"height");return t.x||t.y?new Nn(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function s4(e,t){at(e)?nhe(e,t):l4(e,t)}function nhe(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:o,specifiedScales:s}=e;for(const a of B(n)){const u=s[a],l=n[a],c=e.getScaleComponent(a),f=gt(r[a]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=u_(h,t),y=h5(a,t);if(d!==void 0&&(m?y&&j(y):j(JR(h,t,a))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,b=f.type;switch(t){case"domainMax":case"domainMin":ya(u[t])||b==="temporal"||v?l.set(t,{signal:xm(u[t],{type:b,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=t in a4?a4[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,markDef:o,config:i}):i.scale[t];v!==void 0&&l.set(t,v,!1)}}}const a4={bins:({model:e,fieldOrDatumDef:t})=>G(t)?ihe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>rhe(e,t.type),nice:({scaleType:e,channel:t,domain:n,fieldOrDatumDef:i})=>ohe(e,t,n,i),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>she(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:i})=>ahe(e,t,n.type,i.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:i,scalePaddingInner:r,config:o})=>uhe(e,t,n,i.type,r,o.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=G(e)?e.sort:void 0;return lhe(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>che(e,t,n,i,r)};function u4(e){at(e)?Xde(e):l4(e,"range")}function l4(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?u4(i):s4(i,t);for(const i of B(n)){let r;for(const o of e.children){const s=o.component.scales[i];if(s){const a=s.getWithExplicit(t);r=hs(r,a,t,"scale",z6((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function ihe(e,t){const n=t.bin;if(Be(n)){const i=lE(e,t.field,n);return new Nn(()=>e.getSignalName(i))}else if(hn(n)&&ga(n)&&n.step!==void 0)return{step:n.step}}function rhe(e,t){if(pe([Dn,gr,mr],e)&&t!=="nominal")return"hcl"}function ohe(e,t,n,i){var r;if(!(((r=Er(i))==null?void 0:r.bin)||R(n)||pe([pt.TIME,pt.UTC],e)))return t in os?!0:void 0}function she(e,t,n,i,r,o){if(e in os){if(Li(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:s,orient:a}=r;if(s==="bar"&&!(G(i)&&(i.bin||i.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===pt.POINT)return n.pointPadding}}function ahe(e,t,n,i){if(e===void 0&&t in os){const{bandPaddingInner:r,barBandPaddingInner:o,rectBandPaddingInner:s}=i;return st(r,n==="bar"?o:s)}}function uhe(e,t,n,i,r,o){if(e===void 0&&t in os&&n===pt.BAND){const{bandPaddingOuter:s}=o;return st(s,oe(r)?{signal:`${r.signal}/2`}:r/2)}}function lhe(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return Gn(e)&&t==="descending"?oe(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(Gn(e)&&t==="descending")return!0}function che(e,t,n,i,r){if(!!n&&n!=="unaggregated"&&Gn(r)){if(R(n)){const s=n[0],a=n[n.length-1];if(s<=0&&a>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!zf(r))return!0;if(!(G(t)&&t.bin)&&pe([...yr,...yse],e)){const{orient:s,type:a}=i;return!(pe(["bar","area","line","trail"],a)&&(s==="horizontal"&&e==="y"||s==="vertical"&&e==="x"))}return!1}function fhe(e,t,n,i){const r=dhe(t,n,i),{type:o}=e;return ss(t)?o!==void 0?Eue(t,o)?G(n)&&!_ue(o,n.type)?(j(xae(o,r)),r):o:(j(bae(t,o,r)),r):r:null}function dhe(e,t,n){var i;switch(t.type){case"nominal":case"ordinal":{if(Xu(e)||Bw(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&j(Gw(e,"ordinal")),"ordinal";if(e in os){if(pe(["rect","bar","image","rule"],n.type))return"band"}else if(n.type==="arc"&&e in zw)return"band";const r=n[li(e)];return Qu(r)||b_(t)&&((i=t.axis)==null?void 0:i.tickBand)?"band":"point"}case"temporal":return Xu(e)?"time":Bw(e)==="discrete"?(j(Gw(e,"temporal")),"ordinal"):G(t)&&t.timeUnit&&pn(t.timeUnit).utc?"utc":"time";case"quantitative":return Xu(e)?G(t)&&Be(t.bin)?"bin-ordinal":"linear":Bw(e)==="discrete"?(j(Gw(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(XR(t.type))}function hhe(e,{ignoreRange:t}={}){c4(e),KL(e);for(const n of wue)s4(e,n);t||u4(e)}function c4(e){at(e)?e.component.scales=phe(e):e.component.scales=mhe(e)}function phe(e){const{encoding:t,mark:n,markDef:i}=e;return Qg.reduce((r,o)=>{const s=gt(t[o]);if(s&&n===m5&&o===Tn&&s.type===Zu)return r;let a=s&&s.scale;if(s&&a!==null&&a!==!1){a!=null||(a={});const u=fhe(a,o,s,i);r[o]=new e4(e.scaleName(`${o}`,!0),{value:u,explicit:a.type===u})}return r},{})}const ghe=z6((e,t)=>c5(e)-c5(t));function mhe(e){var o;var t;const n=e.component.scales={},i={},r=e.component.resolve;for(const s of e.children){c4(s);for(const a of B(s.component.scales))if((o=(t=r.scale)[a])!=null||(t[a]=FL(a,e)),r.scale[a]==="shared"){const u=i[a],l=s.component.scales[a].getWithExplicit("type");u?rue(u.value,l.value)?i[a]=hs(u,l,"type","scale",ghe):(r.scale[a]="independent",delete i[a]):i[a]=l}}for(const s of B(i)){const a=e.scaleName(s,!0),u=i[s];n[s]=new e4(a,u);for(const l of e.children){const c=l.component.scales[s];c&&(l.renameScale(c.get("name"),a),c.merged=!0)}}return n}class xE{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function at(e){return(e==null?void 0:e.type)==="unit"}function Bi(e){return(e==null?void 0:e.type)==="facet"}function wE(e){return(e==null?void 0:e.type)==="concat"}function hl(e){return(e==null?void 0:e.type)==="layer"}class _E{constructor(t,n,i,r,o,s,a){var u,l;this.type=n,this.parent=i,this.config=o,this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=i,this.config=o,this.view=On(a),this.name=(u=t.name)!=null?u:r,this.title=us(t.title)?{text:t.title}:t.title?On(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new xE,this.projectionNameMap=i?i.projectionNameMap:new xE,this.signalNameMap=i?i.signalNameMap:new xE,this.data=t.data,this.description=t.description,this.transforms=Cce((l=t.transform)!=null?l:[]),this.layout=n==="layer"||n==="unit"?{}:Lle(t,n,o),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:dm(t)||i&&i.component.data.isFaceted&&t.data===void 0},layoutSize:new ao,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:x({scale:{},axis:{},legend:{}},s?he(s):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){hhe(this)}parseProjection(){qL(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){PL(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)==null?void 0:t.style)!=null?n:"cell"}assembleEncodeFromView(t){const o=t,{style:n}=o,i=Z(o,["style"]),r={};for(const s of B(i)){const a=i[s];a!==void 0&&(r[s]=Ge(a))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Ge(this.description)),this.type==="unit"||this.type==="layer")?x({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):Re(n)?void 0:n}assembleLayout(){if(!this.layout)return;const s=this.layout,{spacing:t}=s,n=Z(s,["spacing"]),{component:i,config:r}=this,o=Pfe(i.layoutHeaders,r);return x(x(x({padding:t},this.assembleDefaultLayout()),n),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of ui)t[i].title&&n.push(Tfe(this,i));for(const i of iE)n=n.concat(Ofe(this,i));return n}assembleAxes(){return xfe(this.component.axes,this.config)}assembleLegends(){return BL(this)}assembleProjections(){return ade(this)}assembleTitle(){var r,s,a;const o=(r=this.title)!=null?r:{},{encoding:t}=o,n=Z(o,["encoding"]),i=x(x(x({},DR(this.config.title).nonMark),n),t?{encode:{update:t}}:{});if(i.text)return pe(["unit","layer"],this.type)?pe(["middle",void 0],i.anchor)&&((s=i.frame)!=null||(i.frame="group")):(a=i.anchor)!=null||(i.anchor="start"),Re(i)?void 0:i}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Bi(this.parent)?ZL(this):[];r.length>0&&(n.scales=r);const o=this.assembleAxes();o.length>0&&(n.axes=o);const s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return He((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Ue[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(Bi(this.parent)){const n=$L(t),i=Zg(n),r=this.component.scales[i];if(r&&!r.merged){const o=r.get("type"),s=r.get("range");if(Vt(o)&&ls(s)){const a=r.get("name"),u=Bm(this,i),l=bE(u);if(l){const c=H({aggregate:"distinct",field:l},{expr:"datum"});return{signal:CL(a,r,c)}}else return j(Ww(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(ER(t)&&ss(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(Bse(n));return i}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)==null?void 0:t.some(i=>i.hasOrientSignalRef()))||((n=this.component.axes.y)==null?void 0:n.some(i=>i.hasOrientSignalRef()))}}class f4 extends _E{vgField(t,n={}){const i=this.fieldDef(t);if(!!i)return H(i,n)}reduceFieldDef(t,n){return fle(this.getMapping(),(i,r,o)=>{const s=Er(r);return s?t(i,s,o):i},n)}forEachFieldDef(t,n){S_(this.getMapping(),(i,r)=>{const o=Er(i);o&&t(o,r)},n)}}class Um extends Le{constructor(t,n){super(t);var r,o,s;this.transform=n,this.transform=he(n);const i=(r=this.transform.as)!=null?r:[void 0,void 0];this.transform.as=[(o=i[0])!=null?o:"value",(s=i[1])!=null?s:"density"]}clone(){return new Um(null,he(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!=null?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${xe(this.transform)}`}assemble(){const r=this.transform,{density:t}=r,n=Z(r,["density"]);return x({type:"kde",field:t},n)}}class td extends Le{constructor(t,n){super(t);this.filter=n}clone(){return new td(null,x({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:o}=n;if(Fe("invalid",o,i)!=="filter")return null;const a=n.reduceFieldDef((u,l,c)=>{const f=ss(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");Gn(d)&&l.aggregate!=="count"&&!cs(r)&&(u[l.field]=l)}return u},{});return B(a).length?new td(t,a):null}dependentFields(){return new Set(B(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${xe(this.filter)}`}assemble(){const t=B(this.filter).reduce((n,i)=>{const r=this.filter[i],o=H(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):r.type==="quantitative"&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class jm extends Le{constructor(t,n){super(t);this.transform=n,this.transform=he(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((o,s)=>{var a;return(a=r[s])!=null?a:o})}clone(){return new jm(this.parent,he(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${xe(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class qm extends Le{constructor(t,n){super(t);var r,o,s;this.transform=n,this.transform=he(n);const i=(r=this.transform.as)!=null?r:[void 0,void 0];this.transform.as=[(o=i[0])!=null?o:"key",(s=i[1])!=null?s:"value"]}clone(){return new qm(null,he(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${xe(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class pl extends Le{constructor(t,n,i,r){super(t);this.fields=n,this.geojson=i,this.signal=r}clone(){return new pl(null,he(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[pr,hr],[ai,Ri]]){const o=r.map(s=>{const a=gt(n.encoding[s]);return G(a)?a.field:ds(a)?{expr:`${a.datum}`}:Ii(a)?{expr:`${a.value}`}:void 0});(o[0]||o[1])&&(t=new pl(t,o,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(Tn)){const r=n.typedFieldDef(Tn);r.type===Zu&&(t=new pl(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}dependentFields(){var n;const t=((n=this.fields)!=null?n:[]).filter(V);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${xe(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],P(x(x({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class nd extends Le{constructor(t,n,i,r){super(t);this.projection=n,this.fields=i,this.as=r}clone(){return new nd(null,this.projection,he(this.fields),he(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[pr,hr],[ai,Ri]]){const r=i.map(s=>{const a=gt(n.encoding[s]);return G(a)?a.field:ds(a)?{expr:`${a.datum}`}:Ii(a)?{expr:`${a.value}`}:void 0}),o=i[0]===ai?"2":"";(r[0]||r[1])&&(t=new nd(t,n.projectionName(),r,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(V))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${xe(this.fields)} ${xe(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Ca extends Le{constructor(t,n){super(t);this.transform=n}clone(){return new Ca(null,he(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!=null?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new Ca(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,o=i.y;if(G(r)&&G(o)){const s=r.impute?r:o.impute?o:void 0;if(s===void 0)return;const a=r.impute?o:o.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=s.impute,d=J5(n.mark,i);return new Ca(t,x(x(x(x(x({impute:s.field,key:a.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${xe(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:o,value:s,frame:a=[null,null]}=this.transform,u=P(x(P(x({type:"impute",field:t,key:n},i?{keyvals:lce(i)?this.processSequence(i):i}:{}),{method:"value"}),o?{groupby:o}:{}),{value:!r||r==="value"?s:null});if(r&&r!=="value"){const l=x({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1},o?{groupby:o}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class Wm extends Le{constructor(t,n){super(t);var r,o,s;this.transform=n,this.transform=he(n);const i=(r=this.transform.as)!=null?r:[void 0,void 0];this.transform.as=[(o=i[0])!=null?o:n.on,(s=i[1])!=null?s:n.loess]}clone(){return new Wm(null,he(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!=null?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${xe(this.transform)}`}assemble(){const o=this.transform,{loess:t,on:n}=o,i=Z(o,["loess","on"]);return x({type:"loess",x:n,y:t},i)}}class id extends Le{constructor(t,n,i){super(t);this.transform=n,this.secondary=i}clone(){return new id(null,he(this.transform),this.secondary)}static make(t,n,i,r){const o=n.component.data.sources,{from:s}=i;let a=null;if(cce(s)){let u=g4(s.data,o);u||(u=new Sa(s.data),o.push(u));const l=n.getName(`lookup_${r}`);a=new mn(u,l,Ue.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(fce(s)){const u=s.param;i=x({as:u},i);let l;try{l=n.getSelectionComponent(He(u),u)}catch(c){throw new Error(qse(u))}if(a=l.materialized,!a)throw new Error(Wse(u))}return new id(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?K(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${xe({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=x({values:this.transform.from.fields},this.transform.as?{as:K(this.transform.as)}:{});else{let n=this.transform.as;V(n)||(j(Zse),n="_lookup"),t={as:[n]}}return x(x({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class Hm extends Le{constructor(t,n){super(t);var r,o,s;this.transform=n,this.transform=he(n);const i=(r=this.transform.as)!=null?r:[void 0,void 0];this.transform.as=[(o=i[0])!=null?o:"prob",(s=i[1])!=null?s:"value"]}clone(){return new Hm(null,he(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!=null?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${xe(this.transform)}`}assemble(){const r=this.transform,{quantile:t}=r,n=Z(r,["quantile"]);return x({type:"quantile",field:t},n)}}class Gm extends Le{constructor(t,n){super(t);var r,o,s;this.transform=n,this.transform=he(n);const i=(r=this.transform.as)!=null?r:[void 0,void 0];this.transform.as=[(o=i[0])!=null?o:n.on,(s=i[1])!=null?s:n.regression]}clone(){return new Gm(null,he(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!=null?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${xe(this.transform)}`}assemble(){const o=this.transform,{regression:t,on:n}=o,i=Z(o,["regression","on"]);return x({type:"regression",x:n,y:t},i)}}class Ym extends Le{constructor(t,n){super(t);this.transform=n}clone(){return new Ym(null,he(this.transform))}addDimensions(t){var n;this.transform.groupby=cr(((n=this.transform.groupby)!=null?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!=null?t:[]])}hash(){return`PivotTransform ${xe(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:o}=this.transform;return x(x(x({type:"pivot",field:t,value:n},r!==void 0?{limit:r}:{}),o!==void 0?{op:o}:{}),i!==void 0?{groupby:i}:{})}}class Vm extends Le{constructor(t,n){super(t);this.transform=n}clone(){return new Vm(null,he(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${xe(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function d4(e){let t=0;function n(i,r){var o;if(i instanceof Sa&&!i.isGenerator&&!Gf(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof Kt&&(i.parent instanceof Sa&&!r.source?(r.format=P(x({},(o=r.format)!=null?o:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof fl){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof Zf||i instanceof Qf||i instanceof td||i instanceof al||i instanceof ul||i instanceof nd||i instanceof Pi||i instanceof id||i instanceof dl||i instanceof ka||i instanceof qm||i instanceof jm||i instanceof Um||i instanceof Wm||i instanceof Hm||i instanceof Gm||i instanceof ys||i instanceof Vm||i instanceof Ym)&&r.transform.push(i.assemble()),(i instanceof kr||i instanceof Ar||i instanceof Ca||i instanceof lo||i instanceof pl)&&r.transform.push(...i.assemble()),i instanceof mn&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof mn?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof mn&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let s=r.name;!r.source||r.transform.length>0?e.push(r):s=r.source;for(const a of i.children)n(a,{name:null,source:s,transform:[]});break}}}return n}function yhe(e){const t=[],n=d4(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function vhe(e,t){var s,a;const n=[],i=d4(n);let r=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${r++}`);const l=u.assemble();i(u,l)}for(const u of n)u.transform.length===0&&delete u.transform;let o=0;for(const[u,l]of n.entries())((s=l.transform)!=null?s:[]).length===0&&!l.source&&n.splice(o++,0,n.splice(u,1)[0]);for(const u of n)for(const l of(a=u.transform)!=null?a:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of n)u.name in t&&(u.values=t[u.name]);return n}function bhe(e){return e==="top"||e==="left"||oe(e)?"header":"footer"}function xhe(e){for(const t of ui)whe(e,t);p4(e,"x"),p4(e,"y")}function whe(e,t){var s;const{facet:n,config:i,child:r,component:o}=e;if(e.channelHasField(t)){const a=n[t],u=cl("title",null,i,t);let l=tl(a,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});r.component.layoutHeaders[t].title&&(l=R(l)?l.join(", "):l,l+=` / ${r.component.layoutHeaders[t].title}`,r.component.layoutHeaders[t].title=null);const c=cl("labelOrient",a.header,i,t),f=a.header!==null?st((s=a.header)==null?void 0:s.labels,i.header.labels,!0):!1,d=pe(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:a.header!==null?l:null,facetFieldDef:a,[d]:t==="facet"?[]:[h4(e,t,f)]}}}function h4(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function p4(e,t){var i;const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:r,resolve:o}=e.component;if(o.axis[t]=aE(o,t),o.axis[t]==="shared"){const s=t==="x"?"column":"row",a=r[s];for(const u of n.component.axes[t]){const l=bhe(u.get("orient"));(i=a[l])!=null||(a[l]=[h4(e,s,!1)]);const c=Jf(u,"main",e.config,{header:!0});c&&a[l][0].axes.push(c),u.mainExtracted=!0}}}}function _he(e){EE(e),Xm(e,"width"),Xm(e,"height")}function Ehe(e){EE(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";Xm(e,t),Xm(e,n)}function EE(e){for(const t of e.children)t.parseLayoutSize()}function Xm(e,t){var a;const n=$L(t),i=Zg(n),r=e.component.resolve,o=e.component.layoutSize;let s;for(const u of e.children){const l=u.component.layoutSize.getWithExplicit(n),c=(a=r.scale[i])!=null?a:FL(i,e);if(c==="independent"&&l.value==="step"){s=void 0;break}if(s){if(c==="independent"&&s.value!==l.value){s=void 0;break}s=hs(s,l,n,"")}else s=l}if(s){for(const u of e.children)e.renameSignal(u.getName(n),e.getName(t)),u.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,s)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function She(e){const{size:t,component:n}=e;for(const i of yr){const r=li(i);if(t[r]){const o=t[r];n.layoutSize.set(r,Sr(o)?"step":o,!0)}else{const o=Ahe(e,r);n.layoutSize.set(r,o,!1)}}}function Ahe(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const o=r.get("type"),s=r.get("range");if(Vt(o)){const a=Hf(i.view,t);return ls(s)||Sr(a)?"step":a}else return L_(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return L_(i.view,t);{const o=Hf(i.view,t);return Sr(o)?o.step:o}}}function SE(e,t,n){return H(t,x({suffix:`by_${H(e)}`},n!=null?n:{}))}class rd extends f4{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve);this.child=ME(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Uf(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=B(t),i={};for(const r of n){if(![Xr,Kr].includes(r)){j(nm(r,"facet"));break}const o=t[r];if(o.field===void 0){j(Hw(o,r));break}i[r]=this.initFacetFieldDef(o,r)}return i}initFacetFieldDef(t,n){const i=__(t,n);return i.header?i.header=On(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Km(this),this.child.parseData()}parseLayoutSize(){EE(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),xhe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var n,i,r;const t={};for(const o of ui)for(const s of rE){const a=this.component.layoutHeaders[o],u=a[s],{facetFieldDef:l}=a;if(l){const c=cl("titleOrient",l.header,this.config,o);if(["right","bottom"].includes(c)){const f=Lm(o,c);(n=t.titleAnchor)!=null||(t.titleAnchor={}),t.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=o==="row"?"height":"width",f=s==="header"?"headerBand":"footerBand";o!=="facet"&&!this.child.component.layoutSize.get(c)&&((i=t[f])!=null||(t[f]={}),t[f][o]=.5),a.title&&((r=t.offset)!=null||(t.offset={}),t.offset[o==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),P(x(x({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof rd))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof rd?x(x({},this.channelHasField("column")?{encode:{update:{columns:{field:H(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof rd){if(this.child.channelHasField("column")){const r=H(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of yr){const o=this.child.component.scales[r];if(o&&!o.merged){const s=o.get("type"),a=o.get("range");if(Vt(s)&&ls(a)){const u=Bm(this.child,r),l=bE(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):j(Ww(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:o,ops:s,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of ui){const f=this.facet[c];if(f){u.push(H(f));const{bin:d,sort:h}=f;if(Be(d)&&u.push(H(f,{binSuffix:"end"})),wr(h)){const{field:p,op:g=fm}=h,m=SE(f,h);i&&r?(o.push(m),s.push("max"),a.push(m)):(o.push(p),s.push(g),a.push(m))}else if(R(h)){const p=ll(f,c);o.push(p),s.push("max"),a.push(p)}}}const l=!!i&&!!r;return x({name:t,data:n,groupby:u},l||o.length>0?{aggregate:x(x({},l?{cross:l}:{}),o.length?{fields:o,ops:s,as:a}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?wr(i.sort)?[SE(i,i.sort,{expr:"datum"})]:R(i.sort)?[ll(i,t,{expr:"datum"})]:[H(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(wr(r)?r.order:!R(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var r;const{facet:t,config:n}=this;if(t.facet)return oE(t.facet,"facet",n);const i={row:["top","bottom"],column:["left","right"]};for(const o of iE)if(t[o]){const s=cl("labelOrient",(r=t[o])==null?void 0:r.header,n,o);if(i[o].includes(s))return oE(t[o],o,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=yhe(n),r=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),s=t.assembleGroupStyle();return[x(x(x(P(x(x({name:this.getName("cell"),type:"group"},o?{title:o}:{}),s?{style:s}:{}),{from:{facet:this.assembleFacet()},sort:{field:ui.map(u=>this.facetSortFields(u)).flat(),order:ui.map(u=>this.facetSortOrder(u)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(zce(this,[])))]}getMapping(){return this.facet}}function khe(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const o of[n,i])if(wr(o.sort)){const{field:s,op:a=fm}=o.sort;e=r=new ka(e,{joinaggregate:[{op:a,field:s,as:SE(o,o.sort,{forAs:!0})}],groupby:[H(o)]})}return r}return null}function g4(e,t){var n,i,r,o;for(const s of t){const a=s.data;if(e.name&&s.hasName()&&e.name!==s.dataName)continue;const u=(n=e.format)==null?void 0:n.mesh,l=(i=a.format)==null?void 0:i.feature;if(u&&l)continue;const c=(r=e.format)==null?void 0:r.feature;if((c||l)&&c!==l)continue;const f=(o=a.format)==null?void 0:o.mesh;if(!((u||f)&&u!==f)){if(Mm(e)&&Mm(a)){if(lr(e.values,a.values))return s}else if(Gf(e)&&Gf(a)){if(e.url===a.url)return s}else if(B6(e)&&e.name===s.dataName)return s}}return null}function Che(e,t){if(e.data||!e.parent){if(e.data===null){const i=new Sa({values:[]});return t.push(i),i}const n=g4(e.data,t);if(n)return _a(e.data)||(n.data.format=dR({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new Sa(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function $he(e,t,n){var r,o;let i=0;for(const s of t.transforms){let a,u;if(wce(s))u=e=new ul(e,s),a="derived";else if(U_(s)){const l=xde(s);u=e=(r=Kt.makeWithAncestors(e,{},l,n))!=null?r:e,e=new al(e,t,s.filter)}else if(D6(s))u=e=kr.makeFromTransform(e,s,t),a="number";else if(Ece(s))a="date",n.getWithExplicit(s.field).value===void 0&&(e=new Kt(e,{[s.field]:a}),n.set(s.field,a,!1)),u=e=Ar.makeFromTransform(e,s);else if(Sce(s))u=e=Pi.makeFromTransform(e,s),a="number",Z_(t)&&(e=new ys(e));else if(F6(s))u=e=id.make(e,t,s,i++),a="derived";else if(vce(s))u=e=new dl(e,s),a="number";else if(bce(s))u=e=new ka(e,s),a="number";else if(Ace(s))u=e=lo.makeFromTransform(e,s),a="derived";else if(kce(s))u=e=new qm(e,s),a="derived";else if(xce(s))u=e=new jm(e,s),a="derived";else if(dce(s))u=e=new Ym(e,s),a="derived";else if(yce(s))e=new Vm(e,s);else if(_ce(s))u=e=Ca.makeFromTransform(e,s),a="derived";else if(hce(s))u=e=new Um(e,s),a="derived";else if(pce(s))u=e=new Hm(e,s),a="derived";else if(gce(s))u=e=new Gm(e,s),a="derived";else if(mce(s))u=e=new Wm(e,s),a="derived";else{j(Jse(s));continue}if(u&&a!==void 0)for(const l of(o=u.producedFields())!=null?o:[])n.set(l,a,!1)}return e}function Km(e){var p,g,m,y,v,b,w,E,S,_;let t=Che(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:i}=e.component.data,r=e.parent?e.parent.component.data.ancestorParse.clone():new Ice,o=e.data;_a(o)?(U6(o)?t=new Qf(t,o.sequence):W_(o)&&(t=new Zf(t,o.graticule)),r.parseNothing=!0):((p=o==null?void 0:o.format)==null?void 0:p.parse)===null&&(r.parseNothing=!0),t=(g=Kt.makeExplicit(t,e,r))!=null?g:t,t=new ys(t);const s=e.parent&&hl(e.parent);(at(e)||Bi(e))&&s&&(t=(m=kr.makeFromEncoding(t,e))!=null?m:t),e.transforms.length>0&&(t=$he(t,e,r));const a=_de(e),u=wde(e);t=(y=Kt.makeWithAncestors(t,{},x(x({},a),u),r))!=null?y:t,at(e)&&(t=pl.parseAll(t,e),t=nd.parseAll(t,e)),(at(e)||Bi(e))&&(s||(t=(v=kr.makeFromEncoding(t,e))!=null?v:t),t=(b=Ar.makeFromEncoding(t,e))!=null?b:t,t=ul.parseAllForSortIndex(t,e));const l=e.getDataName(Ue.Raw),c=new mn(t,l,Ue.Raw,i);if(n[l]=c,t=c,at(e)){const A=Pi.makeFromEncoding(t,e);A&&(t=A,Z_(e)&&(t=new ys(t))),t=(w=Ca.makeFromEncoding(t,e))!=null?w:t,t=(E=lo.makeFromEncoding(t,e))!=null?E:t}at(e)&&(t=(S=td.make(t,e))!=null?S:t);const f=e.getDataName(Ue.Main),d=new mn(t,f,Ue.Main,i);n[f]=d,t=d,at(e)&&vfe(e,d);let h=null;if(Bi(e)){const A=e.getName("facet");t=(_=khe(t,e.facet))!=null?_:t,h=new fl(t,e,A,d.getSource()),n[A]=h}return P(x({},e.component.data),{outputNodes:n,outputNodeRefCounts:i,raw:c,main:d,facetRoot:h,ancestorParse:r})}class Mhe extends _E{constructor(t,n,i,r){super(t,"concat",n,i,r,t.resolve);var o,s,a,u;(((s=(o=t.resolve)==null?void 0:o.axis)==null?void 0:s.x)==="shared"||((u=(a=t.resolve)==null?void 0:a.axis)==null?void 0:u.y)==="shared")&&j(Vse),this.children=this.getChildren(t).map((l,c)=>ME(l,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=Km(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Am(t)?t.vconcat:R_(t)?t.hconcat:t.concat}parseLayoutSize(){Ehe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=sE(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return x(x(x(x({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return P(x({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function Fhe(e){return e===!1||e===null}const Dhe=P(x({disable:1,gridScale:1,scale:1},Y5),{labelExpr:1,encode:1}),m4=B(Dhe);class AE extends ao{constructor(t={},n={},i=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new AE(he(this.explicit),he(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Fhe(this.get(t))}hasOrientSignalRef(){return oe(this.explicit.orient)}}function The(e,t,n){var l;const{encoding:i,config:r}=e,o=(l=gt(i[t]))!=null?l:gt(i[to(t)]),s=e.axis(t)||{},{format:a,formatType:u}=s;return xa(u)?x({text:g_({fieldOrDatumDef:o,field:"datum.value",format:a,formatType:u,config:r})},n):n}function Ohe(e){return yr.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Bhe(n,e)]),t),{})}const Nhe={bottom:"top",top:"bottom",left:"right",right:"left"};function Rhe(e){var r;const{axes:t,resolve:n}=e.component,i={top:0,bottom:0,right:0,left:0};for(const o of e.children){o.parseAxesAndHeaders();for(const s of B(o.component.axes))n.axis[s]=aE(e.component.resolve,s),n.axis[s]==="shared"&&(t[s]=Lhe(t[s],o.component.axes[s]),t[s]||(n.axis[s]="independent",delete t[s]))}for(const o of yr){for(const s of e.children)if(!!s.component.axes[o]){if(n.axis[o]==="independent"){t[o]=((r=t[o])!=null?r:[]).concat(s.component.axes[o]);for(const a of s.component.axes[o]){const{value:u,explicit:l}=a.getWithExplicit("orient");if(!oe(u)){if(i[u]>0&&!l){const c=Nhe[u];i[u]>i[c]&&a.set("orient",c,!1)}i[u]++}}}delete s.component.axes[o]}if(n.axis[o]==="independent"&&t[o]&&t[o].length>1)for(const s of t[o])!!s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}function Lhe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],o=t[i];if(!!r!=!!o)return;if(r&&o){const s=r.getWithExplicit("orient"),a=o.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;e[i]=Ihe(r,o)}}}else return t.map(n=>n.clone());return e}function Ihe(e,t){for(const n of m4){const i=hs(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,o)=>{switch(n){case"title":return BR(r,o);case"gridScale":return{explicit:r.explicit,value:st(r.value,o.value)}}return $m(r,o,n,"axis")});e.setWithExplicit(n,i)}return e}function Phe(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(oe(n.labelAngle)?n.labelAngle:Tf(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===_L(i,r))return!0}return e===n[t]}const zhe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Bhe(e,t){var g,m,y;let n=t.axis(e);const i=new AE,r=gt(t.encoding[e]),{mark:o,config:s}=t,a=(n==null?void 0:n.orient)||((g=s[e==="x"?"axisX":"axisY"])==null?void 0:g.orient)||((m=s.axis)==null?void 0:m.orient)||$fe(e),u=t.getScaleComponent(e).get("type"),l=wfe(e,u,a,t.config),c=n!==void 0?!n:tE("disable",s.style,n==null?void 0:n.style,l).configValue;if(i.set("disable",c,n!==void 0),c)return i;n=n||{};const f=Afe(r,n,e,s.style,l),d={fieldOrDatumDef:r,axis:n,channel:e,model:t,scaleType:u,orient:a,labelAngle:f,mark:o,config:s};for(const v of m4){const b=v in bL?bL[v](d):V5(v)?n[v]:void 0,w=b!==void 0,E=Phe(b,v,n,t,e);if(w&&E)i.set(v,b,E);else{const{configValue:S=void 0,configFrom:_=void 0}=V5(v)&&v!=="values"?tE(v,s.style,n.style,l):{},A=S!==void 0;w&&!A?i.set(v,b,E):(_!=="vgAxisConfig"||zhe.has(v)&&A||qf(S)||oe(S))&&i.set(v,S,!1)}}const h=(y=n.encoding)!=null?y:{},p=G5.reduce((v,b)=>{var S;if(!i.hasAxisPart(b))return v;const w=ML((S=h[b])!=null?S:{},t),E=b==="labels"?The(t,e,w):w;return E!==void 0&&!Re(E)&&(v[b]={update:E}),v},{});return Re(p)||i.set("encode",p,!!n.encoding||n.labelAngle!==void 0),i}function Uhe({encoding:e,size:t}){for(const n of yr){const i=li(n);Sr(t[i])&&_r(e[n])&&(delete t[i],j(ZR(i)))}return t}function jhe(e,t,n){const i=On(e),r=Fe("orient",i,n);if(i.orient=Ghe(i.type,t,r),r!==void 0&&r!==i.orient&&j(dae(i.orient,r)),i.type==="bar"&&i.orient){const a=Fe("cornerRadiusEnd",i,n);if(a!==void 0){const u=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:Nue[i.orient];for(const l of u)i[l]=a;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Fe("opacity",i,n)===void 0&&(i.opacity=Whe(i.type,t)),Fe("cursor",i,n)===void 0&&(i.cursor=qhe(i,t,n)),i}function qhe(e,t,n){return t.href||e.href||Fe("href",e,n)?"pointer":e.cursor}function Whe(e,t){if(pe([am,l_,c_,f_],e)&&!E_(t))return .7}function Hhe(e,t,{graticule:n}){if(n)return!1;const i=ma("filled",e,t),r=e.type;return st(i,r!==am&&r!==sm&&r!==um)}function Ghe(e,t,n){switch(e){case am:case c_:case f_:case g5:case Aue:case Sue:return}const{x:i,y:r,x2:o,y2:s}=t;switch(e){case om:if(G(i)&&(hn(i.bin)||G(r)&&r.aggregate&&!i.aggregate))return"vertical";if(G(r)&&(hn(r.bin)||G(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o&&(G(i)&&i.type===va&&!Be(i.bin)||v_(i)))return"horizontal";if(!s&&(G(r)&&r.type===va&&!Be(r.bin)||v_(r)))return"vertical"}case um:if(o&&!(G(i)&&hn(i.bin))&&s&&!(G(r)&&hn(r.bin)))return;case rm:if(s)return G(r)&&hn(r.bin)?"horizontal":"vertical";if(o)return G(i)&&hn(i.bin)?"vertical":"horizontal";if(e===um){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case sm:case l_:{const a=_r(i),u=_r(r);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u){const l=i,c=r,f=l.type===Ju,d=c.type===Ju;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate&&e!=="tick"?"horizontal":"vertical"}else return}}return"vertical"}const Yhe={vgMark:"arc",encodeEntry:e=>x(x(x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Xt("x",e,{defaultPos:"mid"})),Xt("y",e,{defaultPos:"mid"})),gs(e,"radius","arc")),gs(e,"theta","arc"))},Vhe={vgMark:"area",encodeEntry:e=>x(x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),Dm("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),Dm("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),K_(e))},Xhe={vgMark:"rect",encodeEntry:e=>x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),gs(e,"x","bar")),gs(e,"y","bar"))},Khe={vgMark:"shape",encodeEntry:e=>x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[x({type:"geoshape",projection:e.projectionName()},n&&G(n)&&n.type===Zu?{field:H(n,{expr:"datum"})}:{})]}},Jhe={vgMark:"image",encodeEntry:e=>x(x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),gs(e,"x","image")),gs(e,"y","image")),V_(e,"url"))},Zhe={vgMark:"line",encodeEntry:e=>x(x(x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Xt("x",e,{defaultPos:"mid"})),Xt("y",e,{defaultPos:"mid"})),At("size",e,{vgChannel:"strokeWidth"})),K_(e))},Qhe={vgMark:"trail",encodeEntry:e=>x(x(x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Xt("x",e,{defaultPos:"mid"})),Xt("y",e,{defaultPos:"mid"})),At("size",e)),K_(e))};function kE(e,t){const{config:n}=e;return x(x(x(x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Xt("x",e,{defaultPos:"mid"})),Xt("y",e,{defaultPos:"mid"})),At("size",e)),At("angle",e)),epe(e,n,t))}function epe(e,t,n){return n?{shape:{value:n}}:At("shape",e)}const tpe={vgMark:"symbol",encodeEntry:e=>kE(e)},npe={vgMark:"symbol",encodeEntry:e=>kE(e,"circle")},ipe={vgMark:"symbol",encodeEntry:e=>kE(e,"square")},rpe={vgMark:"rect",encodeEntry:e=>x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),gs(e,"x","rect")),gs(e,"y","rect"))},ope={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:x(x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Dm("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),Dm("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),At("size",e,{vgChannel:"strokeWidth"}))}},spe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return x(x(x(x(x(x(x(x(x(x({},fi(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),Xt("x",e,{defaultPos:"mid"})),Xt("y",e,{defaultPos:"mid"})),V_(e)),At("size",e,{vgChannel:"fontSize"})),At("angle",e)),eL("align",ape(e.markDef,n,t))),eL("baseline",upe(e.markDef,n,t))),Xt("radius",e,{defaultPos:null})),Xt("theta",e,{defaultPos:null}))}};function ape(e,t,n){if(Fe("align",e,n)===void 0)return"center"}function upe(e,t,n){if(Fe("baseline",e,n)===void 0)return"middle"}const lpe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"width":"height",o=i==="horizontal"?"height":"width";return P(x(x(x(x({},fi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Xt("x",e,{defaultPos:"mid",vgChannel:"xc"})),Xt("y",e,{defaultPos:"mid",vgChannel:"yc"})),At("size",e,{defaultValue:cpe(e),vgChannel:r})),{[o]:Ge(Fe("thickness",n,t))})}};function cpe(e){var a;const{config:t,markDef:n}=e,{orient:i}=n,r=i==="horizontal"?"width":"height",o=e.getScaleComponent(i==="horizontal"?"x":"y"),s=(a=Fe("size",n,t,{vgChannel:r}))!=null?a:t.tick.bandSize;if(s!==void 0)return s;{const u=o?o.get("range"):void 0;return u&&ls(u)&&Oe(u.step)?u.step*3/4:km(t.view,r)*3/4}}const Jm={arc:Yhe,area:Vhe,bar:Xhe,circle:npe,geoshape:Khe,image:Jhe,line:Zhe,point:tpe,rect:rpe,rule:ope,square:ipe,text:spe,tick:lpe,trail:Qhe};function fpe(e){if(pe([sm,rm,kue],e.mark)){const t=J5(e.mark,e.encoding);if(t.length>0)return dpe(e,t)}else if(e.mark===om){const t=jw.some(n=>Fe(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return hpe(e)}return CE(e)}const y4="faceted_path_";function dpe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:y4+e.requestDataName(Ue.Main),data:e.requestDataName(Ue.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:CE(e,{fromPrefix:y4})}]}const v4="stack_group_";function hpe(e){const[t]=CE(e,{fromPrefix:v4}),n=e.scaleName(e.stack.fieldChannel),i=(l={})=>e.vgField(e.stack.fieldChannel,l),r=(l,c)=>{const f=[i({prefix:"min",suffix:"start",expr:c}),i({prefix:"max",suffix:"start",expr:c}),i({prefix:"min",suffix:"end",expr:c}),i({prefix:"max",suffix:"end",expr:c})];return`${l}(${f.map(d=>`scale('${n}',${d})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o=P(x({},Gu(t.encode.update,["y","yc","y2","height",...jw])),{x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update=P(x({},Wn(t.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=P(x({},Gu(t.encode.update,["x","xc","x2","width"])),{y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update=P(x({},Wn(t.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const l of jw){const c=ma(l,e.markDef,e.config);t.encode.update[l]?(o[l]=t.encode.update[l],delete t.encode.update[l]):c&&(o[l]=Ge(c)),c&&(t.encode.update[l]={value:0})}const a=[];if(e.stack.groupbyChannel){const l=e.fieldDef(e.stack.groupbyChannel),c=H(l);c&&a.push(c),((l==null?void 0:l.bin)||(l==null?void 0:l.timeUnit))&&a.push(H(l,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,c)=>{if(t.encode.update[c])return P(x({},l),{[c]:t.encode.update[c]});{const f=ma(c,e.markDef,e.config);return f!==void 0?P(x({},l),{[c]:Ge(f)}):l}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Ue.Main),name:v4+e.requestDataName(Ue.Main),groupby:a,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[t]}]}]}function ppe(e){const{encoding:t,stack:n,mark:i,markDef:r,config:o}=e,s=t.order;if(!(!R(s)&&Ii(s)&&Mw(s.value)||!s&&Mw(Fe("order",r,o)))){if((R(s)||G(s))&&!n)return IR(s,{expr:"datum"});if(cs(i)){const a=r.orient==="horizontal"?"y":"x",u=t[a];if(G(u)){const l=u.sort;if(R(l))return{field:H(u,{prefix:a,suffix:"sort_index",expr:"datum"})};if(wr(l))return{field:H({aggregate:E_(e.encoding)?l.op:void 0,field:l.field},{expr:"datum"})};if(T5(l)){const c=e.fieldDef(l.encoding);return{field:H(c,{expr:"datum"}),order:l.order}}else return l===null?void 0:{field:H(u,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function CE(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:o}=e,s=st(i.clip,gpe(e),mpe(e)),a=RR(i),u=r.key,l=ppe(e),c=ype(e),f=Fe("aria",i,o),d=Jm[n].postEncodingTransform?Jm[n].postEncodingTransform(e):null;return[x(P(x(x(x(x(x(x({name:e.getName("marks"),type:Jm[n].vgMark},s?{clip:!0}:{}),a?{style:a}:{}),u?{key:u.field}:{}),l?{sort:l}:{}),c||{}),f===!1?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(Ue.Main)},encode:{update:Jm[n].encodeEntry(e)}}),d?{transform:d}:{})]}function gpe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function mpe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function ype(e){if(!e.component.selection)return null;const t=B(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=B(i.component.selection).length,i=i.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}class b4 extends f4{constructor(t,n,i,r={},o){super(t,"unit",n,i,o,void 0,p6(t)?t.view:void 0);var l;this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=xr(t.mark)?x({},t.mark):{type:t.mark},a=s.type;s.filled===void 0&&(s.filled=Hhe(s,o,{graticule:t.data&&W_(t.data)}));const u=this.encoding=lle(t.encoding||{},a,s.filled,o);this.markDef=jhe(s,u,o),this.size=Uhe({encoding:u,size:p6(t)?x(x(x({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=_6(a,u),this.specifiedScales=this.initScales(a,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=((l=t.params)!=null?l:[]).filter(c=>O_(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===m5,i=t&&lse.some(r=>le(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return Qg.reduce((i,r)=>{var s;const o=gt(n[r]);return o&&(i[r]=this.initScale((s=o.scale)!=null?s:{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=On(t);return R(n)&&(r.domain=n.map(Hn)),R(i)&&(r.range=i.map(Hn)),r}initAxes(t){return yr.reduce((n,i)=>{const r=t[i];if(le(r)||i===Xe&&le(t.x2)||i===ht&&le(t.y2)){const o=le(r)?r.axis:void 0;n[i]=o&&this.initAxis(x({},o))}return n},{})}initAxis(t){const n=B(t),i={};for(const r of n){const o=t[r];i[r]=qf(o)?TR(o):Hn(o)}return i}initLegends(t){return vse.reduce((n,i)=>{const r=gt(t[i]);if(r&&xse(i)){const o=r.legend;n[i]=o&&On(o)}return n},{})}parseData(){this.component.data=Km(this)}parseLayoutSize(){She(this)}parseSelections(){this.component.selection=yfe(this,this.selection)}parseMarkGroup(){this.component.mark=fpe(this)}parseAxesAndHeaders(){this.component.axes=Ohe(this)}assembleSelectionTopLevelSignals(t){return Bce(this,t)}assembleSignals(){return[...yL(this),...Pce(this,[])]}assembleSelectionData(t){return Uce(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return sE(this)}assembleMarks(){var n;let t=(n=this.component.mark)!=null?n:[];return(!this.parent||!hl(this.parent))&&(t=q6(this,t)),t.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return wa(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Er(n)}typedFieldDef(t){const n=this.fieldDef(t);return ci(n)?n:null}}class $E extends _E{constructor(t,n,i,r,o){super(t,"layer",n,i,o,t.resolve,t.view);const s=x(x(x({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,u)=>{if(Cm(a))return new $E(a,this,this.getName(`layer_${u}`),s,o);if(oo(a))return new b4(a,this,this.getName(`layer_${u}`),s,o);throw new Error(qw(a))})}parseData(){this.component.data=Km(this);for(const t of this.children)t.parseData()}parseLayoutSize(){_he(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){Rhe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),yL(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),sE(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return jce(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),BL(this))}}function ME(e,t,n,i,r){if(dm(e))return new rd(e,t,n,r);if(Cm(e))return new $E(e,t,n,i,r);if(oo(e))return new b4(e,t,n,i,r);if(Ole(e))return new Mhe(e,t,n,r);throw new Error(qw(e))}function vpe(e,t={}){t.logger&&Iae(t.logger),t.fieldTitle&&j5(t.fieldTitle);try{const n=x6(Wa(t.config,e.config)),i=L6(e,n),r=ME(i,null,"",void 0,n);return r.parse(),Pde(r.component.data,r),{spec:xpe(r,bpe(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&Pae(),t.fieldTitle&&ele()}}function bpe(e,t,n,i){const r=i.component.layoutSize.get("width"),o=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):V(t)&&(t={type:t}),r&&o&&Nce(t.type)){if(r==="step"&&o==="step")j(qR()),t.type="pad";else if(r==="step"||o==="step"){const s=r==="step"?"width":"height";j(qR(Zg(s)));const a=s==="width"?"height":"width";t.type=Rce(a)}}return x(x(x({},B(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),P6(n,!1)),P6(e,!0))}function xpe(e,t,n={},i){const r=e.config?Yle(e.config):void 0,o=[].concat(e.assembleSelectionData([]),vhe(e.component.data,n)),s=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(p=>(p.name==="width"||p.name==="height")&&p.value!==void 0?(t[p.name]=+p.value,!1):!0);const h=t,{params:f}=h,d=Z(h,["params"]);return x(x(x(x(P(x(x(x(x(x({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),a?{title:a}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),s.length>0?{projections:s}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...h6(f)])),r?{config:r}:{}),i?{usermeta:i}:{})}const wpe=Qoe.version;var _pe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:wpe,compile:vpe,normalize:L6,deepEqual:lr,duplicate:he,pick:Gu,omit:Wn,stringify:ze,hash:xe,isNullOrFalse:Mw,contains:pe,some:Yu,every:Fw,mergeDeep:dR,unique:cr,isEqual:ise,setEqual:hR,hasIntersection:Dw,prefixGenerator:Tw,fieldIntersection:Ow,isEmpty:Re,keys:B,vals:dn,entries:Qo,isBoolean:Mf,varName:He,logicalExpr:Ff,deleteNestedProperty:Hg,titleCase:Df,accessPathWithDatum:Nw,flatAccessWithDatum:pR,replacePathInField:si,replaceAll:fa,removePathFromField:Rw,accessPathDepth:Vu,getFirstDefined:st,uniqueId:mR,resetIdCounter:ose,internalField:yR,isInternalField:vR,normalizeAngle:Tf,isNumeric:Gg});function x4(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var Epe="vega-themes",Spe="2.10.0",Ape="Themes for stylized Vega and Vega-Lite visualizations.",kpe=["vega","vega-lite","themes","style"],Cpe="BSD-3-Clause",$pe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Mpe=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],Fpe="build/vega-themes.js",Dpe="build/vega-themes.module.js",Tpe="build/vega-themes.min.js",Ope="build/vega-themes.min.js",Npe="build/vega-themes.module.d.ts",Rpe={type:"git",url:"https://github.com/vega/vega-themes.git"},Lpe=["src","build"],Ipe={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},Ppe={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},zpe={vega:"*","vega-lite":"*"},Bpe={name:Epe,version:Spe,description:Ape,keywords:kpe,license:Cpe,author:$pe,contributors:Mpe,main:Fpe,module:Dpe,unpkg:Tpe,jsdelivr:Ope,types:Npe,repository:Rpe,files:Lpe,scripts:Ipe,devDependencies:Ppe,peerDependencies:zpe};const gl="#fff",Upe="#888",jpe={background:"#333",title:{color:gl,subtitleColor:gl},style:{"guide-label":{fill:gl},"guide-title":{fill:gl}},axis:{domainColor:gl,gridColor:Upe,tickColor:gl}},$a="#4572a7",qpe={background:"#fff",arc:{fill:$a},area:{fill:$a},line:{stroke:$a,strokeWidth:2},path:{stroke:$a},rect:{fill:$a},shape:{stroke:$a},symbol:{fill:$a,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Ma="#30a2da",FE="#cbcbcb",Wpe="#999",Hpe="#333",w4="#f0f0f0",_4="#333",Gpe={arc:{fill:Ma},area:{fill:Ma},axis:{domainColor:FE,grid:!0,gridColor:FE,gridWidth:1,labelColor:Wpe,labelFontSize:10,titleColor:Hpe,tickColor:FE,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:w4,group:{fill:w4},legend:{labelColor:_4,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:_4,titleFontSize:14,titlePadding:10},line:{stroke:Ma,strokeWidth:2},path:{stroke:Ma,strokeWidth:.5},rect:{fill:Ma},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Ma},bar:{binSpacing:2,fill:Ma,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Fa="#000",Ype={group:{fill:"#e5e5e5"},arc:{fill:Fa},area:{fill:Fa},line:{stroke:Fa},path:{stroke:Fa},rect:{fill:Fa},shape:{stroke:Fa},symbol:{fill:Fa,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Vpe=22,Xpe="normal",E4="Benton Gothic, sans-serif",S4=11.5,Kpe="normal",Da="#82c6df",DE="Benton Gothic Bold, sans-serif",A4="normal",k4=13,od={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},Jpe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:DE,fontSize:Vpe,fontWeight:Xpe},arc:{fill:Da},area:{fill:Da},line:{stroke:Da,strokeWidth:2},path:{stroke:Da},rect:{fill:Da},shape:{stroke:Da},symbol:{fill:Da,size:30},axis:{labelFont:E4,labelFontSize:S4,labelFontWeight:Kpe,titleFont:DE,titleFontSize:k4,titleFontWeight:A4},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:E4,labelFontSize:S4,symbolType:"square",titleFont:DE,titleFontSize:k4,titleFontWeight:A4},range:{category:od["category-6"],diverging:od["fireandice-6"],heatmap:od["fire-7"],ordinal:od["fire-7"],ramp:od["fire-7"]}},Ta="#ab5787",Zm="#979797",Zpe={background:"#f9f9f9",arc:{fill:Ta},area:{fill:Ta},line:{stroke:Ta},path:{stroke:Ta},rect:{fill:Ta},shape:{stroke:Ta},symbol:{fill:Ta,size:30},axis:{domainColor:Zm,domainWidth:.5,gridWidth:.2,labelColor:Zm,tickColor:Zm,tickWidth:.2,titleColor:Zm},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Oa="#3e5c69",Qpe={background:"#fff",arc:{fill:Oa},area:{fill:Oa},line:{stroke:Oa},path:{stroke:Oa},rect:{fill:Oa},shape:{stroke:Oa},symbol:{fill:Oa},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},di="#1696d2",C4="#000000",ege="#FFFFFF",Qm="Lato",TE="Lato",tge="Lato",nge="#DEDDDD",ige=18,sd={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},rge={background:ege,title:{anchor:"start",fontSize:ige,font:Qm},axisX:{domain:!0,domainColor:C4,domainWidth:1,grid:!1,labelFontSize:12,labelFont:TE,labelAngle:0,tickColor:C4,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Qm},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:nge,gridWidth:1,labelFontSize:12,labelFont:TE,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Qm,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:TE,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Qm,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:sd["six-groups-cat-1"],diverging:sd["diverging-colors"],heatmap:sd["diverging-colors"],ordinal:sd["six-groups-seq"],ramp:sd["shades-blue"]},area:{fill:di},rect:{fill:di},line:{color:di,stroke:di,strokeWidth:5},trail:{color:di,stroke:di,strokeWidth:0,size:1},path:{stroke:di,strokeWidth:.5},point:{filled:!0},text:{font:tge,color:di,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:di,stroke:null}},arc:{fill:di},shape:{stroke:di},symbol:{fill:di,size:30}},Na="#3366CC",$4="#ccc",e0="Arial, sans-serif",oge={arc:{fill:Na},area:{fill:Na},path:{stroke:Na},rect:{fill:Na},shape:{stroke:Na},symbol:{stroke:Na},circle:{fill:Na},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:e0,fontSize:12},"guide-title":{font:e0,fontSize:12},"group-title":{font:e0,fontSize:12}},title:{font:e0,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:$4,tickColor:$4,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},sge=Bpe.version;var age=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:jpe,excel:qpe,fivethirtyeight:Gpe,ggplot2:Ype,googlecharts:oge,latimes:Jpe,quartz:Zpe,urbaninstitute:rge,version:sge,vox:Qpe}),uge=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const M4="vg-tooltip-element",lge={offsetX:10,offsetY:10,id:M4,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:cge,maxDepth:2};function cge(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function fge(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return uge.toString().replace(M4,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function dge(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function hge(e,t,n){if(R(e))return`[${e.map(i=>t(V(i)?i:F4(i,n))).join(", ")}]`;if(J(e)){let i="";const r=e,{title:o,image:s}=r,a=dge(r,["title","image"]);o&&(i+=`<h2>${t(o)}</h2>`),s&&(i+=`<img src="${t(s)}">`);const u=Object.keys(a);if(u.length>0){i+="<table>";for(const l of u){let c=a[l];c!==void 0&&(J(c)&&(c=F4(c,n)),i+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function pge(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function F4(e,t){return JSON.stringify(e,pge(t))}function gge(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let o=e.clientY+i;return o+t.height>window.innerHeight&&(o=+e.clientY-i-t.height),{x:r,y:o}}class mge{constructor(t){this.options=Object.assign(Object.assign({},lge),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=fge(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=hge(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:a}=gge(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${a}px; left: ${s}px`)}}function yge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D4(e,t,n,i,r,o,s){try{var a=e[o](s),u=a.value}catch(l){n(l);return}a.done?t(u):Promise.resolve(u).then(i,r)}function t0(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function s(u){D4(o,i,r,s,a,"next",u)}function a(u){D4(o,i,r,s,a,"throw",u)}s(void 0)})}}var T4=Object.prototype,Ra=T4.hasOwnProperty,Cr,OE=typeof Symbol=="function"?Symbol:{},n0=OE.iterator||"@@iterator",vge=OE.asyncIterator||"@@asyncIterator",i0=OE.toStringTag||"@@toStringTag";function O4(e,t,n,i){var r=t&&t.prototype instanceof RE?t:RE,o=Object.create(r.prototype),s=new zE(i||[]);return o._invoke=Ege(e,n,s),o}function NE(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}var N4="suspendedStart",bge="suspendedYield",R4="executing",r0="completed",Ui={};function RE(){}function o0(){}function ml(){}var LE={};LE[n0]=function(){return this};var IE=Object.getPrototypeOf,s0=IE&&IE(IE(BE([])));s0&&s0!==T4&&Ra.call(s0,n0)&&(LE=s0);var yl=ml.prototype=RE.prototype=Object.create(LE);o0.prototype=yl.constructor=ml,ml.constructor=o0,ml[i0]=o0.displayName="GeneratorFunction";function L4(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function I4(e){var t=typeof e=="function"&&e.constructor;return t?t===o0||(t.displayName||t.name)==="GeneratorFunction":!1}function xge(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,ml):(e.__proto__=ml,i0 in e||(e[i0]="GeneratorFunction")),e.prototype=Object.create(yl),e}function wge(e){return{__await:e}}function a0(e,t){function n(o,s,a,u){var l=NE(e[o],e,s);if(l.type==="throw")u(l.arg);else{var c=l.arg,f=c.value;return f&&typeof f=="object"&&Ra.call(f,"__await")?t.resolve(f.__await).then(function(d){n("next",d,a,u)},function(d){n("throw",d,a,u)}):t.resolve(f).then(function(d){c.value=d,a(c)},function(d){return n("throw",d,a,u)})}}var i;function r(o,s){function a(){return new t(function(u,l){n(o,s,u,l)})}return i=i?i.then(a,a):a()}this._invoke=r}L4(a0.prototype),a0.prototype[vge]=function(){return this};function _ge(e,t,n,i,r){r===void 0&&(r=Promise);var o=new a0(O4(e,t,n,i),r);return I4(t)?o:o.next().then(function(s){return s.done?s.value:o.next()})}function Ege(e,t,n){var i=N4;return function(o,s){if(i===R4)throw new Error("Generator is already running");if(i===r0){if(o==="throw")throw s;return z4()}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var u=P4(a,n);if(u){if(u===Ui)continue;return u}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(i===N4)throw i=r0,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);i=R4;var l=NE(e,t,n);if(l.type==="normal"){if(i=n.done?r0:bge,l.arg===Ui)continue;return{value:l.arg,done:n.done}}else l.type==="throw"&&(i=r0,n.method="throw",n.arg=l.arg)}}}function P4(e,t){var n=e.iterator[t.method];if(n===Cr){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=Cr,P4(e,t),t.method==="throw"))return Ui;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return Ui}var i=NE(n,e.iterator,t.arg);if(i.type==="throw")return t.method="throw",t.arg=i.arg,t.delegate=null,Ui;var r=i.arg;if(!r)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,Ui;if(r.done)t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=Cr);else return r;return t.delegate=null,Ui}L4(yl),yl[i0]="Generator",yl[n0]=function(){return this},yl.toString=function(){return"[object Generator]"};function Sge(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function PE(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function zE(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(Sge,this),this.reset(!0)}function Age(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}}function BE(e){if(e){var t=e[n0];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(Ra.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=Cr,r.done=!0,r};return i.next=i}}return{next:z4}}function z4(){return{value:Cr,done:!0}}zE.prototype={constructor:zE,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=Cr,this.done=!1,this.delegate=null,this.method="next",this.arg=Cr,this.tryEntries.forEach(PE),!t)for(var n in this)n.charAt(0)==="t"&&Ra.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=Cr)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(l,c){return s.type="throw",s.arg=t,n.next=l,c&&(n.method="next",n.arg=Cr),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if(o.tryLoc==="root")return i("end");if(o.tryLoc<=this.prev){var a=Ra.call(o,"catchLoc"),u=Ra.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else if(u){if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&Ra.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&(t==="break"||t==="continue")&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=n,o?(this.method="next",this.next=o.finallyLoc,Ui):this.complete(s)},complete:function(t,n){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&n&&(this.next=n),Ui},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),PE(i),Ui}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if(r.type==="throw"){var o=r.arg;PE(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:BE(t),resultName:n,nextLoc:i},this.method==="next"&&(this.arg=Cr),Ui}};var bs={wrap:O4,isGeneratorFunction:I4,AsyncIterator:a0,mark:xge,awrap:wge,async:_ge,keys:Age,values:BE};function kge(e,t,n){var i=e.open(t),r=1e4,o=250,s=new URL(t),a=s.origin,u=~~(r/o);function l(f){f.source===i&&(u=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function c(){u<=0||(i.postMessage(n,a),setTimeout(c,o),u-=1)}setTimeout(c,o)}var Cge=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper.fit-x {
    width: 100%; }
  .vega-embed .chart-wrapper.fit-y {
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function B4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,o=n;r<o.length;r++){var s=o[r];$ge(e,s)}return e}function $ge(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];Ml(e,r,t[r],!0)}}var UE;function U4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function xs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?U4(Object(n),!0).forEach(function(i){yge(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U4(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var ws=Foe,ad=_pe,u0=typeof window!="undefined"?window:void 0;ad===void 0&&u0!==null&&u0!==void 0&&(UE=u0.vl)!==null&&UE!==void 0&&UE.compile&&(ad=u0.vl);var Mge={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},Fge={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},ud={vega:"Vega","vega-lite":"Vega-Lite"},l0={vega:ws.version,"vega-lite":ad?ad.version:"not available"},Dge={vega:e=>e,"vega-lite":(e,t)=>ad.compile(e,{config:t}).spec},Tge=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,Oge="chart-wrapper";function Nge(e){return typeof e=="function"}function j4(e,t,n,i){var r="<html><head>".concat(t,'</head><body><pre><code class="json">'),o="</code></pre>".concat(n,"</body></html>"),s=window.open("");s.document.write(r+e+o),s.document.title="".concat(ud[i]," JSON Source")}function Rge(e,t){if(e.$schema){var n=x4(e.$schema);if(t&&t!==n.library){var i;console.warn("The given visualization spec is written in ".concat(ud[n.library],", but mode argument sets ").concat((i=ud[t])!==null&&i!==void 0?i:t,"."))}var r=n.library;return WS.satisfies(l0[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(ud[r]," ").concat(n.version,", but the current version of ").concat(ud[r]," is v").concat(l0[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function Lge(e){return!!(e&&"load"in e)}function q4(e){return Lge(e)?e:ws.loader(e)}function W4(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function Ige(e,t){return jE.apply(this,arguments)}function jE(){return jE=t0(bs.mark(function e(t,n){var i,r,o,s,a,u,l,c,f,d,h=arguments;return bs.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(o=h.length>2&&h[2]!==void 0?h[2]:{},!V(n)){g.next=10;break}return a=q4(o.loader),g.t0=JSON,g.next=6,a.load(n);case 6:g.t1=g.sent,s=g.t0.parse.call(g.t0,g.t1),g.next=11;break;case 10:s=n;case 11:return u=W4(s).loader,(!a||u)&&(a=q4((l=o.loader)!==null&&l!==void 0?l:u)),g.next=15,H4(W4(s),a);case 15:return c=g.sent,g.next=18,H4(o,a);case 18:return f=g.sent,d=xs(xs({},B4(f,c)),{},{config:Wa((i=f.config)!==null&&i!==void 0?i:{},(r=c.config)!==null&&r!==void 0?r:{})}),g.next=22,zge(t,s,d,a);case 22:return g.abrupt("return",g.sent);case 23:case"end":return g.stop()}},e)})),jE.apply(this,arguments)}function H4(e,t){return qE.apply(this,arguments)}function qE(){return qE=t0(bs.mark(function e(t,n){var i,r,o;return bs.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!V(t.config)){a.next=8;break}return a.t1=JSON,a.next=4,n.load(t.config);case 4:a.t2=a.sent,a.t0=a.t1.parse.call(a.t1,a.t2),a.next=9;break;case 8:a.t0=(i=t.config)!==null&&i!==void 0?i:{};case 9:if(r=a.t0,!V(t.patch)){a.next=18;break}return a.t4=JSON,a.next=14,n.load(t.patch);case 14:a.t5=a.sent,a.t3=a.t4.parse.call(a.t4,a.t5),a.next=19;break;case 18:a.t3=t.patch;case 19:return o=a.t3,a.abrupt("return",xs(xs(xs({},t),o?{patch:o}:{}),r?{config:r}:{}));case 21:case"end":return a.stop()}},e)})),qE.apply(this,arguments)}function Pge(e){var t=e.getRootNode?e.getRootNode():document;if(t instanceof ShadowRoot)return{root:t,rootContainer:t};var n;return{root:document,rootContainer:(n=document.head)!==null&&n!==void 0?n:document.body}}function zge(e,t){return WE.apply(this,arguments)}function WE(){return WE=t0(bs.mark(function e(t,n){var i,r,o,s,a,u,l,c,f,d,h,p,g,m,y,v,b,w,E,S,_,A,C,k,$,F,D,L,M,I,U,Y,Q,ce,$e,De,qe,Pe,mt,hi,pi,yn,X,ue,ye,z,Ke,ve=arguments;return bs.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:if(Ke=function(){ce&&document.removeEventListener("click",ce),L.finalize()},u=ve.length>2&&ve[2]!==void 0?ve[2]:{},l=ve.length>3?ve[3]:void 0,c=u.theme?Wa(age[u.theme],(i=u.config)!==null&&i!==void 0?i:{}):u.config,f=go(u.actions)?u.actions:B4({},Mge,(r=u.actions)!==null&&r!==void 0?r:{}),d=xs(xs({},Fge),u.i18n),h=(o=u.renderer)!==null&&o!==void 0?o:"canvas",p=(s=u.logLevel)!==null&&s!==void 0?s:ws.Warn,g=(a=u.downloadFileName)!==null&&a!==void 0?a:"visualization",m=typeof t=="string"?document.querySelector(t):t,m){Ye.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return u.defaultStyle!==!1&&(y="vega-embed-style",v=Pge(m),b=v.root,w=v.rootContainer,b.getElementById(y)||(E=document.createElement("style"),E.id=y,E.innerText=u.defaultStyle===void 0||u.defaultStyle===!0?Cge.toString():u.defaultStyle,w.appendChild(E))),S=Rge(n,u.mode),_=Dge[S](n,c),S==="vega-lite"&&_.$schema&&(A=x4(_.$schema),WS.satisfies(l0.vega,"^".concat(A.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(A.version,", but current version is v").concat(l0.vega,"."))),m.classList.add("vega-embed"),f&&m.classList.add("has-actions"),m.innerHTML="",C=m,f&&(k=document.createElement("div"),k.classList.add(Oge),m.appendChild(k),C=k),$=u.patch,$&&($ instanceof Function?_=$(_):_=md(_,$,!0,!1).newDocument),u.formatLocale&&ws.formatLocale(u.formatLocale),u.timeFormatLocale&&ws.timeFormatLocale(u.timeFormatLocale),F=u.ast,D=ws.parse(_,S==="vega-lite"?{}:c,{ast:F}),L=new(u.viewClass||ws.View)(D,xs({loader:l,logLevel:p,renderer:h},F?{expr:ws.expressionInterpreter}:{})),L.addSignalListener("autosize",(et,rt)=>{var Nt=rt.type;Nt=="fit-x"?(C.classList.add("fit-x"),C.classList.remove("fit-y")):Nt=="fit-y"?(C.classList.remove("fit-x"),C.classList.add("fit-y")):Nt=="fit"?C.classList.add("fit-x","fit-y"):C.classList.remove("fit-x","fit-y")}),u.tooltip!==!1&&(Nge(u.tooltip)?M=u.tooltip:M=new mge(u.tooltip===!0?{}:u.tooltip).call,L.tooltip(M)),I=u.hover,I===void 0&&(I=S==="vega"),I&&(U=typeof I=="boolean"?{}:I,Y=U.hoverSet,Q=U.updateSet,L.hover(Y,Q)),u&&(u.width!=null&&L.width(u.width),u.height!=null&&L.height(u.height),u.padding!=null&&L.padding(u.padding)),Ye.next=36,L.initialize(C,u.bind).runAsync();case 36:if(f!==!1){if($e=m,u.defaultStyle!==!1&&(De=document.createElement("details"),De.title=d.CLICK_TO_VIEW_ACTIONS,m.append(De),$e=De,qe=document.createElement("summary"),qe.innerHTML=Tge,De.append(qe),ce=et=>{De.contains(et.target)||De.removeAttribute("open")},document.addEventListener("click",ce)),Pe=document.createElement("div"),$e.append(Pe),Pe.classList.add("vega-actions"),f===!0||f.export!==!1)for(mt=function(){var rt=pi[hi];if(f===!0||f.export===!0||f.export[rt]){var Nt=d["".concat(rt.toUpperCase(),"_ACTION")],co=document.createElement("a");co.text=Nt,co.href="#",co.target="_blank",co.download="".concat(g,".").concat(rt),co.addEventListener("mousedown",function(){var Z4=t0(bs.mark(function HE(Q4){var GE;return bs.wrap(function(vl){for(;;)switch(vl.prev=vl.next){case 0:return Q4.preventDefault(),vl.next=3,L.toImageURL(rt,u.scaleFactor);case 3:GE=vl.sent,this.href=GE;case 5:case"end":return vl.stop()}},HE,this)}));return function(HE){return Z4.apply(this,arguments)}}()),Pe.append(co)}},hi=0,pi=["svg","png"];hi<pi.length;hi++)mt();(f===!0||f.source!==!1)&&(yn=document.createElement("a"),yn.text=d.SOURCE_ACTION,yn.href="#",yn.addEventListener("click",function(et){var rt,Nt;j4(A0(n),(rt=u.sourceHeader)!==null&&rt!==void 0?rt:"",(Nt=u.sourceFooter)!==null&&Nt!==void 0?Nt:"",S),et.preventDefault()}),Pe.append(yn)),S==="vega-lite"&&(f===!0||f.compiled!==!1)&&(X=document.createElement("a"),X.text=d.COMPILED_ACTION,X.href="#",X.addEventListener("click",function(et){var rt,Nt;j4(A0(_),(rt=u.sourceHeader)!==null&&rt!==void 0?rt:"",(Nt=u.sourceFooter)!==null&&Nt!==void 0?Nt:"","vega"),et.preventDefault()}),Pe.append(X)),(f===!0||f.editor!==!1)&&(ye=(ue=u.editorUrl)!==null&&ue!==void 0?ue:"https://vega.github.io/editor/",z=document.createElement("a"),z.text=d.EDITOR_ACTION,z.href="#",z.addEventListener("click",function(et){kge(window,ye,{config:c,mode:S,renderer:h,spec:A0(n)}),et.preventDefault()}),Pe.append(z))}return Ye.abrupt("return",{view:L,spec:n,vgSpec:_,finalize:Ke});case 38:case"end":return Ye.stop()}},e)})),WE.apply(this,arguments)}export{KE as A,kI as B,LI as C,oI as D,lI as E,aI as F,Ia as G,cI as H,bI as I,h0 as J,Ige as K,uI as L,vI as M,RI as S,nS as a,pI as b,gI as c,c0 as d,f0 as e,tS as f,iS as g,yI as h,NI as i,DI as j,dI as k,hI as l,TI as m,mI as n,aS as o,MI as p,FI as q,$I as r,QE as s,cd as t,CI as u,sS as v,uS as w,_I as x,wI as y,xI as z};
